\documentclass[../../main.tex]{subfiles}
\graphicspath{{\subfix{../../image/}}} % 指定图片目录,后续可以直接使用图片文件名。

% 例如:
% \begin{figure}[H]
% \centering
% \includegraphics[scale=0.4]{图.png}
% \caption{}
% \label{figure:图}
% \end{figure}
% 注意:上述\label{}一定要放在\caption{}之后,否则引用图片序号会只会显示??.

\begin{document}

\section{凸性相关积分不等式}

\begin{proposition}\label{proposition:凸性积分不等式}
设\( f \)是\([0,1]\)上的下凸函数，则有
\begin{align*}
&\qquad \quad  f(t) \leqslant \frac{1-t}{t} \int_0^t f(x)\,\text{d}x + \frac{t}{1-t}\int_t^1 f(x)\,\text{d}x
\\
&\iff t(1 - t)f(t) \leqslant (1 - t)^2 \int_{0}^{t} f(x) \, \mathrm{d}x + t^2 \int_{t}^{1} f(x) \, \mathrm{d}x.
\end{align*}
\end{proposition}
\begin{note}
记忆这不等式以及这个不等式的证明!
\end{note}
\begin{proof}
设\( t \in (0,1) \)，对于\( x \in [0,1] \)，有
\[
t = (1-t)(tx) + t(1 - x + tx).
\]
因此根据下凸函数的性质，得
\[
f(t) \leqslant (1-t)f(tx) + tf(1 - x + tx).
\]
上式对变量\( x \)在\([a,b]\)上积分，得
\begin{align*}
f(t) &\leqslant (1-t)\int_0^1 f(tx)\,\text{d}x + t\int_0^1 f(1 - x + tx)\,\text{d}x \\
&= \frac{1-t}{t}\int_0^t{f(x)\,\mathrm{d}x}+\frac{t}{1-t}\int_t^1{f(x)\,\mathrm{d}x}.
\end{align*}

\end{proof}

\begin{example}
设\( f \)是\([0,1]\)上的下凸函数，求证:
\[
\int_0^1 t(1-t)f(t)\,\text{d}t \leqslant \frac{1}{3}\int_0^1 \left(t^3 + (1-t)^3\right)f(t)\,\text{d}t.
\]
\end{example}
\begin{note}
利用凸函数积分不等式\refpro{proposition:凸性积分不等式}.
\end{note}
\begin{proof}
设\( t \in (0,1) \)，对于\( x \in [0,1] \)，有
\[
t = (1-t)(tx) + t(1 - x + tx).
\]
因此根据下凸函数的性质，得
\[
f(t) \leqslant (1-t)f(tx) + tf(1 - x + tx).
\]
上式对变量\( x \)在\([0,1]\)上积分，得
\begin{align*}
f(t) &\leqslant (1-t)\int_0^1 f(tx)\,\text{d}x + t\int_0^1 f(1 - x + tx)\,\text{d}x \\
&= \frac{1-t}{t} \int_0^t f(x)\,\text{d}x + \frac{t}{1-t}\int_t^1 f(x)\,\text{d}x.
\end{align*}
因而
\[
t(1-t)f(t) \leqslant (1-t)^2\int_0^t f(x)\,\text{d}x + t^2\int_t^1 f(x)\,\text{d}x, \, t \in [0,1].
\]
积分可得
\begin{align*}
\int_0^1{t(1}-t)f(t)\,\mathrm{d}t&\leqslant \int_0^1{\left[ (1-t)^2\int_0^t{f(x)\,\mathrm{d}x} \right] \mathrm{d}t}+\int_0^1{\left[ t^2\int_t^1{f(x)\,\mathrm{d}x} \right] \mathrm{d}t}
\\
&=\int_0^1{\left[ f\left( x \right) \int_x^1{(1-t)^2\,\mathrm{d}t} \right] \mathrm{d}x}+\int_0^1{\left[ f(x)\int_0^x{\,t^2\mathrm{d}t} \right] \mathrm{d}x}
\\
&=\frac{1}{3}\int_0^1{\left( x^3+(1-x)^3 \right) f(x)\,\mathrm{d}x}.
\end{align*}

\end{proof}

\begin{proposition}\label{proposition:凸函数相关积分不等式11111}
设 $f$ 是 $[a,b]$ 上的非负上凸函数. 证明对任何 $x \in [a,b]$, 都有
\begin{align}\label{equation-凸性相关积分-16.40}
f(x) &\leqslant \frac{2}{b - a}\int_{a}^{b}f(y)\mathrm{d}y.
\end{align} 
\end{proposition}
\begin{remark}
$\mathbb{Step}\mathbb{2}$中的$g(x)$的构造可以类比Lagrange中值定理的构造函数(关键是这个构造函数的几何直观).
\end{remark}
\begin{note}
这种只考虑函数端点函数值同为0的情形,再
通过构造$g(x)=f(x)-p(x)$(其中$p(x)$是$f$过两个端点的直线),将其推广到一般情况的想法很重要!
\end{note}
\begin{proof}
{\color{blue}证法一:}利用\hyperref[proposition:下凸函数的基本性质]{割线不等式}可得, 对$\forall x\in [a,b]$, 都有
\begin{align*}
\int_a^b{f\left( x \right) \mathrm{d}x}&= \int_a^x{f\left( y \right) \mathrm{d}y}+\int_x^b{f\left( y \right) \mathrm{d}y}
\\
&\geqslant \int_a^x{\left[ \frac{f\left( x \right) -f\left( a \right)}{x-a}\left( y-a \right) +f\left( a \right) \right] \mathrm{d}y}+\int_x^b{\left[ \frac{f\left( b \right) -f\left( x \right)}{b-x}\left( y-b \right) +f\left( b \right) \right] \mathrm{d}y}
\\
&=\frac{f\left( x \right) +f\left( a \right)}{2}\left( x-a \right) +\frac{f\left( x \right) +f\left( b \right)}{2}\left( b-x \right) 
\\
&=\frac{b-a}{2}f\left( x \right) +\frac{\left( x-a \right) f\left( a \right) +\left( b-x \right) f\left( b \right)}{2}
\\
&\geqslant \frac{b-a}{2}f\left( x \right) .
\end{align*}

{\color{blue}证法二:}由\hyperref[corollary:开集上的下凸函数必连续]{开集上的凸函数必连续}可知, 开集上的上凸函数连续且有限个点不影响积分值. 又由\hyperref[proposition:下凸函数的单调性刻画]{凸函数单调性的刻画}, 我们知道
\[\lim_{x \to a^+}f(x), \lim_{x \to b^-}f(x)\]
是存在的. 因此不妨设 $f \in C[a,b]$.不妨设$a=0,b=1$,否则用$f(a+(b-a)x)$代替$f(x)$即可.

$\mathbb{Step}\mathbb{1}$ 当
\[f(a) = f(b) = 0, x_0\text{是}f(x)\text{最大值点}, x_0 \in (a,b),\]
我们利用上凸函数一定在割线上放缩得不等式
\[
\begin{cases}
f(x) \geqslant   \frac{f(x_0) }{x_0 }x, &x \in [0,x_0]\\
f(x) \geqslant \frac{f(x_0) }{x_0 - 1}(x - 1), &x \in [x_0,1]
\end{cases}.
\]
运用得到的不等式就有
\begin{align*}
\int_0^1{f(x)\mathrm{d}x\geqslant \int_0^{x_0}{\frac{f(x_0)}{x_0}x}}\mathrm{d}x+\int_{x_0}^1{\frac{f(x_0)}{x_0-1}(x}-1)\mathrm{d}x=\frac{1}{2}f(x_0),
\end{align*}
这就相当于得到了不等式\eqref{equation-凸性相关积分-16.40}.

当$x_0=a\text{或}b$时,由$f(a)=f(b)=0$且$f$非负可知,此时$f(x)\equiv 0$结论显然成立.

$\mathbb{Step}\mathbb{2}$ 一般情况可设
\begin{align*}
g\left( x \right) =f\left( x \right) -\left[ f\left( 1 \right) -f\left( 0 \right) \right] x-f\left( 0 \right) ,
\end{align*}
从而$g(0)=g(1)=0,$
于是 $g$ 就满足 $\mathbb{Step}\mathbb{1}$ 中的条件. 因此由\eqref{equation-凸性相关积分-16.40}知
\begin{align}\label{equation-凸性相关积分-16.41}
g\left( x \right) \leqslant 2\int_0^1{g\left( y \right) \mathrm{d}y,}\forall x\in [0,1].
\end{align}
于是利用\eqref{equation-凸性相关积分-16.41}知
\begin{align*}
f\left( x \right) -\left[ \left( f\left( 1 \right) -f\left( 0 \right) \right) x+f\left( 0 \right) \right] \leqslant 2\int_0^1{f\left( y \right) \mathrm{d}y}-2\int_0^1{\left[ \left( f\left( 1 \right) -f\left( 0 \right) \right) y+f\left( 0 \right) \right] \mathrm{d}y},\forall x\in [0,1].
\end{align*}
从而
\begin{align*}
f\left( x \right) -2\int_0^1{f\left( y \right) \mathrm{d}y}\leqslant \left[ \left( f\left( 1 \right) -f\left( 0 \right) \right) x+f\left( 0 \right) \right] -2\int_0^1{\left[ \left( f\left( 1 \right) -f\left( 0 \right) \right) y+f\left( 0 \right) \right] \mathrm{d}y},\forall x\in [0,1].
\end{align*}
注意到对$\forall x\in [0,1]$,都有
\begin{align*}
&\quad \quad \left[ \left( f\left( 1 \right) -f\left( 0 \right) \right) x+f\left( 0 \right) \right] -2\int_0^1{\left[ \left( f\left( 1 \right) -f\left( 0 \right) \right) y+f\left( 0 \right) \right] \mathrm{d}y}\leqslant 0
\\
&\Leftrightarrow \left[ f\left( 1 \right) -f\left( 0 \right) \right] x+f\left( 0 \right) \leqslant 2\int_0^1{\left[ \left( f\left( 1 \right) -f\left( 0 \right) \right) x+f\left( 0 \right) \right] \mathrm{d}x}
\\
&\Leftrightarrow \left[ f\left( 1 \right) -f\left( 0 \right) \right] x+f\left( 0 \right) \leqslant f\left( 1 \right) +f\left( 0 \right) 
\\
&\Leftrightarrow \left[ f\left( 1 \right) -f\left( 0 \right) \right] x\leqslant f\left( 1 \right) 
\\
&\Leftrightarrow f\left( 1 \right) \left( 1-x \right) +f\left( 0 \right) x\geqslant 0
\end{align*}
上述最后一个不等式可由$x\in[0,1],f(1),f(0)\geqslant  0$直接得到.
于是我们完成了证明. 

\end{proof}

\begin{example}
设 \( f \in C^2[0, 1] \) 是下凸函数且满足 \( \int_0^1 f(x)\mathrm{d}x = 0 \)，证明：
\[ |f(x)| \leqslant \max\{f(0), f(1)\}, \forall x \in [0, 1]. \]
\end{example}
\begin{proof}
因为$f\in C^2\left[ 0,1 \right]$且下凸, 所以由\hyperref[proposition:下凸函数的单调性刻画]{下凸函数的单调性刻画}知$f$的单调性只可能是递增、递减、先减后增其中一种. 无论是哪种情况, 都有$f$的最大值一定在端点$0,1$处取到.
记$f$的最大值点为$c\in \{ 0,1 \}$, $f$的最小值点$d\in [0,1]$, 则$f\left( c \right) =\max \left\{ f\left( 0 \right) ,f\left( 1 \right) \right\}$.
由$\int_0^1{f\left( x \right) \mathrm{d}x}=0$及积分中值定理知, 存在$\xi \in (0,1)$, 使得$f\left( \xi \right) =0$, 故$f\left( c \right) \geqslant 0$. 于是利用\refpro{proposition:凸函数相关积分不等式11111}可得, 有
\begin{align*}
f\left( c \right) -f\left( d \right) \leqslant f\left( c \right) -2\int_0^1{f\left( x \right) \mathrm{d}x}=f\left( c \right) \Longrightarrow f\left( d \right) \geqslant 0\geqslant -f\left( c \right) .
\end{align*}
故对$\forall x\in [0,1]$, 都有
\begin{gather*}
-\max \left\{ f\left( 0 \right) ,f\left( 1 \right) \right\} =-f\left( c \right) \leqslant f\left( x \right) \leqslant f\left( c \right) =\max \left\{ f\left( 0 \right) ,f\left( 1 \right) \right\} \\
\Longleftrightarrow \left| f\left( x \right) \right|\leqslant \max \left\{ f\left( 0 \right) ,f\left( 1 \right) \right\} .
\end{gather*}

\end{proof}

\begin{proposition}\label{proposition:下凸函数可构造右半递增偶函数}
设$g$是$[-1,1]$上的下凸函数,$h(x)=g(x)+g(-x)$,则$h$在$[0,1]$上单调递增.
\end{proposition}
\begin{proof}
{\color{blue}证法一:}由\hyperref[theorem:Bernstein多项式的性质]{Bernstein多项式的性质}知$g$的Bernstein多项式$B_n(g,x)$可导且$B_n(g,x) \rightrightarrows  g(x),\, B_n'(g,x)\rightrightarrows  g'(x)$,并且$B_n(g,x)$仍是$[-1,1]$上的下凸函数.故可不妨设$g\in D[-1,1]$.再由$g$的下凸性知,$g'(x)$递增.故
$$
h'(x)=g'(x)-g'(-x)\geqslant 0,\quad \forall x\in [0,1].
$$
因此$h$在$[0,1]$上递增.

{\color{blue}证法二:}对$\forall 0\leqslant a<b\leqslant 1$,固定$a,b.$

$\left( \mathrm{i} \right)$当$a>0$时,由$g$的下凸性知
\begin{align}\label{eq:::890u834t1.8923r1}
\frac{g\left( a \right) -g\left( 0 \right)}{a}\leqslant \frac{g\left( b \right) -g\left( a \right)}{b-a}.
\end{align}
注意到$-b<-a<0$,再利用$g$的下凸性知
\begin{align}\label{eq:::890u834t1.8923r2}
\frac{g\left( -a \right) -g\left( -b \right)}{-a-\left( -b \right)}\leqslant \frac{g\left( 0 \right) -g\left( -a \right)}{0-\left( -a \right)}\Longleftrightarrow \frac{g\left( -a \right) -g\left( -b \right)}{b-a}\leqslant \frac{g\left( 0 \right) -g\left( -a \right)}{a}.
\end{align}
由$g$的下凸性还有
\begin{align}\label{eq:::890u834t1.8923r3}
g\left( 0 \right) \leqslant \frac{g\left( a \right) +g\left( -a \right)}{2}\Longleftrightarrow g\left( a \right) -g\left( 0 \right) \geqslant g\left( 0 \right) -g\left( -a \right).
\end{align}
由\eqref{eq:::890u834t1.8923r1}\eqref{eq:::890u834t1.8923r2}\eqref{eq:::890u834t1.8923r3}式可得
$$\frac{g\left( b \right) -g\left( a \right)}{b-a}\geqslant \frac{g\left( a \right) -g\left( 0 \right)}{a}\geqslant \frac{g\left( 0 \right) -g\left( -a \right)}{a}\geqslant \frac{g\left( -a \right) -g\left( -b \right)}{b-a}.$$
故
$$g\left( b \right) -g\left( a \right) \geqslant g\left( -a \right) -g\left( -b \right) \Longleftrightarrow g\left( b \right) +g\left( -b \right) \geqslant g\left( a \right) +g\left( -a \right).$$
即$h\left( b \right) \geqslant h\left( a \right)$.

$\left( \mathrm{ii} \right)$当$a=0$时,由$g$的下凸性知
$$h\left( 0 \right) =2g\left( 0 \right) \leqslant g\left( b \right) +g\left( -b \right) =h\left( b \right).$$
综上可知$h$在$\left[ 0,1 \right]$上递增.

\end{proof}

\begin{example}
设$f:[-1,1]\to\mathbb{R}$为偶函数，$f$在$[0,1]$上单调递增，又设$g$是$[-1,1]$上的下凸函数，即对任意$x,y\in[-1,1]$及$t\in(0,1)$有
\begin{align*}
g(tx+(1-t)y)\leqslant tg(x)+(1-t)g(y).
\end{align*}
求证：
\begin{align*}
2\int_{-1}^1 f(x)g(x)\mathrm{d}x\geqslant \int_{-1}^1 f(x)\mathrm{d}x\int_{-1}^1 g(x)\mathrm{d}x
\end{align*}
\end{example}
\begin{proof}
由于$f$为偶函数，可得
\begin{align*}
\int_{-1}^1 f(x)g(x)\mathrm{d}x = \int_{-1}^1 f(x)g(-x)\mathrm{d}x.
\end{align*}
因而
\begin{align}\label{eq:234r34r345353r4g1}
2\int_{-1}^1 f(x)g(x)\mathrm{d}x = \int_{-1}^1 f(x)\bigl(g(x) + g(-x)\bigr)\mathrm{d}x = 2\int_0^1 f(x)\bigl(g(x) + g(-x)\bigr)dx
\end{align}
令$h(x) = g(x) + g(-x),$则由\refpro{proposition:下凸函数可构造右半递增偶函数}知$h$在$[0,1]$上递增.
故对任意$x,y \in [0,1]$，有
\begin{align*}
\bigl(f(x) - f(y)\bigr)\bigl(h(x) - h(y)\bigr) \geqslant 0
\end{align*}
因而
\begin{align*}
\int_0^1 \int_0^1 \bigl(f(x) - f(y)\bigr)\bigl(h(x) - h(y)\bigr)\mathrm{d}x\mathrm{d}y \geqslant 0
\end{align*}
由此可得
\begin{align*}
2\int_0^1 f(x)h(x)\mathrm{d}x \geqslant 2\int_0^1 f(x)\mathrm{d}x \cdot \int_0^1 h(x)\mathrm{d}x = \frac{1}{2}\int_{-1}^1 f(x)\mathrm{d}x \cdot \int_{-1}^1 h(x)\mathrm{d}x = \int_{-1}^1 f(x)\mathrm{d}x \cdot \int_{-1}^1 g(x)\mathrm{d}x.
\end{align*}
结合\eqref{eq:234r34r345353r4g1}即得结论。

\end{proof}








\end{document}
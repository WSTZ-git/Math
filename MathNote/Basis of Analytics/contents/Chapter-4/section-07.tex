\documentclass[../../main.tex]{subfiles}
\graphicspath{{\subfix{../../image/}}} % 指定图片目录,后续可以直接使用图片文件名。

% 例如:
% \begin{figure}[H]
% \centering
% \includegraphics[scale=0.4]{图.png}
% \caption{}
% \label{figure:图}
% \end{figure}
% 注意:上述\label{}一定要放在\caption{}之后,否则引用图片序号会只会显示??.

\begin{document}

\section{分部积分}

分析学里流传着一句话:“遇事不决分部积分”.

分部积分在渐近分析中的用法:
\begin{enumerate}[(1)]
\item\label{分部积分在渐近分析中的用法(1)} 有时候分部积分不能计算出某一积分的具体值,但是我们可以利用分部积分去估计原积分(或原含参积分)的范围.并且我们可以通过不断分部积分来提高估计的精确程度.

\item\label{分部积分在渐近分析中的用法(2)} 分部积分也可以转移被积函数的导数.

\item\label{分部积分在渐近分析中的用法(3)} 分部积分可以改善阶.通过分部积分提高分母的次方从而增加收敛速度方便估计.并且可以通过反复分部积分得到更加精细的估计.
\end{enumerate}

\begin{theorem}[Newton-Leibniz公式]\label{theorem:Newton-Leibniz公式}
\begin{enumerate}
\item 若$f\in \mathbf{R}[a,b]$,且有原函数$F$,则有
\begin{align*}
\int_a^b{f\left( x \right) \,\mathrm{d}x}=F\left( b \right) -F\left( a \right) .
\end{align*}

\item 若函数 \( f \) 在 \([a, +\infty)\) 上的无穷积分收敛，且有原函数 \( F \)，则有
\[
\int_a^{+\infty} f(x) \, \mathrm{d}x = F(+\infty) - F(a).
\]
若函数 \( f \) 在 \((-\infty, a]\) 上无穷积分收敛，且有原函数 \( F \)，则有
\[
\int_{-\infty}^a f(x) \, \mathrm{d}x = F(a) - F(-\infty).
\]
若函数 \( f \) 在 \((-\infty, +\infty)\) 上的无穷积分收敛，且有原函数 \( F \)，则有
\[
\int_{-\infty}^{+\infty} f(x) \, \mathrm{d}x = F(+\infty) - F(-\infty).
\]
\end{enumerate}
\end{theorem}

\begin{theorem}[分部积分公式]\label{theorem:分部积分公式}
\begin{enumerate}
\item 设函数 \( u, v \) 在 \([a, b]\) 上连续可微,则
\[
\int_a^b{u\left( x \right) v' \left( x \right) \,\mathrm{d}x}=u\left( x \right) v\left( x \right) \Big|_{a}^{+\infty}-\int_a^b{u'\left( x \right) v\left( x \right) \,\mathrm{d}x}.
\]

\item 设函数 \( u, v \) 在 \([a, +\infty)\) 上连续可微且极限 \( \lim\limits_{x \to +\infty} u(x)v(x) \) 存在。若 \( u'v \) 和 \( uv' \) 中有一个在 \([a, +\infty)\) 上的无穷积分收敛，则另一个在 \([a, +\infty)\) 上的无穷积分也收敛，且
\[
\int_a^{+\infty} u(x)v'(x) \, \mathrm{d}x = u(x)v(x) \Big |_a^{+\infty} - \int_a^{+\infty} u'(x)v(x) \, \mathrm{d}x.
\]
\end{enumerate}
\end{theorem}
\begin{remark}
广义积分的分部积分公式形式上与常义积分的分部积分公式一样，既可用来计算 (已知收敛的) 广义积分，也能用来证明广义积分收敛。
\end{remark}

\begin{example}
\begin{align*}
f\left( x \right) =\int_x^{x+1}{\sin \left( t^2 \right) \mathrm{d}t}.
\end{align*}
证明$\left| f\left( x \right) \right|\le \frac{1}{x},x>0$.
\end{example}
\begin{note}
证明的想法是利用\hyperref[分部积分在渐近分析中的用法(1)]{分部积分在渐近分析中的用法(1)}.
\end{note}
\begin{proof}
由分部积分可得,对$\forall x>0$,都有
\begin{align*}
&\left| f\left( x \right) \right|=\left| \int_x^{x+1}{\sin \left( t^2 \right) \mathrm{d}t} \right|=\left| \int_{x^2}^{\left( x+1 \right) ^2}{\frac{\sin u}{2\sqrt{u}}\mathrm{d}u} \right|=\left| -\frac{1}{4}\int_{x^2}^{\left( x+1 \right) ^2}{u^{-\frac{3}{2}}\cos u\mathrm{d}u}-\frac{\cos u}{2\sqrt{u}}\Big|_{x^2}^{\left( x+1 \right) ^2} \right|
\\
&\leqslant \left| \frac{1}{4}\int_{x^2}^{\left( x+1 \right) ^2}{u^{-\frac{3}{2}}\mathrm{d}u} \right|+\left| \frac{\cos x}{2x}-\frac{\cos \left( x+1 \right)}{2\left( x+1 \right)} \right|=\frac{1}{2}\left| \frac{1}{x}-\frac{1}{x+1} \right|+\frac{1}{2}\left| \frac{\cos x}{x}-\frac{\cos \left( x+1 \right)}{\left( x+1 \right)} \right|
\\
&=\frac{1}{2x\left( x+1 \right)}+\frac{x\left[ \cos x-\cos \left( x+1 \right) \right] +\cos x}{2x\left( x+1 \right)}=\frac{1}{2x\left( x+1 \right)}+\frac{2\sin \frac{1}{2}x\sin \frac{2x+1}{2}+\cos x}{2x\left( x+1 \right)}
\\
&\le \frac{1}{2x\left( x+1 \right)}+\frac{x+1}{2x\left( x+1 \right)}=\frac{1}{2x\left( x+1 \right)}+\frac{1}{2x}\leqslant \frac{1}{x}.
\end{align*}

\end{proof}

\begin{example}
设$f\left( x \right) =\int_0^x{\sin \frac{1}{y}\mathrm{d}y}$,求$f'\left( 0 \right) $.
\end{example}
\begin{note}
证明的想法是利用\hyperref[分部积分在渐近分析中的用法(3)]{分部积分在渐近分析中的用法(3)}.
\end{note}
\begin{solution}
注意到
\begin{align}
f_{+}^{\prime}\left( 0 \right) =\underset{x\rightarrow 0^+}{\lim}\frac{\int_0^x{\sin \frac{1}{y}\mathrm{d}y}}{x}=\underset{x\rightarrow 0^+}{\lim}\frac{\int_{+\infty}^{\frac{1}{x}}{\sin yd\frac{1}{y}}}{x}=\underset{x\rightarrow 0^+}{\lim}\frac{\int_{\frac{1}{x}}^{+\infty}{\frac{\sin y}{y^2}\mathrm{d}y}}{x}\xlongequal{\text{令}t=\frac{1}{x}}\underset{t\rightarrow +\infty}{\lim}t\int_t^{+\infty}{\frac{\sin y}{y^2}\mathrm{d}y},\left( 1.1 \right) \label{example4.48-1.1}
\\
f_{-}^{\prime}\left( 0 \right) =\underset{x\rightarrow 0^-}{\lim}\frac{\int_0^x{\sin \frac{1}{y}\mathrm{d}y}}{x}=\underset{x\rightarrow 0^-}{\lim}\frac{\int_{+\infty}^{\frac{1}{x}}{\sin yd\frac{1}{y}}}{x}=\underset{x\rightarrow 0^-}{\lim}\frac{\int_{\frac{1}{x}}^{+\infty}{\frac{\sin y}{y^2}\mathrm{d}y}}{x}\xlongequal{\text{令}t=\frac{1}{x}}\underset{t\rightarrow -\infty}{\lim}t\int_t^{-\infty}{\frac{\sin y}{y^2}\mathrm{d}y}.\left( 1.2 \right) \label{example4.48-1.2}
\end{align}
由分部积分可得
\begin{align*}
\int_t^{+\infty}{\frac{\sin y}{y^2}\mathrm{d}y}=-\int_t^{+\infty}{\frac{1}{y^2}d\cos y}
=\frac{\cos y}{y^2}\big|_{+\infty}^{t}+\int_t^{+\infty}{\cos yd\frac{1}{y^2}}
=\frac{\cos t}{t^2}-2\int_t^{+\infty}{\frac{\cos y}{y^3}\mathrm{d}y}.
\end{align*}
故对\(\forall t>0\)，我们有
\begin{align*}
\left|\int_t^{+\infty}{\frac{\sin y}{y^2}\mathrm{d}y}\right|=\left|\frac{\cos t}{t^2}-2\int_t^{+\infty}{\frac{\cos y}{y^3}\mathrm{d}y}\right|
\leqslant \frac{1}{t^2}+2\int_t^{+\infty}{\frac{1}{y^3}\mathrm{d}y}\
=\frac{2}{t^2}.
\end{align*}
即\(\int_t^{+\infty}{\frac{\sin y}{y^2}\mathrm{d}y}=O\left(\frac{1}{t^2}\right), \forall t>0\)。再结合\eqref{example4.48-1.1}式可知
\[
f_{+}^{\prime}(0)=\lim_{t\rightarrow +\infty}t\int_t^{+\infty}{\frac{\sin y}{y^2}\mathrm{d}y}=0.
\]
同理可得\(f_{-}^{\prime}(0)=\lim_{t\rightarrow -\infty}t\int_t^{-\infty}{\frac{\sin y}{y^2}\mathrm{d}y}=0\)。故\(f^{\prime}(0)=f_{+}^{\prime}(0)=f_{-}^{\prime}(0)=0\)。

\end{solution}

\begin{example}
设 $f$ 是区间 $[0,1]$ 上的连续函数并满足 $0\leqslant  f(x)\leqslant  x$. 求证:
$$\int_0^1 f(x)\mathrm{d}x-\left(\int_0^1 f(x)\mathrm{d}x\right)^2\geqslant \int_0^1 x^2f(x)\mathrm{d}x\geqslant \left(\int_0^1 f(x)\mathrm{d}x\right)^2.$$
并且上式成为等式当且仅当$f(x)=x$.
\end{example}
\begin{proof}
{\color{blue}证法一:}
设 $f$ 是连续函数满足所给的条件, $F(x)=\int_0^x f(t)\mathrm{d}t$, 则 $F'=f$. 由 $0<f(x)\leqslant  x$ 得 $F(x)\leqslant \int_0^x t\mathrm{d}t=\frac{1}{2}x^2$. 因而
$$\int_0^1 x^2f(x)\mathrm{d}x\geqslant \int_0^1 2F(x)F'(x)\mathrm{d}x=F^2(x)\bigg|_0^1=\left(\int_0^1 f(x)\mathrm{d}x\right)^2.$$
利用分部积分, 得
$$
\begin{aligned}
\int_0^1 x^2f(x)\mathrm{d}x &= x^2F(x)\bigg|_0^1-\int_0^1 2xF(x)\mathrm{d}x \\
&= \int_0^1 f(x)\mathrm{d}x-\int_0^1 2xF(x)\mathrm{d}x \\
&\leqslant  \int_0^1 f(x)\mathrm{d}x-\int_0^1 2f(x)F(x)\mathrm{d}x \\
&= \int_0^1 f(x)\mathrm{d}x-F^2(x)\bigg|_0^1 \\
&= \int_0^1 f(x)\mathrm{d}x-\left(\int_0^1 f(x)\mathrm{d}x\right)^2.
\end{aligned}
$$
由证明过程可知只有当 $f(x)=x$ 时, 所证不等式成为等式.

{\color{blue}证法二(直接求导法):}令
\begin{align*}
F(x) = \int_0^x t^2 f(t) \mathrm{d}t - \left( \int_0^x f(t) \mathrm{d}t \right)^2,
\end{align*}
则
\begin{align*}
F'(x) = x^2 f(x) - 2f(x) \int_0^x f(t) \mathrm{d}t \geqslant x^2 f(x) - 2f(x) \int_0^x t \mathrm{d}t = 0.
\end{align*}
故
\begin{align*}
\int_0^1 t^2 f(t) \mathrm{d}t - \left( \int_0^1 f(t) \mathrm{d}t \right)^2 = F(1) \geqslant F(0) = 0.
\end{align*}
令$h(x) = \int_0^x f(t) \mathrm{d}t$, 则$f(x) = h'(x)$, 从而
\begin{align*}
\int_0^1 x^2 f(x) \mathrm{d}x = \int_0^1 x^2 h'(x) \mathrm{d}x \xlongequal{\text{分部积分}} \int_0^1 f(x) \mathrm{d}x - 2 \int_0^1 x h(x) \mathrm{d}x.
\end{align*}
因此
\begin{align}
\int_0^1 x^2 f(x) \mathrm{d}x \leqslant \int_0^1 f(x) \mathrm{d}t - \left( \int_0^1 f(x) \mathrm{d}x \right)^2 \Longleftrightarrow 2 \int_0^1 x h(x) \mathrm{d}x \geqslant \left( \int_0^1 f(x) \mathrm{d}x \right)^2. \label{eq:103.121233}
\end{align}
再令
\begin{align*}
G(x) = 2 \int_0^x t h(t) \mathrm{d}t - \left( \int_0^x f(t) \mathrm{d}t \right)^2,
\end{align*}
则
\begin{align*}
G'(x) = 2x \int_0^x f(t) \mathrm{d}t - 2f(x) \int_0^x f(t) \mathrm{d}t \geqslant 0.
\end{align*}
故
\begin{align*}
2 \int_0^1 x h(x) \mathrm{d}x - \left( \int_0^1 f(x) \mathrm{d}x \right)^2 = G(1) \geqslant G(0) = 0.
\end{align*}
因此\eqref{eq:103.121233}式成立.

\end{proof}










































































\end{document}
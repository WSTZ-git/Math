\documentclass[../../main.tex]{subfiles}
\graphicspath{{\subfix{../../image/}}} % 指定图片目录,后续可以直接使用图片文件名。

% 例如:
% \begin{figure}[H]
% \centering
% \includegraphics[scale=0.4]{图.png}
% \caption{}
% \label{figure:图}
% \end{figure}
% 注意:上述\label{}一定要放在\caption{}之后,否则引用图片序号会只会显示??.

\begin{document}

\section{Hermite插值定理}

\begin{theorem}[Taylor定理]\label{theorem:带各种余项的Taylor公式}
\begin{enumerate}[(1)]
\item \textbf{带Peano余项:}

设 $f(x)$ 在 $x_0$ 处 $n$ 阶可导。
则 $\exists \delta > 0$，使得当 $x \in U(x_0, \delta)$ 时，有
\begin{align*}
f(x) = \sum_{k=0}^{n} \frac{f^{(k)}(x_0)}{k!} (x - x_0)^k + o((x - x_0)^n).
\end{align*}

\item \textbf{带Lagrange余项:}

设 $f(x)$ 在 $[a, b]$ 上存在 $n$ 阶连续导数，且 $(a, b)$ 上存在 $n + 1$ 阶导数，$x_0$ 为 $[a, b]$ 内一定点,
则对于任意的 $x \in [a, b]$，在 $x, x_0$ 之间存在一个数 $\xi$ 使得
\begin{align*}
f(x) = \sum_{k=0}^{n} \frac{f^{(k)}(x_0)}{k!} (x - x_0)^k + \frac{f^{(k+1)}(\xi)}{(n + 1)!} (x - x_0)^{n+1}.
\end{align*}

\item \textbf{带积分型余项:}

设 $f(x)$ 定义是在 $U(x_0, \delta)$ 上的函数 $f(x)$ 在 $x_0$ 处 $n + 1$ 阶可导,对任意$x\in U(x_0, \delta)$,$\,t$ 在 $x$ 与 $x_0$ 之间,都有
\begin{align*}
f(x) = \sum_{k=0}^{n} \frac{f^{(k)}(x_0)}{k!} (x - x_0)^k + \frac{1}{n!} \int_{x_0}^{x} f^{(n+1)}(t) (x - t)^n \mathrm{d}t.
\end{align*}

\item \textbf{带Cauchy型余项:}

设 $f(x)$ 定义是在 $U(x_0, \delta)$ 上的函数 $f(x)$ 在 $x_0$ 处 $n + 1$ 阶可导,对任意$x\in U(x_0, \delta)$,都存在$\xi$在$x$与$x_0$之间,使得
\begin{align*}
f(x)=\sum_{k=0}^n{\frac{f^{(k)}(x_0)}{k!}(x}-x_0)^k+\frac{1}{n!}f^{\left( n+1 \right)}\left( \xi \right) \left( x-\xi \right) ^n\left( x-x_0 \right) .
\end{align*}
\end{enumerate}
\end{theorem}
\begin{proof}
\begin{enumerate}[(1)]
\item {\heiti 带Peano余项:}



\item  {\heiti 带Lagrange余项:}



\item {\heiti 带积分型余项:}



\item {\heiti 带Cauchy型余项:}


\end{enumerate}
\end{proof}

\begin{theorem}[Hermite插值定理]\label{theorem:Hermite插值定理}
给定\(a < x_1 < x_2 < \cdots < x_m < b\)和非负整数\(s_j,j = 0,1,2,\cdots,m\)。设\(f \in C^{\sum\limits_{j = 1}^{m}(s_j + 1)-1}[a,b]\)且\(f \in D^{\sum\limits_{j = 1}^{m}(s_j + 1)}(a,b)\),设\(p(x)\)满足条件:
对闭区间\([a,b]\)中的\(m\)个点\(a \leqslant  x_1 < x_2 < \cdots < x_m \leqslant  b\),\(s_j \in \mathbb{N}_0,j = 1,2,\cdots,m\),都有唯一的次数不超过$\sum_{j = 1}^{m}(s_j + 1)-1$的多项式$p(x)\in \mathbb{R}[x]$,并且
\begin{align*}
p^{(i)}(x_j)=f^{(i)}(x_j),i = 0,1,\cdots,s_j,j = 1,2,\cdots,m.
\end{align*}
并称满足上述条件的多项式$p(x)$为\textbf{Hermite 插值多项式},
则对每个$x$ $\in$ $[a,b]$,都存在$\theta$ $\in$ $(\min\{x,x_1\}$, $\max\{x,x_m\})$，使得
\begin{align*}
f(x)=p(x)+\frac{f^{(\sum\limits_{j = 1}^{m}(s_j + 1))}(\theta)}{\left(\sum\limits_{j = 1}^{m}(s_j + 1)\right)!}(x - x_1)^{s_1 + 1}(x - x_2)^{s_2 + 1}\cdots(x - x_m)^{s_m + 1}.
\end{align*}
\end{theorem}
\begin{note}
$p(x)$的求法:先由各插值点的次数确定$p(x)$的最高次数(即$\sum_{j = 1}^{m}(s_j + 1)-1$),再由方程$p^{(i)}(x_j)=f^{(i)}(x_j),i = 0,1,\cdots,s_j,j = 1,2,\cdots,m.$直接解出.
\end{note}
\begin{proof}

\end{proof}

\begin{proposition}[Lagrange插值公式]\label{proposition:Lagrange插值公式}
设 $f \in C[a, b] \cap D^2(a, b)$，证明：对$\forall x \in [a, b]$，存在 $\theta \in (a, b)$ 使得
\begin{align*}
f(x) = \frac{x - b}{a - b} f(a) + \frac{x - a}{b - a} f(b) + \frac{f''(\theta)}{2} (x - a)(x - b).
\end{align*}
\end{proposition}
\begin{remark}
考试中先用K值法证明,再直接用.
\end{remark}
\begin{note}
K值法:先令要证的中值等式中的高阶导数中值点(本题为$f''(\theta)$)为常数,再构造函数由Rolle中值定理推出结论即可.
\end{note}
\begin{proof}
当$x=a$或$b$时,结论显然成立.

对 $\forall x\in (a,b)$，固定 $x$，记
\[
K=\frac{2\left[ f(x) -\frac{x-b}{a-b}f(a) -\frac{x-a}{b-a}f(b) \right]}{\left( x-a \right) \left( x-b \right)}.
\]
令 $g(y) =f(y) -\frac{y-b}{a-b}f(a) -\frac{y-a}{b-a}f(b) -\frac{K}{2}\left( y-a \right) \left( y-b \right)$，则
\begin{align*}
g'(y) = f'(y) -\frac{f(a)}{a-b}-\frac{f(b)}{b-a}-\frac{K}{2}\left( 2y-a-b \right),\quad 
g''(y) = f''(y) -K.
\end{align*}
从而 $g(a) = g(b) = g(x) = 0$，由 Rolle 中值定理可知，存在 $\theta_1 \in (a,x)$，$\theta_2 \in (x,b)$，使得
\[
g'(\theta_1) = g'(\theta_2) = 0.
\]
再由 Rolle 中值定理可得，存在 $\theta \in (\theta_1, \theta_2) \subset (a,b)$，使得 $g''(\theta) = f''(\theta) - K = 0$，即 $f''(\theta) = K$.
\end{proof}

\begin{theorem}[带积分型余项的Lagrange插值公式]\label{theorem:带积分型余项的Lagrange插值公式}
设 $f$ 是 $[a,b]$ 上的二阶可微函数且 $f''$ 在 $[a,b]$ 可积, 则成立
\begin{align*}
f(x) = \frac{b-x}{b-a} f(a) + \frac{x-a}{b-a} f(b) + \int_{a}^{b} f''(y) k(x,y) \mathrm{d}y,
\end{align*}
这里
\begin{align*}
k(x,y) = 
\begin{cases}
\frac{x-a}{b-a} (y-b), & b \geqslant  y \geqslant  x \geqslant  a, \\
\frac{b-x}{b-a} (a-y), & b \geqslant  x \geqslant  y \geqslant  a.
\end{cases}
\end{align*}
特别的, 若还有 $f(a) = f(b) = 0$, 则有
\begin{align}
f(x) = \int_{a}^{b} f''(y) k(x,y) \mathrm{d}y.\label{theorem6.3-11.21}
\end{align}
\end{theorem}
\begin{note}
$k(x,y)$也叫Green函数.容易验证$|k(x,y)|\leqslant  |k(x,x)|$.
\end{note}
\begin{proof}
考虑
\begin{align*}
g(x) = f(x) - \frac{b-x}{b-a} f(a) - \frac{x-a}{b-a} f(b), x \in [a,b],
\end{align*}
则有 $g''(x) = f''(x), g(a) = g(b) = 0$. 因此只需对 $g$ 证明式\eqref{theorem6.3-11.21}.

事实上,由分部积分可得
\begin{align*}
\int_{a}^{b} g''(y) k(x,y) \mathrm{d}y &= \frac{b-x}{b-a} \int_{a}^{x} g''(y) (a-y) \mathrm{d}y + \frac{x-a}{b-a} \int_{x}^{b} g''(y) (y-b) \mathrm{d}y \\
&= \frac{b-x}{b-a} \left[ (a-x) g'(x) - \int_{a}^{x} g'(y) \mathrm{d}y \right] + \frac{x-a}{b-a} \left[ -g'(x) (x-b) + \int_{x}^{b} g'(y) \mathrm{d}y \right] \\
&= \frac{b-x}{b-a} [(a-x) g'(x) + g(x)] + \frac{x-a}{b-a} [-g'(x) (x-b) + g(x)] \\
&= g(x).
\end{align*}
这就证明了\eqref{theorem6.3-11.21}式.
\end{proof}




\begin{example}
设 $f \in D^3[0,1]$ 满足 $f(0) = -1, f'(0) = 0, f(1) = 0$，证明对任何 $x \in [0,1]$，存在 $\theta \in (0,1)$，使得
\begin{align*}
f(x) = -1 + x^2 + \frac{x^2 (x - 1)}{6} f'''(\theta).
\end{align*}
\end{example}
\begin{proof}
当$x=0$或$1$时,结论显然.

对 $\forall x\in (0,1)$，固定 $x$，记 $K=\frac{6[f(x) +1-x^2]}{x^2(x-1)}$。
令 $g(y) =f(y) +1-y^2-\frac{y^2(y-1)}{6}K$，则
\begin{align*}
&g'(y) =f'(y) -2y-\frac{y(y-1)}{3}K-\frac{y^2}{6}K, \\
&g''(y) =f''(y) -2-\frac{2y-1}{3}K-\frac{y}{3}K, \\
&g'''(y) =f'''(y) -K.
\end{align*}
从而 $g(0) =g(1) =g(x) =0$，由 Rolle 中值定理可知，存在 $\theta_1\in (0,x)$，$\theta_2\in (x,1)$，使得
\begin{align*}
g'(\theta_1) =g'(\theta_2) =0.
\end{align*}
又由 $f'(0) =0$ 可知
\begin{align*}
g'(0) =g'(\theta_1) =g'(\theta_2) =0.
\end{align*}
再由 Rolle 中值定理可得，存在 $\xi_1\in (0,\theta_1)$，$\xi_2\in (\theta_1,\theta_2)$，使得
\begin{align*}
g''(\xi_1) =g''(\xi_2) =0.
\end{align*}
于是再由 Rolle 中值定理可得，存在 $\theta \in (\xi_1,\xi_2) \subset (0,1)$，使得 $g'''(\theta) =f'''(\theta) -K$。即 $f'''(\theta) =K$。
\end{proof}

\begin{example}
设 $f \in C[0,2] \cap D(0,2)$ 满足 $f(0) = f(2) = 0$，$|f'(x)| \leqslant  M, \forall x \in (0,2)$。证明
\begin{align*}
\left| \int_{0}^{2} f(x) \, \mathrm{d}x \right| \leqslant  M.
\end{align*}
\end{example}
\begin{note}
靠近哪个点就用哪个点的插值多项式.(原因是:越靠近插值点,拟合的效果越好)
\end{note}
\begin{proof}
当 $x \in [0,1]$，由Lagrange中值定理(插值定理)，我们有
\begin{align*}
f(x) = f(0) + \frac{f'(\theta(x))}{1!} (x - 0) = f'(\theta(x)) x,
\end{align*}
于是
\begin{align}
|f(x)| \leqslant  |f'(\theta(x))| \cdot x \leqslant  Mx.\label{example6.2-11.11}
\end{align}
当 $x \in [1,2]$，由Lagrange中值定理(插值定理)，我们有
\begin{align*}
f(x) = f(2) + \frac{f'(\zeta(x))}{1!} (x - 2) = f'(\zeta(x)) (x - 2),
\end{align*}
于是
\begin{align}
|f(x)| \leqslant  |f'(\zeta(x))| \cdot |x - 2| \leqslant  M(2 - x).\label{example6.2-11.12}
\end{align}
结合\eqref{example6.2-11.11} 和\eqref{example6.2-11.12}，我们有
\begin{align*}
\left| \int_{0}^{2} f(x) \, \mathrm{d}x \right| &\leqslant  \left| \int_{0}^{1} f(x) \, \mathrm{d}x \right| + \left| \int_{1}^{2} f(x) \, \mathrm{d}x \right| 
\leqslant  \int_{0}^{1} |f(x)| \, \mathrm{d}x + \int_{1}^{2} |f(x)| \, \mathrm{d}x \\
&\leqslant  \int_{0}^{1} (Mx) \, \mathrm{d}x + \int_{1}^{2} (M(2 - x)) \, \mathrm{d}x 
= M.
\end{align*}
\end{proof}

\begin{example}
设 $f \in D^2[0,1]$，$f(0) = f(1) = 0$，$|f''(x)| \leqslant  M$，证明
\begin{align*}
\left| \int_{0}^{1} f(x) \, \mathrm{d}x \right| \leqslant  \frac{M}{12}.
\end{align*}
\end{example}
\begin{note}
最多可以拟合$f(0),f(1)$两个条件,需要插值一次多项式,余项需要2阶导数,条件完美符合.因此
先由Hermite插值定理(\hyperref[proposition:Lagrange插值公式]{Lagrange插值公式})直接写出插值多项式和余项:存在 $\theta(x) \in (0,1)$,使得
\begin{align*}
f(x) = \frac{f''(\theta(x))}{2} x (x - 1), \forall x \in [0,1].
\end{align*}
但是注意考试时,需要先用K值法证明上式再使用.
\end{note}
\begin{proof}
由Hermite插值定理可知,存在 $\theta(x) \in (0,1)$，使得
\begin{align*}
f(x) = \frac{f''(\theta(x))}{2} x (x - 1), \forall x \in [0,1].
\end{align*}
积分并取绝对值就有
\begin{align*}
\left| \int_{0}^{1} f(x) \, \mathrm{d}x \right| = \left| \int_{0}^{1} \frac{f''(\theta(x))}{2} x (x - 1) \, \mathrm{d}x \right| \leqslant  \int_{0}^{1} \left| \frac{f''(\theta(x))}{2} \right| \left| x (x - 1) \right| \, \mathrm{d}x 
\leqslant  \frac{M}{2} \int_{0}^{1} x (1 - x) \, \mathrm{d}x = \frac{M}{12}.
\end{align*}
\end{proof}

\begin{example}
设 $f \in D^2[a,b]$，证明存在 $\xi \in (a,b)$，使得
\begin{align*}
\int_{a}^{b} f(x) \, \mathrm{d}x = (b - a) \frac{f(a) + f(b)}{2} - \frac{(b - a)^3}{12} f''(\xi).
\end{align*}
\end{example}
\begin{note}
题目并没有明确给出插值点的相关条件,需要我们自己选取合适的插值点.(一般插值点都是特殊点,比如:端点、中点、极值点等)

我们观察到需要证明的等式中含有$a,b$两点并且$f$2阶可导,因此直接选取这两点作为插值点即可.
\end{note}
\begin{remark}
考试中下述证明中的Lagrange插值公式也需要先用K值法证明才能使用.

本题也可以直接用K值法证明.只需令$g(y)=\int_a^y{f(x)\,\mathrm{d}x}=(y-a)\frac{f(a)+f(y)}{2}-\frac{(y-a)^3}{12}K$即可.
\end{remark}
\begin{proof}
由\hyperref[proposition:La
grange插值公式]{Lagrange插值公式}(或\hyperref[theorem:Hermite插值定理]{Hermite插值定理})可知,对$\forall x\in [a,b]$,存在$\theta (x)\in (a,b)$使得
\begin{align}\label{example6.3-1.1}
f(x) = \frac{x - b}{a - b} f(a) + \frac{x - a}{b - a} f(b) + \frac{f''(\theta (x))}{2} (x - a)(x - b).
\end{align}
两边同时积分得到
\begin{align}
\int_a^b{f(x)\mathrm{d}x}&=\int_a^b{\frac{x-b}{a-b}f(a)\mathrm{d}x}+\int_a^b{\frac{x-a}{b-a}f(b)\mathrm{d}x}+\frac{1}{2}\int_a^b{f'' (\theta (x) )(x-a)(x-b})\mathrm{d}x.\label{example6.3-1.2}
\end{align}
由\eqref{example6.3-1.1}式可得
\begin{align*}
f'' (\theta (x) )=\frac{2\left[ f\left( x \right) -\frac{x-b}{a-b}f(a)-\frac{x-a}{b-a}f\left( b \right) \right]}{(x-a)(x-b)}\in C\left( a,b \right) .
\end{align*}
又由L'Hospital法则可得
\begin{align*}
\underset{x\rightarrow a^+}{\lim}f'' \left( \theta \left( x \right) \right) &=\underset{x\rightarrow a^+}{\lim}\frac{2\left( f\left( x \right) -\frac{x-b}{a-b}f(a)-\frac{x-a}{b-a}f\left( b \right) \right)}{(x-a)(x-b)}=\frac{2}{a-b}\underset{x\rightarrow a^+}{\lim}\frac{f\left( x \right) -\frac{x-b}{a-b}f(a)-\frac{x-a}{b-a}f\left( b \right)}{x-a}
\\
&=\frac{2}{a-b}\lim_{x\rightarrow a^+} \frac{f^{\prime}(x)-\frac{f(a)}{a-b}-\frac{f(b)}{b-a}}{1}=\frac{2}{b-a}\left[ \frac{f\left( b \right) -f\left( a \right)}{b-a}-f' \left( a \right) \right] ,   
\end{align*}
\begin{align*}
\underset{x\rightarrow b^-}{\lim}f'' \left( \theta \left( x \right) \right) &=\underset{x\rightarrow b^-}{\lim}\frac{2\left( f(x)-\frac{x-b}{a-b}f(a)-\frac{x-a}{b-a}f(b) \right)}{(x-a)(x-b)}=\frac{2}{b-a}\underset{x\rightarrow b^-}{\lim}\frac{f\left( x \right) -\frac{x-b}{a-b}f(a)-\frac{x-a}{b-a}f\left( b \right)}{x-a}
\\
&=\frac{2}{b-a}\lim_{x\rightarrow b^-} \frac{f^{\prime}(x)-\frac{f(a)}{a-b}-\frac{f(b)}{b-a}}{1}=\frac{2\left[ f^{\prime}(b)-\frac{f(b)-f(a)}{b-a} \right]}{b-a}.   
\end{align*}
从而$f'' \left( \theta \left( x \right) \right)$可以连续延拓到$[a,b]$上,又因为改变有限个点的函数值后,其积分结果不变,所以可以不妨设$f''(\theta(x))\in C[a,b]$.
于是由积分中值定理可知，存在 $\xi \in (a, b)$，使得
\begin{align}
\frac{1}{2} \int_a^b f''(\theta (x)) (x-a)(x-b) \, \mathrm{d}x = \frac{f''(\xi)}{2} \int_a^b (x-a)(x-b) \, \mathrm{d}x \label{example6.3-1.3}
\end{align}
利用\eqref{example6.3-1.2}和\eqref{example6.3-1.3}式可得
\begin{align*}
\int_a^b f(x) \, \mathrm{d}x &= (b-a) \cdot \frac{f(a) + f(b)}{2} + \frac{f''(\xi)}{2} \int_a^b (x-a)(x-b) \, \mathrm{d}x \\
&= (b-a) \frac{f(a) + f(b)}{2} - \frac{(b-a)^3}{12} f''(\xi). 
\end{align*}
\end{proof}

\begin{example}
设 $f \in C^2[a, b]$，证明存在 $\xi \in (a, b)$，使得
\begin{align*}
\int_a^b f(x) \, \mathrm{d}x = (b - a) f \left( \frac{a + b}{2} \right) + \frac{(b - a)^3}{24} f''(\xi).
\end{align*}
\end{example}
\begin{note}
本题需要我们选取合适的插值点和插值条件,这里我们应该选$f(\frac{a+b}{2}),f'(\frac{a+b}{2})$作为插值条件,插值多项式为1次,余项需要2阶导数.
\end{note}
\begin{remark}
本题也可以直接用K值法证明.
\end{remark}
\begin{proof}
由Taylor定理(Hermite插值定理)可知,存在$\theta \in \left( a,b \right)$，使得
\begin{align*}
f\left( x \right) &= f\left( \frac{a+b}{2} \right) + f'\left( \frac{a+b}{2} \right) \left( x - \frac{a+b}{2} \right) + \frac{f'' \left( \theta \right)}{2}\left( x - \frac{a+b}{2} \right)^2.
\end{align*}
两边同时积分，并由积分中值定理可知，存在 $\xi \in \left( a,b \right)$
\begin{align*}
\int_a^b{f\left( x \right) \mathrm{d}x} &= \left( b-a \right) f\left( \frac{a+b}{2} \right) + \int_a^b{\frac{f'' \left( \theta \right)}{2}\left( x - \frac{a+b}{2} \right)^2 \mathrm{d}x}
= \left( b-a \right) f\left( \frac{a+b}{2} \right) + \frac{f'' \left( \xi \right)}{2} \int_a^b{\left( x - \frac{a+b}{2} \right)^2 \mathrm{d}x} \\
&= \left( b-a \right) f\left( \frac{a+b}{2} \right) + \frac{\left( b-a \right)^3}{24} f'' \left( \xi \right).
\end{align*}
\end{proof}

\begin{example}
设 $f \in C^2[0,1]$ 满足 $f(0) = f(1) = 0$，证明
\begin{align*}
\int_{0}^{1} \left| \frac{f''(x)}{f(x)} \right| \mathrm{d}x \geqslant  4.
\end{align*}
\end{example}
\begin{proof}
由\hyperref[theorem:带积分型余项的Lagrange插值公式]{带积分余项的 Lagrange 插值定理}可知, 我们有
\begin{align*}
f(x) &= \int_0^1 f''(y) k(x,y) \, \mathrm{d}y, \quad \text{其中} \quad k(x,y) = 
\begin{cases}
\frac{x-0}{1-0}(y-1),&		1\ge y\ge x\ge 0,\\
\frac{1-x}{1-0}(0-y),&		1\ge x\ge y\ge 0.\\
\end{cases}
\end{align*}
从而
\begin{align*}
|f(x)| &\leqslant \int_0^1 |f''(y)| |k(x,y)| \, \mathrm{d}y \leqslant |k(x,x)| \int_0^1 |f''(y)| \, \mathrm{d}y \\
&= x(1-x) \int_0^1 |f''(y)| \, \mathrm{d}y \leqslant \frac{1}{4} \int_0^1 |f''(y)| \, \mathrm{d}y.
\end{align*}
故
\begin{align*}
\int_0^1 \left| \frac{f''(x)}{f(x)} \right| \, \mathrm{d}x &\geqslant \int_0^1 \frac{|f''(x)|}{\frac{1}{4} \int_0^1 |f''(y)| \, \mathrm{d}y} \, \mathrm{d}x = \frac{4}{\int_0^1 |f''(y)| \, \mathrm{d}y} \int_0^1 |f''(x)| \, \mathrm{d}x = 4.
\end{align*}
但实际上,我们可以得到
\begin{align*}
\int_0^1 \left| \frac{f''(x)}{f(x)} \right| \, \mathrm{d}x &\geqslant \int_0^1 \frac{|f''(x)|}{x(1-x) \int_0^1 |f''(y)| \, \mathrm{d}y} \, \mathrm{d}x = \frac{1}{\int_0^1 |f''(y)| \, \mathrm{d}y} \int_0^1 \frac{|f''(x)|}{x(1-x)} \, \mathrm{d}x.
\end{align*}
\end{proof}











\end{document}
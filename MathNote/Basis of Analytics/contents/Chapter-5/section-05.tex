\documentclass[../../main.tex]{subfiles}
\graphicspath{{\subfix{../../image/}}} % 指定图片目录,后续可以直接使用图片文件名。

% 例如:
% \begin{figure}[h]
% \centering
% \includegraphics{image-01.01}
% \label{fig:image-01.01}
% \caption{图片标题}
% \end{figure}

\begin{document}

\section{性态分析类}

\begin{theorem}[积分中值定理]\label{theorem:积分中值定理}
\begin{enumerate}[(1)]
\item \label{theorem:积分中值定理(1)}\(f(x)\in R[a,b],g(x)\)是\([a,b]\)上的非负递减函数, 则存在\(\zeta\in[a,b]\), 使得
\begin{align*}
\int_{a}^{b}f(x)g(x)dx = g(a)\int_{a}^{\zeta}f(x)dx.
\end{align*}

\item \label{theorem:积分中值定理(2)} \(f(x)\in R[a,b],g(x)\)是\([a,b]\)上的非负递增函数, 则存在\(\zeta\in[a,b]\), 使得
\begin{align*}
\int_{a}^{b}f(x)g(x)dx = g(b)\int_{\zeta}^{b}f(x)dx.
\end{align*}

\item \label{theorem:积分中值定理(3)}\(f(x)\in R[a,b],g(x)\)是\([a,b]\)上的单调函数, 则存在\(\zeta\in[a,b]\), 使得
\begin{align*}
\int_{a}^{b}f(x)g(x)dx = g(a)\int_{a}^{\zeta}f(x)dx + g(b)\int_{\zeta}^{b}f(x)dx.
\end{align*}

\item \label{theorem:积分中值定理(4)}\(f(x)\in R[a,b]\)且不变号,\(g(x)\in R[a,b]\), 则存在\(\eta\)介于\(g(x)\)上下确界之间, 使得
\begin{align*}
\int_{a}^{b}f(x)g(x)dx = \eta\int_{a}^{b}f(x)dx.
\end{align*}

\item \label{theorem:积分中值定理(5)}\(f(x)\in R[a,b]\)且不变号,\(g(x)\in C[a,b]\), 则存在\(\zeta\in(a,b)\), 使得
\begin{align*}
\int_{a}^{b}f(x)g(x)dx = g(\zeta)\int_{a}^{b}f(x)dx.
\end{align*}

\item 若(1),(2),(3)中再加入条件\(g(x)\)在\((a,b)\)中不为常数, 则结论可以加强到\(\zeta\in(a,b)\).
\end{enumerate}
\end{theorem}

\begin{theorem}[Hadamard不等式]\label{theorem:Hadamard不等式}
\(f\)是\([a,b]\)上的下凸函数，则
\begin{align*}
\frac{f(a)+f(b)}{2} \geqslant \frac{1}{b - a}\int_{a}^{b}f(x)dx \geqslant f\left(\frac{a + b}{2}\right).
\end{align*} 
\end{theorem}
\begin{note}
一句话积累证明：一边是区间再现，一边是换元到区间\([0,1]\)。
\end{note}
\begin{remark}
左边的不等式证明中的线性换元构造思路:我期望找到一个线性函数$g(t)$，使得令$x = g(t)$换元后，有
\begin{align*}
\int_a^b f(x) \mathrm{d}x \xlongequal{x = g(t)} \int_0^1 f(g(t))g'(t) \mathrm{d}t.
\end{align*}
即$g(0) = a$，$g(1) = b$。因此$g(t) = \frac{b - a}{1 - 0}t + a = a + (b - a)t$。从而
\begin{align*}
\int_a^b f(x) \mathrm{d}x \xlongequal{x = a + (b - a)t} (b - a)\int_0^1 f(a + (b - a)t) \mathrm{d}t = (b - a)\int_0^1 f((1 - t)a + bt) \mathrm{d}t.
\end{align*} 
\end{remark}
\begin{proof}
由$f$在$[a,b]$上下凸，一方面,我们有
\begin{align*}
\frac{1}{b - a}\int_{a}^{b}f(x)dx = \int_{0}^{1}f(a(1 - t)+bt)dt \leqslant \int_{0}^{1}[(1 - t)f(a)+tf(b)]dt = \frac{f(a)+f(b)}{2}.
\end{align*}
另一方面,我们有
\begin{align*}
\frac{1}{b - a}\int_{a}^{b}f(x)dx &= \frac{1}{b - a}\int_{a}^{b}f(a + b - x)dx
= \frac{1}{2(b - a)}\int_{a}^{b}[f(a + b - x)+f(x)]dx\\
&\geqslant \frac{1}{b - a}\int_{a}^{b}f\left(\frac{a + b}{2}\right)dx
= f\left(\frac{a + b}{2}\right).
\end{align*}
故结论成立.
\end{proof}

\begin{example}
若$f$在$[0,1]$上有二阶导数且$f(0) = 0$，$f(1) = 1$，$\int_0^1 f(x)dx = 1$，证明存在$\eta\in(0,1)$使得$f''(\eta)< -2$。
\end{example}
\begin{remark}
通过$f''(x)+2\geq 0,\forall x\in(0,1)$来推出$f + x^2$在$[0,1]$下凸:实际上，令$g=f+x^2$,则$g''\geq 0,\forall x\in(0,1)$,从而$g$在$(0,1)$下凸.因为$g = f + x^2\in C[0,1]$和$g$在$(0,1)$下凸我们就有
\begin{align*}
g(\lambda x + (1 - \lambda)y)\leq\lambda g(x) + (1 - \lambda)g(y),\forall x,y\in(0,1),\lambda\in[0,1].
\end{align*}
上式中令$x$趋于$0$或者$1$也成立，再令$y$趋于$1$或者$0$也成立.因此$g$在$[0,1]$下凸。 
\end{remark}
\begin{proof}
若不然，对任何$x\in(0,1)$都有$f''(x)\geq -2$，于是$f(x) + x^2$是$[0,1]$的下凸函数。于是由\hyperref[theorem:Hadamard不等式]{Hadamard不等式}我们知道
\begin{align*}
\frac{4}{3}=\int_0^1 [f(x) + x^2]dx\leq\frac{f(0) + 0^2 + f(1) + 1^2}{2}=\frac{2}{2}=1,
\end{align*}
矛盾！现在存在$\eta\in(0,1)$使得$f''(\eta)< -2$。
\end{proof}

\begin{theorem}[达布中值定理/导数介值定理]\label{theorem:导数介值定理}
设\(f \in D[a,b]\)，对任何介于\(f'(a),f'(b)\)之间的\(\eta\)，存在\(c \in [a,b]\)使得\(f'(c)=\eta\).
\end{theorem}
\begin{proof}
和连续函数介值定理一样,我们只需证明导数满足零点定理。即不妨设\(f'(a) < 0 < f'(b)\)，去找\(c \in [a,b]\)使得\(f'(c)=0\)。
事实上由极限保号性和
\begin{align*}
\lim_{x \to a^{+}}\frac{f(x)-f(a)}{x - a}=f'(a)<0,\lim_{x \to b^{-}}\frac{f(x)-f(b)}{x - b}=f'(b)>0,
\end{align*}
我们知道存在\(\delta>0\)，使得
\[f(x)<f(a),\forall x \in (a,a + \delta],f(x)<f(b),\forall x \in [b - \delta,b).\]
因此\(f\)最小值在内部取到，此时由费马引理知最小值的导数为\(0\)，从而证毕！
\end{proof}

\begin{theorem}[加强的Rolle中值定理]\label{theorem:加强的Rolle中值定理}
\((a)\)：设\(f \in D(a,b)\)且在\([a,b]\)上\(f\)有介值性，则若\(f(a)=f(b)\)，必然存在\(\theta \in (a,b)\)，使得\(f'(\theta)=0\)。

\((b)\)：设\(f \in C[a,+\infty)\cap D^{1}(a,+\infty)\)满足\(f(a)=\lim_{x \to +\infty}f(x)\)，则存在\(\theta \in (a,+\infty)\)使得\(f'(\theta)=0\)。
\end{theorem}
\begin{note}
一旦罗尔成立，所有中值定理和插值定理都会有类似的结果，可以具体情况具体分析。
\end{note}
\begin{proof}
对于\((a)\)：不妨设\(f\)不恒为常数，则可取\(x_0 \in (a,b)\)，使得\(f(x_0)\neq f(a)\)，不妨设\(f(x_0)>f(a)\)，则由\(f\)的介值性，我们知道存在\(x_1 \in (a,x_0),x_2 \in (x_0,b)\)，使得
\begin{align*}
f(x_1)=\frac{f(a)+f(x_0)}{2},f(x_2)=\frac{f(b)+f(x_0)}{2}.
\end{align*}
因为\(f(a)=f(b)\)，我们知道\(f(x_1)=f(x_2)\)，由Rolle中值定理($f\in C[x_1,x_2]\cap D(x_1,x_2)$)可知,存在\(\theta \in (a,b)\)，使得\(f'(\theta)=0\)。这就完成了\((a)\)的证明。

对于\((b)\)：若对任何\(x \in (0,+\infty)\)使得\(f'(x)\neq 0\),则由导数介值性可知,$f'$恒大于0或恒小于0(否则,由导数介值性可得到一个零点).从而\(f\)在\([0,+\infty)\)严格单调，不妨设为递增。现在
\[f(x)\geqslant f(a + 1)>f(a),\forall x\geqslant a + 1,\]
于是
\[f(a)=\lim_{x \to +\infty}f(x)\geqslant f(a + 1)>f(a),\]
这就是一个矛盾！因此我们证明了存在\(\theta \in (a,+\infty)\)使得\(f'(\theta)=0\)。    
\end{proof}

\begin{example}
设$f$在$[a,b]$连续，$(a,b)$可微且不是线性函数，证明：存在$\xi\in(a,b)$使得
\begin{align*}
f'(\xi) > \frac{f(b) - f(a)}{b - a}.
\end{align*}
\end{example}
\begin{note}
$g(x) = f(x) - f(a)- \frac{f(b) - f(a)}{b - a}(x - a)$这个线性构造必须记忆!
\end{note}
\begin{proof}
考虑
\begin{align*}
g(x) = f(x) - f(a)- \frac{f(b) - f(a)}{b - a}(x - a) ,
\end{align*}
则$g(a) = g(b) = 0$且$g$不是常值函数。因$g'\leq 0$恒成立会导致$g$在$[a,b]$递减,从而$0=g(b)<g(a)=0$,这不可能！现在存在$\xi\in(a,b)$使得$g'(\xi) > 0$，即结论成立.
\end{proof}

\begin{example}
\begin{enumerate}
\item 设$f\in C[0,\pi]\cap D(0,\pi)$满足
\begin{align*}
\int_0^\pi f(x)\cos xdx = \int_0^\pi f(x)\sin xdx = 0.
\end{align*}
证明存在$\xi\in(0,\pi)$，使得$f'(\xi)=0$。

\item 设$f\in C[0,\frac{\pi}{2}]$满足
\begin{align}\label{example0.12-11.64}
\int_0^{\frac{\pi}{2}} f(x)dx = \int_0^{\frac{\pi}{2}} f(x)\cos xdx = \int_0^{\frac{\pi}{2}} f(x)\sin xdx = 0.
\end{align}
证明：$f$在$(0,\frac{\pi}{2})$至少有三个互不相同的零点。
\end{enumerate}
\end{example}
\begin{note}
此类给出积分等式的问题，往往就是寻求给定积分等式的线性组合来实现目标。即本题我们要寻求合适的$a,b\in\mathbb{R}$，考虑积分
\begin{align*}
\int_0^\pi f(x)(a\cos x + b\sin x)dx = 0.
\end{align*}
一句话证明本题1问，就是寻求合适的$a,b\in\mathbb{R}$，使得$a\cos x + b\sin x$和$f$的符号一致。第2问可以待定系数解方程来得到线性组合。
\end{note}
\begin{proof}
\begin{enumerate}
\item  我们只需断言$f$在$[0,\pi]$至少有两个不相同的零点，之后由罗尔定理就给出了存在$\xi\in(0,\pi)$，使得$f'(\xi)=0$。
由积分中值定理可知,存在$x_0\in(0,\pi)$,使得
\begin{align*}
\int_0^{\pi}{f(x)\sin x\mathrm{d}x}=f(\theta )\int_0^{\pi}{\sin x\mathrm{d}x}=2f\left( x \right) =0.
\end{align*}
即$f$在$(0,\pi)$上有一个零点$x_0$。若$f$在$[0,\pi]$只有一个零点，则$f$在$[0,x_0)$，$(x_0,\pi]$不同号（否则$f$不变号，则由$\int_0^\pi f(x)\sin xdx = 0$知$f = 0$，与$f$只有一个零点矛盾！）。不妨设
\begin{align*}
f(x)<0,\forall x\in[0,x_0), f(x)>0,\forall x\in(x_0,\pi].
\end{align*}
于是可取
\begin{align*}
a\sin x + b\cos x = \sin(x - x_0)(a=\cos x_0,b=\sin x_0).
\end{align*}
此时根据条件就有
\begin{align*}
\int_0^{\pi}{f(x)\sin\mathrm{(}x}-x_0)\mathrm{d}x=\int_0^{\pi}{f(x)\left( \cos x_0\sin x-\sin x_0\cos x \right) \mathrm{d}x}=\cos x_0\int_0^{\pi}{f(x)\sin x\mathrm{d}x}-\sin x_0\int_0^{\pi}{f(x)\cos x\mathrm{d}x}=0.
\end{align*}
又注意到
\begin{align*}
f(x)\sin(x - x_0)>0,\forall x\in[0,\pi]\setminus\{x_0\},
\end{align*}
故$0=\int_0^{\pi}{f(x)\sin\mathrm{(}x}-x_0)\mathrm{d}x>0$，矛盾！这就完成了证明。

\item 不妨设$f$不恒为$0$，由积分中值定理和\eqref{example0.12-11.64}式知$f$在$(0,\frac{\pi}{2})$至少有一个零点且变号。
若$f$在$(0,\frac{\pi}{2})$只变号一次，设在$x_1$变号，则$f$在$x_1$两侧符号相反。由\eqref{example0.12-11.64}式得
\begin{align*}
\int_0^{\frac{\pi}{2}} f(x)\sin(x - x_1)dx = 0.
\end{align*}
但是$f(x)\sin(x - x_1)$不变号，这就推出$f = 0$而矛盾！
若$f$在$(0,\frac{\pi}{2})$只变号两次，设变号处为$x_1,x_2$，考虑
\begin{align*}
g(x)\triangleq\sin x - \frac{\sin x_2 - \sin x_1}{\cos x_2 - \cos x_1}\cos x + \frac{\sin(x_2 - x_1)}{\cos x_2 - \cos x_1},x\in[0,\frac{\pi}{2}].
\end{align*}
注意到
\begin{align*}
g'(x)=\cos x + \frac{\sin x_2 - \sin x_1}{\cos x_2 - \cos x_1}\sin x = \frac{\sin x_2 - \sin x_1}{\cos x_2 - \cos x_1}\cos x\left(\tan x - \frac{\cos x_1 - \cos x_2}{\sin x_2 - \sin x_1}\right),
\end{align*}
我们知$g'$在$(0,\frac{\pi}{2})$有且只有一个零点。注意$g(x_1)=g(x_2)=0$，我们由罗尔中值定理知道$g'$在$(x_1,x_2)$有零点，因此$g$当且仅当在$x_1,x_2$变号。现由\eqref{example0.12-11.64}式得
\begin{align*}
\int_0^{\frac{\pi}{2}} f(x)g(x)dx = 0.
\end{align*}
但是$fg$不变号，故$f = 0$，这就是一个矛盾！至此我们证明了$f$在$(0,\frac{\pi}{2})$至少有三个互不相同的零点。 
\end{enumerate}
\end{proof}

\begin{example}
设$f(x)\in C[0,1]$，证明：
\begin{enumerate}[(1)]
\item 存在唯一的$\xi\in(0,1)$，使得
\begin{align*}
\int_{0}^{\xi}e^{f(t)}dt=\int_{\xi}^{1}e^{-f(t)}dt
\end{align*}

\item 对任何大于 1 的正整数 $n$，存在唯一的$\xi_n\in(0,1)$，使得
\begin{align*}
\int_{\frac{1}{n}}^{\xi_n}e^{f(t)}dt=\int_{\xi_n}^{1}e^{-f(t)}dt
\end{align*}
并求极限$\lim_{n \to \infty}\xi_n$。
\end{enumerate}
\end{example}
\begin{proof}
\begin{enumerate}[(1)]
\item 令$F(x) = \int_0^x e^{f(t)} \mathrm{d}t - \int_x^1 e^{-f(t)} \mathrm{d}t$，则$F(0) = -\int_0^1 e^{-f(t)} \mathrm{d}t < 0$，$F(1) = \int_0^1 e^{f(t)} \mathrm{d}t > 0$。又$F^\prime(x) = e^{f(x)} + e^{-f(x)} > 0$，
故由零点存在定理可知，存在唯一的$\xi \in (0,1)$ ，使得$F(\xi) = 0$，即$\int_0^{\xi} e^{f(t)} \mathrm{d}t = \int_{\xi}^1 e^{-f(t)} \mathrm{d}t$.

\item 令$F_n(x)=\int_{\frac{1}{n}}^x{e^{f(t)}\mathrm{d}t}-\int_x^1{e^{-f(t)}\mathrm{d}t}$,则$F_n\left(\frac{1}{n}\right)=-\int_{\frac{1}{n}}^1{e^{-f(t)}\mathrm{d}t}<0$,$F_n(1)=\int_x^1{e^{-f(t)}\mathrm{d}t}>0$.又$F_{n}^{\prime}(x)=e^{f(x)}+e^{-f(x)}>0$,故由零点存在定理可知,存在唯一的$\xi_n\in\left(\frac{1}{n},1\right)$,使得$F(\xi_n)=0$,即
\begin{align}
\int_{\frac{1}{n}}^{\xi_n}{e^{f(t)}\mathrm{d}t}=\int_{\xi_n}^1{e^{-f(t)}\mathrm{d}t}.\label{example234-1.1}
\end{align}
因为$\xi_n\in(0,1),\forall n\in\mathbb{N}$,所以由聚点定理可知,$\{\xi_n\}$存在收敛子列.任取$\{\xi_n\}$的一个收敛子列$\{\xi_{n_k}\}$,设$\underset{k\rightarrow\infty}{\lim}\xi_{n_k}=a$,则由\eqref{example234-1.1}式可知
\begin{align*}
\int_{\frac{1}{n_k}}^{\xi_{n_k}}{e^{f(t)}\mathrm{d}t}=\int_{\xi_{n_k}}^1{e^{-f(t)}\mathrm{d}t}.
\end{align*}
令$k\rightarrow\infty$,由归结原则得到
\begin{align*}
\int_0^a{e^{f(t)}\mathrm{d}t}=\int_a^1{e^{-f(t)}\mathrm{d}t}.
\end{align*}
由$(1)$可知$a=\xi$.故由\hyperref[proposition:子列极限命题]{命题\ref{proposition:子列极限命题}(a)}可知$\underset{n\rightarrow\infty}{\lim}\xi_n=\xi$.
\end{enumerate}
\end{proof}

\begin{example}
$f \in C(0,1)$ 且存在互不相同的 $x_1, x_2, x_3, x_4 \in (0,1)$ 满足
\begin{align*}
a = \frac{f(x_2) - f(x_1)}{x_2 - x_1} < \frac{f(x_4) - f(x_3)}{x_4 - x_3} = b.
\end{align*}
证明对任何 $\lambda \in (a, b)$, 存在互不相同的 $x_5, x_6 \in (0,1)$, 使得 $\lambda = \frac{f(x_6) - f(x_5)}{x_6 - x_5}$.
\end{example}
\begin{proof}
要证原结论,等价于对$\forall \lambda \in (a,b)$,存在$x_5 \ne x_6$且$x_5,x_6 \in (0,1)$,使得
\begin{align*}
f(x_6) -f(x_5) = \lambda (x_6-x_5) \Leftrightarrow f(x_6) -\lambda x_6=f(x_5) -\lambda x_5.
\end{align*}
即证$f(x) -\lambda x$在$(0,1)$上不是单射.又由\hyperref[proposition:连续单射等价严格单调]{命题\ref{proposition:连续单射等价严格单调}}及$f\in C(0,1)$,故只须证$f(x) -\lambda x$不是严格单调的.
对$\forall \lambda \in (a,b)$,令$g(x) =f(x) -\lambda x$,不妨设$x_2>x_1,x_4>x_3$,则  
\begin{align*}
\frac{g(x_2) -g(x_1)}{x_2-x_1}=a-\lambda <0,\quad \frac{g(x_4) -g(x_3)}{x_4-x_3}=b-\lambda >0.
\end{align*}
从而$g(x_2) <g(x_1)$, $g(x_4) >g(x_3)$,故$g$在$(0,1)$上非严格单调,结论得证.
\end{proof}

\begin{example}
$f\in D[a,b]$,且在$(a,b)$上$f'$有零点.证明:存在$\theta \in (a,b)$,使得
\begin{align*}
f'(\theta) = \frac{f(\theta) -f(a)}{b-a}.
\end{align*}
\end{example}
\begin{remark}
先考虑微分方程:$y' =\frac{y-f(a)}{b-a}$,解出微分方程的解,再常数变易得到构造函数:$g(x) =\frac{f(x) -f(a)}{e^{\frac{x}{b-a}}}$.
\end{remark}
\begin{proof}
令$g(x) =\frac{f(x) -f(a)}{e^{\frac{x}{b-a}}}$,则$g'(x) =\frac{f'(x) -\frac{f(x) -f(a)}{b-a}}{e^{\frac{x}{b-a}}}$.由条件可设$f'(c) =0,c\in (a,b)$.从而$g'(c) =\frac{-\frac{f(c) -f(a)}{b-a}}{e^{\frac{c}{b-a}}}$.

(i) 若$g'(c) =0$,则取$\theta =c$即可.

(ii) 若$g'(c) >0$,则$f(c) <f(a)$.从而$g(c) =\frac{f(c) -f(a)}{e^{\frac{c}{b-a}}}<0$.于是存在$\delta >0$,使得
\begin{align*}
g(x) \leqslant g(c) <0,\forall x\in (c-\delta ,c+\delta).
\end{align*}
又因为$g(a) =0$,所以
\begin{align}
g(x) \leqslant g(c) <g(a),\forall x\in (c-\delta ,c+\delta).\label{example000.6-1.1}
\end{align}
由于$g\in C[a,c]$,因此$g$在$[a,c]$上存在最小值.由\eqref{example000.6-1.1}式可知,$g$在$[a,c]$上的最小值一定在$(a,c)$上取到.故存在$\theta \in (a,c)$,使得
\begin{align*}
g(\theta) =\min_{x\in (a,c)}g(x).
\end{align*}
由Fermat引理可知,$g'(\theta) =0$,即$f'(\theta) =\frac{f(\theta) -f(a)}{b-a}$.

(iii) 若$g'(c) <0$,则由(ii)同理可证,存在$\theta \in (a,b)$,使得$f'(\theta) =\frac{f(\theta) -f(a)}{b-a}$.
\end{proof}

\begin{example}
设 $f \in C[0,1]$ 满足 $\int_0^1 f(x) \, dx = 0$, $\int_0^1 xf(x) \, dx = 1$，证明：存在 $\xi \in [0,1]$ 使得 $|f(\xi)| = 4$。
\end{example}
\begin{note}
考虑题目条件的线性组合，待定 $a \in \mathbb{R}$ 考虑
\begin{align*}
1 = \left| \int_0^1 (x - a)f(x) \, dx \right| \leq \int_0^1 |x - a| \cdot |f(x)| \, dx \leq \max_{x \in [0,1]} |f(x)| \cdot \int_0^1 |x - a| \, dx.
\end{align*}
为了使放缩最精确，我们希望右边积分 $\int_0^1 |x - a| \, dx$ 达到最小，容易知道是 $a = \frac{1}{2}$。
\end{note}
\begin{proof}
注意到
\begin{align*}
1=\left| \int_0^1{(x}-\frac{1}{2})f(x)\,\mathrm{d}x \right|\le \int_0^1{|x}-\frac{1}{2}|\cdot |f(x)|\,\mathrm{d}x\le \max_{x\in [0,1]} |f(x)|\cdot \int_0^1{|x}-\frac{1}{2}|\,\mathrm{d}x=\frac{1}{4}\max_{x\in [0,1]} |f(x)|.
\end{align*}
故$\max_{x\in [0,1]} |f(x)|\geqslant 4$.又因为$\int_0^1{f(x) \mathrm{d}x}=0$,所以由积分中值定理可知,存在$\theta \in (0,1)$,使得$f(\theta) =\left| f(\theta) \right|=0$.从而由介值定理可知,存在$\xi \in [0,1]$,使得$\left| f(\xi) \right|=4$.
\end{proof}






\end{document}
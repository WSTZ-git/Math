\documentclass[../../main.tex]{subfiles}
\graphicspath{{\subfix{../../image/}}} % 指定图片目录,后续可以直接使用图片文件名。

% 例如:
% \begin{figure}[H]
% \centering
% \includegraphics[scale=0.4]{图.png}
% \caption{}
% \label{figure:图}
% \end{figure}
% 注意:上述\label{}一定要放在\caption{}之后,否则引用图片序号会只会显示??.

\begin{document}

\section{重积分与累次积分的关系}

\subsection{Fubini定理}

\begin{definition}
不失一般性，我们令 \( n = p + q \)，其中 \( p, q \) 是正整数，
\[
\mathbb{R}^p, \quad x = (\xi_1, \xi_2, \cdots, \xi_p);
\]
\[
\mathbb{R}^q, \quad y = (\xi_{p + 1}, \xi_{p + 2}, \cdots, \xi_n);
\]
\[
\mathbb{R}^n = \mathbb{R}^p \times \mathbb{R}^q, \, (x, y) = (\xi_1, \cdots, \xi_p, \xi_{p + 1}, \cdots, \xi_n).
\]
并记定义在 \( \mathbb{R}^n \) 上的函数 \( f \) 的积分为
\[
\int_{\mathbb{R}^p \times \mathbb{R}^q} f(x, y) \, \mathrm{d}x\mathrm{d}y = \int_{\mathbb{R}^n} f(x, y) \, \mathrm{d}x\mathrm{d}y.
\]
\end{definition}

\begin{definition}
我们记满足条件 (A),(B) 及 (C) 的非负可测函数的全体为 \( \mathcal{F} \)（显然非空）.

(A) 对于几乎处处的 \( x \in \mathbb{R}^p \)，\( f(x, y) \) 作为 \( y \) 的函数是 \( \mathbb{R}^q \) 上的非负可测函数；

(B) 记 \( F_f(x) = \int_{\mathbb{R}^q} f(x, y) \, \mathrm{d}y \)，则 \( F_f(x) \) 是 \( \mathbb{R}^p \) 上的非负可测函数；

(C)$\int_{\mathbb{R}^p} F_f(x) \, \mathrm{d}x = \int_{\mathbb{R}^p} \mathrm{d}x \int_{\mathbb{R}^q} f(x, y) \, \mathrm{d}y = \int_{\mathbb{R}^n} f(x, y) \, \mathrm{d}x\mathrm{d}y.$
\end{definition}

\begin{lemma}\label{lemma:引理4.28}
(i) 若 \( f \in \mathcal{F} \)，且 \( a \geq 0 \)，则 \( af \in \mathcal{F} \)；

(ii) 若 \( f_1, f_2 \in \mathcal{F} \)，则 \( f_1 + f_2 \in \mathcal{F} \)；

(iii) 若 \( f, g \in \mathcal{F} \)，\( f(x, y) - g(x, y) \geq 0 \)，且 \( g \in L(\mathbb{R}^n) \)，则
\(
f - g \in \mathcal{F};
\)

(iv) 若 \( f_k \in \mathcal{F} \) \( (k = 1, 2, \cdots) \)，\( f_k(x, y) \leq f_{k + 1}(x, y) \) \( (k = 1, 2, \cdots) \)，且有 \( \lim_{k \to \infty} f_k(x, y) = f(x, y) \)，\( (x, y) \in \mathbb{R}^p \times \mathbb{R}^q \)，则 \( f \in \mathcal{F} \).
\end{lemma}
\begin{proof}
根据积分的线性性质，(i) 与 (ii) 是显然成立的.

(iii) 因为 \( g \in \mathcal{F} \) 且可积，所以由 (C) 可知 \( F_g(x) \) 是几乎处处有限的. 由此再根据 (B) 可知，对几乎处处的 \( x \)，\( g(x, y) \) 看成 \( y \) 的函数在 \( \mathbb{R}^q \) 上是几乎处处有限的. 于是从等式
\[
(f(x, y) - g(x, y)) + g(x, y) = f(x, y), \quad \text{a.e.}\, (x, y) \in \mathbb{R}^n
\]
立即推得 \( f - g \) 是满足条件 (A),(B) 与 (C) 的.

(iv) (A) 显然成立.

(B)
\[
\int_{\mathbb{R}^q} f(x, y) \, \mathrm{d}y = \lim_{k \to \infty} \int_{\mathbb{R}^q} f_k(x, y) \, \mathrm{d}y.
\]

(C)
\begin{align*}
&\int_{\mathbb{R}^n} f(x, y) \, \mathrm{d}x\mathrm{d}y = \lim_{k \to \infty} \int_{\mathbb{R}^n} f_k(x, y) \, \mathrm{d}x\mathrm{d}y \\
&= \lim_{k \to \infty} \int_{\mathbb{R}^p} \mathrm{d}x \int_{\mathbb{R}^q} f_k(x, y) \, \mathrm{d}y = \int_{\mathbb{R}^p} \left[ \lim_{k \to \infty} \int_{\mathbb{R}^q} f_k(x, y) \, \mathrm{d}y \right] \mathrm{d}x \\
&= \int_{\mathbb{R}^p} \mathrm{d}x \int_{\mathbb{R}^q} \lim_{k \to \infty} f_k(x, y) \, \mathrm{d}y = \int_{\mathbb{R}^p} \mathrm{d}x \int_{\mathbb{R}^q} f(x, y) \, \mathrm{d}y.
\end{align*}
\end{proof}

\begin{theorem}[Tonelli 定理$\,$非负可测函数的情形]\label{theorem:Tonelli 定理 非负可测函数的情形}
设 \( f(x, y) \) 是 \( \mathbb{R}^n = \mathbb{R}^p \times \mathbb{R}^q \) 上的非负可测函数，则有

(A) 对于几乎处处的 \( x \in \mathbb{R}^p \)，\( f(x, y) \) 作为 \( y \) 的函数是 \( \mathbb{R}^q \) 上的非负可测函数；

(B) 记 \( F_f(x) = \int_{\mathbb{R}^q} f(x, y) \, \mathrm{d}y \)，则 \( F_f(x) \) 是 \( \mathbb{R}^p \) 上的非负可测函数；

(C)$\int_{\mathbb{R}^p} F_f(x) \, \mathrm{d}x = \int_{\mathbb{R}^p} \mathrm{d}x \int_{\mathbb{R}^q} f(x, y) \, \mathrm{d}y = \int_{\mathbb{R}^n} f(x, y) \, \mathrm{d}x\mathrm{d}y.$
\end{theorem}
\begin{note}
因为非负可测函数是非负可测简单函数渐升列的极限，所以我们自然想到采用从简单函数类出发，再扩大到非负可测函数类的证明方法. 利用\reflem{lemma:引理4.28}可以使定理的证明叙述得简明一些. 
\end{note}
\begin{remark}
\begin{enumerate}[(i)]
\item 在\refthe{theorem:Tonelli 定理，非负可测函数的情形}的证明中，改变 \( x \in \mathbb{R}^p \) 与 \( y \in \mathbb{R}^q \) 的次序，结论同样成立. 因此，实际上我们可得
\[
\int_{\mathbb{R}^n} f(x, y) \, \mathrm{d}x\mathrm{d}y = \int_{\mathbb{R}^p} \mathrm{d}x \int_{\mathbb{R}^q} f(x, y) \, \mathrm{d}y = \int_{\mathbb{R}^q} \mathrm{d}y \int_{\mathbb{R}^p} f(x, y) \, \mathrm{d}x.
\]

\item 若 \( f(x, y) \) 是 \( E \) 上的非负可测函数，则可用 \( f(x, y) \chi_E(x, y) \) 代替\refthe{theorem:Tonelli 定理，非负可测函数的情形}中的 \( f(x, y) \)，我们有
\[
\int_E f(x, y) \, \mathrm{d}x\mathrm{d}y = \int_{\mathbb{R}^p} \mathrm{d}x \int_{\mathbb{R}^q} f(x, y) \chi_E(x, y) \, \mathrm{d}y.
\]
\end{enumerate}
\end{remark}
\begin{proof}
首先，\refthe{theorem:Tonelli 定理，非负可测函数的情形}的结论现在可改述为：凡非负可测函数皆属于 \( \mathcal{F} \). 其次，根据\nreflem{lemma:引理4.28}{(iv)}，我们只需指出非负可测简单函数属于 \( \mathcal{F} \) 即可. 又由于\nreflem{lemma:引理4.28}{(ii)}，实际上只需证明任一可测集 \( E \) 上的特征函数 \( \chi_E(x, y) \) 皆属于 \( \mathcal{F} \);

(i) \( E = I_1 \times I_2 \)，其中 \( I_1 \) 与 \( I_2 \) 各为 \( \mathbb{R}^p \) 与 \( \mathbb{R}^q \) 中的矩体. 显然，有
\[
\int_{\mathbb{R}^n} \chi_E(x, y) \, \mathrm{d}x\mathrm{d}y = m(E) = |I_1| \times |I_2|.
\]
此外，对每个 \( x \in \mathbb{R}^p \)，\( \chi_E(x, y) \) 显然是 \( \mathbb{R}^q \) 上的非负可测函数，且有
\[
F_{\chi}(x) = 
\begin{cases} 
|I_2|, & x \in I_1, \\
0, & x \notin I_1,
\end{cases}
\]
从而可知 \( F_{\chi}(x) \) 是 \( \mathbb{R}^p \) 上的非负可测函数，以及
\[
\int_{\mathbb{R}^p} F_{\chi}(x) \, \mathrm{d}x = |I_1| \times |I_2|.
\]
这说明 \( \chi_E \in \mathcal{F} \).

(ii) 若 \( E \) 是 \( \mathbb{R}^n \) 中的开集，即 \( E = \bigcup_{k = 1}^{\infty} I_k \)，其中 \( I_k \) 是互不相交的半开闭矩体，则 \( \chi_E \in \mathcal{F} \).

事实上，令 \( E_k = \bigcup_{i = 1}^k I_i \)，由(i)以及\nreflem{lemma:引理4.28}{(ii)}可知 \( \chi_{E_k} \in \mathcal{F} \). 又根据\nreflem{lemma:引理4.28}{(iv)}可知 \( \chi_E \in \mathcal{F} \).

(iii) 若 \( E \) 是有界闭集，则 \( E \) 可表示为两个有界开集 \( (G_1 \supset G_2) \) 的差集，从而由(2)以及\nreflem{lemma:引理4.28}{(ii)}可知 \( \chi_E \in \mathcal{F} \).

(iv) 设 \( \{ E_k \} \) 是递减可测集合列，且 \( m(E_1) < \infty \)，记 \( E = \bigcap_{k = 1}^{\infty} E_k \). 若 \( \chi_{E_k} \in \mathcal{F} \) \( (k = 1, 2, \cdots) \)，则 \( \chi_E \in \mathcal{F} \).

事实上，把 \( \chi_{E_k} \) 看成 \( f_k \)，\( \chi_E \) 看成 \( f \)，那么类似于\nreflem{lemma:引理4.28}{(iv)}的证明方法，用控制收敛定理即可得证.

(v) 若 \( E \) 是零测集，则 \( \chi_E \in \mathcal{F} \).

事实上，此时存在递减开集列 \( \{ G_k \} \)，\( G_k \supset E \) \( (k = 1, 2, \cdots) \)，使得
\[
\lim_{k \to \infty} m(G_k) = 0.
\]
令 \( H = \bigcap_{k = 1}^{\infty} G_k \)，则由(ii)以及(iv)可知 \( \chi_H \in \mathcal{F} \). 又 \( E \subset H \)，并注意到 \( m(H) = 0 \)，我们有
\[
\int_{\mathbb{R}^p} \mathrm{d}x \int_{\mathbb{R}^q} \chi_H(x, y) \, \mathrm{d}y = 0
\]
以及
\[
\int_{\mathbb{R}^n} \chi_E(x, y) \, \mathrm{d}x\mathrm{d}y = 0 = \int_{\mathbb{R}^p} \mathrm{d}x \int_{\mathbb{R}^q} \chi_E(x, y) \, \mathrm{d}y,
\]
即 \( \chi_E \) 满足条件(C). 上述等式还指出，对几乎处处的 \( x \in \mathbb{R}^p \)，有
\[
F_{\chi_E}(x) = \int_{\mathbb{R}^q} \chi_E(x, y) \, \mathrm{d}y = 0.
\]
从而立即推出，对几乎处处的 \( x \in \mathbb{R}^p \)，有 \( \chi_E(x, y) = 0 \)，\(\text{a.e.}\)（于 \( \mathbb{R}^q \)）. 这说明 \( \chi_E \) 满足条件(A)与(B)，\( \chi_E \in \mathcal{F} \).

(vi) 若 \( E \in \mathcal{M} \)，则 \( \chi_E \in \mathcal{F} \).

事实上，因为 \( E \) 可以表示为两个互不相交的集合的并：
\[
E = \left( \bigcup_{k = 1}^{\infty} F_k \right) \cup Z,
\]
其中每个 \( F_k \) 都是有界闭集，\( m(Z) = 0 \). 令 \( K = \bigcup_{k = 1}^{\infty} F_k \)，由(iii)以及用类似于(ii)中的方法不难证明 \( \chi_K \in \mathcal{F} \). 最后，根据等式
\[
\chi_E(x, y) = \chi_K(x, y) + \chi_Z(x, y)
\]
立即得到 \( \chi_E \in \mathcal{F} \).
\end{proof}

\begin{theorem}[Fubini定理$\,$可积函数的情形]\label{theorem:Fubini定理 可积函数的情形}
若 \( f \in L(\mathbb{R}^n) \)，\( (x, y) \in \mathbb{R}^n = \mathbb{R}^p \times \mathbb{R}^q \)，则

(A) 对于几乎处处的 \( x \in \mathbb{R}^p \)，\( f(x, y) \) 是 \( \mathbb{R}^q \) 上的可积函数；

(B) 积分$\int_{\mathbb{R}^q} f(x, y) \, \mathrm{d}y$
是 \( \mathbb{R}^p \) 上的可积函数；

(C) 我们有
\[
\int_{\mathbb{R}^n} f(x, y) \, \mathrm{d}x\mathrm{d}y = \int_{\mathbb{R}^p} \mathrm{d}x \int_{\mathbb{R}^q} f(x, y) \, \mathrm{d}y = \int_{\mathbb{R}^q} \mathrm{d}y \int_{\mathbb{R}^p} f(x, y) \, \mathrm{d}x.
\]
\end{theorem}
\begin{proof}
令 \( f(x, y) = f^+(x, y) - f^-(x, y) \)，则根据非负可测函数的\hyperref[theorem:Tonelli 定理 非负可测函数的情形]{Tonelli 定理}可知，\( f^+(x, y) \) 与 \( f^-(x, y) \) 满足上述条件(A),(B)与(C). 注意到所有的积分值都是有限的，从而可以作减法运算，并立即得出定理的结论.
\end{proof}
\begin{remark}
\begin{enumerate}
\item 在被积函数变号且不知其是否可积时，不妨先取绝对值再进行讨论.

\item 即使 \( f(x, y) \) 的两个累次积分存在且相等，\( f(x, y) \) 在 \( \mathbb{R}^n \) 上也可能是不可积的.

\item \hyperref[theorem:Tonelli 定理 非负可测函数的情形]{Tonelli 定理}对 Riemann 积分不真. 例如，设 \( E \) 是 \( [0, 1] \times [0, 1] \) 中的稠密集，且任一平行于坐标轴的直线至多交 \( E \) 于一个点，又作函数
\[
f(x, y) = 
\begin{cases} 
1, & (x, y) \in E, \\
0, & (x, y) \notin E,
\end{cases}
\]
易知 \( f \notin R([0, 1] \times [0, 1]) \)，但我们有（Riemann 积分）
\[
\int_0^1 \mathrm{d}y \int_0^1 f(x, y) \, \mathrm{d}x = 0 = \int_0^1 \mathrm{d}x \int_0^1 f(x, y) \, \mathrm{d}y.
\]

\item 设 \( f(x) = f(\xi_1, \xi_2, \cdots, \xi_n) \) 在开球 \( B(0, r) \subset \mathbb{R}^n \) 上有表达式
\[
f(x) = \sum_{(k_1, \cdots, k_n) = (1, \cdots, 1)}^{\infty} \cdots \sum a_{k_1 \cdots k_n} x_1^{k_1} x_2^{k_2} \cdots x_n^{k_n},
\]
则或有 \( f(x) = 0 (x \in B(0, r)) \)，或是 \( m(f^{-1}(0) \cap B(0, r)) = 0 \).

证明 (i) 若 \( n = 1 \)，则可视 \( f(x) \) 为在复平面中 \( \{ z : |z| < r \} \) 上的解析函数 \( F(z) \) 在 \( (-r, r) \) 上的限定. 此时，如果 \( f \neq 0 \)，那么 \( F^{-1}(0) \) 是一个至多可列集. 证毕.

(ii) 对一般的 \( n \)，采用归纳法. 假定 \( n = 1, 2, \cdots, N - 1 \) 时结论为真，且记 \( E = f^{-1}(0) \cap B(0, r) \) 以及
\[
E_N = \{ (\xi_1, \xi_2, \cdots, \xi_{N - 1}) : (\xi_1, \xi_2, \cdots, \xi_{N - 1}, \xi_N) \in E \},
\]
则根据 \hyperref[theorem:Fubini定理 可积函数的情形]{Fubini 定理}可知
\[
m_N(E) = \int_{-r}^r m_{N - 1}(E_N) \, d\xi_N,
\]
其中 \( m_k(A) \) 表示 \( \mathbb{R}^k \) 中点集 \( A \) 的 Lebesgue 测度.

现在，对 \( \xi_N \in (-r, r) \)，视 \( f(\xi_1, \xi_2, \cdots, \xi_{N - 1}, \xi_N) \) 为变量 \( \xi_1, \xi_2, \cdots, \xi_{N - 1} \) 的函数在 \( \mathbb{R}^{N - 1} \) 中的点集 \( E_N \) 上为 0，则 \( m_{N - 1}(E_N) = 0 \). 根据归纳法，即得所证.

解意：该结论表明，几乎所有的 \( n \times n \) 阶矩阵均有 \( n \) 个不同的特征值. 这里“几乎所有”是指：\( \mathbb{R}^{n^2} \) 中所有 \( n \times n \) 阶矩阵形成之集的 \( m_{n^2} \) 之测度.
\end{enumerate}
\end{remark}

\begin{example}
设 \( f \in L([0, +\infty)) \)，\( a > 0 \)，则有等式
\[
\int_0^{+\infty} \sin ax \, \mathrm{d}x \int_0^{+\infty} f(y) \mathrm{e}^{-xy} \, \mathrm{d}y = a \int_0^{+\infty} \frac{f(y) \, \mathrm{d}y}{a^2 + y^2}.
\]
\end{example}
\begin{proof}
因为
\[
\int_0^{+\infty} \sin ax \mathrm{e}^{-xy} \, \mathrm{d}x = \frac{a}{a^2 + y^2} \quad (x > 0),
\]
所以只需阐明原等式积分可交换次序即可.

考查二元可测函数 \( \sin ax f(y) \mathrm{e}^{-xy} \). 它不是非负的，从而要研究它的可积性. 为此，取其绝对值并将对 \( x \) 的积分范围限于 \( [\delta, X] \)：\( 0 < \delta < X < +\infty \). 此时有
\begin{align*}
\int_{\delta}^{X} \int_0^{+\infty} |\sin ax \cdot f(y) \mathrm{e}^{-xy}| \, \mathrm{d}x\mathrm{d}y &\leqslant \int_{\delta}^{X} \int_0^{+\infty} |f(y)| \mathrm{e}^{-\delta y} \, \mathrm{d}x\mathrm{d}y \\
&\leqslant (X - \delta) \int_0^{+\infty} |f(y)| \, \mathrm{d}y,
\end{align*}
这说明 \( \sin ax f(y) \mathrm{e}^{-xy} \) 在 \( [\delta, X] \times [0, +\infty) \) 上可积. 于是，我们有
\[
\int_{\delta}^{X} \sin ax \, \mathrm{d}x \int_0^{+\infty} f(y) \mathrm{e}^{-xy} \, \mathrm{d}y = \int_0^{+\infty} f(y) \, \mathrm{d}y \int_{\delta}^{X} \sin ax \mathrm{e}^{-xy} \, \mathrm{d}x.
\]

注意到（根据积分第二中值定理）
\[
\left| \int_{\delta}^{X} \mathrm{e}^{-xy} \sin ax \, \mathrm{d}x \right| \leqslant \frac{2}{a}, \quad 0 < \delta < X < +\infty,
\]
由\hyperref[theorem:控制收敛定理]{控制收敛定理}即得
\begin{align*}
\int_0^{+\infty} \sin ax \, \mathrm{d}x \int_0^{+\infty} f(y) \mathrm{e}^{-xy} \, \mathrm{d}y &= \lim_{\substack{\delta \to 0 \\ X \to +\infty}} \int_{\delta}^{X} \sin ax \, \mathrm{d}x \int_0^{+\infty} f(y) \mathrm{e}^{-xy} \, \mathrm{d}y \\
&= \lim_{\substack{\delta \to 0 \\ X \to +\infty}} \int_0^{+\infty} f(y) \, \mathrm{d}y \int_{\delta}^{X} \sin ax \mathrm{e}^{-xy} \, \mathrm{d}x \\
&= \int_0^{+\infty} f(y) \, \mathrm{d}y \int_0^{+\infty} \sin ax \mathrm{e}^{-xy} \, \mathrm{d}y.
\end{align*}
\end{proof}

\begin{example}
$\int_0^{+\infty} \mathrm{e}^{-x^2} \, \mathrm{d}x = \frac{\sqrt{\pi}}{2}.$
\end{example}
\begin{proof}

\end{proof}
\begin{proof}
因为 \( f(x, y) = y \mathrm{e}^{-(1 + x^2)y^2} \) 在 \( [0, +\infty) \times [0, +\infty) \) 上非负可测，所以根据\hyperref[theorem:Tonelli 定理 非负可测函数的情形]{Tonelli 定理}可知
\[
\int_0^{+\infty} \left( \int_0^{+\infty} y \mathrm{e}^{-(1 + x^2)y^2} \, \mathrm{d}y \right) \mathrm{d}x = \int_0^{+\infty} \left( \int_0^{+\infty} y \mathrm{e}^{-(1 + x^2)y^2} \, \mathrm{d}x \right) \mathrm{d}y.
\]
易知上式左端为 \( \pi/4 \)，而右端为
\[
\left( \int_0^{+\infty} \mathrm{e}^{-x^2} \, \mathrm{d}x \right) \left( \int_0^{+\infty} \mathrm{e}^{-y^2} \, \mathrm{d}y \right) = \left( \int_0^{+\infty} \mathrm{e}^{-x^2} \, \mathrm{d}x \right)^2.
\]
\end{proof}

\begin{example}
对 \( x \in \mathbb{R}^{n - 1} (n > 1) \)，\( t \in \mathbb{R} \)，记 \( (x, t) \) 为
\[
(x, t) = (x_1, x_2, \cdots, x_{n - 1}, t) \in \mathbb{R}^n.
\]
设 \( E \) 是 \( \mathbb{R}^{n - 1} \) 中的可测集，\( h > 0 \)，点集
\[
A = \{ (\alpha z, \alpha h) : z \in E, 0 \leqslant \alpha \leqslant 1 \}
\]
是以 \( E \) 为底、高为 \( h \) 且顶点为 0 的锥，则
\[
m(A) = \frac{h}{n} m(E).
\]
\end{example}
\begin{proof}
当 \( (x, t) \in A \) 时，\( x = \alpha z \)，\( t = \alpha h \)，也就是 \( \alpha = t/h \)，\( \alpha z = t z / h \). 从而当 \( 0 \leqslant t \leqslant h \) 时，有
\[
A_t \stackrel{\text{def}}{=} \{ x \in \mathbb{R}^{n - 1} : (x, t) \in A \} = \left\{ \frac{t}{h} z : z \in E \right\}.
\]
易知 \( m(A_t) = (t/h)^{n - 1} m(E) \). 由此可得
\begin{align*}
m(A) &= \int_{\mathbb{R}^n} \chi_A(u) \, du = \int_{\mathbb{R}} dt \int_{\mathbb{R}^{n - 1}} \chi_A(x, t) \, \mathrm{d}x \\
&= \int_{\mathbb{R}} dt \int_{A_t} 1 \, \mathrm{d}x = \int_{\mathbb{R}} m(A_t) \, dt = \frac{m(E)}{h^{n - 1}} \int_0^h t^{n - 1} \, dt \\
&= \frac{h}{n} m(E).
\end{align*}
\end{proof}




\subsection{积分的几何意义}

\begin{theorem}
设 \( E \) 是 \( \mathbb{R}^n = \mathbb{R}^p \times \mathbb{R}^q \) 中的点集，对任意的 \( x \in \mathbb{R}^p \)，令
\[
E(x) = \{ y \in \mathbb{R}^q : (x, y) \in E \},
\]
称它为点集 \( E \) 在 \( x \) 处的截段集. 若 \( E \) 是可测集，则对几乎处处的 \( x \)，\( E(x) \) 是 \( \mathbb{R}^q \) 中的可测集，\( m(E(x)) \) 是 \( \mathbb{R}^p \) 上（几乎处处有定义的）的可测函数，且有
\[
m(E) = \int_{\mathbb{R}^p} m(E(x)) \, \mathrm{d}x.
\]
\end{theorem}
\begin{proof}
只需在\hyperref[theorem:Tonelli 定理 非负可测函数的情形]{Tonelli定理}中令 \( f = \chi_E \) 便可得证.
\end{proof}

\begin{theorem}
若 \( E_1 \) 与 \( E_2 \) 是 \( \mathbb{R}^p \) 与 \( \mathbb{R}^q \) 中的可测集，则 \( E_1 \times E_2 \) 是 \( \mathbb{R}^p \times \mathbb{R}^q \) 中的可测集，且有
\[
m(E_1 \times E_2) = m(E_1) \cdot m(E_2).
\]
\end{theorem}
\begin{proof}
因为
\[
\chi_{E_1}(x) \cdot \chi_{E_2}(y) = \chi_{E_1 \times E_2}(x, y),
\]
所以若能证明 \( E_1 \times E_2 \) 是 \( \mathbb{R}^p \times \mathbb{R}^q \) 中的可测集，则由\hyperref[theorem:Tonelli 定理 非负可测函数的情形]{Tonelli定理}立即推知
\begin{align*}
m(E_1 \times E_2) = \int_{\mathbb{R}^p \times \mathbb{R}^q} \chi_{E_1 \times E_2}(x, y) \, \mathrm{d}x\mathrm{d}y 
= \int_{\mathbb{R}^p} \chi_{E_1}(x) \, \mathrm{d}x \int_{\mathbb{R}^q} \chi_{E_2}(y) \, \mathrm{d}y = m(E_1) \cdot m(E_2).
\end{align*}
现在来证明 \( E_1 \times E_2 \) 是 \( \mathbb{R}^p \times \mathbb{R}^q \) 中的可测集. 由于 \( E_1 \times E_2 \) 可以表示成可数个点集 \( A \times B \) 的并集，其中 \( A, B \) 是有界闭集或零测集. 故只需讨论两种情形：

(i) \( A \) 是零测集. 此时，对于任给的 \( \varepsilon > 0 \)，可作 \( \mathbb{R}^p \) 中的开矩体列 \( \{ I_k \} \) 以及 \( \mathbb{R}^q \) 中开矩体列 \( \{ J_i \} \)，使得
\[
\bigcup_{k = 1}^{\infty} I_k \supset A, \quad \sum_{k = 1}^{\infty} |I_k| < \varepsilon,
\]
\[
\bigcup_{i = 1}^{\infty} J_i \supset B, \quad \sum_{i = 1}^{\infty} |J_i| < +\infty.
\]
显然，\( A \times B \) 被 \( \mathbb{R}^p \times \mathbb{R}^q \) 中的开矩体列 \( \{ I_k \times J_i \} \) 所覆盖. 因此，我们有
\begin{align*}
m^*(A \times B) \leqslant m\left( \bigcup_{k, i = 1}^{\infty} (I_k \times J_i) \right) 
\leqslant \sum_{k = 1}^{\infty} |I_k| \cdot \sum_{i = 1}^{\infty} |J_i| < \varepsilon \sum_{i = 1}^{\infty} |J_i|.
\end{align*}
这说明 \( A \times B \) 是 \( \mathbb{R}^p \times \mathbb{R}^q \) 中的零测集.

(ii) \( A \) 与 \( B \) 都是有界闭集. 易知 \( A \times B \) 是 \( \mathbb{R}^p \times \mathbb{R}^q \) 中的闭集，是可测集.
\end{proof}

\begin{corollary}[可测函数图形的测度]\label{corollary:可测函数图形的测度}
设 \( f(x) \) 是 \( E \subset \mathbb{R}^n \) 上的非负实值可测函数，作点集
\[
G_E(f) = \{ (x, y) \in \mathbb{R}^{n + 1} : x \in E, y = f(x) \},
\]
称它为 \( y = f(x) \) 在 \( E \) 上的图形.（注意，\( E \) 是 \( \mathbb{R}^n \) 中的点集，\( G_E(f) \) 是 \( \mathbb{R}^{n + 1} \) 中的点集.）我们有
\[
m(G_E(f)) = 0.
\]
\end{corollary}
\begin{proof}
不妨设 \( m(E) < +\infty \). 对任给 \( \delta > 0 \)，作分点：
\[
0, \delta, 2\delta, \cdots, k\delta, (k + 1)\delta, \cdots,
\]
令 \( E_k = \{ x : k\delta \leqslant f(x) < (k + 1)\delta \} \) \( (k = 0, 1, \cdots) \). 显然有
\[
G_E(f) = \bigcup_{k = 0}^{\infty} G_{E_k}(f).
\]
从而得
\begin{align*}
m^*(G_E(f)) \leqslant \sum_{k = 0}^{\infty} m^*(G_{E_k}(f)) \leqslant \sum_{k = 0}^{\infty} \delta m(E_k) = \delta m(E).
\end{align*}
由 \( \delta \) 的任意性可知
\[
m(G_E(f)) = 0.
\]
\end{proof}

\begin{theorem}[积分的几何意义]\label{theorem:积分的几何意义}
设 \( f(x) \) 是 \( E \subset \mathbb{R}^n \) 上的非负实值函数，记
\[
\underline{G}(f) = \underline{G}_E(f) = \{ (x, y) \in \mathbb{R}^{n + 1} : x \in E, 0 \leqslant y \leqslant f(x) \},
\]
称它为 \( y = f(x) \) 在 \( E \) 上的下方图形. 我们有下述结论：

(i) 若 \( f(x) \) 是可测函数，则 \( \underline{G}(f) \) 是 \( \mathbb{R}^{n + 1} \) 中的可测集，且有
\[
m(\underline{G}(f)) = \int_E f(x) \, \mathrm{d}x.
\]

(ii) 若 \( E \) 是可测集，\( \underline{G}(f) \) 是 \( \mathbb{R}^{n + 1} \) 中的可测集，则 \( f(x) \) 是可测函数，且有
\[
m(\underline{G}(f)) = \int_E f(x) \, \mathrm{d}x.
\]
这正是 Riemann 积分中曲边梯形面积意义的推广.
\end{theorem}
\begin{proof}
(i) 若 \( f(x) \) 是一个可测集上的特征函数，结论显然成立. 从而对于非负可测简单函数结论也真（注意，在互不相交子集的并集上的下方图形等于在每个子集上的下方图形的并）. 于是，我们作非负可测简单函数渐升列 \( \{ \varphi_k(x) \} \) 收敛于 \( f(x) \)，易证
\[
\lim_{k \to \infty} \underline{G}(\varphi_k) \cup Z = \underline{G}(f),
\]
\[
Z = \{ (x, f(x)) : x \in E \} \subset G_E(f).
\]
因为 \( f \) 的图形集 \( G_E(f) \) 是 \( \mathbb{R}^{n + 1} \) 中的零测集，所以 \( \underline{G}(f) \) 不仅是 \( \mathbb{R}^{n + 1} \) 中的可测集，而且还有
\[
m(\underline{G}(f)) = \lim_{k \to \infty} m(\underline{G}(\varphi_k)) = \lim_{k \to \infty} \int_E \varphi_k(x) \, \mathrm{d}x = \int_E f(x) \, \mathrm{d}x.
\]

(ii) 设 \( H = \underline{G}(f) \) 是 \( \mathbb{R}^{n + 1} \) 中的可测集. 由定理 4.27 可知，对几乎处处的 \( y \in \mathbb{R} \)，截段集 \( H(y) \) 是 \( \mathbb{R}^n \) 中的可测集. 但我们有
\[
H(y) = \{ x : f(x) \geqslant y \},
\]
因此除一零测集中的 \( y \) 值以外，\( \{ x : f(x) \geqslant y \} \) 是可测集. 这说明 \( f(x) \) 是 \( E \subset \mathbb{R}^n \) 上的可测函数. 根据(i)即得
\[
m(\underline{G}(f)) = \int_E f(x) \, \mathrm{d}x.
\]
\end{proof}



\subsection{卷积函数、分布函数}

\begin{definition}[卷积]
设 \( f(x) \) 和 \( g(x) \) 是 \( \mathbb{R}^n \) 上的可测函数. 若积分
\[
\int_{\mathbb{R}^n} f(x - y) g(y) \, \mathrm{d}y
\]
存在，则称此积分为 \( f \) 与 \( g \) 的\textbf{卷积}，记为 \( (f * g)(x) \).
\end{definition}
\begin{remark}
注意，这里的 \( f(x - y) \) 是 \( (x, y) \in \mathbb{R}^n \times \mathbb{R}^n \) 上的可测函数.
\end{remark}

\begin{theorem}
若 \( f, g \in L(\mathbb{R}^n) \)，则 \( (f * g)(x) \) 对几乎处处的 \( x \in \mathbb{R}^n \) 存在，\( (f * g)(x) \) 是 \( \mathbb{R}^n \) 上的可积函数，且有
\[
\int_{\mathbb{R}^n} |(f * g)(x)| \, \mathrm{d}x \leqslant \left( \int_{\mathbb{R}^n} |f(x)| \, \mathrm{d}x \right) \left( \int_{\mathbb{R}^n} |g(x)| \, \mathrm{d}x \right).
\]
\end{theorem}
\begin{proof}
首先，设 \( f(x) \geq 0 \)，\( g(x) \geq 0 \). 因为 \( f(x - t) g(t) \) 是 \( \mathbb{R}^n \times \mathbb{R}^n \) 上的可测函数，所以根据\hyperref[theorem:theorem:Tonelli 定理 非负可测函数的情形]{非负可测函数的Tonelli定理}可得
\begin{align*}
\int_{\mathbb{R}^n} \mathrm{d}x \int_{\mathbb{R}^n} f(x - t) g(t) \, dt &= \int_{\mathbb{R}^n} dt \int_{\mathbb{R}^n} f(x - t) g(t) \, \mathrm{d}x \\
&= \int_{\mathbb{R}^n} g(t) \, dt \int_{\mathbb{R}^n} f(x - t) \, \mathrm{d}x \\
&= \int_{\mathbb{R}^n} g(t) \, dt \int_{\mathbb{R}^n} f(x) \, \mathrm{d}x < +\infty.
\end{align*}
这说明 \( (f * g)(x) \) 几乎处处存在（有限），且有
\[
\int_{\mathbb{R}^n} (f * g)(x) \, \mathrm{d}x = \int_{\mathbb{R}^n} g(t) \, dt \cdot \int_{\mathbb{R}^n} f(x) \, \mathrm{d}x.
\]

其次，对于一般情形，只需注意
\[
|(f * g)(x)| \leq (|f| * |g|)(x),
\]
从而有
\begin{align*}
\int_{\mathbb{R}^n} |(f * g)(x)| \, \mathrm{d}x \leq \int_{\mathbb{R}^n} (|f| * |g|)(x) \, \mathrm{d}x = \int_{\mathbb{R}^n} |f(x)| \, \mathrm{d}x \int_{\mathbb{R}^n} |g(x)| \, \mathrm{d}x < +\infty.
\end{align*}
\end{proof}

\begin{proposition}[卷积是连续函数]\label{proposition:卷积是连续函数}
设 \( f \in L(\mathbb{R}^n) \)，\( g(x) \) 在 \( \mathbb{R}^n \) 上有界可测，则 \( F(x) = (f * g)(x) \) 是 \( \mathbb{R} \) 上的一致连续函数.
\end{proposition}
\begin{proof}
不妨设 \( |g(x)| \leq M \)，\( x \in \mathbb{R}^n \). 我们有
\begin{align*}
|F(x + h) - F(x)| &= \left| \int_{\mathbb{R}^n} f(x + h - t) g(t) \, dt - \int_{\mathbb{R}^n} f(x - t) g(t) \, dt \right| \\
&\leq \int_{\mathbb{R}^n} |f(x - t + h) - f(x - t)| |g(t)| \, dt \\
&\leq M \int_{\mathbb{R}^n} |f(t + h) - f(t)| \, dt \to 0 \quad (h \to 0),
\end{align*}
即得所证.
\end{proof}

\begin{proposition}[\( L \) 中无卷积单位]\label{proposition:L中无卷积单位}
\( L(\mathbb{R}) \) 中不存在函数 \( u(x) \)，使得对一切 \( f \in L(\mathbb{R}) \)，有
\[
(u * f)(x) = f(x), \quad \text{a.e.}\, x \in \mathbb{R}.
\]
\end{proposition}
\begin{proof}
应用反证法. 假设存在 \( u \in L(\mathbb{R}) \) 使上式成立. 首先，可取 \( \delta > 0 \)，使得
\[
\int_{-2\delta}^{2\delta} |u(x)| \, \mathrm{d}x < 1.
\]
其次，对 \( L(\mathbb{R}) \) 中的函数 \( f(x) = \chi_{[-\delta, \delta]}(x) \)，易知
\begin{align*}
f(x) = (u * f)(x) = \int_{-\delta}^{\delta} u(x - y) \, \mathrm{d}y = \int_{x - \delta}^{x + \delta} u(t) \, dt, \quad \text{a.e.}\, x \in \mathbb{R}.
\end{align*}
因此，必有 \( x_0 \in [-\delta, \delta] \)，使得
\[
1 = f(x_0) = \int_{x_0 - \delta}^{x_0 + \delta} u(t) \, dt.
\]
然而，另一方面，我们又有
\[
1 = \left| \int_{x_0 - \delta}^{x_0 + \delta} u(t) \, dt \right| \leq \int_{x_0 - \delta}^{x_0 + \delta} |u(t)| \, dt \leq \int_{-2\delta}^{2\delta} |u(t)| \, dt < 1.
\]
这一矛盾说明，不存在 \( u \in L(\mathbb{R}) \)，使得对一切 \( f \in L(\mathbb{R}) \)，有
\[
(u * f)(x) = f(x), \quad \text{a.e.}\, x \in \mathbb{R}.
\]
\end{proof}

\begin{example}
设 \( f(x) \) 在 \( \mathbb{R} \) 上可测，\( E \subset \mathbb{R} \) 且 \( \overline{E} = \mathbb{R} \). 若对任意 \( a \in E \)，有 \( f(x + a) = f(x) \)，\(\text{a.e.}\, x \in \mathbb{R} \)，则存在常数 \( C \)，使得 \( f(x) = C \)，\(\text{a.e.}\, x \in \mathbb{R} \).
\end{example}
\begin{proof}
首先假定 \( f(x) \) 有界，且设 \( \{ \varphi_{\varepsilon_n}(x) \} \) 是 \( L^1(\mathbb{R}) \) 中的\hyperref[definition:展缩函数]{展缩函数列}，则知 \( f_n(x) = f * \varphi_{\varepsilon_n}(x) \) 在 \( \mathbb{R} \) 上连续，且有
\[
f_n(x + a) = f_n(x) \quad (n \in \mathbb{N}).
\]
从而由 \( E \) 的稠密性，可得 \( f_n(x) = C_n (x \in \mathbb{R}) \). 不妨认定（否则用子列，注意 \( f \in L^1 \)）
\[
\lim_{n \to \infty} f_n(x) = f(x), \quad \text{a.e.}\, x \in \mathbb{R},
\]
因此我们有 \( C_n \to C (n \to \infty) \)，即 \( f(x) = C \)，\(\text{a.e.}\, x \in \mathbb{R} \).

其次，对一般可测函数 \( f(x) \)，作函数列
\[
f_n(x) = 
\begin{cases} 
f(x), & |f(x)| \leq n, \\
0, & \text{其他},
\end{cases}
\]
易知每个 \( f_n(x) \) 均满足题设，故存在 \( C_n \)，使得
\[
f_n(x) = C_n, \quad \text{a.e.}\, x \in \mathbb{R}.
\]

若存在 \( n_0 \)，使得 \( C_{n_0} \neq 0 \)，则 \( f(x) = C_{n_0} \)，\(\text{a.e.}\, x \in \mathbb{R} \)；

若对一切 \( n \in \mathbb{N} \)，\( C_n = 0 \)，即 \( f_n(x) = 0 \)，\(\text{a.e.}\, x \in \mathbb{R} \)，则 \( f(x) = 0 \)，\(\text{a.e.}\, x \in \mathbb{R} \).
\end{proof}

\begin{definition}[分布函数]
设 \( f(x) \) 在 \( E \) 上可测，则称
\[
f_*(\lambda) = m(\{ x \in E : |f(x)| > \lambda \}), \quad \lambda > 0
\]
为 \( f(x) \) 在 \( E \) 上的\textbf{分布函数}. 显然，\( f_*(\lambda) \) 是 \( (0, +\infty) \) 上的递减函数.
\end{definition}

\begin{theorem}
设 \( f(x) \) 在 \( E \) 上可测，则对 \( 1 \leq p < +\infty \)，有
\[
\int_E |f(x)|^p \, \mathrm{d}x = p \int_0^{+\infty} \lambda^{p - 1} f_*(\lambda) \, \mathrm{d}\lambda. \tag{4.17}
\]
\end{theorem}
\begin{proof}
作函数
\[
F(\lambda, x) = 
\begin{cases} 
1, & |f(x)| > \lambda, \\
0, & |f(x)| \leq \lambda.
\end{cases}
\]
易知 \( F(\lambda, x) \) 作为 \( x \) 的函数是 \( \{ x \in E : |f(x)| > \lambda \} \) 上的特征函数，从而由 \hyperref[theorem:Tonelli 定理 非负可测函数的情形]{Tonelli 定理}可得
\begin{align*}
\int_E |f(x)|^p \, \mathrm{d}x &= \int_E \mathrm{d}x \int_0^{|f(x)|} p\lambda^{p - 1} \, \mathrm{d}\lambda = \int_E \mathrm{d}x \int_0^{+\infty} p\lambda^{p - 1} F(\lambda, x) \, \mathrm{d}\lambda \\
&= \int_0^{+\infty} p\lambda^{p - 1} \mathrm{d}\lambda \int_E F(\lambda, x) \, \mathrm{d}x = p \int_0^{+\infty} \lambda^{p - 1} f_*(\lambda) \, \mathrm{d}\lambda.
\end{align*}
\end{proof}





































































































































































\end{document}
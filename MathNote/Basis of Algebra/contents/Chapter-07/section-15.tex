\documentclass[../../main.tex]{subfiles}
\graphicspath{{\subfix{../../image/}}} % 指定图片目录,后续可以直接使用图片文件名。

% 例如:
% \begin{figure}[H]
% \centering
% \includegraphics[scale=0.4]{图.png}
% \caption{}
% \label{figure:图}
% \end{figure}
% 注意:上述\label{}一定要放在\caption{}之后,否则引用图片序号会只会显示??.

\begin{document}

\section{Jordan标准型的应用}

\subsection{利用Jordan标准型研究矩阵的性质}

\begin{proposition}\label{proposition:矩阵相似于分块幂零,可逆块}
设 $A$ 是 $n$ 阶复矩阵，求证：$A$ 相似于分块对角矩阵 $\mathrm{diag}\{B,C\}$，其中 $B$ 是幂零矩阵，$C$ 是可逆矩阵.
\end{proposition}
\begin{remark}
这个命题告诉我们：在相似的意义下，对复方阵的研究可归结为对幂零矩阵和可逆矩阵这两类特殊矩阵的研究，它们的刻画分别是：特征值全为零以及特征值全不为零。这也是前面很多例题都处理这两类矩阵的深层次原因。 
\end{remark}
\begin{proof}
我们发现 $A$ 的初等因子分离开了零特征值和非零特征值，从而 $A$ 的 Jordan 标准型满足题目要求。此时，可将零特征值的 Jordan 块 $J_r(0)$（幂零矩阵）放入 $B$ 中，将非零特征值的 Jordan 块 $J_r(\lambda_0)$（可逆矩阵）放入 $C$ 中，即得结论。
\end{proof}

\begin{theorem}
设 $\lambda_0$ 是 $n$ 阶矩阵 $A$ 的特征值，其代数重数为 $m$。设属于特征值 $\lambda_0$ 的最大 Jordan 块的阶数为 $k$，求证：
\[\mathrm{r}(A - \lambda_0I_n) > \cdots > \mathrm{r}((A - \lambda_0I_n)^k) = \mathrm{r}((A - \lambda_0I_n)^{k + 1}) = \cdots = n - m\]
\end{theorem}
\begin{proof}
设 $P$ 为可逆矩阵，使 $P^{-1}AP = J = \mathrm{diag}\{J_{r_1}(\lambda_1),J_{r_2}(\lambda_2),\cdots,J_{r_s}(\lambda_s)\}$ 为 Jordan 标准型，则对任意的正整数 $j$，
\begin{align*}
\mathrm{r}((A - \lambda_0I_n)^j) &= \mathrm{r}(P^{-1}(A - \lambda_0I_n)^jP) = \mathrm{r}((J - \lambda_0I_n)^j) = \sum_{i = 1}^{s}\mathrm{r}(J_{r_i}(\lambda_i - \lambda_0)^j)
\end{align*}
若 $\lambda_i \neq \lambda_0$，则 $\mathrm{r}(J_{r_i}(\lambda_i - \lambda_0)^j) = r_i$。若 $\lambda_i = \lambda_0$，则当 $1 \leqslant  j \leqslant  r_i$ 时，$\mathrm{r}(J_{r_i}(0)^j) = r_i - j$；当 $j \geqslant  r_i$ 时，$\mathrm{r}(J_{r_i}(0)^j) = 0$。注意到 $A$ 至少有一个 Jordan 块 $J_k(\lambda_0)$，并且属于特征值 $\lambda_0$ 的所有 Jordan 块阶数之和等于 $m$，故当 $1 \leqslant  j \leqslant  k$ 时，$\mathrm{r}((A - \lambda_0I_n)^j)$ 严格递减；当 $j \geqslant  k$ 时，$\mathrm{r}((A - \lambda_0I_n)^j) = n - m$.
\end{proof}

\begin{proposition}\label{proposition:列向量的线性组合}
设 $\lambda_0$ 是 $n$ 阶复矩阵 $A$ 的特征值，并且属于 $\lambda_0$ 的初等因子都是次数大于等于 2 的多项式。求证：特征值 $\lambda_0$ 的任一特征向量 $\alpha$ 均可表示为 $A - \lambda_0I_n$ 的列向量的线性组合。
\end{proposition}
\begin{remark}
\textbf{若特征值 $\lambda_0$ 有一个初等因子为一次多项式，则必存在特征向量 $\alpha$，它不能表示为 $A - \lambda_0I_n$ 的列向量的线性组合。}证明的细节留给读者完成。一个极端的例子就是 $A = I_n$，其特征值 1 的初等因子都是一次的，并且任一特征向量都不是 $A - I_n = O$ 的列向量的线性组合。\refpro{proposition:列向量的线性组合}与\refpro{proposition:线性变换可对角化的几何充要条件1}（可对角化的判定）有着密切的联系，请读者思考两者之间的关系.
\end{remark}
\begin{proof}
由\refcor{corollary:每个Jordan块都有且仅有一个线性无关的特征向量}可知，属于特征值 $\lambda_0$ 的每个 Jordan 块的线性无关的特征向量均只有一个，并且特征值 $\lambda_0$ 的任一特征向量都是这些特征向量的线性组合，因此我们只要证明 $A$ 的 Jordan 标准型只含一个 Jordan 块 $J_n(\lambda_0)$ 的情形即可。设 $P = (\alpha_1,\alpha_2,\cdots,\alpha_n)$ 为非异阵，使得 $P^{-1}AP = J_n(\lambda_0)$，即 $AP = PJ_n(\lambda_0)$，利用分块矩阵的乘法可得
\begin{align*}
A\alpha_1 &= \lambda_0\alpha_1,\\
A\alpha_2 &= \alpha_1 + \lambda_0\alpha_2,\\
&\cdots\\
A\alpha_n &= \alpha_{n - 1} + \lambda_0\alpha_n
\end{align*}
注意到 $n \geqslant  2$，故有 $\alpha_1 = (A - \lambda_0I_n)\alpha_2$，从而特征向量 $\alpha_1$ 可表示为 $A - \lambda_0I_n$ 的列向量的线性组合。
\end{proof}



\subsection{运用Jordan标准型进行相似问题的化简}

\begin{proposition}\label{proposition:r(A+B)=r(A)+r(B)}
设 $A,B$ 为 $n$ 阶矩阵，满足 $AB = BA = O$，$\mathrm{r}(A) = \mathrm{r}(A^2)$，求证：$\mathrm{r}(A + B) = \mathrm{r}(A) + \mathrm{r}(B)$.
\end{proposition}
\begin{proof}
注意到问题的条件和结论在同时相似变换：$A\mapsto P^{-1}AP$，$B\mapsto P^{-1}BP$ 下不改变，故不妨从一开始就假设 $A$ 为 Jordan 标准型。设 $A = \mathrm{diag}\{A_0,A_1\}$，其中 $A_0$ 由零特征值的 Jordan 块构成，$A_1$ 由非零特征值的 Jordan 块构成。由 $\mathrm{r}(A) = \mathrm{r}(A^2)$ 可知，零特征值的 Jordan 块都是一阶的否则,$\mathrm{r}(A^2_0)<\mathrm{r}(A_0)$.即 $A_0 = O$。将 $B$ 进行对应的分块 $B = \begin{pmatrix}B_{11}&B_{12}\\B_{21}&B_{22}\end{pmatrix}$，则由 $AB = BA = O$ 以及 $A_1$ 非异可知，$B_{12}$,$B_{21}$ 和 $B_{22}$ 都是零矩阵。于是
\begin{align*}
\mathrm{r}(A + B) &= \mathrm{r}\begin{pmatrix}B_{11}&O\\O&A_1\end{pmatrix} = \mathrm{r}(B_{11}) + \mathrm{r}(A_1) = \mathrm{r}(B) + \mathrm{r}(A).
\end{align*}
\end{proof}

\begin{proposition}[$AX=BX$经典结论]\label{proposition:AX-XB线性映射相关等价条件--(1)}
\begin{enumerate}[(1)]
\item 设 $A\in\mathbb{C}^{n\times n}, B\in\mathbb{C}^{m\times m}, m,n\in\mathbb{N}$，求证：矩阵方程 $AX = XB$ 只有零解的充要条件是 $A$, $B$ 无公共的特征值。

\item 设$A\in\mathbb{C}^{n\times n}, B\in\mathbb{C}^{m\times m}, m,n\in\mathbb{N}$，求证：矩阵方程$AX = XB$有非$0$解$X\in\mathbb{C}^{n\times m}$的充分必要条件是$A,B$至少有一个相同的特征值. 
\end{enumerate}
\end{proposition}
\begin{proof}
上述两个命题等价,因此我们只证(2).

{\color{blue} 证法一:}先做两步化简。注意到问题的条件和结论在矩阵变换：$B \mapsto P^{-1}BP$, $X \mapsto XP$ 下不改变，故不妨从一开始就假设 $B$ 为 Jordan 标准型。设 $X = (\alpha_1, \alpha_2, \cdots, \alpha_n)$ 为列分块，则有
\begin{align}
AX = (A\alpha_1, A\alpha_2, \cdots, A\alpha_n) = (\alpha_1, \alpha_2, \cdots, \alpha_n)B = XB. \label{equation----::7.11}
\end{align}
若 $B$ 有 $k$ 个 Jordan 块，则方程组\eqref{equation----::7.11} 可分解为 $k$ 个独立方程组。注意到：

(i) 方程组\eqref{equation----::7.11}只有零解当且仅当这 $k$ 个独立方程组都只有零解；

(ii) 方程组\eqref{equation----::7.11}有非零解当且仅当这 $k$ 个独立方程组中至少有一个有非零解。

因此，不妨进一步假设 $B = J_n(\lambda_0)$ 为 Jordan 块。此时，方程组\eqref{equation----::7.11}等价于下列方程组：
\[
A\alpha_1 = \lambda_0\alpha_1,~ A\alpha_2 = \alpha_1 + \lambda_0\alpha_2,~ \cdots,~ A\alpha_n = \alpha_{n - 1} + \lambda_0\alpha_n.
\]

{\heiti 充分性：}假设 $A$, $B$ 没有公共的特征值，则 $\lambda_0$ 不是 $A$ 的特征值，从而由 $A\alpha_1 = \lambda_0\alpha_1$ 只能得到 $\alpha_1 = \mathbf{0}$。代入第二个方程可得 $A\alpha_2 = \lambda_0\alpha_2$，相同的理由可推出 $\alpha_2 = \mathbf{0}$。不断这样做下去，最后可得 $\alpha_i = \mathbf{0} (1 \leqslant  i \leqslant  n)$，即 $X = O$，从而矩阵方程 $AX = XB$ 只有零解。

{\heiti 必要性：}假设 $A$ 和 $B = J_n(\lambda_0)$ 有公共的特征值 $\lambda_0$，在上述方程组中令 $\alpha_1 = \cdots = \alpha_{n - 1} = \mathbf{0}$。因为 $\lambda_0$ 也是 $A$ 的特征值，所以 $A\alpha_n = \lambda_0\alpha_n$ 有非零解 $\alpha_n = \alpha$，于是 $X_0 = (\mathbf{0}, \cdots, \mathbf{0}, \alpha)$ 是上述方程组的非零解，从而矩阵方程 $AX = XB$ 有非零解,矛盾!

{\color{blue} 证法二:}{\heiti 必要性:}若 \( AX = XB \) 有非零解 \( X \)，记 \( f(x) \) 是 \( B \) 的特征多项式，则 \( f(A)X = Xf(B) \) 也有非零解。  
由 Cayley-Hamilton 定理可知 \( f(B) = O \)，进而 \( f(A)X = O \) 有非零解，因此 \( f(A) \) 是奇异阵，从而 \( f(A) \) 有 \( 0 \) 特征值。  
又由\refpro{proposition:矩阵多项式的特征值就是原特征值代入多项式得到的数}可知 \( f(A) \) 的特征值都形如  
\[ f(\lambda_i), \, i = 1,2,\cdots,n. \]  
其中 \( \lambda_i \) 都是 \( A \) 的特征值。因此存在 \( k \in \{1,2,\cdots,n\} \)，使得 \( f(\lambda_k) = 0 \)。而 \( f(x) \) 是 \( B \) 的特征多项式，故 \( \lambda_k \) 也是 \( B \) 的特征值。因此 \( \lambda_k \) 既是 \( A \) 的特征值，也是 \( B \) 的特征值。  

{\heiti 充分性:}若 \( A,B \) 有相同特征值，则由\hyperref[proposition:lambda-矩阵一定与其转置相似]{矩阵与其自身的转置相似}可知，\( A,B,B^T \) 都有相同特征值 \( \lambda \in \mathbb{C} \)。于是取相应的特征向量 \( \alpha \in \mathbb{C}^n, \beta \in \mathbb{C}^m, \alpha,\beta \ne 0 \)，使  
\[ A\alpha = \lambda \alpha, \quad B^T\beta = \lambda \beta \Longleftrightarrow A\alpha = \lambda \alpha, \quad \beta^TB = \lambda \beta^T. \]  
从而  
\[ A\alpha\beta^T = \lambda \alpha\beta^T = \alpha \cdot \lambda \beta^T = \alpha\beta^TB. \]  
记 \( X = \alpha\beta^T \ne 0 \)，则由上式可知 \( AX = XB \)，故 \( X = \alpha\beta^T \) 就是 \( AX = XB \) 的非零解. 
\end{proof}

\begin{proposition}\label{proposition:AX-XB线性映射相关等价条件--(3)}
设 $A$, $B$ 分别是 $m$, $n$ 阶矩阵，$C$ 是 $m\times n$ 矩阵，求证：矩阵方程 $AX - XB = C$ 存在唯一解的充要条件是 $A$, $B$ 无公共的特征值。
\end{proposition}
\begin{proof}
先做两步化简。注意到问题的条件和结论在矩阵变换：$B\mapsto P^{-1}BP$, $C\mapsto CP$, $X\mapsto XP$ 下不改变，故不妨从一开始就假设 $B$ 为 Jordan 标准型。设 $X = (\alpha_1,\alpha_2,\cdots,\alpha_n)$, $C = (\beta_1,\beta_2,\cdots,\beta_n)$ 为列分块，则 $AX - XB = C$ 即为：
\begin{align}
(A\alpha_1,A\alpha_2,\cdots,A\alpha_n) - (\alpha_1,\alpha_2,\cdots,\alpha_n)B &= (\beta_1,\beta_2,\cdots,\beta_n).\label{eq:7.12}
\end{align}
若 $B$ 有 $k$ 个 Jordan 块，则方程组 \eqref{eq:7.12} 可分解为 $k$ 个独立方程组。注意到：

(i) 方程组 \eqref{eq:7.12} 无解当且仅当这 $k$ 个独立方程组中至少有一个无解；

(ii) 方程组 \eqref{eq:7.12} 有唯一解当且仅当这 $k$ 个独立方程组都只有唯一解；

(iii) 方程组 \eqref{eq:7.12} 有无穷个解当且仅当这 $k$ 个独立方程组都有解，且至少有一个有无穷个解。

进一步，若假设 $B = J_n(\lambda_0)$ 为 Jordan 块，则方程组 \eqref{eq:7.12} 等价于下列方程组：
$(A - \lambda_0I_n)\alpha_1 = \beta_1$, $(A - \lambda_0I_n)\alpha_2 = \alpha_1 + \beta_2$, $\cdots$, $(A - \lambda_0I_n)\alpha_n = \alpha_{n - 1} + \beta_n$。

{\heiti 充分性：}假设 $A$, $B$ 没有公共的特征值，则 $\lambda_0$ 不是 $A$ 的特征值，从而 $A - \lambda_0I_n$ 是可逆矩阵。从第一个方程可解得 $\alpha_1 = (A - \lambda_0I_n)^{-1}\beta_1$，代入第二个方程可解得 $\alpha_2 = (A - \lambda_0I_n)^{-1}(\alpha_1 + \beta_2)$，$\cdots$，代入最后一个方程可解得 $\alpha_n = (A - \lambda_0I_n)^{-1}(\alpha_{n - 1} + \beta_n)$，从而上述方程组有唯一解，因此矩阵方程 $AX - XB = C$ 也有唯一解。

{\heiti 必要性：}假设 $A$, $B$ 有公共的特征值 $\lambda_0$，若这 $k$ 个独立方程组中有一个无解，则矩阵方程 $AX - XB = C$ 无解，从而结论成立。若这 $k$ 个独立方程组都有解，则不妨设 $B = J_n(\lambda_0)$ 为 Jordan 块。由于 $\lambda_0$ 是 $A$ 的特征值，故 $(A - \lambda_0I_n)x = 0$ 有无穷个解。注意到，若 $(\alpha_1,\alpha_2,\cdots,\alpha_n)$ 是上述方程组的一个解，则对 $(A - \lambda_0I_n)x = 0$ 的任一解 $\alpha_0$，$(\alpha_1,\alpha_2,\cdots,\alpha_n + \alpha_0)$ 也是上述方程组的解，因此矩阵方程 $AX - XB = C$ 有无穷个解,矛盾!
\end{proof}

\begin{proposition}\label{proposition:AX-XB线性映射相关等价条件}
设 $A$, $B$ 分别是 $m$, $n$ 阶矩阵，$M_{m\times n}(\mathbb{C})$ 上的线性变换 $\varphi$ 定义为 $\varphi(X) = AX - XB$，则下列 3 个结论等价:

(1) $\varphi$ 是单映射；

(2) $\varphi$ 是自同构；

(3) 对某个给定的 $m \times n$ 矩阵 $C$，存在唯一的 $X_0$，使得 $\varphi(X_0) = C$.
\end{proposition}
\begin{remark}
由这个命题可知,\refpro{proposition:AX-XB线性映射相关等价条件--(1)}和\refpro{proposition:AX-XB线性映射相关等价条件--(3)}都等价于\refpro{proposition:AX-XB相关命题1}，并且\refpro{proposition:AX-XB线性映射相关等价条件--(1)}和\refpro{proposition:AX-XB线性映射相关等价条件--(3)}都给出了它们的 Jordan 标准型证法。
\end{remark}
\begin{proof}
事实上，$(1) \Rightarrow (2)$由\refcor{corollary:线性变换自同构的充要条件}立得. 
$(2) \Rightarrow (3)$ 显然成立。
用反证法来证明 $(3) \Rightarrow (1)$：若 $\mathrm{Ker}\varphi \neq 0$，则 $\mathrm{Ker}\varphi$ 中任一非零元 $X_1$ 都满足 $\varphi(X_0 + X_1) = C$，这与唯一性矛盾。
\end{proof}

\begin{theorem}[交结数]\label{theorem:AX-XB相关命题3}
设$\mathbb{K}$为数域，对$A\in\mathbb{K}^{m\times m}, B\in\mathbb{K}^{n\times n}$，计算矩阵方程$AX = XB$在$X\in\mathbb{K}^{m\times n}$的解空间维数.
\end{theorem}
\begin{remark}
因为$AX = XB$本质上是一个线性方程组，线性方程组的解空间维数不随域扩张而改变. 因此我们只需在代数闭域(即复数域$\mathbb{C}$)研究即可.
\end{remark}
\begin{proof}
不妨设$\mathbb{K}=\mathbb{C}$,设
\begin{align*}
P^{-1}AP = \mathrm{diag}\{J_1, J_2, \cdots, J_s\}, Q^{-1}BQ = \mathrm{diag}\{T_1, T_2, \cdots, T_t\}, P\in\mathbb{C}^{m\times m}, Q\in\mathbb{C}^{n\times n},
\end{align*}
这里$J_i, T_j, 1\leqslant i\leqslant s, 1\leqslant j\leqslant t$都是相同特征值对应所有Jordan块构成的分块对角矩阵.
注意到
\begin{align*}
P^{-1}APP^{-1}XQ = P^{-1}XQQ^{-1}BQ,
\end{align*}
于是定理的条件和结论在同构$A\rightarrow P^{-1}AP,B\rightarrow Q^{-1}BQ,X\rightarrow P^{-1}XQ$下不改变. 因此可不妨设
\begin{align*}
A = \mathrm{diag}\{J_1, J_2, \cdots, J_s\}, B = \mathrm{diag}\{T_1, T_2, \cdots, T_t\},
\end{align*}
这里$J_i, T_j, 1\leqslant i\leqslant s, 1\leqslant j\leqslant t$都是相同特征值对应所有Jordan块构成的分块对角矩阵. 不妨设$0\leqslant s_0\leqslant\min\{s, t\}$使得$J_1, J_2, \cdots, J_{s_0}$分别和$T_1, T_2, \cdots, T_{s_0}$特征值对应相同，且$A, B$剩下的每一个块对应特征值都不相同.

为了解$AX = XB$，把$X$对应分块为$(X_{ij}), 1\leqslant i\leqslant s, 1\leqslant j\leqslant t$，于是$AX = XB$等价于
\begin{align}
J_iX_{ij} = X_{ij}T_j, 1\leqslant i\leqslant s, 1\leqslant j\leqslant t. \label{23.13}
\end{align}
注意到由\refpro{proposition:AX-XB线性映射相关等价条件--(1)}，我们知道\eqref{23.13}中只有$1\leqslant i = j\leqslant s_0$时$X_{ij}$才能非$0$. 于是记$AX = XB$解空间为$W$，我们有
\begin{align}
\dim W = \sum_{i = 1}^{s_0}\dim\{Y : J_iY = YT_i\}. \label{23.14}
\end{align}
对固定的$1\leqslant i\leqslant s_0$，为了计算$\dim\{Y : J_iY = YT_i\}$，我们设
\begin{align*}
J_i = \mathrm{diag}\{J_{n_1}(\lambda), J_{n_2}(\lambda), \cdots, J_{n_{s'}}(\lambda)\}, T_i = \mathrm{diag}\{J_{n_1'}(\lambda), J_{n_2'}(\lambda), \cdots, J_{n_{t'}'}(\lambda)\}.
\end{align*}
做对应分块
\begin{align*}
Y = (Y_{i'j'}), 1\leqslant i'\leqslant s', 1\leqslant j'\leqslant t'.
\end{align*}
同样的$J_iY = YT_i$等价于
\begin{align}
J_{n_{i'}}(\lambda)Y_{i'j'} = Y_{i'j'}J_{n_{j'}'}(\lambda), \forall 1\leqslant i'\leqslant s', 1\leqslant j'\leqslant t'. \label{23.15}
\end{align}
而上述方程只能通过矩阵乘法定义计算. 由\refcor{corollary:与Jordan块J_n(lambda)可交换的矩阵}，我们知道
\begin{align*}
\dim\left\{Y_{i'j'} : J_{n_{i'}}(\lambda)Y_{i'j'} = Y_{i'j'}J_{n_{j'}'}(\lambda)\right\} = \min\{n_{i'}, n_{j'}'\},
\end{align*}
于是由\eqref{23.14}可计算出结果. 

综上所述,
设$s_0$是$A, B$公共特征值数,$J_i$由$n_{i1}, n_{i2}, \cdots, n_{ip_i}$阶Jordan块构成，$T_i$由$t_{i1}, t_{i2}, \cdots, t_{iq_i}$阶Jordan块构成,其中$i=1,2,\cdots,s_0$.则
\begin{align}
\dim W = \sum_{i = 1}^{s_0}\sum_{r = 1}^{p_i}\sum_{\ell = 1}^{q_i}\min\{n_{ir}, t_{i\ell}\}. \label{23.16}
\end{align}
\end{proof}

\begin{corollary}\label{corollary:AX-XB相关命题1}
设$B\in\mathbb{C}^{n\times n}, A\in\mathbb{C}^{m\times m}$，则矩阵方程$AX = XB$在$X\in\mathbb{C}^{m\times n}$中有秩$r$的解的充分必要条件是$A,B$至少有$r$个相同特征值(计重数).
\end{corollary}
\begin{proof}
从\refthe{theorem:AX-XB相关命题3}我们可看到，不妨设
\begin{align*}
A = \mathrm{diag}\{J_1, J_2, \cdots, J_s\}, B = \mathrm{diag}\{T_1, T_2, \cdots, T_t\},
\end{align*}
这里$J_i, T_j, 1\leqslant i\leqslant s, 1\leqslant j\leqslant t$都是相同特征值对应所有Jordan块构成的分块对角矩阵. 不妨设$0\leqslant s_0\leqslant\min\{s, t\}$使得$J_1, J_2, \cdots, J_{s_0}$分别和$T_1, T_2, \cdots, T_{s_0}$特征值对应相同，且$A,B$剩下的每一个块对应特征值都不相同. $J_i$由$n_{i1}, n_{i2}, \cdots, n_{ip_i}$阶Jordan块构成，$T_i$由$t_{i1}, t_{i2}, \cdots, t_{iq_i}$阶Jordan块构成，于是$AX = XB$的解形如$X = \mathrm{diag}\{X_{11}, X_{22}, \cdots, X_{s_0s_0}, 0, \cdots, 0\}$且
\begin{align*}
r(X) = \sum_{i = 1}^{s_0}r(X_{ii}).
\end{align*}
更精细的，每个$X_{ii}$至多可以提供$T_i, J_i$中较小的阶数的秩，这个数字也恰好是属于$T_i, J_i$的特征值的公共个数. 这就证明了$AX = XB$在$X\in\mathbb{C}^{n\times m}$中有秩$r$的解的充分必要条件是$A,B$至少有$r$个相同特征值(计重数). 
\end{proof}

\begin{corollary}\label{corollary:AX-XB相关命题3}
计算与数域上$n$阶矩阵$A$可交换的全体矩阵空间构成的维数. 
\end{corollary}
\begin{note}
$C(A)\triangleq\{X: AX = XA\}$本质上是一个线性方程组的解，因此不随域扩张而改变，所以不妨只在复数域上考虑.
\end{note}
\begin{proof}
不妨只在复数域上考虑.设$s_0$是$A$不同特征值个数，$A = \mathrm{diag}\{J_1, J_2, \cdots, J_{s_0}\}$,其中$J_i$是$n_{i,1},n_{i,2},\cdots,n_{i,m_i}$阶相同特征值对应Jordan块组成的分块对角矩阵.
于是由\refthe{theorem:AX-XB相关命题3}，可得
\begin{align*}
\dim C(A) = \sum_{i = 1}^{s_0}\sum_{r = 1}^{m_i}\sum_{\ell = 1}^{m_i}\min\{n_{i,r}, n_{i,\ell}\}.
\end{align*}
\end{proof}

\begin{proposition}\label{proposition:矩阵多项式空间的维数等于极小多项式的次数}
设数域上$n$阶矩阵$A$且$F(A)$是$A$的多项式空间，则$F(A)\subset C(A)\triangleq\{X: AX = XA\}$且$\dim F(A)=\deg m_A$，这里$m_A$是$A$的极小多项式.
\end{proposition}
\begin{proof}
显然有$F(A)\subset C(A)$.
设\(\deg m_A = r\)，\(\sum_{i = 0}^{r - 1} c_i A^i = O\)，则\(\sum_{i = 0}^{r - 1} c_i x^i\)就是\(A\)的零化多项式。由\hyperref[proposition:极小多项式的性质]{极小多项式的性质(1)}可知\(m_A(x) \mid \sum_{i = 0}^{r - 1} c_i x^i\)，  
而\(\deg m_A = r > r - 1 = \deg \sum_{i = 0}^{r - 1} c_i A^i\)，故\(\sum_{i = 0}^{r - 1} c_i x^i = O\)，即\(c_i = 0\)。因此\(I_n, A, \cdots, A^{r - 1}\)线性无关，故  
\[
\dim F(A) = \dim L(I_n, A, \cdots, A^{r - 1}) = r.
\]
\end{proof}

\begin{theorem}[F(A)=C(A)的充要条件和不变子空间刻画]\label{theorem:F(A)=C(A)的充要条件和不变子空间刻画}
设数域$\mathbb{K}$上$n$阶矩阵$A$,记$C\left( A \right) \triangleq \left\{ X:AX=XA \right\},\,\,
F\left( A \right) \triangleq \left\{ f\left( A \right) :f\in \mathbb{K} \left[ x \right] \right\} ,$则有下述等价刻画:
\begin{enumerate}[(1)]
\item 存在$n$维向量$v$使得$v,Av,\cdots,A^{n-1}v$是线性无关的;

\item $A$相似于一个友矩阵;

\item  $F(A)=C(A)$;

\item  $\dim F(A)=\dim C(A)$;

\item $\sum\limits_{i=1}^{s_0}\max\{n_{i,1},n_{i,2},\cdots,n_{i,m_i}\}=\sum\limits_{i=1}^{s_0}\sum\limits_{r=1}^{m_i}\sum\limits_{\ell=1}^{m_i}\min\{n_{i,r},n_{i,\ell}\}$;

\item $m_i=1,i=1,2,\cdots,s$;

\item 每种复特征值的几何重数都是$1$;

\item 对每个特征值$\lambda\in\mathbb{C}$,都有$r(\lambda E-A)=n-1$;

\item 特征多项式$=$极小多项式;

\item $A$的不变子空间个数有限.

并当$A$的不变子空间个数有限时,计算$A$的所有不变子空间.
\end{enumerate}
\end{theorem}
\begin{proof}
由课本定理、\refpro{proposition:极小多项式对应Jordan标准型的最大块}、\refthe{theorem:AX-XB相关命题3}、\refcor{corollary:AX-XB相关命题3}知除第一个,第二个和最后一个等价外,其余都是显然的.
\begin{enumerate}[(1)]
\item 我们来证明第1个和第2个等价.直接在基$v,Av,\cdots,A^{n-1}v$下计算$A$的表示矩阵并利用$A^n=c_0I_n+c_1A+\cdots+c_{n-1}A^{n-1}$得$A$相似于一个友矩阵.反过来若$A$相似于一个友矩阵,不失一般性,假设
$$A=\begin{pmatrix}0&\cdots&0&c_0\\1&\cdots&0&c_1\\\vdots&\ddots&\vdots&\vdots\\0&\cdots&1&c_{n-1}\end{pmatrix},v=\begin{pmatrix}1\\0\\\vdots\\0\end{pmatrix}.$$
我们直接演算有
$$Av=\begin{pmatrix}0\\1\\0\\\vdots\\0\end{pmatrix},A^2v=\begin{pmatrix}0\\0\\1\\\vdots\\0\end{pmatrix},\cdots,A^{n-1}v=\begin{pmatrix}0\\0\\0\\\vdots\\1\end{pmatrix},$$
即$v,Av,\cdots,A^{n-1}v$是线性无关的,我们完成了证明.

\item 我们来证明第2个和第9个等价.友矩阵的特征多项式和极小多项式相等,所以第2条推第9条成立.反过来若第9条成立,即$A$特征多项式和极小多项式相等,设为$f$.于是$A$的不变因子为$\underbrace{1,1,\cdots,1}_{n-1个},f$.而$f$的友矩阵的不变因子也为$\underbrace{1,1,\cdots,1}_{n-1个},f$.因此我们有第2条成立,我们完成了证明.

\item 我们来证明最后一个和上面每一条等价并完整刻画$A$的不变子空间.

$\mathbf{Step}\mathbf{1}$ 我们先做一些讨论,使得不变子空间问题归结到$f$特征多项式是个不可约多项式的次方.
设$A$是数域$\mathbb{F}$上线性空间$V$的线性变换,其特征多项式有标准分解
$$f(\lambda)=p_1^{r_1}(\lambda)p_2^{r_2}(\lambda)\cdots p_s^{r_s}(\lambda),$$
这里$r_i\in\mathbb{N},p_i(\lambda),i=1,2,\cdots,s$两两互素且不可约.
由\refthe{theorem:线性变换互素分解对应核子空间直和分解},我们知道有直和分解
\begin{align}
V=\ker f(A)=\bigoplus_{i=1}^s\ker p_i^{r_i}(A)\label{23.18}.
\end{align}
任取$A$的不变子空间$U$.下证明
\begin{align}
U=\bigoplus_{i=1}^s\left(U\bigcap\ker p_i^{r_i}(A)\right)\label{23.19}.
\end{align}
直和由零的分解唯一易证.对$x\in U$,利用分解\eqref{23.18},我们设
$$x=\sum_{i=1}^su_i,u_i\in\ker p_i^{r_i}(A),i=1,2,\cdots,s.$$
只需证明$u_i\in U,i\in\{1,2,\cdots,s\}$.证明的想法通过\hyperref[theorem:中国剩余定理(多项式版)]{中国剩余定理}使得$u_i$暴露出来并让其余$u_j,j\neq i$变成$0$.
由\hyperref[theorem:中国剩余定理(多项式版)]{中国剩余定理},取多项式$g_i\in\mathbb{F}[\lambda]$使得
$$\begin{cases}g_i\equiv0\pmod{p_j^{r_j}},\ j\neq i\\g_i\equiv1\pmod{p_i^{r_i}},\ j=i\end{cases},$$
则
$$g_i(A)x=\sum_{j=1}^sg_i(A)u_j=u_i\in U,i=1,2,\cdots,s,$$
这就证明了\eqref{23.19}.
注意到$U\bigcap\ker p_i^{r_i}(A)$是$A|_{\ker p_i^{r_i}(A)}$的不变子空间且$A|_{\ker p_i^{r_i}(A)}$的特征多项式是$p_i^{r_i}(\lambda)$,这里前者是显然的,后者注意到写成矩阵有
$$A=\operatorname{diag}\{A|_{\ker p_1^{r_1}(A)},A|_{\ker p_2^{r_2}(A)},\cdots,A|_{\ker p_s^{r_s}(A)}\}.$$
若特征多项式不是$p_i^{r_i}(\lambda)$,则这些特征多项式的乘积就是$A$的特征多项式不为$f(\lambda)$矛盾!因此得到我们需要的.
现在任取$A|_{\ker p_i^{r_i}(A)}$不变子空间$W_i,i=1,2,\cdots,s$,容易验证$\bigoplus_{i=1}^sW_i$是$A$不变子空间,因此我们的$\mathbf{Step}\mathbf{1}$的目标完成.

$\mathbf{Step}\mathbf{2}$ 设$A$是数域$\mathbb{F}$上线性空间$V$的线性变换,其特征多项式极小多项式都为$f(\lambda)=p^r(\lambda)$,这里$p$不可约且$r\in\mathbb{N},\deg p=d>0$.我们将完整计算出$A$不变子空间.
我们断言
\begin{align}
\dim\ker p^s(A)=ds,0\leq s\leq r\label{23.20}.
\end{align}
一方面由维数公式,我们有
$$\dim\ker p^s(A)=\dim V-r(p^s(A))=rd-r(p^s(A)).$$
另外一方面因为秩不随域扩张而改变,我们在复数域由这个\nrefthe{theorem:F(A)=C(A)的充要条件和不变子空间刻画}{(7)(9)}知$A$的所有特征值几何重数都是1,可设
$$A\sim\operatorname{diag}\{J_r(\lambda_1),J_r(\lambda_2),\cdots,J_r(\lambda_d)\},\lambda_i\text{两两互不相同},i=1,2,\cdots,d.$$
由
\begin{align*}
r(p^s(A))&=r\left(\operatorname{diag}\{p^s(J_r(\lambda_1)),p^s(J_r(\lambda_2)),\cdots,p^s(J_r(\lambda_d))\}\right)\\
&=\sum_{i=1}^dr(p^s(J_r(\lambda_i)))=\sum_{i=1}^d{r\left[ \left( J_r\left( \lambda _i \right) -\lambda _1E \right) ^s\left( J_r\left( \lambda _i \right) -\lambda _2E \right) ^s\cdots \left( J_r\left( \lambda _i \right) -\lambda _dE \right) ^s \right]}
\\
&\xlongequal{i\ne j\text{时}\left( J_r\left( \lambda _i \right) -\lambda _jE \right) ^s\text{可逆}}\sum_{i=1}^dr\left((J_r(\lambda_i)-\lambda_iE)^s\right)=\sum_{i=1}^d(r-s)=d(r-s),
\end{align*}
我们知\eqref{23.20}成立.
自然的, 期望$A$不变子空间一定形如$U=\ker p^s(A),0\leq s\leq r$.事实上任取$A$不变子空间$U$. 注意到$A|_U$特征多项式必然是$p^s(\lambda),0\leq s\leq r$. 因为$p^s(A|_U)=0$, 所以$U\subset\ker p^s(A)$. 由\eqref{23.20}的维数等式知$U=\ker p^s(A)$. 这就完整刻画清楚了$A$不变子空间.

$\mathbf{Step}\mathbf{3}$下证$A$的极小多项式不等于特征多项式,不变子空间有无穷多个.

由$\mathbf{Step}\mathbf{1}$,不妨设$A$特征多项式$f(\lambda)=p^r(\lambda)$,这里$p$不可约且$r\in\mathbb{N},\deg p=d>0$.再假设$f$极小多项式为$p^s(\lambda),1\leq s<r$.任取向量$a\neq0$并考虑$a$生成的最小$A$不变子空间(见\refthe{theorem:循环子空间的基本性质}和\refthe{theorem:循环子空间的基})$V_a=\operatorname{span}\{a,Aa,A^2a,\cdots,A^{ds-1}a\}$.
因为$s<r$,所以必有$\dim V_a<\dim V=rd$, 因此可以取向量$a_2\notin V_a$,继续考虑$a_2$生成的最小$A$不变子空间$V_{a_2}$. 由\hyperref[theorem:覆盖定理]{覆盖定理},非平凡真子空间的并不可能为全空间,即$V\neq V_a\bigcup V_{a_2}$,于是又可取$a_3\in V\setminus(V_a\bigcup V_{a_2})$.因此这样下去就得到无穷多个不变子空间.
\end{enumerate}
\end{proof}

\begin{example}
证明: 存在 \( A \in \mathbb{R}^{n \times n} \) 满足 \( A^2 + 2A + 5I_n = 0 \) 的充要条件是 \( n \) 为偶数. 当 \( n \geqslant 4 \), 验证满足上面矩阵 \( A \) 有无限个不变子空间.
\end{example}
\begin{proof}
由条件知$x^2+2x+5$是$A$的零化多项式，故$A$的极小多项式整除$x^2+2x+5$。又注意到$x^2+2x+5$在$\mathbb{R}$上不可约，故$x^2+2x+5$是$A$的极小多项式。
从而$A$的不变因子组可设为
\begin{align*}
1,\cdots ,1,x^2+2x+5,\cdots ,x^2+2x+5.
\end{align*}
于是由\hyperref[theorem:有理标准型核心定理]{有理标准型}知
\begin{align*}
A\sim \begin{pmatrix}
A_1&		&		&		\\
&		A_2&		&		\\
&		&		\ddots&		\\
&		&		&		A_s\\
\end{pmatrix},
\end{align*}
其中$A_1,A_2,\cdots ,A_s$都是二阶友矩阵，故$n$为偶数。显然，当$n\geqslant 4$，$A$的极小多项式一定不等于特征多项式。故由\nrefthe{theorem:F(A)=C(A)的充要条件和不变子空间刻画}{(10)}知$A$有无限个不变子空间。
\end{proof}

\begin{example}
设\( V \)是复数域上的\( n \)维线性空间，\( A \)是\( V \)上的一个线性变换，证明存在\( \alpha \in V \)，使得\( \{ \alpha, A\alpha, \cdots, A^{n-1}\alpha \} \)为\( V \)一组基当且仅当对\( A \)的任一特征值\( \lambda \)，\( \lambda \)的几何重数是1.
\end{example}
\begin{proof}
由\refthe{theorem:F(A)=C(A)的充要条件和不变子空间刻画}即得.
\end{proof}

\begin{example}
假设\( T \)是数域上的线性空间\( V \)上的线性变换且存在\( v \in V \)使得\( v,Tv,\cdots,T^{n-1}v \)是\( V \)的一组基，\( T \)的极小多项式为\( m(\lambda)=\prod_{i=1}^{s}(\lambda-\lambda_i)^{v_i} \)，这里\( \{\lambda_i\} \)互不相同，证明：该数域上的多项式\( p \)满足存在\( u \in V \)使得\( u,p(T)u,\cdots,p^{n-1}(T)u \)也是\( V \)的一组基当且仅当\( \lambda_i \neq \lambda_j \)时\( p(\lambda_i) \neq p(\lambda_j) \)且\( v_i > 1 \)时\( p'(\lambda_i) \neq 0 \).
\end{example}
\begin{proof}
$\mathbf{Step}\mathbf{1}$由\hyperref[proposition:Jordan块的性质]{Jordan块的性质(5)},我们知道
\[
p\left(J_m(\mu)\right)=\begin{pmatrix}
p(\mu)& p'(\mu)& \cdots& \frac{p^{(m-1)}(\mu)}{(m-1)!}\\
& p(\mu)& \ddots& \vdots\\
& & \ddots& p'(\mu)\\
& & & p(\mu)
\end{pmatrix}.
\]
即当且仅当$p'(\mu)\neq 0$时成立
\[
r\left( p\left( J_m(\mu ) \right) \right) =r\left( J_m(p(\mu )) \right) =n\text{或}n-1\Longrightarrow 
p\left(J_m(\mu)\right)\sim J_m(p(\mu)).
\]
所以条件$\lambda_i\neq \lambda_j$时$p(\lambda_i)\neq p(\lambda_j)$且$v_i>1$时$p'(\lambda_i)\neq 0$的充要条件是若$T$有Jordan标准型
\[
\text{diag}\{J_{m_1}(\mu_1),J_{m_2}(\mu_2),\cdots,J_{m_t}(\mu_t)\},
\]
则$p(T)$有Jordan标准型
\[
\text{diag}\{J_{m_1}(p(\mu_1)),J_{m_2}(p(\mu_2)),\cdots,J_{m_t}(p(\mu_t))\}.
\]

$\mathbf{Step}\mathbf{2}$注意到$T$在基$v,Tv,\cdots,T^{n-1}v$下的矩阵是一个友矩阵,所以特征多项式和极小多项式相等,所以每种特征值只有1个Jordan块.由\refthe{theorem:F(A)=C(A)的充要条件和不变子空间刻画}知存在$u\in V$使得$u,p(T)u,\cdots,p^{n-1}(T)u$也是$V$的一组基当且仅当$p(T)$每种特征值只有1个Jordan块.由\textbf{Step 1}知这当且仅当$\lambda_i\neq \lambda_j$时$p(\lambda_i)\neq p(\lambda_j)$且$v_i>1$时$p'(\lambda_i)\neq 0$.
\end{proof}









\subsection{应用 Jordan 标准型的三段论法}
 
如果矩阵问题的条件和结论在相似关系下不改变，则可以先证明结论对 Jordan 块成立，再证明对 Jordan 标准型成立，最后证明对一般的矩阵也成立，这就是所谓的 “三段论法”。事实上，我们已经利用三段论法证明过\refexa{example:特征值全为1矩阵的任意幂次于原矩阵相似}和\refexa{example:特征值全为正负1的矩阵的逆与其自身相似}，下面再来看一些典型的例题。

首先，我们来看计算矩阵乘幂的问题。
设 $A$ 为 $n$ 阶矩阵，$P$ 为 $n$ 阶可逆矩阵，使得 
\[
P^{-1}AP = J = \mathrm{diag}\{J_{r_1}(\lambda_1), J_{r_2}(\lambda_2), \cdots, J_{r_k}(\lambda_k)\}
\] 
为 Jordan 标准型。注意任一 Jordan 块 $J_{r_i}(\lambda_i)$ 都有分解 $J_{r_i}(\lambda_i) = \lambda_i I_{r_i} + N$，其中 $N = J_{r_i}(0)$ 是特征值为零的 $r_i$ 阶 Jordan 块，故对任意的正整数 $m$，
\begin{align*}
J_{r_i}(\lambda_i)^m = (\lambda_i I_{r_i} + N)^m = \lambda_i^m I_{r_i} + \mathrm{C}_m^1 \lambda_i^{m - 1} N + \cdots + \mathrm{C}_m^{m - 1} \lambda_i N^{m - 1} + N^m.
\end{align*}
于是 $J^m = \mathrm{diag}\{J_{r_1}(\lambda_1)^m, J_{r_2}(\lambda_2)^m, \cdots, J_{r_k}(\lambda_k)^m\}$，从而 $A^m = (PJP^{-1})^m = PJ^mP^{-1}$ 便可计算出来了。 

\begin{example}
设 $A = \begin{pmatrix}
2 & 6 & -15 \\
1 & 1 & -5 \\
1 & 2 & -6
\end{pmatrix}$，求 $A^m (m \geqslant  1)$。
\end{example}
\begin{remark}
本题是\refexa{example:2235890789}的延拓.
\end{remark}
\begin{solution}
由\refexa{example:2235890789},我们已经计算出过渡矩阵 $P$，使得 $P^{-1}AP = J = \mathrm{diag}\{-1, J_2(-1)\}$，于是可进一步计算出
\begin{align*}
A^m = PJ^mP^{-1} &= \begin{pmatrix}
-2 & 3 & 1 \\
1 & 1 & 0 \\
0 & 1 & 0
\end{pmatrix}
\begin{pmatrix}
(-1)^m & 0 & 0 \\
0 & (-1)^m & (-1)^{m - 1}m \\
0 & 0 & (-1)^m
\end{pmatrix}
\begin{pmatrix}
0 & 1 & -1 \\
0 & 0 & 1 \\
1 & 2 & -5
\end{pmatrix}\\
&= (-1)^{m - 1}
\begin{pmatrix}
3m - 1 & 6m & -15m \\
m & 2m - 1 & -5m \\
m & 2m & -5m - 1
\end{pmatrix}. 
\end{align*}
\end{solution}

\begin{example}
求矩阵 $B$，使得 $A = B^2$，其中 $A = \begin{pmatrix}
3 & 1 \\
-1 & 5
\end{pmatrix}$。
\end{example}
\begin{solution}
利用\hyperref[section:过渡矩阵的求法]{过渡矩阵的求法}的方法，可求出过渡矩阵 $P = \begin{pmatrix}
1 & 0 \\
1 & 1
\end{pmatrix}$，使得 $P^{-1}AP = J = \begin{pmatrix}
4 & 1 \\
0 & 4
\end{pmatrix}$ 为 Jordan 标准型。用待定元素法不难求得 $C = \pm\begin{pmatrix}
2 & \frac{1}{4} \\
0 & 2
\end{pmatrix}$，使得 $C^2 = J$。

注意到 $(PCP^{-1})^2 = PC^2P^{-1} = PJP^{-1} = A$，故可取 $B = PCP^{-1}$。经计算可得
\[B = \pm\begin{pmatrix}
\frac{7}{4} & \frac{1}{4} \\
-\frac{1}{4} & \frac{9}{4}
\end{pmatrix}. \]
\end{solution}

\begin{definition}[非异阵的$k$次方根]
设$A$为$n$阶非异复矩阵，称$B$为$A$的\textbf{$\boldsymbol{k}$次方根}，若$B$满足$A=B^k$，其中$k\in \mathbb{N} _1$。
\end{definition}

\begin{theorem}[非异阵存在任意次的方根]\label{theorem:非奇异阵有任意方根}
设 $A$ 为 $n$ 阶非异复矩阵，证明：对任一正整数 $m$，存在 $n$ 阶复矩阵 $B$，使得 $A = B^m$。
\end{theorem}
\begin{remark}
\refthe{theorem:非奇异阵有任意方根}的结论对奇异矩阵一般并不成立。例如，设 $A = J_n(0)^{m - 1}$，其中 $n = mq - r$, $m \geqslant  2$ 且 $0 \leqslant  r < m$，则不存在 $B$，使得 $A = B^m$。我们用反证法来证明这个结论。若存在满足条件的 $B$，则 $B$ 的特征值全为零，从而 $B$ 也是幂零矩阵，即有 $B^n = O$。于是 $O = B^{n + r} = (B^m)^q = A^q = J_n(0)^{(m - 1)q} \neq O$，这就导出了矛盾.
\end{remark}
\begin{proof}
设 $P$ 为非异阵，使得 $P^{-1}AP = J = \mathrm{diag}\{J_{r_1}(\lambda_1), J_{r_2}(\lambda_2), \cdots, J_{r_k}(\lambda_k)\}$ 为 $A$ 的 Jordan 标准型。由于 $A$ 非异，故 $A$ 的所有特征值都非零。对 $A$ 的任一 Jordan 块 $J_{r_i}(\lambda_i)$，取定 $\lambda_i$ 的某个 $m$ 次方根 $\mu_i$，即 $\mu_i^m = \lambda_i$，则由\refpro{proposition:Jordan块的m次方的Jordan标准型}可知，$J_{r_i}(\mu_i)^m$ 相似于 $J_{r_i}(\lambda_i)$，即存在非异阵 $Q_i$，使得 $J_{r_i}(\lambda_i) = Q_i^{-1}J_{r_i}(\mu_i)^mQ_i = (Q_i^{-1}J_{r_i}(\mu_i)Q_i)^m$，即结论对 Jordan 块成立。令
\[C = \mathrm{diag}\{Q_1^{-1}J_{r_1}(\mu_1)Q_1, Q_2^{-1}J_{r_2}(\mu_2)Q_2, \cdots, Q_k^{-1}J_{r_k}(\mu_k)Q_k\},\]
则 $J = C^m$，即结论对 Jordan 标准型也成立。最后，
\[A = PJP^{-1} = PC^mP^{-1} = (PCP^{-1})^m.\]
令 $B = PCP^{-1}$，则有 $A = B^m$，即结论对一般的矩阵也成立。
\end{proof}

\begin{example}
设 \( n \) 阶复方阵 \( A \) 的特征多项式为 \( f(\lambda) \)，若复系数多项式 \( g(\lambda) \) 满足
\[
\gcd\bigl(f(g(\lambda)), g'(\lambda)\bigr) = 1.
\]
求证: 存在 \( n \) 阶复方阵 \( B \) 使得 \( g(B) = A \).
\end{example}
\begin{note}
本题是\refthe{theorem:非奇异阵有任意方根}的推广.
\end{note}
\begin{proof}
设 \( P \) 为非异阵，使得 \( P^{-1}AP = J = \mathrm{diag}\{J_{r_1}(\lambda_1), \cdots, J_{r_k}(\lambda_k)\} \) 为 Jordan 标准型，我们先对 Jordan 块来证明结论. 任取多项式方程 \( g(\lambda) - \lambda_i = 0 \) 的根 \( \mu_i \)，即 \( g(\mu_i) = \lambda_i \)，从而 \( f(g(\mu_i)) = f(\lambda_i) = 0 \). 由 \( f(g(\lambda)) \) 与 \( g'(\lambda) \) 互素可知它们无公共根，从而 \( g'(\mu_i) \neq 0 \). 由\nrefpro{proposition:Jordan块的性质}{(5)}知
\[
g(J_{r_i}(\mu_i)) = \begin{pmatrix} 
g(\mu_i) & g'(\mu_i) & \cdots & * \\
& g(\mu_i) & \ddots & \vdots \\
& & \ddots & g'(\mu_i) \\
& & & g(\mu_i)
\end{pmatrix},
\]
于是 \( g(J_{r_i}(\mu_i)) \) 的特征值全为 \( g(\mu_i)=\lambda_i \)，其几何重数等于 \( r_i - r(g(J_{r_i}(\mu_i)) - \lambda_i I) = r_i - (r_i - 1) = 1 \). 因此 \( g(J_{r_i}(\mu_i)) \) 的 Jordan 标准型中只有一个 Jordan 块，即 \( g(J_{r_i}(\mu_i)) \) 相似于 \( J_{r_i}(\lambda_i) \). 设 \( Q_i \) 为非异阵，使得 
\begin{align*}
J_{r_i}(\lambda_i) = Q_i g(J_{r_i}(\mu_i)) Q_i^{-1} = g(Q_i J_{r_i}(\mu_i) Q_i^{-1}),
\end{align*}
故结论对 Jordan 块成立. 令 \( Q = \mathrm{diag}\{Q_1, \cdots, Q_k\} \)，\( C = \mathrm{diag}\{J_{r_1}(\mu_1), \cdots, J_{r_k}(\mu_k)\} \)，则
\begin{align*}
J = \mathrm{diag}\{J_{r_1}(\lambda_1), \cdots, J_{r_k}(\lambda_k)\} = Q g(C) Q^{-1} = g(Q C Q^{-1}),
\end{align*}
故结论对 Jordan 标准型也成立. 最后我们有 \( A = P J P^{-1} = P g(Q C Q^{-1}) P^{-1} = g(P Q C Q^{-1} P^{-1}) \)，令 \( B = P Q C Q^{-1} P^{-1} \)，则 \( A = g(B) \)，故结论对一般矩阵也成立. 
\end{proof}

\begin{lemma}\label{lemma:使得Jordan转置的矩阵}
(1)记$H=\begin{pmatrix}
& & & & 1 \\
& & & \begin{turn}{80}$\ddots$\end{turn} & \\
& & \begin{turn}{80}$\ddots$\end{turn} & & \\
& 1 & & & \\
1 & & & &
\end{pmatrix}$,则$H=H^{T}=H^{-1},\quad HJ_n(a)H=J_n^{T}(a)$.

(2)\begin{align*}
J_n(a)&=\begin{pmatrix}
a & 1 & & \\
& a & 1 & \\
& & \ddots & \ddots \\
& & & \ddots & 1 \\
& & & & a
\end{pmatrix}
=
\left( \begin{matrix}
&		&		&		1&		a\\
&		&		\begin{turn}{80}$\ddots$\end{turn}&		a&		\\
&		1&		\begin{turn}{80}$\ddots$\end{turn}&		&		\\
1&		a&		&		&		\\
a&		&		&		&		\\
\end{matrix} \right) 
\begin{pmatrix}
& & & & 1 \\
& & & \begin{turn}{80}$\ddots$\end{turn} & \\
& & \begin{turn}{80}$\ddots$\end{turn} & & \\
& 1 & & & \\
1 & & & &
\end{pmatrix}
\\
&=
\begin{pmatrix}
& & & & 1 \\
& & & \begin{turn}{80}$\ddots$\end{turn} & \\
& & \begin{turn}{80}$\ddots$\end{turn} & & \\
& 1 & & & \\
1 & & & &
\end{pmatrix}
\begin{pmatrix}
& & & & a \\
& & & a & 1 \\
& & \begin{turn}{80}$\ddots$\end{turn} & \begin{turn}{80}$\ddots$\end{turn} & \\
& a & 1 & & \\
a & 1 & & &
\end{pmatrix}
\end{align*}
\end{lemma}
\begin{proof}
证明都是显然的.
\end{proof}

\begin{proposition}\label{proposition:复矩阵的对称可逆分解}
设 $A$ 为 $n$ 阶复矩阵，证明：存在 $n$ 阶复对称矩阵 $B$, $C$，使得 $A = BC$，并且可以指定 $B$, $C$ 中任何一个为可逆矩阵。
\end{proposition}
\begin{proof}
设 $P$ 为非异阵，使得 $P^{-1}AP = J = \mathrm{diag}\{J_{r_1}(\lambda_1),J_{r_2}(\lambda_2),\cdots,J_{r_k}(\lambda_k)\}$ 为 $A$ 的 Jordan 标准型。考虑 Jordan 块 $J_{r_i}(\lambda_i)$ 的如下两种分解(列倒排和行倒排)：
\begin{align}
&\begin{pmatrix}
\lambda_i & 1 & & \\
& \lambda_i & 1 & \\
& & \ddots & \ddots \\
& & & \ddots & 1 \\
& & & & \lambda_i
\end{pmatrix}
=
\left( \begin{matrix}
&		&		&		1&		\lambda _i\\
&		&		\begin{turn}{80}$\ddots$\end{turn}&		\lambda _i&		\\
&		1&		\begin{turn}{80}$\ddots$\end{turn}&		&		\\
1&		\lambda _i&		&		&		\\
\lambda _i&		&		&		&		\\
\end{matrix} \right) 
\begin{pmatrix}
& & & & 1 \\
& & & \begin{turn}{80}$\ddots$\end{turn} & \\
& & \begin{turn}{80}$\ddots$\end{turn} & & \\
& 1 & & & \\
1 & & & &
\end{pmatrix}
\label{eq:7.13326574}
\\
&=
\begin{pmatrix}
& & & & 1 \\
& & & \begin{turn}{80}$\ddots$\end{turn} & \\
& & \begin{turn}{80}$\ddots$\end{turn} & & \\
& 1 & & & \\
1 & & & &
\end{pmatrix}
\begin{pmatrix}
& & & & \lambda_i \\
& & & \lambda_i & 1 \\
& & \begin{turn}{80}$\ddots$\end{turn} & \begin{turn}{80}$\ddots$\end{turn} & \\
& \lambda_i & 1 & & \\
\lambda_i & 1 & & &
\end{pmatrix}
\label{eq:7.142346356789}
\end{align}
我们将 \eqref{eq:7.13326574} 式的分解记为 $J_{r_i}(\lambda_i) = R_iS_i$，\eqref{eq:7.142346356789} 式的分解记为 $J_{r_i}(\lambda_i) = S_iT_i$，注意到 $R_i$, $S_i$, $T_i$ 都是对称矩阵，并且 $S_i$ 是可逆矩阵。如果一开始选定 $B$ 为可逆矩阵，则利用 \eqref{eq:7.142346356789} 式的分解；如果一开始选定 $C$ 为可逆矩阵，则利用 \eqref{eq:7.13326574} 式的分解。以下不妨设定 $B$ 为可逆矩阵，令
\[
S = \mathrm{diag}\{S_1,S_2,\cdots,S_k\}, \quad T = \mathrm{diag}\{T_1,T_2,\cdots,T_k\}
\]
则有 $J = ST$，其中 $S$, $T$ 都是对称矩阵，并且 $S$ 是可逆矩阵。因此，我们有
\[
A = PJP^{-1} = PSTP^{-1} = (PSP')((P^{-1})'TP^{-1})
\]
令 $B = PSP'$, $C = (P^{-1})'TP^{-1}$，则 $A = BC$ 即为所求分解。
\end{proof}

\begin{proposition}\label{proposition:复矩阵都合同相似于其转置矩阵}
设 $A$ 为 $n$ 阶复矩阵，证明：存在 $n$ 阶非异复对称矩阵 $Q$，使得 $Q^{-1}AQ = A'$。
\end{proposition}
\begin{proof}
设 $P$ 为非异阵，使得 $P^{-1}AP = J = \mathrm{diag}\{J_{r_1}(\lambda_1),J_{r_2}(\lambda_2),\cdots,J_{r_k}(\lambda_k)\}$ 为 $A$ 的 Jordan 标准型。记$r_i$阶矩阵
\begin{align*}
S_i=\begin{pmatrix}
& & & & 1 \\
& & & \begin{turn}{80}$\ddots$\end{turn} & \\
& & \begin{turn}{80}$\ddots$\end{turn} & & \\
& 1 & & & \\
1 & & & &
\end{pmatrix},
\end{align*}
注意到 $S_i$ 是非异对称矩阵，且 $S_i^2 = I$，即 $S_i^{-1} = S_i$，我们来考虑 Jordan 块 $J_{r_i}(\lambda_i)$ 的如下相似关系：
\begin{align*}
J_{r_i}(\lambda_i) &=
\begin{pmatrix}
& & & & 1 \\
& & & \begin{turn}{80}$\ddots$\end{turn} & \\
& & \begin{turn}{80}$\ddots$\end{turn} & & \\
& 1 & & & \\
1 & & & &
\end{pmatrix}
\left( \begin{matrix}
\lambda _i&		&		&		&		\\
1&		\lambda _i&		&		&		\\
&		1&		\ddots&		&		\\
&		&		\ddots&		\ddots&		\\
&		&		&		1&		\lambda _i\\
\end{matrix} \right) 
\begin{pmatrix}
& & & & 1 \\
& & & \begin{turn}{80}$\ddots$\end{turn} & \\
& & \begin{turn}{80}$\ddots$\end{turn} & & \\
& 1 & & & \\
1 & & & &
\end{pmatrix}
\end{align*}
即有 $J_{r_i}(\lambda_i) = S_iJ_{r_i}(\lambda_i)'S_i$。令 $S = \mathrm{diag}\{S_1,S_2,\cdots,S_k\}$，则 $S$ 是非异对称矩阵，$S^2 = I_n$，且 $J = SJ'S$。因此，我们有
\begin{align*}
A &= PJP^{-1} = PSJ'SP^{-1} = PSP'A'(P^{-1})'SP^{-1} = (PSP')A'(PSP')^{-1}
\end{align*}
令 $Q = PSP'$，则 $Q$ 为非异复对称矩阵，使得 $Q^{-1}AQ = A'$。
\end{proof}

\begin{proposition}\label{proposition:e^A与I_n+A相似}
设 $A$ 为 $n$ 阶幂零矩阵，证明：$\mathrm{e}^A$ 与 $I_n + A$ 相似。
\end{proposition}
\begin{proof}
{\color{blue}证法一:}由 $A$ 是幂零矩阵及\refpro{proposition:幂零矩阵关于特征值的充要条件}可知，$A$ 的特征值全为零。设 $P$ 为非异阵，使得 $P^{-1}AP$ $=$ $J$ $=$ $\mathrm{diag}$ $\{$ $J_{r_1}(0)$ , $J_{r_2}(0)$ ,$\cdots$,$J_{r_k}(0)$ $\}$ 为 $A$ 的 Jordan 标准型。先对 Jordan 块 $J_{r_i}(0)$ 进行证明。注意到
\begin{align*}
\mathrm{e}^{J_{r_i}(0)} &= I_{r_i}+\frac{1}{1!}J_{r_i}(0)+\frac{1}{2!}J_{r_i}(0)^2+\cdots+\frac{1}{(r_i - 1)!}J_{r_i}(0)^{r_i - 1}\\
&= 
\begin{pmatrix}
1 & 1 & \cdots & * \\
& 1 & \ddots & \vdots \\
& & \ddots & 1 \\
& & & 1
\end{pmatrix}
\end{align*}
故 $\mathrm{e}^{J_{r_i}(0)}$ 的特征值全为 $1$，其几何重数等于 $r_i - \mathrm{r}(\mathrm{e}^{J_{r_i}(0)}-I_{r_i}) = r_i - (r_i - 1) = 1$。因此 $\mathrm{e}^{J_{r_i}(0)}$ 只有一个 Jordan 块，其 Jordan 标准型为 $J_{r_i}(1) = I_{r_i}+J_{r_i}(0)$，即存在非异阵 $Q_i$，使得 $\mathrm{e}^{J_{r_i}(0)} = Q_i(I_{r_i}+J_{r_i}(0))Q_i^{-1}$ ($1\leqslant  i\leqslant  k$)。再对 Jordan 标准型 $J$ 进行证明。令 $Q = \mathrm{diag}\{Q_1,Q_2,\cdots,Q_k\}$，则 $Q$ 为非异阵，满足
\[
\mathrm{e}^J = \mathrm{diag}\{\mathrm{e}^{J_{r_1}(0)},\mathrm{e}^{J_{r_2}(0)},\cdots,\mathrm{e}^{J_{r_k}(0)}\} = Q(I_n + J)Q^{-1}
\]
最后对一般的矩阵 $A$ 进行证明。由前两步可得
\begin{align*}
\mathrm{e}^A &= \mathrm{e}^{PJP^{-1}} = P\mathrm{e}^JP^{-1} = PQ(I_n + J)Q^{-1}P^{-1}\\
&= PQ(I_n + P^{-1}AP)Q^{-1}P^{-1} = (PQP^{-1})(I_n + A)(PQP^{-1})^{-1}
\end{align*}
即 $\mathrm{e}^A$ 与 $I_n + A$ 相似。

{\color{blue}证法二:}
由 $A$ 是幂零矩阵及\refpro{proposition:幂零矩阵关于特征值的充要条件}可知，$A$ 的特征值全为零，从而 $I_n + A$ 和 $\mathrm{e}^A = I_n+A+\cdots+\frac{1}{(n - 1)!}A^{n - 1}$ 的特征值全为 $1$。容易验证 $\mathrm{r}((\mathrm{e}^A - I_n)^k) = \mathrm{r}(A^k)$ ($k\geqslant  1$) 成立，故由\refpro{proposition:矩阵相似的充要条件(关于秩的充要条件)}即得结论。
\end{proof}


\subsection{采用Jordan块作为测试矩阵}

在矩阵问题中，如果需要构造满足某种性质的矩阵，则可以采用 Jordan 块作为测试矩阵进行探索和讨论。比如在\refthe{theorem:非奇异阵有任意方根}的证明中，为了构造 Jordan 块 $J_{r_i}(\lambda_i)$ 的 $m$ 次方根，我们采用了 Jordan 块 $J_{r_i}(\mu_i)$ 作为测试矩阵，并最终得到了正确的答案。

\begin{example}
证明：存在 $71$ 阶实方阵 $A$，使得
\[
A^{70}+A^{69}+\cdots+A + I_{71}=
\begin{pmatrix}
2019 & 2018 & \cdots & 1949 \\
& 2019 & \ddots & \vdots \\
& & \ddots & 2018 \\
& & & 2019
\end{pmatrix}
\]
\end{example}
\begin{proof}
记 $f(x) = x^{70}+x^{69}+\cdots+x + 1$，上述等式右边的矩阵为 $B$。注意到 $f(1) < 2019$ 和 $f(2) > 2019$，故由连续函数的性质可知，$f(x)=2019$ 在开区间 $(1,2)$ 中必有一实根 $\lambda_0$。将 Jordan 块 $J_{71}(\lambda_0)$ 代入 $f(x)$ 中，由\nrefpro{proposition:Jordan块的性质}{(5)}计算可得
\[
f(J_{71}(\lambda_0))=
\begin{pmatrix}
f(\lambda_0) & f'(\lambda_0) & \cdots & * \\
& f(\lambda_0) & \ddots & \vdots \\
& & \ddots & f'(\lambda_0) \\
& & & f(\lambda_0)
\end{pmatrix}
\]
这是一个上三角矩阵，主对角元全为 $f(\lambda_0)=2019$，上次对角元全为 $f'(\lambda_0)>0$，从而 $f(J_{71}(\lambda_0))$ 的特征值全为 $2019$，其几何重数为 $71 - \mathrm{r}(f(J_{71}(\lambda_0)) - 2019I_{71}) = 1$。因此，$f(J_{71}(\lambda_0))$ 的 Jordan 标准型中只有一个 Jordan 块 $J_{71}(2019)$，即 $f(J_{71}(\lambda_0))$ 相似于 $J_{71}(2019)$。另一方面，矩阵 $B$ 也是一个上三角矩阵，主对角元全为 $2019$，上次对角元全为 $2018$，从而 $B$ 的特征值全为 $2019$，其几何重数为 $71 - \mathrm{r}(B - 2019I_{71}) = 1$。因此，$B$ 的 Jordan 标准型中只有一个 Jordan 块 $J_{71}(2019)$，即 $B$ 也相似于 $J_{71}(2019)$。由于\hyperref[corollary:矩阵的相似关系在基域扩张下不变]{矩阵的相似在基域扩张下不改变}，故 $f(J_{71}(\lambda_0))$ 和 $B$ 在实数域上相似，即存在非异实矩阵 $P$，使得 $B = P^{-1}f(J_{71}(\lambda_0))P = f(P^{-1}J_{71}(\lambda_0)P)$。令 $A = P^{-1}J_{71}(\lambda_0)P$，则 $A$ 是实矩阵，且满足 $f(A) = B$。
\end{proof}

\begin{example}
设 $a$, $b$ 都是实数，其中 $b\neq 0$，证明：对任意的正整数 $m$，存在四阶实方阵 $A$，使得
\[
A^m = B = 
\begin{pmatrix}
a & b & 2 & 0 \\
-b & a & 2 & 0 \\
0 & 0 & a & b \\
0 & 0 & -b & a
\end{pmatrix}
\]
\end{example}
\begin{remark}
这个例题采用了\hyperref[theorem:实数域上的广义Jordan标准型]{广义 Jordan 块}作为测试矩阵。
\end{remark}
\begin{proof}
显然，$B$ 的特征多项式 $f(\lambda) = ((\lambda - a)^2 + b^2)^2$。我们可用 $3$ 种方法求出 $B$ 的 Jordan 标准型(section:Jordan标准型的求法)。第一种方法是计算行列式因子：
\[
\lambda I_4 - B = 
\begin{pmatrix}
\lambda - a & -b & -2 & 0 \\
b & \lambda - a & -2 & 0 \\
0 & 0 & \lambda - a & -b \\
0 & 0 & b & \lambda - a
\end{pmatrix}
\]
经计算可知
\[
(\lambda I_4 - B)\begin{pmatrix}1&2&3\\1&2&4\end{pmatrix} = -b((\lambda - a)^2 + b^2), \quad (\lambda I_4 - B)\begin{pmatrix}1&2&3\\2&3&4\end{pmatrix} = -2b(\lambda - a + b)
\]
显然这两个三阶子式互素，故三阶行列式因子 $D_3(\lambda) = 1$，于是 $B$ 的行列式因子组和不变因子组均为 $1,1,1,((\lambda - a)^2 + b^2)^2$，从而初等因子组为 $(\lambda - a - bi)^2,(\lambda - a + bi)^2$，因此 $B$ 的 Jordan 标准型 $J = \mathrm{diag}\{J_2(a + bi),J_2(a - bi)\}$。

第二种方法是计算极小多项式：由于 $B$ 是实方阵，故其极小多项式 $m(\lambda)$ 是实系数多项式，又 $m(\lambda)$ 整除 $f(\lambda)$，从而只能是 $m(\lambda) = (\lambda - a)^2 + b^2$ 或 $m(\lambda) = ((\lambda - a)^2 + b^2)^2$。通过简单的计算可知 $B$ 不适合多项式 $(\lambda - a)^2 + b^2$，于是 $m(\lambda) = f(\lambda) = ((\lambda - a)^2 + b^2)^2$，剩余的讨论同第一种方法。

第三种方法是计算特征值的几何重数：$B$ 的全体特征值为 $a + bi$（$2$ 重），$a - bi$（$2$ 重），通过简单的计算可知 $\mathrm{r}(B - (a + bi)I_4) = 3$ 以及 $\mathrm{r}(B - (a - bi)I_4) = 3$，于是 $a\pm bi$ 的几何重数都等于 $1$，从而分别只有一个二阶 Jordan 块，因此 $B$ 的 Jordan 标准型 $J = \mathrm{diag}\{J_2(a + bi),J_2(a - bi)\}$。

取 $a + bi$ 的 $m$ 次方根 $c + di$ ($c,d\in\mathbb{R}$)，即满足 $(c + di)^m = a + bi$（取定一个即可）。构造实方阵（取法不唯一）：
\[
C = 
\begin{pmatrix}
c & d & 2 & 0 \\
-d & c & 2 & 0 \\
0 & 0 & c & d \\
0 & 0 & -d & c
\end{pmatrix}, \text{ 或 }
C = 
\begin{pmatrix}
c & d & 1 & 0 \\
-d & c & 0 & 1 \\
0 & 0 & c & d \\
0 & 0 & -d & c
\end{pmatrix}, \text{ 或 }
C = 
\begin{pmatrix}
c & d & 0 & 0 \\
-d & c & 1 & 0 \\
0 & 0 & c & d \\
0 & 0 & -d & c
\end{pmatrix}
\]
注意到 $d\neq 0$，故由开始处完全类似的讨论可知，$C$ 的 Jordan 标准型为 $\mathrm{diag}\{J_2(c + di),J_2(c - di)\}$。由\refpro{proposition:Jordan块的m次方的Jordan标准型}可知，$J_2(c\pm di)^m$ 的 Jordan 标准型为 $J_2(a\pm bi)$，从而 $C^m$ 的 Jordan 标准型为 $\mathrm{diag}\{J_2(a + bi),J_2(a - bi)\}$，于是 $B$ 与 $C^m$ 有相同的 Jordan 标准型，故它们在复数域上相似。注意到 $B$ 与 $C^m$ 都是实矩阵，故由\hyperref[corollary:矩阵的相似关系在基域扩张下不变]{矩阵的相似在基域扩张下不改变}可知，它们在实数域上也相似，即存在非异阵 $P\in M_4(\mathbb{R})$，使得 $B = P^{-1}C^mP = (P^{-1}CP)^m$。令 $A = P^{-1}CP$，则 $A$ 为实方阵，满足 $A^m = B$。
\end{proof}


































\end{document}
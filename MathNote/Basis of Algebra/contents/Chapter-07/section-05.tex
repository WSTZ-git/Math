\documentclass[../../main.tex]{subfiles}
\graphicspath{{\subfix{../../image/}}} % 指定图片目录,后续可以直接使用图片文件名。

% 例如:
% \begin{figure}[H]
% \centering
% \includegraphics[scale=0.4]{图.png}
% \caption{}
% \label{figure:图}
% \end{figure}
% 注意:上述\label{}一定要放在\caption{}之后,否则引用图片序号会只会显示??.

\begin{document}

\section{可对角化的判断(二)}

\subsection{极小多项式无重根}

\begin{proposition}\label{example:幂等和对合矩阵的Jordan标准型}
证明:

(1) 若$A^2 = A$,则$A$可对角化,并且$A$的Jordan标准型为$\mathrm{diag}\{1,\cdots,1,0\cdots,0\}$;

(2) 若$A^k = I_n$,则$A$可对角化,并且$A$的Jordan标准型为$\mathrm{diag}\{\omega_1,\omega_2,\cdots,\omega_n\}$，其中 $\omega_i^k = 1 (1\leqslant  i\leqslant  n)$.
\end{proposition}
\begin{proof}
(1) 矩阵 $A$ 适合 $g(x)=x^2 - x$ 且 $g(x)$ 无重根，故由\refpro{proposition:适合的多项式无重根则可对角化}可知 $A$ 可对角化，并且由\refpro{proposition:矩阵适合的多项式其特征值也适合}可知$A$ 的特征值也适合 $g(x)$，故只能是 $0,1$。因此，$A$ 的 Jordan 标准型为 $\mathrm{diag}\{1,\cdots,1,0\cdots,0\}$，其中有 $\mathrm{r}(A)$ 个 $1$。

(2) 矩阵 $A$ 适合 $g(x)=x^k - 1$ 且 $g(x)$ 无重根，故由\refpro{proposition:适合的多项式无重根则可对角化}可知 $A$ 可对角化，并且由\refpro{proposition:矩阵适合的多项式其特征值也适合}可知 $A$ 的特征值也适合 $g(x)$，故只能是 $1$ 的 $k$ 次方根。因此，$A$ 的 Jordan 标准型为 $\mathrm{diag}\{\omega_1,\omega_2,\cdots,\omega_n\}$，其中 $\omega_i^k = 1 (1\leqslant  i\leqslant  n)$。

\end{proof}

\begin{example}
设 $A$ 是有理数域上的 $n$ 阶矩阵，其特征多项式的所有不可约因式为 $\lambda^2 + \lambda + 1,\lambda^2 - 2$。又 $A$ 的极小多项式是四次多项式，求证：$A$ 在复数域上可对角化。
\end{example}
\begin{proof}
因为 $A$ 的极小多项式 $m(\lambda)$ 和特征多项式 $f(\lambda)$ 有相同的根（不计重数），且 $\deg m(\lambda)=4$，所以 $m(\lambda)=(\lambda^2 + \lambda + 1)(\lambda^2 - 2)$。注意到 $m(\lambda)$ 在复数域内无重根，故 $A$ 在复数域上可对角化.

\end{proof}

\begin{proposition}\label{proposition:可对角化的线性变换其限制变换和诱导变换也可对角化}
设 $\varphi$ 是复线性空间 $V$ 上的线性变换，$V_0$ 是 $\varphi$ 的不变子空间。求证：若 $\varphi$ 可对角化，则 $\varphi$ 在 $V_0$ 上的限制变换和 $\varphi$ 在 $V/V_0$ 上的诱导变换都可对角化。
\end{proposition}
\begin{proof}
{\color{blue}证法一:}由\refpro{proposition:没有公共的特征值的可对角化矩阵的分块也可对角化 逆命题}的几何版本可知，限制变换 $\varphi|_{V_0}$ 和诱导变换 $\overline{\varphi}$ 都有完全的特征向量系，从而可对角化。

{\color{blue}证法二:}设线性变换 $\varphi$、限制变换 $\varphi|_{V_0}$ 和诱导变换 $\overline{\varphi}$ 的极小多项式分别为 $m(\lambda),g(\lambda)$ 和 $h(\lambda)$，则由由\refpro{proposition:没有公共的特征值的可对角化矩阵的分块也可对角化 逆命题}容易验证$\varphi|_{V_0}$ 和 $\overline{\varphi}$ 的表示矩阵都适合多项式$m(x)$,于是$\varphi|_{V_0}$ 和 $\overline{\varphi}$ 都适合多项式 $m(\lambda)$，从而 $g(\lambda)\mid m(\lambda)$ 且 $h(\lambda)\mid m(\lambda)$。由于 $\varphi$ 可对角化，故 $m(\lambda)$ 无重根，从而 $g(\lambda),h(\lambda)$ 也无重根，于是 $\varphi|_{V_0}$ 和 $\overline{\varphi}$ 都可对角化。

\end{proof}

\begin{proposition}\label{proposition:线性变换可对角化的关于不变子空间的充要条件}
设 $\varphi$ 是 $n$ 维复线性空间 $V$ 上的线性变换，求证：$\varphi$ 可对角化的充要条件是对任一 $\varphi$-不变子空间 $U$，均存在 $\varphi$-不变子空间 $W$，使得 $V = U\oplus W$。这样的 $W$ 称为 $U$ 的 \textbf{$\varphi$-不变补空间}。
\end{proposition}
\begin{proof}
{\color{blue}证法一:}
{\heiti 先证充分性：}假设 $\varphi$ 不能对角化，则 $\varphi$ 只有 $m$ 个线性无关的特征向量，其中 $1\leqslant  m < n$。设由这些特征向量张成的子空间为 $U$，由条件可知，$U$ 存在非零的 $\varphi$-不变补空间 $W$。考虑限制变换 $\varphi|_W$，它在 $W$ 上必存在特征值和特征向量，这些也是 $\varphi$ 的特征值和特征向量，于是 $\varphi$ 有多于 $m$ 个线性无关的特征向量，矛盾！

{\heiti 再证必要性：}设 $\varphi$ 可对角化，$U$ 是 $\varphi$-不变子空间，则由\refpro{proposition:可对角化的线性变换其限制变换和诱导变换也可对角化}可知，$\varphi|_U$ 仍可对角化，故存在 $U$ 的一组基 $\alpha_1,\cdots,\alpha_r$，它们是 $\varphi|_U$，也是 $\varphi$ 的线性无关的特征向量。又因为 $\varphi$ 可对角化，故存在 $n$ 个线性无关的特征向量 $\{e_1,e_2,\cdots,e_n\}$，再由\hyperref[theorem:基扩张定理]{基扩张定理}可知，可从这组基中取出 $n - r$ 个向量和 $\alpha_1,\cdots,\alpha_r$ 一起组成 $V$ 的一组基。设这 $n - r$ 个向量张成的子空间为 $W$，则 $W$ 是 $U$ 的 $\varphi$-不变补空间。

{\color{blue}证法二:}
{\heiti 必要性:}
设线性变换$\varphi: V \rightarrow V$可对角化,则
\begin{align}
V = V_{\lambda_1} \oplus V_{\lambda_2} \oplus \cdots \oplus V_{\lambda_s}, \label{eq:23.106}
\end{align}
这里$V_{\lambda_i}, i = 1,2,\cdots,s$是互不相同的属于$\varphi$的特征值$\lambda_i$的特征子空间.

对$\varphi$的任一不变子空间$W \subset V$,我们断言
\begin{align}
W = (W \bigcap V_{\lambda_1}) \oplus (W \bigcap V_{\lambda_2}) \oplus \cdots \oplus (W \bigcap V_{\lambda_s}). \label{eq:23.107}
\end{align}
事实上,显然有上式右边是直和(零的分解唯一),并且
\begin{align}
W \supset (W \bigcap V_{\lambda_1}) \oplus (W \bigcap V_{\lambda_2}) \oplus \cdots \oplus (W \bigcap V_{\lambda_s}). \label{eq:-----1241-23.108}
\end{align}
对$x \in W$,由\eqref{eq:23.106}得$x_i \in V_{\lambda_i}, i = 1,2,\cdots,s$使得$x = \sum_{i=1}^s x_i$. 由\hyperref[theorem:中国剩余定理(多项式版)]{中国剩余定理},我们知道存在多项式$p_j \in \mathbb{C}[x]$使得
\begin{align}
p_j(x) \equiv \delta_{ij} \ (\text{mod} \ (x - \lambda_i)), i,j = 1,2,\cdots,n. \label{eq:-----1241-23.109}
\end{align}
这里$\delta_{ij}$是Kronecker符号.由\eqref{eq:-----1241-23.109}得
\begin{align*}
x_j=\sum_{i=1}^s{\delta _{ij}x_i}=\sum_{i=1}^s{\left[ k_j\left( \varphi \left( x_i \right) -\lambda _iI\left( x_i \right) \right) +\delta _{ij}I\left( x_i \right) \right]}=\sum_{i=1}^s{p_j(\varphi )x_i}=p_j(\varphi )x\in W,j=1,2,\cdots ,s.
\end{align*}
现在我们由$x_j \in W \bigcap V_{\lambda_j}, j = 1,2,\cdots,s$知
\begin{align}
W \subset (W \bigcap V_{\lambda_1}) \oplus (W \bigcap V_{\lambda_2}) \oplus \cdots \oplus (W \bigcap V_{\lambda_s}). \label{eq:-----1241-23.110}
\end{align}
结合\eqref{eq:-----1241-23.108}和\eqref{eq:-----1241-23.110}得\eqref{eq:23.107}.

对每一个$i = 1,2,\cdots,s$,取$W \bigcap V_{\lambda_i}$在$V_{\lambda_i}$的补空间$U_i$. 注意到$\varphi|_{V_{\lambda_i}}$是数量矩阵,于是$U_i$是$\varphi$不变子空间. 考虑
$$U \triangleq U_1 \oplus U_2 \oplus \cdots \oplus U_s.$$
显然$U$是$\varphi$不变子空间且$V = W \oplus U$.

{\heiti 充分性:}
若$\varphi$的任一不变子空间$W \subset V$,都有$\varphi$的不变补空间$U$,我们来对矩阵阶数归纳证明$\varphi$可对角化.

当$n = 1$,这没什么好证的,假设命题对$n - 1$成立,则对$n$时,首先设$V_\lambda$是$\varphi$的属于特征值$\lambda \in \mathbb{C}$的特征子空间,则若$V = V_\lambda$,已经有$\varphi$是数量矩阵.

若$V \neq V_\lambda$,则存在$\varphi$的不变补空间$U_\lambda$使得$V = V_\lambda \oplus U_\lambda$. 下证$U_\lambda$上的任何$\varphi$的不变子空间都有不变补空间.现在对任何$\varphi$的不变子空间$W \subset U_\lambda$,取$\varphi$的不变补空间$U_W$使得$V = W \oplus U_W$.

注意到$U_W \bigcap U_\lambda$是$\varphi$的不变子空间. 显然$W + U_W \bigcap U_\lambda$是直和(零的分解唯一),且$U_\lambda \supset W \oplus (U_W \bigcap U_\lambda). $

又注意到$\varphi|_{U_\lambda}$没有特征值$\lambda$,所以其极小多项式$m_1(x)$和$\varphi|_{V_\lambda}$极小多项式$m_2(x)$互素. 由\hyperref[theorem:中国剩余定理(多项式版)]{中国剩余定理}知,存在多项式$p_j\in \mathbb{C}[x]$,使得
\begin{align*}
p_j(x) \equiv \delta_{ij} \ (\text{mod} \ m_i(x)), i,j = 1,2, 
\end{align*}
其中$\delta_{ij}$是Kronecker符号.对$\forall x\in U_{\lambda},$由$V=W\oplus U_W$知,存在$x_1\in W,x_2\in U_W$,使得$x=x_1+x_2.$于是
\begin{align*}
x_j=\sum_{i=1}^s{\left[ k_jm_i\left( \varphi \right) \left( x_i \right) +\delta _{ij}I\left( x_i \right) \right]}=\sum_{i=1}^s{p_j(\varphi )x_i}=p_j(\varphi )x\in U_{\lambda},\,\,j=1,2.
\end{align*}
因此$U_{\lambda}\subset W \oplus (U_W \bigcap U_\lambda)$.故
\begin{align}
U_\lambda = W \oplus (U_W \bigcap U_\lambda). \label{eq:-----1241-23.111}
\end{align}
由\eqref{eq:-----1241-23.111}得$\varphi|_{U_\lambda}$满足归纳假设,因此$\varphi|_{U_\lambda}$可对角化,又$\varphi$在$V_{\lambda}$上可对角化,故$\varphi$在$V$上可对角化. 我们完成了证明.


\end{proof}

\begin{proposition}
设 $n$ 阶矩阵 $A$ 的极小多项式 $m(\lambda)$ 的次数为 $s$，$B = (b_{ij})$ 为 $s$ 阶矩阵，其中 $b_{ij}=\mathrm{tr}(A^{i + j - 2})$（约定 $b_{11}=n$），求证：$A$ 可对角化的充要条件是 $B$ 为可逆矩阵。
\end{proposition}
\begin{remark}
本题主要利用的方法是:设矩阵 $A$ 的全体不同特征值为 $\lambda_1,\lambda_2,\cdots,\lambda_k$，定义
\begin{align*}
g(\lambda)=(\lambda - \lambda_1)(\lambda - \lambda_2)\cdots(\lambda - \lambda_k)
\end{align*}
若 $A$ 可对角化，则 $A$ 的极小多项式就是 $g(\lambda)$（参考\hyperref[proposition:常见矩阵的极小多项式]{常见矩阵的极小多项式(2)}）。反之，若 $A$ 适合多项式 $g(\lambda)$，则由极小多项式的性质可知，$g(\lambda)$ 就是 $A$ 的极小多项式。特别地，由于 $g(\lambda)$ 无重根，故 $A$ 可对角化。
\end{remark}
\begin{proof}
设 $A$ 的全体不同特征值为 $\lambda_1,\lambda_2,\cdots,\lambda_k$，其代数重数分别为 $m_1,m_2,\cdots,m_k$，则由\refpro{proposition:矩阵多项式的特征值就是原特征值代入多项式得到的数}可知$A^i$的全体特征值为$\lambda^i_1,\lambda^i_2,\cdots,\lambda^i_k$,其代数重数分别为$m_1,m_2,\cdots,m_k$.从而$\mathrm{tr}(A^i)=m_1\lambda_1^i + m_2\lambda_2^i + \cdots + m_k\lambda_k^i$。定义 $g(\lambda)=(\lambda - \lambda_1)(\lambda - \lambda_2)\cdots(\lambda - \lambda_k)$，则 $g(\lambda)\mid m(\lambda)$，从而 $s\geqslant  k$。若 $A$ 可对角化，则 $m(\lambda)=g(\lambda)$，从而 $s = k$。若 $A$ 不可对角化，则 $m(\lambda)$ 有重根，从而 $s > k$。考虑矩阵 $B$ 的如下分解：
\begin{align*}
B=\begin{pmatrix}
m_1 & m_2 & \cdots & m_k \\
m_1\lambda_1 & m_2\lambda_2 & \cdots & m_k\lambda_k \\
\vdots & \vdots & & \vdots \\
m_1\lambda_1^{s - 1} & m_2\lambda_2^{s - 1} & \cdots & m_k\lambda_k^{s - 1}
\end{pmatrix}\begin{pmatrix}
1 & \lambda_1 & \cdots & \lambda_1^{s - 1} \\
1 & \lambda_2 & \cdots & \lambda_2^{s - 1} \\
\vdots & \vdots & & \vdots \\
1 & \lambda_k & \cdots & \lambda_k^{s - 1}
\end{pmatrix}
\end{align*}
其中上式右边第一个矩阵是 $s\times k$ 矩阵，第二个矩阵是 $k\times s$ 矩阵。

{\heiti 必要性:}若$A$可对角化,则由上述分析可知$s = k$，则由 Vandermonde 行列式可知
\begin{align*}
|B|=m_1m_2\cdots m_k\prod_{1\leqslant  i < j\leqslant  k}(\lambda_i - \lambda_j)^2\neq 0
\end{align*}
即 $B$ 是可逆矩阵。

{\heiti 充分性:}若$B$可逆,反证,设$A$不可对角化,则由上述分析可知$s > k$，则由 Cauchy - Binet 公式可得 $|B| = 0$，即 $B$ 不可逆,矛盾!

\end{proof}

\subsection{初等因子都是一次多项式,或Jordan块都是一阶矩阵}

回顾\refcor{corollary:矩阵可对角化的几何叙述}中可对角化的充要条件.

\begin{proposition}\label{proposition:矩阵可对角化关于多项式的充要条件1}
设 $n$ 阶复方阵 $A$ 的特征多项式为 $f(\lambda)$，复系数多项式 $g(\lambda)$ 满足 $(f(\lambda),g'(\lambda)) = 1$。证明：$A$ 可对角化的充要条件是 $g(A)$ 可对角化。
\end{proposition}
\begin{proof}
必要性显然成立，下证充分性。用反证法，设 $A$ 不可对角化，则存在可逆矩阵 $P$，使得
\begin{align*}
P^{-1}AP = J = \mathrm{diag}\{J_{r_1}(\lambda_1),\cdots,J_{r_k}(\lambda_k)\}
\end{align*}
为 Jordan 标准型，其中 $r_1 > 1$。注意到
\begin{align*}
P^{-1}g(A)P = g(P^{-1}AP) = g(J) = \mathrm{diag}\{g(J_{r_1}(\lambda_1)),\cdots,g(J_{r_k}(\lambda_k))\}
\end{align*}
由\nrefpro{proposition:Jordan块的性质}{(5)}可知   
\begin{align*}
g(J_{r_1}(\lambda_1))=\begin{pmatrix}
g(\lambda_1) & g'(\lambda_1) & \cdots & * \\
& g(\lambda_1) & \ddots & \vdots \\
& & \ddots & g'(\lambda_1) \\
& & & g(\lambda_1)
\end{pmatrix}
\end{align*}
由 $(f(\lambda),g'(\lambda)) = 1$ 可知 $g'(\lambda_1) \neq 0$，于是 $g(J_{r_1}(\lambda_1))$ 的特征值全为 $g(\lambda_1)$，其几何重数为 $r_1 - \mathrm{r}(g(J_{r_1}(\lambda_1)) - g(\lambda_1)I_{r_1}) = 1$，因此 $g(J_{r_1}(\lambda_1))$ 的 Jordan 标准型为 $J_{r_1}(g(\lambda_1))$，其阶数 $r_1 > 1$。由于 $J_{r_1}(g(\lambda_1))$ 也是 $g(A)$ 的一个 Jordan 块，但其不是对角阵(因为$\lambda_1$的代数重数与几何重数不相等),故 $g(A)$ 不可对角化，矛盾！

\end{proof}

\begin{proposition}\label{proposition:线性变换可对角化的几何充要条件1}
设 $\varphi$ 是 $n$ 维复线性空间 $V$ 上的线性变换，求证：$\varphi$ 可对角化的充要条件是对 $\varphi$ 的任一特征值 $\lambda_0$，总有 $\mathrm{Ker}(\varphi - \lambda_0I_V)\cap\mathrm{Im}(\varphi - \lambda_0I_V)=0$。
\end{proposition}
\begin{remark}
这个\refpro{proposition:线性变换可对角化的几何充要条件1}是这个\refpro{proposition:可对角化的补充}的特例.
\end{remark}
\begin{proof}
{\heiti 先证必要性：}若 $\varphi$ 可对角化，则存在一组基 $\{e_1,e_2,\cdots,e_n\}$，使得 $\varphi$ 在这组基下的表示矩阵为 $\mathrm{diag}$ $\{$ $\lambda_1'$ , $\lambda_2'$, $\cdots$, $\lambda_n'$ $\}$.适当调整基向量的顺序，不妨设 $\lambda_0' = \lambda_1' = \cdots = \lambda_r'$，$\lambda_0'\neq\lambda_j' (j > r)$，则\(\varphi - \lambda_0 I_V\) 在基 \(\{e_1, e_2, \cdots, e_n\}\) 下的表示矩阵为 \(\operatorname{diag}\{0, \cdots, 0, \lambda_{r+1}, \cdots, \lambda_n\}\)。下证$\mathrm{Ker}(\varphi - \lambda_0I_V)=L(e_1,\cdots,e_r)$，$\mathrm{Im}(\varphi - \lambda_0I_V)=L(e_{r + 1},\cdots,e_n)$.

对 \(\forall v \in V\)，都存在非零列向量 \((a_1, a_2, \cdots, a_n)'\)，使得
\[
v=(e_1,e_2,\cdots ,e_n)\left( \begin{array}{c}
a_1\\
a_2\\
\vdots\\
a_n\\
\end{array} \right) .
\]
从而
\[
(\varphi -\lambda _0I_V)(v)=\mathrm{diag}\{0,\cdots ,0,\lambda _{r+1},\cdots ,\lambda _n\}(e_1,e_2,\cdots ,e_n)\left( \begin{array}{c}
a_1\\
a_2\\
\vdots\\
a_n\\
\end{array} \right) =\sum_{i=r+1}^n{a_ie_i}\in L(e_{r+1},\cdots ,e_n).
\]
故 \(\operatorname{Im}(\varphi - \lambda_0 I_V) \subset L(e_{r+1}, \cdots, e_n)\)。再任取 \(\alpha \in L(e_{r+1}, \cdots, e_n)\)，存在非零列向量 \((0, \cdots, 0, b_{r+1}, \cdots, b_n)'\)，使得
\[
\alpha =(e_1,\cdots ,e_r,e_{r+1},\cdots ,e_n)\left( \begin{array}{c}
0\\
\vdots\\
0\\
b_{r+1}\\
\vdots\\
b_n\\
\end{array} \right) .
\]
取
\begin{align*}
\beta =(e_1,\cdots ,e_r,e_{r+1},\cdots ,e_n)\left( \begin{array}{c}
0\\
\vdots\\
0\\
\frac{b_{r+1}}{\lambda _{r+1}}\\
\vdots\\
\frac{b_n}{\lambda _n}\\
\end{array} \right) ,
\end{align*}
则
\[
(\varphi -\lambda _0I_V)(\beta )=\mathrm{diag}\{0,\cdots ,0,\lambda _{r+1},\cdots ,\lambda _n\}(e_1,\cdots ,e_r,e_{r+1},\cdots ,e_n)\left( \begin{array}{c}
0\\
\vdots\\
0\\
\frac{b_{r+1}}{\lambda _{r+1}}\\
\vdots\\
\frac{b_n}{\lambda _n}\\
\end{array} \right) =\sum_{i=r+1}^n{b_ie_i}=\alpha \text{。}
\]
故 \(L(e_{r+1}, \cdots, e_n) \subset \operatorname{Im}(\varphi - \lambda_0 I_V)\)。综上，\(\operatorname{Im}(\varphi - \lambda_0 I_V) = L(e_{r+1}, \cdots, e_n)\)。

任取 \(u \in L(e_1, \cdots, e_r)\)，则存在非零列向量 \((u_1, \cdots, u_r, 0, \cdots, 0)'\)，使得
\[
u=(e_1,\cdots ,e_r,e_{r+1},\cdots ,e_n\left( \begin{array}{c}
u_1\\
\vdots\\
u_r\\
0\\
\vdots\\
0\\
\end{array} \right) .
\]
从而
\[
(\varphi -\lambda _0I_V)(u)=\mathrm{diag}\{0,\cdots ,0,\lambda _{r+1},\cdots ,\lambda _n\}(e_1,\cdots ,e_r,e_{r+1},\cdots ,e_n)\left( \begin{array}{c}
u_1\\
\vdots\\
u_r\\
0\\
\vdots\\
0\\
\end{array} \right) =0\text{。}
\]
于是 \(L(e_1, \cdots, e_r) \subset \operatorname{Ker}(\varphi - \lambda_0 I_V)\)。再任取 \(y \in \operatorname{Ker}(\varphi - \lambda_0 I_V) \subset V\)，则存在非零列向量 \((y_1, y_2, \cdots, y_n)'\)，使得
\[
y=(e_1,e_2,\cdots ,e_n)\left( \begin{array}{c}
y_1\\
y_2\\
\vdots\\
y_n\\
\end{array} \right) =\sum_{i=1}^n{y_ie_i}.
\]
从而
\[
(\varphi -\lambda _0I_V)(y)=\mathrm{diag}\{0,\cdots ,0,\lambda _{r+1},\cdots ,\lambda _n\}(e_1,e_2,\cdots ,e_n)\left( \begin{array}{c}
y_1\\
y_2\\
\vdots\\
y_n\\
\end{array} \right) =\sum_{i=r+1}^n{y_ie_i}=0.
\]
因此 \(y_{r+1} = y_{r+2} = \cdots = y_n = 0\)，故 \(y = \sum_{i=1}^n y_i e_i = \sum_{i=1}^r y_i e_i \in L(e_1, \cdots, e_r)\)。进而 \(\operatorname{Ker}(\varphi - \lambda_0 I_V) \subset L(e_1, \cdots, e_r)\)。综上，\(\operatorname{Ker}(\varphi - \lambda_0 I_V) = L(e_1, \cdots, e_r)\)。
由此可知$\mathrm{Ker}(\varphi - \lambda_0I_V)=L(e_1,\cdots,e_r)$，$\mathrm{Im}(\varphi - \lambda_0I_V)=L(e_{r + 1},\cdots,e_n)$，从而 $\mathrm{Ker}(\varphi - \lambda_0I_V)\cap\mathrm{Im}(\varphi - \lambda_0I_V)=0$。

{\heiti 再证充分性：}用反证法，设 $\varphi$ 不可对角化，则存在 $V$ 的一组基 $\{e_1,e_2\cdots,e_n\}$，使得 $\varphi$ 在这组基下的表示矩阵为 Jordan 标准型 $J = \mathrm{diag}\{J_{r_1}(\lambda_1),\cdots,J_{r_k}(\lambda_k)\}$，其中 $r_1 > 1$。由表示矩阵的定义可得 $\varphi(e_1)=\lambda_1e_1$，$\varphi(e_2)=e_1 + \lambda_1e_2$，于是 $(\varphi - \lambda_1I_V)(e_1)=0$，$(\varphi - \lambda_1I_V)(e_2)=e_1$，从而 $\mathbf{0}\neq e_1\in\mathrm{Ker}(\varphi - \lambda_1I_V)\cap\mathrm{Im}(\varphi - \lambda_1I_V)$，这与假设矛盾。

\end{proof}

\begin{proposition}\label{proposition:线性变换可对角化的代数充要条件2}
求证：$n$ 阶复矩阵 $A$ 可对角化的充要条件是对 $A$ 的任一特征值 $\lambda_0$，$(\lambda_0I_n - A)^2$ 和 $\lambda_0I_n - A$ 的秩相同。
\end{proposition}
\begin{remark}
这个\refpro{proposition:线性变换可对角化的代数充要条件2}是这个\refpro{proposition:可对角化的补充}的特例.
\end{remark}
\begin{proof}
{\heiti 先证必要性：}若 $A$ 可对角化，则存在可逆矩阵 $P$，使得 $P^{-1}AP = \Lambda = \mathrm{diag}\{\lambda_1,\lambda_2,\cdots,\lambda_n\}$。适当调整 $P$ 的列向量的顺序，不妨设 $\lambda_0 = \lambda_1 = \cdots = \lambda_r$，$\lambda_0\neq\lambda_j (j > r)$，则由于相似矩阵的特征多项式相同可知,$\lambda_0I_n-A=\lambda_0I_n-\Lambda$.从而 $\mathrm{r}(\lambda_0I_n - A)=\mathrm{r}(\lambda_0I_n - \Lambda)=n - r$，$\mathrm{r}((\lambda_0I_n - A)^2)=\mathrm{r}((\lambda_0I_n - \Lambda)^2)=n - r$，于是结论成立。

{\heiti 再证充分性：}用反证法，若 $A$ 不可对角化，则存在可逆矩阵 $P$，使得 $P^{-1}AP = J = \mathrm{diag}\{J_{r_1}(\lambda_1),\cdots,J_{r_k}(\lambda_k)\}$ 为 Jordan 标准型，其中不妨设$r_1 > 1$.由于相似矩阵的特征多项式相等,因此$\lambda_1I_n-A=\lambda_1I_n-J$.从而注意到
\begin{align*}
\mathrm{r}((\lambda_1I_n - A)^j)=\mathrm{r}((\lambda_1I_n - J)^j)=\sum_{i = 1}^{k}\mathrm{r}((\lambda_1I_{r_i} - J_{r_i}(\lambda_i))^j),\ j\geqslant  1
\end{align*}
又注意到$\lambda_1I_{r_1}-J_{r_1}(\lambda_1)$是$r_1$阶基础幂零阵,故
$\mathrm{r}(\lambda_1I_{r_1} - J_{r_1}(\lambda_1))=r_1 - 1$，$\mathrm{r}((\lambda_1I_{r_1} - J_{r_1}(\lambda_1))^2)=r_1 - 2$，因此 $\mathrm{r}((\lambda_1I_n - A)^2)<\mathrm{r}(\lambda_1I_n - A)$，这与假设矛盾。

\end{proof}

\begin{proposition}\label{proposition:可对角化的补充}
设\(\varphi\)是\(n\)维复线性空间\(V\)上的线性变换, 求证: \(\varphi\)可对角化的充要条件是对\(\varphi\)的任一特征值\(\lambda_{0}\), 下列条件之一成立:
\begin{enumerate}[(1)]
\item \(V = \mathrm{Ker}(\varphi-\lambda_{0}\boldsymbol{I}_{V})+\mathrm{Im}(\varphi-\lambda_{0}\boldsymbol{I}_{V})\);

\item \(V = \mathrm{Ker}(\varphi-\lambda_{0}\boldsymbol{I}_{V})\oplus\mathrm{Im}(\varphi-\lambda_{0}\boldsymbol{I}_{V})\);

\item \(\mathrm{Ker}(\varphi-\lambda_{0}\boldsymbol{I}_{V})\cap\mathrm{Im}(\varphi-\lambda_{0}\boldsymbol{I}_{V}) = 0\);

\item \(\mathrm{dim}\mathrm{Ker}(\varphi-\lambda_{0}\boldsymbol{I}_{V})=\mathrm{dim}\mathrm{Ker}(\varphi-\lambda_{0}\boldsymbol{I}_{V})^{2}\);

\item \(\mathrm{Ker}(\varphi-\lambda_{0}\boldsymbol{I}_{V})=\mathrm{Ker}(\varphi-\lambda_{0}\boldsymbol{I}_{V})^{2}=\mathrm{Ker}(\varphi-\lambda_{0}\boldsymbol{I}_{V})^{3}=\cdots\);

\item \(\mathrm{r}(\varphi-\lambda_{0}\boldsymbol{I}_{V})=\mathrm{r}((\varphi-\lambda_{0}\boldsymbol{I}_{V})^{2})\);

\item \(\mathrm{Im}(\varphi-\lambda_{0}\boldsymbol{I}_{V})=\mathrm{Im}(\varphi-\lambda_{0}\boldsymbol{I}_{V})^{2}=\mathrm{Im}(\varphi-\lambda_{0}\boldsymbol{I}_{V})^{3}=\cdots\);

\item \(\mathrm{Ker}(\varphi-\lambda_{0}\boldsymbol{I}_{V})\)存在\(\varphi\)-不变补空间, 即存在\(\varphi\)-不变子空间\(U\), 使得\(V = \mathrm{Ker}(\varphi-\lambda_{0}\boldsymbol{I}_{V})\oplus U\);

\item \(\mathrm{Im}(\varphi-\lambda_{0}\boldsymbol{I}_{V})\)存在\(\varphi\)-不变补空间, 即存在\(\varphi\)-不变子空间\(W\), 使得\(V = \mathrm{Im}(\varphi-\lambda_{0}\boldsymbol{I}_{V})\oplus W\).
\end{enumerate}
\end{proposition}
\begin{remark}
\refpro{proposition:线性变换可对角化的几何充要条件1}与\refpro{proposition:线性变换可对角化的代数充要条件2}都是这个\refpro{proposition:可对角化的补充}的特例.
\end{remark}
\begin{note}
由\refpro{proposition:像空间和核空间的直和分解}可知条件(1)$\sim$(9)是相互等价的, 因此本题的结论由\refpro{proposition:线性变换可对角化的几何充要条件1}(与条件(3)对应) 或\refpro{proposition:线性变换可对角化的代数充要条件2}(与条件(6)对应) 即得. 事实上, 对充分性而言, 我们还可以从其他条件出发来证明\(\varphi\)可对角化, 下面是\(3\)种证法.
\end{note}
\begin{proof}
{\color{blue}证法一:}对任一特征值\(\lambda_{0}\), 由\(\mathrm{Ker}(\varphi-\lambda_{0}\boldsymbol{I}_{V})=\mathrm{Ker}(\varphi-\lambda_{0}\boldsymbol{I}_{V})^{2}=\cdots=\mathrm{Ker}(\varphi-\lambda_{0}\boldsymbol{I}_{V})^{n}\), 取维数之后可得特征值\(\lambda_{0}\)的几何重数等于代数重数, 从而\(\varphi\)有完全的特征向量系, 于是\(\varphi\)可对角化.
    
{\color{blue}证法二:} 对任一特征值\(\lambda_{0}\), 由\(\mathrm{Ker}(\varphi-\lambda_{0}\boldsymbol{I}_{V})=\mathrm{Ker}(\varphi-\lambda_{0}\boldsymbol{I}_{V})^{2}=\cdots=\mathrm{Ker}(\varphi-\lambda_{0}\boldsymbol{I}_{V})^{n}\)可知, 特征子空间等于根子空间, 再由根子空间的直和分解可知, 全空间等于特征子空间的直和, 从而\(\varphi\)可对角化.

{\color{blue}证法三:} 设\(\varphi\)的全体不同特征值为\(\lambda_{1},\lambda_{2},\cdots,\lambda_{k}\), 特征多项式\(f(\lambda)=(\lambda-\lambda_{1})^{m_{1}}(\lambda-\lambda_{2})^{m_{2}}\cdots(\lambda-\lambda_{k})^{m_{k}}\), 则对任意的\(\boldsymbol{\alpha}\in V\), 由Cayley - Hamilton定理可得
\begin{align*}
(\varphi-\lambda_{1}\boldsymbol{I}_{V})^{m_{1}}(\varphi-\lambda_{2}\boldsymbol{I}_{V})^{m_{2}}\cdots(\varphi-\lambda_{k}\boldsymbol{I}_{V})^{m_{k}}(\boldsymbol{\alpha}) = \boldsymbol{0},
\end{align*}
即有\((\varphi-\lambda_{2}\boldsymbol{I}_{V})^{m_{2}}\cdots(\varphi-\lambda_{k}\boldsymbol{I}_{V})^{m_{k}}(\boldsymbol{\alpha})\in\mathrm{Ker}(\varphi-\lambda_{1}\boldsymbol{I}_{V})^{m_{1}}=\mathrm{Ker}(\varphi-\lambda_{1}\boldsymbol{I}_{V})\), 从而
\begin{align*}
(\varphi-\lambda_{1}\boldsymbol{I}_{V})(\varphi-\lambda_{2}\boldsymbol{I}_{V})^{m_{2}}\cdots(\varphi-\lambda_{k}\boldsymbol{I}_{V})^{m_{k}}(\boldsymbol{\alpha}) = \boldsymbol{0}.
\end{align*}
不断这样做下去, 最终可得对任意的\(\boldsymbol{\alpha}\in V\), 总有
\begin{align*}
(\varphi-\lambda_{1}\boldsymbol{I}_{V})(\varphi-\lambda_{2}\boldsymbol{I}_{V})\cdots(\varphi-\lambda_{k}\boldsymbol{I}_{V})(\boldsymbol{\alpha}) = \boldsymbol{0},
\end{align*}
即\(\varphi\)适合多项式\(g(\lambda)=(\lambda-\lambda_{1})(\lambda-\lambda_{2})\cdots(\lambda-\lambda_{k})\),于是$\varphi$的极小多项式整除$g(\lambda)$也无重根, 从而\(\varphi\)可对角化. 

\end{proof}

\begin{example}
若 $n(n\geqslant  2)$ 阶矩阵 $B$ 相似于 $R = \mathrm{diag}\left\{\begin{pmatrix}0 & 1 \\ 1 & 0\end{pmatrix},I_{n - 2}\right\}$，则称 $B$ 为反射矩阵。证明：任一对合矩阵 $A$（即 $A^2 = I_n$）均可分解为至多 $n$ 个两两乘法可交换的反射矩阵的乘积。
\end{example}
\begin{proof}
由\hyperref[example:幂等和对合矩阵的Jordan标准型]{命题\ref{example:幂等和对合矩阵的Jordan标准型}(2)}可知，对合矩阵 $A$ 可对角化，即存在可逆矩阵 $P$，使得 $P^{-1}AP=\mathrm{diag}\{-I_r,I_{n - r}\}$，其中 $0\leqslant  r\leqslant  n$。当 $r = 0$ 时，$A = I_n = R^2$，结论成立。当 $r\geqslant  1$ 时，设 $B_i = P\mathrm{diag}\{1,\cdots,1,-1,1,\cdots,1\}P^{-1}$，其中 $-1$ 在主对角线上的第 $i$ 个位置，则 $B_i(1\leqslant  i\leqslant  r)$ 两两乘法可交换，并且 $A = B_1B_2\cdots B_r$。由于 $\begin{pmatrix}0 & 1 \\ 1 & 0\end{pmatrix}$ 的特征值是 $-1,1$，故其相似于 $\mathrm{diag}\{-1,1\}$，因此矩阵 $B$ 是反射矩阵当且仅当 $B$ 相似于 $\mathrm{diag}\{-1,1,\cdots,1\}$。因为对角矩阵的两个主对角元素对换是一个相似变换，所以上述 $B_i$ 都是反射矩阵，于是 $A$ 可以分解为 $r$ 个两两乘法可交换的反射矩阵的乘积。

\end{proof}







\end{document}
\documentclass[../../main.tex]{subfiles}
\graphicspath{{\subfix{../../image/}}} % 指定图片目录,后续可以直接使用图片文件名。

% 例如:
% \begin{figure}[H]
% \centering
% \includegraphics{image-01.01}
% \caption{图片标题}
% \label{figure:image-01.01}
% \end{figure}
% 注意:上述\label{}一定要放在\caption{}之后,否则引用图片序号会只会显示??.

\begin{document}

\section{Jordan标准型的求法}\label{section:Jordan标准型的求法}

\hypertarget{分析矩阵结构的方法}{分析矩阵结构的方法:}
\begin{enumerate}[(1)]
\item 计算行列式因子 对于某些具有简单结构的矩阵 (如上 (下) 三角矩阵、类上 (下) 三角矩阵), 可以通过选取适当的子式, 计算出行列式因子, 再得到不变因子和初等因子. 比如, Frobenius 块和 Jordan 块就是利用这种方法的典型例子.

\item 计算极小多项式 因为矩阵的极小多项式是整除关系下最大的不变因子, 所以极小多项式确定了最大 Jordan 块的阶数.

\item 计算特征值的几何重数 因为特征值的几何重数等于其 Jordan 块的个数, 所以计算几何重数有助于 Jordan 标准型的确定. 
\end{enumerate}

\begin{proposition}\label{proposition:矩阵任一特征值对应的特征矩阵的秩为r的充要条件}
设 \(n\) 阶矩阵 \(\boldsymbol{A}\) 的不变因子组为 \(d_1(\lambda), d_2(\lambda), \cdots, d_n(\lambda)\), 其中 \(d_i(\lambda) \mid d_{i + 1}(\lambda)\) \((1 \leq i \leq n - 1)\), 又 \(\lambda_0\) 是 \(\boldsymbol{A}\) 的特征值. 求证: \(\mathrm{r}(\lambda_0\boldsymbol{I}_n - \boldsymbol{A}) = r\) 的充要条件是 \((\lambda - \lambda_0) \nmid d_r(\lambda)\) 但 \((\lambda - \lambda_0) \mid d_{r + 1}(\lambda)\).
\end{proposition}
\begin{proof}
{\color{blue}证法一:}\(\mathrm{r}(\lambda_0\boldsymbol{I}_n - \boldsymbol{A}) = r\) 当且仅当特征值 \(\lambda_0\) 的几何重数为 \(n - r\); 这当且仅当特征值 \(\lambda_0\) 的 Jordan 块有 \(n - r\) 个; 由不变因子之间的整除关系可知, 这当且仅当后 \(n - r\) 个不变因子能被 \(\lambda - \lambda_0\) 整除, 而前 \(r\) 个不变因子不能被 \(\lambda - \lambda_0\) 整除.

{\color{blue}证法二:}由\refpro{proposition:特征值对应的特征矩阵的秩与不变因子组的关系}可知, \(\mathrm{r}(\lambda_0\boldsymbol{I}_n - \boldsymbol{A}) = r\) 当且仅当 \(\sum_{i = 1}^{n} \delta_{d_i(\lambda_0),0} = n - r\); 由不变因子之间的整除关系可知, 这当且仅当 \(d_i(\lambda_0) \neq 0\) \((1 \leq i \leq r)\) 且 \(d_i(\lambda_0) = 0\) \((r + 1 \leq i \leq n)\); 最后由余数定理即得结论.
\end{proof}

\begin{proposition}\label{proposition:限制变换的任一Jordan块的个数一定小于原线性变换的特征值对应的Jordan块的个数}
设 \(\varphi\) 是 \(n\) 维线性空间 \(V\) 上的线性变换，\(U\) 是 \(V\) 的非零 \(\varphi -\)不变子空间。设 \(\lambda_0\) 是限制变换 \(\varphi|_U\) 的特征值，证明：\(\varphi|_U\) 的属于特征值 \(\lambda_0\) 的 Jordan 块的个数不超过 \(\varphi\) 的属于特征值 \(\lambda_0\) 的 Jordan 块的个数。
\end{proposition}
\begin{proof}
Jordan 块的个数等于特征值的几何重数，即线性无关的特征向量的个数。设 \(\varphi|_U\) 的属于特征值 \(\lambda_0\) 的 Jordan 块的个数为 \(r\)，则 \(\varphi|_U\) 关于特征值 \(\lambda_0\) 有 \(r\) 个线性无关的特征向量，它们也都是 \(\varphi\) 关于特征值 \(\lambda_0\) 的线性无关的特征向量，从而 \(\varphi\) 的属于特征值 \(\lambda_0\) 的 Jordan 块至少有 \(r\) 个。

也可用纯代数的方法（矩阵的秩）进行证明，请读者自行思考完成。
\end{proof}

\begin{example}\label{example:元素全一样的上三角矩阵的Jordan标准型}
求下列 \(n\) 阶矩阵的 Jordan 标准型，其中 \(a \neq 0\)：
\[
\boldsymbol{A} = 
\begin{pmatrix}
a & a & a & \cdots & a \\
& a & a & \cdots & a \\
& & a & \cdots & a \\
& & & \ddots & \vdots \\
& & & & a
\end{pmatrix}
\]
\end{example}
\begin{remark}
本题同时利用\hyperlink{分析矩阵结构的方法}{分析矩阵结构的三种方法}计算其Jordan标准型.
\end{remark}
\begin{solution}
{\color{blue}解法一:}由\refpro{proposition:A(a,b)矩阵均相似}可知，\(\boldsymbol{A}\) 的行列式因子组为 \(1, \cdots, 1, (\lambda - a)^n\)，这也是 \(\boldsymbol{A}\) 的不变因子组，从而 \(\boldsymbol{A}\) 的 Jordan 标准型为 \(\boldsymbol{J}_n(a)\)。

{\color{blue}解法二:}显然 \(\boldsymbol{A}\) 的特征多项式为 \((\lambda - a)^n\)，故 \(\boldsymbol{A}\) 的极小多项式是 \(\lambda - a\) 的某个幂。设 \(\boldsymbol{N} = \boldsymbol{J}_n(0)\)，即特征值为 \(0\) 的 \(n\) 阶 Jordan 块，它满足 \(\boldsymbol{N}^{n - 1} \neq \boldsymbol{O}\) 但 \(\boldsymbol{N}^n = \boldsymbol{O}\)，则 \(\boldsymbol{A} = a(\boldsymbol{I}_n + \boldsymbol{N} + \boldsymbol{N}^2 + \cdots + \boldsymbol{N}^{n - 1})\)。注意到
\begin{align*}
(\boldsymbol{A} - a\boldsymbol{I}_n)^{n - 1} = a^{n - 1}(\boldsymbol{N} + \boldsymbol{N}^2 + \cdots + \boldsymbol{N}^{n - 1})^{n - 1} = a^{n - 1}\boldsymbol{N}^{n - 1} \neq \boldsymbol{O}
\end{align*}
故 \(\boldsymbol{A}\) 不适合多项式 \((\lambda - a)^{n - 1}\)，于是 \(\boldsymbol{A}\) 的极小多项式只能是 \((\lambda - a)^n\)。因此 \(\boldsymbol{A}\) 的不变因子组是 \(1, \cdots, 1, (\lambda - a)^n\)，从而 \(\boldsymbol{A}\) 的 Jordan 标准型为 \(\boldsymbol{J}_n(a)\)。

{\color{blue}解法三：}显然 \(\boldsymbol{A}\) 的特征值全为 \(a\)，我们来计算它的几何重数。注意到 \(\mathrm{r}(a\boldsymbol{I}_n - \boldsymbol{A}) = n - 1\)，故特征值 \(a\) 的几何重数为 \(n - \mathrm{r}(a\boldsymbol{I}_n - \boldsymbol{A}) = 1\)，于是 \(\boldsymbol{A}\) 的 Jordan 标准型中关于特征值 \(a\) 的 Jordan 块只有一个，因此 \(\boldsymbol{A}\) 的 Jordan 标准型为 \(\boldsymbol{J}_n(a)\)。
\end{solution}

\begin{proposition}[秩一阵的Jordan标准型]\label{proposition:秩一阵的Jordan标准型}
设 \(n(n > 1)\) 阶矩阵 \(\boldsymbol{A}\) 的秩为 \(1\)，证明: 

若 \(\mathrm{tr}(\boldsymbol{A}) \ne 0\)，则\(\boldsymbol{A}\) 的 Jordan 标准型为 \(\mathrm{diag}\{0, \cdots, 0, \mathrm{tr}(\boldsymbol{A})\}\)。

若 \(\mathrm{tr}(\boldsymbol{A}) = 0\)，则\(\boldsymbol{A}\) 的 Jordan 标准型为 \(\mathrm{diag}\{0, \cdots, 0, \boldsymbol{J}_2(0)\}\)。
\end{proposition}
\begin{proof}
{\color{blue}解法一:}由 \(\mathrm{r}(\boldsymbol{A}) = 1\)及\reflem{lemma:秩1矩阵的列向量分解}可知，存在非零列向量 \(\boldsymbol{\alpha}, \boldsymbol{\beta}\)，使得 \(\boldsymbol{A} = \boldsymbol{\alpha}\boldsymbol{\beta}'\)。由\hyperref[theorem:特征值的降价公式]{特征值的降价公式}可得 \(|\lambda\boldsymbol{I}_n - \boldsymbol{A}| = \lambda^{n - 1}(\lambda - \boldsymbol{\beta}'\boldsymbol{\alpha})\)，再由所有特征值之和等于矩阵的迹可得 \(\mathrm{tr}(\boldsymbol{A}) = \boldsymbol{\beta}'\boldsymbol{\alpha}\)。若 \(\mathrm{tr}(\boldsymbol{A}) \neq 0\)，则特征值 \(\mathrm{tr}(\boldsymbol{A})\) 的几何重数等于 \(1\)，特征值 \(0\) 的几何重数等于 \(n - \mathrm{r}(\boldsymbol{A}) = n - 1\)，因此 \(\boldsymbol{A}\) 的 Jordan 标准型为 \(\mathrm{diag}\{0, \cdots, 0, \mathrm{tr}(\boldsymbol{A})\}\)。若 \(\mathrm{tr}(\boldsymbol{A}) = 0\)，则特征值 \(0\) 的代数重数是 \(n\)，几何重数是 \(n - 1\)，因此 \(\boldsymbol{A}\) 的 Jordan 标准型为 \(\mathrm{diag}\{0, \cdots, 0, \boldsymbol{J}_2(0)\}\)。

{\color{blue}解法二:}特征多项式的计算同解法一，又由\hyperref[proposition:常见矩阵的极小多项式]{常见矩阵的极小多项式(4)}可知，\(\boldsymbol{A}\) 的极小多项式 \(m(\lambda) = \lambda(\lambda - \mathrm{tr}(\boldsymbol{A}))\)，于是 \(\boldsymbol{A}\) 的不变因子组为 \(1, \lambda, \cdots, \lambda, m(\lambda)\)。若 \(\mathrm{tr}(\boldsymbol{A}) \neq 0\)，则 \(\boldsymbol{A}\) 的 Jordan 标准型为 \(\mathrm{diag}\{0, \cdots, 0, \mathrm{tr}(\boldsymbol{A})\}\)。若 \(\mathrm{tr}(\boldsymbol{A}) = 0\)，则 \(\boldsymbol{A}\) 的 Jordan 标准型为 \(\mathrm{diag}\{0, \cdots, 0, \boldsymbol{J}_2(0)\}\)。

{\color{blue}解法三：}直接利用 Jordan 标准型来解最为简单。特征多项式和特征值的计算同解法一，由于还不知道每个特征值的几何重数,故设 \(\boldsymbol{A}\) 的 Jordan 标准型 $\boldsymbol{J}$  $=$ $\mathrm{diag}$ $\{$ $\boldsymbol{J}_{r_1}$ $(0)$,$ \cdots$ , $\boldsymbol{J}_{r_k}(0)$ , $\boldsymbol{J}_{s_1}(\lambda_1)$, $\cdots$, $\boldsymbol{J}_{s_l}$ $(\lambda_l)$ $\}$(因为Jordan块对应的特征值为0时秩会减1,所以单独把特征值为0的Jordan块分出来)，其中 \(\lambda_j \neq 0\) \((1 \leq j \leq l)\)。由于相似关系不改变矩阵的秩，故 \(\boldsymbol{J}\) 的秩也为 \(1\)，即有 \((r_1 - 1) + \cdots + (r_k - 1) + s_1 + \cdots + s_l = 1\)。于是只有以下两种情况成立：第一种情况是 \(l = 1, s_1 = 1, \lambda_1 = \mathrm{tr}(\boldsymbol{A}) \neq 0\)，且所有的 \(r_i = 1\)，此时 \(\boldsymbol{A}\) 的 Jordan 标准型为 \(\mathrm{diag}\{0, \cdots, 0, \mathrm{tr}(\boldsymbol{A})\}\)。第二种情况是某个 \(r_i = 2\)，其余的 \(r_i = 1\) 且 \(l = 0\)，此时 \(\boldsymbol{A}\) 的 Jordan 标准型为 \(\mathrm{diag}\{0, \cdots, 0, \boldsymbol{J}_2(0)\}\)。
\end{proof}

\begin{proposition}\label{proposition:幂等阵和幂零阵关于迹的充要条件}
设$n(n>1)$阶矩阵$A$的秩为1,求证:
\begin{enumerate}[(1)]
\item $A$是幂等矩阵的充要条件是$\mathrm{tr}\left( A \right) =1$,


\item $A$是幂零矩阵的充要条件是$\mathrm{tr}\left( A \right) =0$.
\end{enumerate}
\end{proposition}
\begin{proof}
由\refpro{proposition:秩一阵的Jordan标准型}的结论即得.
\end{proof}

\begin{example}
设 $A = \begin{pmatrix}
1 & 0 & 0 & 0 \\
a + 2 & 1 & 0 & 0 \\
5 & 3 & 1 & 0 \\
7 & 6 & b + 4 & 1
\end{pmatrix}$, 求 $A$ 的 Jordan 标准型.
\end{example}
\begin{solution}
显然 $A$ 的特征值全为 $1$, 首先我们来计算特征值 $1$ 的几何重数. 考虑矩阵
\begin{align*}
A - I_4 = \begin{pmatrix}
0 & 0 & 0 & 0 \\
a + 2 & 0 & 0 & 0 \\
5 & 3 & 0 & 0 \\
7 & 6 & b + 4 & 0
\end{pmatrix}.
\end{align*}

(1) 当 $a + 2 \neq 0$ 且 $b + 4 \neq 0$ 时, $\mathrm{r}(A - I_4) = 3$, 于是特征值 $1$ 的几何重数等于 $1$, 从而只有一个 Jordan 块, 因此 $A$ 的 Jordan 标准型是 $J_4(1)$.

(2) 当 $a + 2 = 0$ 或 $b + 4 = 0$ 时, $\mathrm{r}(A - I_4) = 2$, 于是特征值 $1$ 的几何重数等于 $2$, 从而有两个 Jordan 块. 进一步我们来计算 $A$ 的极小多项式.

(2.1) 若 $a + 2 = 0$ 和 $b + 4 = 0$ 中只有一个成立, 容易验证 $(A - I_4)^2 \neq O$, 但 $(A - I_4)^3 = O$, 于是 $A$ 的极小多项式是 $(\lambda - 1)^3$, 从而不变因子组为 $1,1,\lambda - 1,(\lambda - 1)^3$, 因此 $A$ 的 Jordan 标准型为 $\mathrm{diag}\{1,J_3(1)\}$.

(2.2) 若 $a + 2 = 0$ 和 $b + 4 = 0$ 都成立, 容易验证 $(A - I_4)^2 = O$, 于是 $A$ 的极小多项式是 $(\lambda - 1)^2$, 从而不变因子组为 $1,1,(\lambda - 1)^2,(\lambda - 1)^2$, 因此 $A$ 的 Jordan 标准型为 $\mathrm{diag}\{J_2(1),J_2(1)\}$. 
\end{solution}

\begin{example}\label{example:J_n(0)的Jordan标准型}
设 $J = J_n(0)$ 是特征值为零的 $n(n \geq 2)$ 阶 Jordan 块, 求 $J^2$ 的 Jordan 标准型.
\end{example}
\begin{solution}
显然 $J^2$ 的特征值全为 $0$ 且 $\mathrm{r}(J^2) = n - 2$, 于是特征值 $0$ 的几何重数等于 $2$, 从而有两个 Jordan 块. 接下去计算 $J^2$ 的极小多项式, 注意到 $J^n = O$, $J^{n - 1} \neq O$.

(1) 当 $n = 2m$ 时, $\lambda^m$ 是 $J^2$ 的极小多项式, 于是 $J^2$ 的不变因子组为 $1,\cdots,1,\lambda^m,\lambda^m$, 因此 $J^2$ 的 Jordan 标准型为 $\mathrm{diag}\{J_m(0),J_m(0)\}$.

(2) 当 $n = 2m + 1$ 时, $\lambda^{m + 1}$ 是 $J^2$ 的极小多项式, 于是 $J^2$ 的不变因子组为 $1,\cdots,1,\lambda^m,\lambda^{m + 1}$, 因此 $J^2$ 的 Jordan 标准型为 $\mathrm{diag}\{J_m(0),J_{m + 1}(0)\}$.

另外, 也可以用行列式因子的讨论来替代几何重数的讨论. 注意到 $\lambda I_n - J^2$ 的右上角有一个 $n - 2$ 阶子式等于 $(-1)^{n - 2}$, 故 $J^2$ 的 $n - 2$ 阶行列式因子为 $1$, 从而前 $n - 2$ 个不变因子都是 $1$, 后面再用极小多项式的讨论即可得到结论.
\end{solution}

\begin{example}
求下列 $n(n \geq 2)$ 阶矩阵的 Jordan 标准型:
\[
A = \begin{pmatrix}
c & 0 & 1 & 0 & \cdots & 0 \\
c & 0 & 1 & \cdots & 0 \\
& \ddots & \ddots & \ddots & \vdots \\
& & \ddots & \ddots & 1 \\
& & & \ddots & 0 \\
& & & & & c
\end{pmatrix}.
\]
\end{example}
\begin{solution}
利用\refexa{example:J_n(0)的Jordan标准型}的记号和结论, 显然 $A = cI_n + J^2$. 设 $P$ 是可逆矩阵, 使得 $P^{-1}J^2P$ 是 $J^2$ 的 Jordan 标准型, 则 $P^{-1}AP = cI_n + P^{-1}J^2P$ 就是 $A$ 的 Jordan 标准型. 具体地, 当 $n = 2m$ 时, $A$ 的 Jordan 标准型是 $\mathrm{diag}\{J_m(c),J_m(c)\}$; 当 $n = 2m + 1$ 时, $A$ 的 Jordan 标准型是 $\mathrm{diag}\{J_m(c),J_{m + 1}(c)\}$.
\end{solution}

\vspace{0.5cm}

我们可以自然地考虑如下问题: 如果已知 $n$ 阶矩阵 $A$ 的 Jordan 标准型, 那么对任意的正整数 $m$, $A^m$ 的 Jordan 标准型应该有怎样的形状呢?(后续的\refpro{proposition:Jordan块的m次方的Jordan标准型}和\refpro{proposition:J_n(0)的Jordan标准型的推广}完美解决了这个问题) 首先, 我们可以把这个问题化约到 Jordan 块的情形. 设 $A$ 的 Jordan 标准型为 $J = \mathrm{diag}\{J_{r_1}(\lambda_1),J_{r_2}(\lambda_2),\cdots,J_{r_s}(\lambda_s)\}$, 则 $A^m$ 相似于 $J^m = \mathrm{diag}\{J_{r_1}(\lambda_1)^m,J_{r_2}(\lambda_2)^m,\cdots,J_{r_s}(\lambda_s)^m\}$, 因此要求 $A^m$ 的 Jordan 标准型, 只要求每一个 $J_{r_i}(\lambda_i)^m$ 的 Jordan 标准型即可. 若 $\lambda_i \neq 0$, 则由\refexa{example:元素全一样的上三角矩阵的Jordan标准型}类似的讨论可知, $J_{r_i}(\lambda_i)^m$ 的 Jordan 标准型为 $J_{r_i}(\lambda_i^m)$. 若 $\lambda_i = 0$, 则\refexa{example:J_n(0)的Jordan标准型}处理了 $m = 2$ 的情形, 不过类似的讨论很难推广到 $m \geq 3$ 的情形, 换言之, 只依靠几何重数和极小多项式还不能完全确定 $J_{r_i}(0)^m$ 的 Jordan 标准型. 解决这个问题可以有代数和几何两种方法, 几何方法 (利用 Jordan 标准型的几何意义) , 而代数方法 (利用矩阵的秩) 则需要下面的\refpro{proposition:Jordan块的个数与秩的关系}.

\begin{proposition}\label{proposition:Jordan块的个数与秩的关系}
设 $\lambda_0$ 是 $n$ 阶矩阵 $A$ 的特征值, 证明: 对任意的正整数 $k$, 特征值为 $\lambda_0$ 的 $k$ 阶 Jordan 块 $J_k(\lambda_0)$ 在 $A$ 的 Jordan 标准型 $J$ 中出现的个数为
\[
\mathrm{r}((A - \lambda_0 I_n)^{k - 1}) + \mathrm{r}((A - \lambda_0 I_n)^{k + 1}) - 2\mathrm{r}((A - \lambda_0 I_n)^k),
\]
其中约定 $\mathrm{r}((A - \lambda_0 I_n)^0) = n$.
\end{proposition}
\begin{remark}
这个\refpro{proposition:Jordan块的个数与秩的关系}告诉我们, $n$ 阶矩阵 $A$ 的 Jordan 标准型被若干个非负整数, 即 $\{\mathrm{r}((A - \lambda_i I_n)^j) \mid \lambda_i$ 为 $A$ 的特征值, $1 \leq j \leq n\}$ 完全决定. 因此从理论上说, 我们可以不计算矩阵 $A$ 的不变因子或初等因子, 改为计算上述若干个矩阵的秩, 也可以求出 $A$ 的 Jordan 标准型. 进一步, 我们还可以得到如下矩阵相似的判定准则.
\end{remark}
\begin{proof}
设 $P$ 为非异阵, 使得 $P^{-1}AP = J = \mathrm{diag}\{J_{r_1}(\lambda_1),J_{r_2}(\lambda_2),\cdots,J_{r_s}(\lambda_s)\}$ 为 $A$ 的 Jordan 标准型. 注意到
\[
(A - \lambda_0 I_n)^k = P\mathrm{diag}\{J_{r_1}(\lambda_1 - \lambda_0)^k,J_{r_2}(\lambda_2 - \lambda_0)^k,\cdots,J_{r_s}(\lambda_s - \lambda_0)^k\}P^{-1},
\]
故 $\mathrm{r}((A - \lambda_0 I_n)^k) = \sum_{i = 1}^{s}\mathrm{r}(J_{r_i}(\lambda_i - \lambda_0)^k)$.

(i)当 $\lambda_i \neq \lambda_0$ 时, $\mathrm{r}(J_{r_i}(\lambda_i - \lambda_0)^k) = r_i$. 
当 $\lambda_i = \lambda_0$ 时, 
若 $r_i < k$, 则 $\mathrm{r}(J_{r_i}(\lambda_i - \lambda_0)^k) = 0$; 
若 $r_i \geq k$, 则 $\mathrm{r}(J_{r_i}(\lambda_i - \lambda_0)^k) = r_i - k$. 

(ii)当 $\lambda_i \neq \lambda_0$ 时, $\mathrm{r}(J_{r_i}(\lambda_i - \lambda_0)^{k-1}) = r_i$. 
当 $\lambda_i = \lambda_0$ 时, 
若 $r_i < k-1$, 则 $\mathrm{r}(J_{r_i}(\lambda_i - \lambda_0)^{k-1}) = 0$; 
若 $r_i \geq k-1$, 则 $\mathrm{r}(J_{r_i}(\lambda_i - \lambda_0)^{k-1}) = r_i - k+1$. 

于是当 $\lambda_i \neq \lambda_0$ 时,$\mathrm{r}((A - \lambda_0 I_n)^{k - 1}) - \mathrm{r}((A - \lambda_0 I_n)^k)=r_i-r_i=0$;

当 $\lambda_i = \lambda_0$ 时, 
若 $r_i < k-1$, 则$\mathrm{r}((A - \lambda_0 I_n)^{k - 1}) - \mathrm{r}((A - \lambda_0 I_n)^k)=0-0=0$;

若 $r_i =k-1$, 则$\mathrm{r}((A - \lambda_0 I_n)^{k - 1}) - \mathrm{r}((A - \lambda_0 I_n)^k)=0-(k-1-k+1)=0$;

若 $r_i \geq k$, 则$\mathrm{r}((A - \lambda_0 I_n)^{k - 1}) - \mathrm{r}((A - \lambda_0 I_n)^k)=(r_i-k)-(r_i-k+1)=1$.

因此 $\mathrm{r}((A - \lambda_0 I_n)^{k - 1}) - \mathrm{r}((A - \lambda_0 I_n)^k)$ 等于特征值为 $\lambda_0$ 且阶数大于等于 $k$ 的 Jordan 块的个数. 同理, $\mathrm{r}((A - \lambda_0 I_n)^k) - \mathrm{r}((A - \lambda_0 I_n)^{k + 1})$ 等于特征值为 $\lambda_0$ 且阶数大于等于 $k + 1$ 的 Jordan 块的个数, 从而特征值为 $\lambda_0$ 的 $k$ 阶 Jordan 块 $J_k(\lambda_0)$ 在 $A$ 的 Jordan 标准型 $J$ 中出现的个数为
\begin{align*}
&(\mathrm{r}((A - \lambda_0 I_n)^{k - 1}) - \mathrm{r}((A - \lambda_0 I_n)^k)) - (\mathrm{r}((A - \lambda_0 I_n)^k) - \mathrm{r}((A - \lambda_0 I_n)^{k + 1}))\\
=&\mathrm{r}((A - \lambda_0 I_n)^{k - 1}) + \mathrm{r}((A - \lambda_0 I_n)^{k + 1}) - 2\mathrm{r}((A - \lambda_0 I_n)^k). 
\end{align*}
\end{proof}

\begin{proposition}\label{proposition:矩阵相似的充要条件(关于秩的充要条件)}
设 $A,B$ 为 $n$ 阶矩阵, 证明: 它们相似的充要条件是对 $A$ 或 $B$ 的任一特征值 $\lambda_0$ 以及任意的 $1 \leq k \leq n$, 有 $\mathrm{r}((A - \lambda_0 I_n)^k) = \mathrm{r}((B - \lambda_0 I_n)^k)$.
\end{proposition}
\begin{proof}
必要性由相似矩阵特征多项式相同显然, 现证充分性. 由已知条件及\refpro{proposition:矩阵n次方幂秩等式}可知,
\[
\mathrm{r}((A - \lambda_0 I_n)^{n + 1}) = \mathrm{r}((A - \lambda_0 I_n)^n) = \mathrm{r}((B - \lambda_0 I_n)^n) = \mathrm{r}((B - \lambda_0 I_n)^{n + 1}).
\]
因此由\refpro{proposition:Jordan块的个数与秩的关系}可知, 特征值为 $\lambda_0$ 的 $k$ 阶 Jordan 块 $J_k(\lambda_0)$ 在 $A,B$ 的 Jordan 标准型中出现的个数相同, 从而 $A,B$ 有相同的 Jordan 标准型, 于是它们相似.
\end{proof}

\begin{proposition}\label{proposition:Jordan块的m次方的Jordan标准型}
设 $J = J_n(a)$ 是特征值为 $a \neq 0$ 的 $n$ 阶 Jordan 块, 证明:$J^m$的 Jordan 标准型为$J_n(a^m)$, 其中 $m$ 为非零整数.
\end{proposition}
\begin{proof}
先处理 $m \geq 1$ 的情形, 采用几何重数的方法来做, 行列式因子和极小多项式的方法也可以做, 请读者自行补充完成. 显然 $J^m$ 的所有特征值都为 $a^m$. 作分解 $J = aI_n + N$, 其中 $N = J_n(0)$, 则有
\begin{align*}
J^m = (aI_n + N)^m = a^mI_n + \mathrm{C}_m^1a^{m - 1}N + \cdots + N^m,
\end{align*}
于是 $\mathrm{r}(J^m - a^mI_n) = \mathrm{r}(\mathrm{C}_m^1a^{m - 1}N + \cdots + N^m) = n - 1$, 从而特征值 $a^m$ 的几何重数等于 $1$, 因此 $J^m$ 的 Jordan 标准型中只有一个 Jordan 块, 即 $J^m$ 的 Jordan 标准型为 $J_n(a^m)$.

再处理 $m = -1$ 的情形. 显然 $J^{-1}$ 的所有特征值都为 $a^{-1}$. 注意到
\[
J^{-1} = (aI_n + N)^{-1} = a^{-1}I_n - a^{-2}N + \cdots + (-1)^{n - 1}a^{-n}N^{n - 1},
\]
故 $\mathrm{r}(J^{-1} - a^{-1}I_n) = \mathrm{r}(-a^{-2}N + \cdots + (-1)^{n - 1}a^{-n}N^{n - 1}) = n - 1$, 从而特征值 $a^{-1}$ 的几何重数等于 $1$, 因此 $J^{-1}$ 的 Jordan 标准型中只有一个 Jordan 块, 即 $J^{-1}$ 的 Jordan 标准型为 $J_n(a^{-1})$.

最后处理 $m \leq -1$ 的情形. 注意到 $J^m = (J^{-1})^{-m}$, 故由前面两个结论即得 $J^m$ 的 Jordan 标准型为 $J_n((a^{-1})^{-m}) = J_n(a^m)$. 
\end{proof}

\begin{proposition}\label{proposition:J_n(0)的Jordan标准型的推广}
设 $J = J_n(0)$ 是特征值为零的 $n$ 阶 Jordan 块, 证明: $J^m (m \geq 1)$ 的 Jordan 标准型为$\mathrm{diag}\{J_q(0),\cdots,J_q(0),J_{q + 1}(0),\cdots,J_{q + 1}(0)\}$, 其中有 $m - r$ 个 $J_q(0)$, $r$ 个 $J_{q + 1}(0)$. 
\end{proposition}
\begin{remark}
这个命题是\refexa{example:J_n(0)的Jordan标准型}的推广.
\end{remark}
\begin{solution}
若 $m \geq n$, 则 $J^m = O$, 这就是它的 Jordan 标准型. 下设 $m < n$, 并作带余除法: $n = mq + r$, 其中 $0 \leq r < m$. 我们先来计算 $J^m$ 的幂的秩, 再利用\refpro{proposition:Jordan块的个数与秩的关系}来计算 Jordan 块的个数. 注意到
\begin{align*}
&\mathrm{r}((J^m)^k) = n - mk, \ 0 \leq k \leq q; \ 
\mathrm{r}((J^m)^k) = 0, \ k \geq q + 1.
\end{align*}

(1) 当 $1 \leq k < q$ 时, $J_k(0)$ 的个数为 $\mathrm{r}((J^m)^{k - 1}) + \mathrm{r}((J^m)^{k + 1}) - 2\mathrm{r}((J^m)^k) = (n - m(k - 1)) + (n - m(k + 1)) - 2(n - mk) = 0$;

(2) $J_q(0)$ 的个数为 $\mathrm{r}((J^m)^{q - 1}) + \mathrm{r}((J^m)^{q + 1}) - 2\mathrm{r}((J^m)^q) = (n - m(q - 1)) + 0 - 2(n - mq) = m - r$;

(3) $J_{q + 1}(0)$ 的个数为 $\mathrm{r}((J^m)^q) + \mathrm{r}((J^m)^{q + 2}) - 2\mathrm{r}((J^m)^{q + 1}) = (n - mq) + 0 - 0 = r$;

(4) 当 $k > q + 1$ 时, $J_k(0)$ 的个数为 $0$.

因此 $J^m$ 的 Jordan 标准型为 $\mathrm{diag}\{J_q(0),\cdots,J_q(0),J_{q + 1}(0),\cdots,J_{q + 1}(0)\}$, 其中有 $m - r$ 个 $J_q(0)$, $r$ 个 $J_{q + 1}(0)$. 
\end{solution}

\begin{proposition}\label{proposition:分块上三角阵的Jordan标准型}
设 $m$ 阶矩阵 $A$ 与 $n$ 阶矩阵 $B$ 没有公共的特征值, 且 $A,B$ 的 Jordan 标准型分别为 $J_1,J_2$, 又 $C$ 为 $m \times n$ 矩阵, 求证: $M = \begin{pmatrix}A & C \\ O & B\end{pmatrix}$ 的 Jordan 标准型为 $\mathrm{diag}\{J_1,J_2\}$.
\end{proposition}
\begin{remark}
这个命题可用来化简矩阵, 消去其非主对角块, 使其剩下低阶的主对角块. 
\end{remark}
\begin{proof}
{\color{blue}证法一:}
设 $P_1(\lambda),P_2(\lambda),Q_1(\lambda),Q_2(\lambda)$ 是可逆 $\lambda$-矩阵, 使得
\begin{align*}
P_1(\lambda)(\lambda I_m - A)Q_1(\lambda) &= \Lambda_1 = \mathrm{diag}\{f_1(\lambda),f_2(\lambda),\cdots,f_m(\lambda)\},\\
P_2(\lambda)(\lambda I_n - B)Q_2(\lambda) &= \Lambda_2 = \mathrm{diag}\{g_1(\lambda),g_2(\lambda),\cdots,g_n(\lambda)\}
\end{align*}
分别是 $A,B$ 的法式. 考虑如下 $\lambda$-矩阵的初等变换:
\[
\begin{pmatrix}P_1 & O \\ O & P_2\end{pmatrix}
\begin{pmatrix}\lambda I_m - A & -C \\ O & \lambda I_n - B\end{pmatrix}
\begin{pmatrix}Q_1 & O \\ O & Q_2\end{pmatrix}
=
\begin{pmatrix}\Lambda_1 & D \\ O & \Lambda_2\end{pmatrix},
\]
其中 $D = -P_1CQ_2 = (d_{ij}(\lambda))$ 是 $m \times n$ $\lambda$-矩阵. 由于 $A,B$ 没有公共的特征值, 故对任意的 $1 \leq i \leq m$, $1 \leq j \leq n$, $(f_i(\lambda),g_j(\lambda)) = 1$, 从而存在 $u_{ij}(\lambda),v_{ij}(\lambda)$, 使得 $f_i(\lambda)u_{ij}(\lambda) + g_j(\lambda)v_{ij}(\lambda) = 1$. 将 $\lambda$-矩阵 $\begin{pmatrix}\Lambda_1 & D \\ O & \Lambda_2\end{pmatrix}$ 的第 $i$ 列乘以 $-u_{ij}(\lambda)d_{ij}(\lambda)$ 加到第 $m + j$ 列上, 再将第 $m + j$ 行乘以 $-v_{ij}(\lambda)d_{ij}(\lambda)$ 加到第 $i$ 行上, 则可以消去 $D$ 的第 $(i,j)$ 元素, 因此 $M$ 的特征矩阵相抵于对角矩阵 $\mathrm{diag}\{\Lambda_1,\Lambda_2\}$. 再由\hyperref[theorem:lambda-矩阵和初等因子的基本性质]{$\lambda$-矩阵和初等因子的基本性质(2)}可知, $M$ 的初等因子组是 $f_1(\lambda),\cdots,f_m(\lambda),g_1(\lambda),\cdots,g_n(\lambda)$ 的准素因子组, 而 $f_1(\lambda),\cdots,f_m(\lambda)$ 的准素因子组是 $A$ 的初等因子组, $g_1(\lambda),\cdots,g_n(\lambda)$ 的准素因子组是 $B$ 的初等因子组, 因此 $M$ 的初等因子组是 $A,B$ 的初等因子组的无交并集, 于是 $M$ 的 Jordan 标准型为 $\mathrm{diag}\{J_1,J_2\}$.

{\color{blue}证法二:}
由\refpro{proposition:AX-XB相关命题1}可知, 矩阵方程 $AX - XB = C$ 存在唯一解 $X = X_0$. 考虑如下相似变换:
\[
\begin{pmatrix}I_m & X_0 \\ O & I_n\end{pmatrix}
\begin{pmatrix}A & C \\ O & B\end{pmatrix}
\begin{pmatrix}I_m & -X_0 \\ O & I_n\end{pmatrix}
=
\begin{pmatrix}A & -AX_0 + X_0B + C \\ O & B\end{pmatrix}
=
\begin{pmatrix}A & O \\ O & B\end{pmatrix},
\]
因此 $M$ 的 Jordan 标准型为 $\mathrm{diag}\{J_1,J_2\}$. 
\end{proof}

\begin{example}
设 $A = \begin{pmatrix}
1 & 0 & 0 & 0 \\
b & a + 1 & 0 & 0 \\
3 & b & 2 & 0 \\
5 & 4 & a & 2
\end{pmatrix}$, 求 $A$ 的 Jordan 标准型.
\end{example}
\begin{solution}
显然, $A$ 的特征值为 $1,a + 1,2,2$. 对 $A$ 进行分块 $A = \begin{pmatrix}A_{11} & O \\ A_{21} & A_{22}\end{pmatrix}$, 其中所有的分块都是二阶方阵. 下面按 $a + 1$ 是否等于 $1,2$ 进行分类讨论.

(1) 若 $a \neq 0$ 及 $a \neq 1$, 则可有两种方法来处理. {\heiti 方法一}(几何重数): 经计算可知特征值 $2$ 的几何重数等于 $1$, 因此 $A$ 的 Jordan 标准型为 $\mathrm{diag}\{1,a + 1,J_2(2)\}$. {\heiti 方法二}(\hyperref[proposition:分块上三角阵的Jordan标准型]{命题\ref{proposition:分块上三角阵的Jordan标准型}}): 显然 $A_{11}$ 可对角化, $A_{22}$ 不可对角化,但$A_{22}$此时就是Jordan块$J_2(2)$, 且 $A_{11},A_{22}$ 无公共特征值, 故可消去 $A_{21}$, 因此 $A$ 的 Jordan 标准型为 $\mathrm{diag}\{1,a + 1,J_2(2)\}$.

(2) 若 $a = 0$ 及 $b \neq 0$, 则利用{\heiti 方法二}(\hyperref[proposition:分块上三角阵的Jordan标准型]{命题\ref{proposition:分块上三角阵的Jordan标准型}})可得, $A$ 的 Jordan 标准型为 $\mathrm{diag}\{J_2(1),2,2\}$.

(3) 若 $a = 0$ 及 $b = 0$, 则利用{\heiti 方法二}(\hyperref[proposition:分块上三角阵的Jordan标准型]{命题\ref{proposition:分块上三角阵的Jordan标准型}})可得, $A$ 的 Jordan 标准型为 $\mathrm{diag}\{1,1,2,2\}$.

(4) 若 $a = 1$ 及 $b \neq 0$, 则利用{\heiti 方法一}(几何重数)可得, $A$ 的 Jordan 标准型为 $\mathrm{diag}\{1,J_3(2)\}$.

(5) 若 $a = 1$ 及 $b = 0$, 则利用{\heiti 方法一}(几何重数)可得, $A$ 的 Jordan 标准型为 $\mathrm{diag}\{1,2,J_2(2)\}$. 
\end{solution}







\end{document}
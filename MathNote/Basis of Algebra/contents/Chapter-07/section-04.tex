\documentclass[../../main.tex]{subfiles}
\graphicspath{{\subfix{../../image/}}} % 指定图片目录,后续可以直接使用图片文件名。

% 例如:
% \begin{figure}[H]
% \centering
% \includegraphics[scale=0.4]{图.png}
% \caption{}
% \label{figure:图}
% \end{figure}
% 注意:上述\label{}一定要放在\caption{}之后,否则引用图片序号会只会显示??.

\begin{document}

\section{有理标准型}\label{section:有理标准型}

\begin{proposition}\label{proposition:特征矩阵的法式和不变因子}
设矩阵 $A$ 的特征矩阵 $\lambda I - A$ 的法式为
\begin{align*}
\mathrm{diag}\{1,\cdots,1,d_1(\lambda),\cdots,d_k(\lambda)\},
\end{align*}
其中 $d_i(\lambda)$ 为非常数首一多项式且 $d_i(\lambda)\mid d_{i + 1}(\lambda)\ (i = 1, 2, \cdots, k - 1)$，则 $A$ 的不变因子就是
\[
1,\cdots,1,d_1(\lambda),\cdots,d_k(\lambda).
\] 
\end{proposition}
\begin{proof}
由\refcor{corollary:特征矩阵的法式}可知，矩阵 $A$ 的特征矩阵 $\lambda I - A$ 的法式为
\begin{align*}
\mathrm{diag}\{1,\cdots,1,d_1(\lambda),\cdots,d_k(\lambda)\},
\end{align*}
其中 $d_i(\lambda)$ 为非常数首一多项式且 $d_i(\lambda)\mid d_{i + 1}(\lambda)\ (i = 1, 2, \cdots, k - 1)$，则根据不变因子的定义可知 ,$A$ 的不变因子就是
\[
1,\cdots,1,d_1(\lambda),\cdots,d_k(\lambda).
\] 

\end{proof}

\begin{lemma}[Frobenius块的基本性质]\label{lemma:Frobenius标准型矩阵的极小多项式和不变因子}
设 $r$ 阶矩阵
\[
F=F(f(\lambda)) = \begin{pmatrix}
0 & 1 & 0 & \cdots & 0 \\
0 & 0 & 1 & \cdots & 0 \\
\vdots & \vdots & \vdots & & \vdots \\
0 & 0 & 0 & \cdots & 1 \\
-a_r & -a_{r - 1} & -a_{r - 2} & \cdots & -a_1
\end{pmatrix},
\]
其中$\,f(\lambda)=\lambda^r + a_1\lambda^{r - 1}+\cdots + a_r$,则
\begin{enumerate}[(1)]
\item $|F(f(\lambda))|=(-1)^{r}a_r=(-1)^{r}f(0).$

\item $F=F(f(\lambda))$的特征多项式等于极小多项式等于 $f(\lambda)$。

\item $F$ 的行列式因子为
\begin{align}
1,\cdots,1,f(\lambda),\label{(7.4.1)}
\end{align}
其中共有 $r - 1$ 个 $1$，$\,f(\lambda)=\lambda^r + a_1\lambda^{r - 1}+\cdots + a_r$，$\,F$ 的不变因子也由\eqref{(7.4.1)}式给出,$F$ 的不变因子分别为:
\begin{align*}
1,\cdots,1,f(\lambda).
\end{align*}
进而,$\lambda I-F$相抵于$\mathrm{diag}\{1,\cdots,1,f(\lambda)\}.$
\end{enumerate}
\end{lemma}
\begin{remark}
$f(\lambda)$的友矩阵$C(f(\lambda))$(即$F(f(\lambda))$的转置)的性质与$F(f(\lambda))$相同.
\end{remark}
\begin{proof}
\begin{enumerate}[(1)]
\item 注意到$f(0)=a_r$,于是就有
\begin{align*}
\left| F(f(\lambda )) \right|=\left| \begin{matrix}
0&		1&		0&		\cdots&		0\\
0&		0&		1&		\cdots&		0\\
\vdots&		\vdots&		\vdots&		&		\vdots\\
0&		0&		0&		\cdots&		1\\
-a_r&		-a_{r-1}&		-a_{r-2}&		\cdots&		-a_1\\
\end{matrix} \right|\xlongequal{\text{按第一列展开}}\left( -1 \right) ^{r}a_r=\left( -1 \right) ^{r}f\left( 0 \right) .
\end{align*}

\item 由\hyperref[proposition:多项式的友阵的特征多项式与特征值]{命题\ref{proposition:多项式的友阵的特征多项式与特征值}(1)}同理可得得
\[
|\lambda I - F| = \lambda^r + a_1\lambda^{r - 1}+\cdots + a_r=f(\lambda).
\]
因为 $F$ 的特征多项式为 $f(\lambda)$，所以 $F$ 适合多项式 $f(\lambda)$。设 $e_i\ (i = 1, 2, \cdots, r)$ 是 $r$ 维标准单位行向量，则不难算出：
\[
e_1F = e_2,\quad e_1F^2 =e_2F= e_3,\quad \cdots,\quad e_1F^{r - 1} =e_{r-1}F= e_r.
\]
显然，$e_1, e_1F,\cdots, e_1F^{r - 1}$ 是一组线性无关的向量，从而任取$g(x)\in P_{r-1}[x]$且$g(x)$非零,则存在一组不全为零的数$a_1$,$a_2$,$\cdots$, $a_r$,使得
\begin{align*}
g(x)=a_1x^{r-1}+a_2x^{r-2}+\cdots+a_r.
\end{align*}
于是将$F$代入上式,再在等式两边同乘$e_1$得到
\begin{align*}
e_1g(F)=a_1e_1F^{r-1}+a_2e_1F^{r-2}+\cdots +a_re_1F.
\end{align*}
又因为$e_1, e_1F,\cdots, e_1F^{r - 1}$ 是一组线性无关的向量，且$a_1$,$a_2$,$\cdots$, $a_r$不全为零,所以$e_1g(F)\ne 0.$即$g(F)$的第一行不为零,故$g(F)\ne O$.
因此 $F$ 不可能适合一个次数不超过 $r - 1$ 的非零多项式，从而 $F$ 的极小多项式就是 $f(\lambda)$。

\item $F$ 的 $r$ 阶行列式因子就是它的特征多项式，由\hyperref[proposition:多项式的友阵的特征多项式与特征值]{命题\ref{proposition:多项式的友阵的特征多项式与特征值}(1)}同理可得得
\[
|\lambda I - F| = \lambda^r + a_1\lambda^{r - 1}+\cdots + a_r=f(\lambda).
\]
对任一 $k < r$，$\lambda I - F$ 总有一个 $k$ 阶子式其值等于 $(-1)^k$，故 $D_k(\lambda)=1$。又由\refcor{corollary:不变因子和法式相互唯一确定}可知,$\lambda I-F$的法式为$\mathrm{diag}\{1,\cdots,1,f(\lambda)\}.$故$\lambda I-F$相抵于$\mathrm{diag}\{1,\cdots,1,f(\lambda)\}.$
\end{enumerate}

\end{proof}

\begin{lemma}\label{lemma:对角元素的置换不改变相抵性}
设 $\lambda$-矩阵 $A(\lambda)$ 相抵于对角 $\lambda$-矩阵
\begin{align}
\mathrm{diag}\{d_1(\lambda),d_2(\lambda),\cdots,d_n(\lambda)\},
\label{eq:::7.4.2}
\end{align}
$\lambda$-矩阵 $B(\lambda)$ 相抵于对角 $\lambda$-矩阵
\begin{align}
\mathrm{diag}\{d_1'(\lambda),d_2'(\lambda),\cdots,d_n'(\lambda)\},
\label{eq:::7.4.3}
\end{align}
且 $d_1'(\lambda),d_2'(\lambda),\cdots,d_n'(\lambda)$ 是 $d_1(\lambda),d_2(\lambda),\cdots,d_n(\lambda)$ 的一个置换（即若不计次序，这两组多项式完全相同），则 $A(\lambda)$ 相抵于 $B(\lambda)$。
\end{lemma}
\begin{proof}
利用初等行对换及初等列对换即可将\eqref{eq:::7.4.2}式变成\eqref{eq:::7.4.3}式，因此\eqref{eq:::7.4.2} 式所示的矩阵与 \eqref{eq:::7.4.3}式所示的矩阵相抵，从而 $A(\lambda)$ 与 $B(\lambda)$ 相抵。

\end{proof}

\begin{theorem}[有理标准型/Frobenius标准型]\label{theorem:有理标准型核心定理}
设 $A$ 是数域 $\mathbb{K}$ 上的 $n$ 阶方阵，$A$ 的不变因子组为
\[
1,\cdots,1,d_1(\lambda),\cdots,d_k(\lambda),
\]
其中 $\deg d_i(\lambda)=m_i\geqslant 1$,$d_i\in \mathbb{K}[x]$.则 $A$ 在数域$\mathbb{K}$上相似于下列分块对角阵：
\begin{align}\label{equation-矩阵的有理标准型}
F = \begin{pmatrix}
F_1 & & & \\
& F_2 & & \\
& & \ddots & \\
& & & F_k
\end{pmatrix},
\end{align}
其中 $F_i$ 的阶等于 $m_i$，且 $F_i$ 是形如\reflem{lemma:Frobenius标准型矩阵的极小多项式和不变因子} 中的矩阵，$F_i$ 的最后一行由 $d_i(\lambda)$ 的系数（除首项系数之外）的负值组成。此即,设$d_i=\lambda ^{m_i}+a_{1i}\lambda ^{m_i-1}+\cdots +a_{m_i,i}$,则
\begin{align*}
F_i=F(d_i(\lambda))=\left( \begin{matrix}
0&		1&		0&		\cdots&		0\\
0&		0&		1&		\cdots&		0\\
\vdots&		\vdots&		\vdots&		&		\vdots\\
0&		0&		0&		\cdots&		1\\
-a_{m_i,i}&		-a_{m_i-1,i}&		-a_{m_i-2,i}&		\cdots&		-a_{1i}\\
\end{matrix} \right) .
\end{align*}
\eqref{equation-矩阵的有理标准型}式称为矩阵 $A$ 的\textbf{有理标准型}或 \textbf{Frobenius 标准型}，每个 $F_i$ 称为 \textbf{Frobenius 块}。

进而,$A$在数域$\mathbb{K}$上也相似于下列分块对角阵:
\begin{align*}
C=\left( \begin{matrix}
C_1&		&		&		\\
&		C_2&		&		\\
&		&		\ddots&		\\
&		&		&		C_k\\
\end{matrix} \right) ,
\end{align*}
其中$C_i$的阶等于$m_i$,$C_i$就是上述$F_i$的转置,即
\begin{align*}
C_i=C(d_i(\lambda ))=\left( \begin{matrix}
0&		0&		\cdots&		0&		-a_{m_i,i}\\
1&		0&		\cdots&		0&		-a_{m_i-1,i}\\
0&		1&		\cdots&		0&		-a_{m_i-2,i}\\
\vdots&		\vdots&		&		\vdots&		\vdots\\
0&		0&		\cdots&		1&		-a_{1i}\\
\end{matrix} \right) .
\end{align*}
\end{theorem}
\begin{proof}
注意到 $\lambda I - A$ 的第 $n$ 个行列式因子就是 $A$ 的特征多项式 $|\lambda I - A|$，再由不变因子的定义可知：
\begin{align*}
|\lambda I - A| = d_1(\lambda)d_2(\lambda)\cdots d_k(\lambda).
\end{align*}
而 $|\lambda I - A|$ 是一个 $n$ 次多项式，因此 $m_1 + m_2 + \cdots + m_k = n$。一方面，$\lambda I - A$ 的法式为
\[
\mathrm{diag}\{1,\cdots,1,d_1(\lambda),d_2(\lambda),\cdots,d_k(\lambda)\},
\]
其中有 $n - k$ 个 $1$。另一方面，对 $\lambda I - F$ 的每个分块都施以 $\lambda$-矩阵的初等变换，由\reflem{lemma:Frobenius标准型矩阵的极小多项式和不变因子}可知，$\lambda I - F$ 相抵于如下对角阵：
\begin{align}
\mathrm{diag}\{1,\cdots,1,d_1(\lambda);1,\cdots,1,d_2(\lambda);\cdots;1,\cdots,1,d_k(\lambda)\},
\label{equation::7.4.5}
\end{align}
其中每个 $d_i(\lambda)$ 前各有 $m_i - 1$ 个 $1$，从而共有 $\sum_{i = 1}^{k}(m_i - 1)=n - k$ 个 $1$。因此 \eqref{equation::7.4.5} 式所示的矩阵与 $\lambda I - A$ 的法式只相差主对角线上元素的置换，由\reflem{lemma:对角元素的置换不改变相抵性}可得 $\lambda I - A$ 与 $\lambda I - F$ 相抵，从而 $A$ 与 $F$ 相似。

又因为\hyperref[proposition:lambda-矩阵一定与其转置相似]{矩阵与其自身的转置相似},所以矩阵$A$也相似于$F$的转置，即$C$.

\end{proof}

\begin{example}
设 6 阶矩阵 $A$ 的不变因子为
\[
1,1,1,\lambda - 1,(\lambda - 1)^2,(\lambda - 1)^2(\lambda + 1),
\]
则 $A$ 的有理标准型为
\[
\begin{pmatrix}
1 & & & & & \\
& 0 & 1 & & & \\
& -1 & 2 & & & \\
& & & 0 & 1 & 0 \\
& & & 0 & 0 & 1 \\
& & & -1 & 1 & 1
\end{pmatrix}.
\] 
\end{example}

\begin{theorem}[极小多项式就是幂次最大的不变因子]\label{theorem:极小多项式与不变因子的关系}
设数域 $\mathbb{K}$ 上的 $n$ 阶矩阵 $A$ 的不变因子为
\[
1,\cdots,1,d_1(\lambda),\cdots,d_k(\lambda),
\]
其中 $d_i(\lambda)\mid d_{i + 1}(\lambda)\ (i = 1,\cdots,k - 1)$，则 $A$ 的特征多项式为$d_1(\lambda)d_2(\lambda)\cdots d_k(\lambda)$,极小多项式为 $m(\lambda)=d_k(\lambda)$.进而$A$的特征多项式也是所有初等因子的乘积,极小多项式是所有不同特征值对应的最高次幂的初等因子的乘积,即若矩阵的初等因子(同行按升幂排列)为
\begin{gather*}
(x-\lambda _1)^{n_{11}},(x-\lambda _1)^{n_{12}},\cdots ,(x-\lambda _1)^{n_{1k_1}}; 
\\
(x-\lambda _2)^{n_{21}},(x-\lambda _2)^{n_{22}},\cdots ,(x-\lambda _2)^{n_{2k_2}}; 
\\
\cdots \cdots \cdots \cdots 
\\
(x-\lambda _s)^{n_{s1}},(x-\lambda _s)^{n_{s2}},\cdots ,(x-\lambda _s)^{n_{sk_s}}.
\end{gather*}
其中\(\lambda_1,\lambda_2,\cdots,\lambda_s\)为不同特征值，
则极小多项式为
\begin{align}\label{eq:::342424241241341241}
m(x)=(x-\lambda _1)^{n_{1k_1}}(x-\lambda _2)^{n_{2k_2}}\cdots (x-\lambda _s)^{n_{sk_s}}.
\end{align}
\end{theorem}
\begin{proof}
首先证明特征多项式,根据不变因子和行列式因子的定义可知
\begin{align*}
1\cdot 1\cdot d_1(\lambda)d_2(\lambda)\cdots d_k(\lambda)=D_n(\lambda).
\end{align*}
其中$D_n(\lambda)$为$\lambda I_n-A$的$n$阶行列式因子,即$A$的特征多项式$|\lambda I_n-A|$.
因此
\begin{align*}
|\lambda I_n-A|=d_1(\lambda)d_2(\lambda)\cdots d_k(\lambda).
\end{align*}
然后证明极小多项式,设 $A$ 的有理标准型为
\begin{align*}
F = \begin{pmatrix}
F_1 & & & \\
& F_2 & & \\
& & \ddots & \\
& & & F_k
\end{pmatrix}.
\end{align*}
因为相似矩阵有相同的极小多项式，故只需证明 $F$ 的极小多项式是 $d_k(\lambda)$ 即可。但 $F$ 是分块对角阵，由\hyperref[proposition:极小多项式的性质]{极小多项式的性质(6)}知 $F$ 的极小多项式是诸 $F_i$ 极小多项式的最小公倍式。又由\reflem{lemma:Frobenius标准型矩阵的极小多项式和不变因子} 知 $F_i$ 的极小多项式为 $d_i(\lambda)$。因为 $d_i(\lambda)\mid d_{i + 1}(\lambda)$，故诸 $d_i(\lambda)$ 的最小公倍式等于 $d_k(\lambda)$。

再由$d_i\mid d_{i+1}$和$(x-\lambda_i)|m(x)$易知\eqref{eq:::342424241241341241}式成立.

\end{proof}

\begin{example}
下面两个 4 阶矩阵
\[
A = \begin{pmatrix}
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 1 \\
0 & 0 & 0 & 0
\end{pmatrix}, \quad
B = \begin{pmatrix}
0 & 1 & 0 & 0 \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 1 \\
0 & 0 & 0 & 0
\end{pmatrix}
\]
的不变因子分别为 $A$：$1,\lambda,\lambda,\lambda^2$ 和 $B$：$1,1,\lambda^2,\lambda^2$。它们的特征多项式和极小多项式分别相等，但它们不相似。 
\end{example}

\begin{definition}[循环子空间]\label{definition:循环子空间和循环空间}
设 \(V\) 是数域 \(\mathbb{K}\) 上的 \(n\) 维线性空间，\(\varphi\) 是 \(V\) 上的线性变换。设 \(\mathbf{0}\neq\alpha\in V\)，则 \(U = L(\alpha,\varphi(\alpha),\varphi^2(\alpha),\cdots)\) 称为 \(V\) 的\textbf{循环子空间}，记为 \(U = C(\varphi,\alpha)\)，\(\alpha\) 称为 \(U\) 的\textbf{循环向量}。
若 \(U = V\)，则称 \(V\) 为\textbf{循环空间}。 
\end{definition}

\begin{theorem}[循环子空间的基本性质]\label{theorem:循环子空间的基本性质}
设 \(V\) 是数域 \(\mathbb{K}\) 上的 \(n\) 维线性空间，\(\varphi\) 是 \(V\) 上的线性变换,\(\mathbf{0}\neq\alpha\in V\)， \(U = C(\varphi,\alpha)\) 为循环子空间,则循环子空间 \(U\) 是 \(V\) 的 \(\varphi\)-不变子空间，并且是包含 \(\alpha\) 的最小 \(\varphi\)-不变子空间。
\end{theorem}
\begin{proof}
\(U\) 是 \(V\) 的 \(\varphi\)-不变子空间是显然的.下证\(U\) 是包含 \(\alpha\) 的最小 \(\varphi\)-不变子空间。

设$\alpha \in W$,且$W$为$\varphi$-不变子空间,则由数学归纳法易知
\begin{align*}
\alpha,\varphi^k(\alpha)\in W,\forall k\in \mathbb{N}_1.
\end{align*}
于是
\begin{align*}
U=L(\alpha,\varphi(\alpha),\cdots)\in W.
\end{align*}

\end{proof}

\begin{theorem}\label{theorem:循环子空间的基}
设 \(V\) 是数域 \(\mathbb{K}\) 上的 \(n\) 维线性空间，\(\varphi\) 是 \(V\) 上的线性变换,\(\mathbf{0}\neq\alpha\in V\)， \(U = C(\varphi,\alpha)\) 为循环子空间，若$\varphi$的极小多项式的次数或$\dim U$为$r$,则\(\{\alpha,\varphi(\alpha),\cdots,\varphi^{r - 1}(\alpha)\}\) 是 \(U\) 的一组基。
\end{theorem}
\begin{proof}
(1)若$\dim U$为$r$,则设 \(m = \max\{k\in\mathbb{Z}^+\mid\alpha,\varphi(\alpha),\cdots,\varphi^{k - 1}(\alpha)\text{ 线性无关}\}\)，则显然$1\leqslant  m\leqslant  r$,故$m$是良定义的.于是由\refpro{proposition:线性无关向量组的命题1}和数学归纳法容易验证：对任意的 \(k\geqslant  m\)，\(\varphi^k(\alpha)\) 都是 \(\alpha,\varphi(\alpha),\cdots,\varphi^{m - 1}(\alpha)\) 的线性组合，于是 \(\{\alpha,\varphi(\alpha),\cdots,\varphi^{m - 1}(\alpha)\}\) 是 \(U\) 的一组基，从而 \(m = \dim U = r\)。 

(2)若$\varphi$的极小多项式$p$的次数为$r$,则设$\sum_{i=0}^{r-1}c_i\varphi^i(\alpha)=0$，其中$c_i$不全为零，则$\sum_{i=0}^{r-1}c_ix^i$就是$\varphi$的零化多项式。注意到$m_{\varphi}|\sum_{i=0}^{r-1}c_ix^i$，故$\deg\,m_{\varphi}=r>r-1=\deg\sum_{i=0}^{r-1}c_ix^i$。故$\sum_{i=0}^{r-1}c_ix^i=0$，即$c_i=0$。故$I,A,\cdots,A^{r-1}$线性无关。因此结论得证。

\end{proof}

\begin{theorem}\label{theorem:不变子空间是循环子空间的充要条件}
设 \(U\) 是 \(V\) 的 \(\varphi\)-不变子空间，求证：\(U\) 为循环子空间的充要条件是 \(\varphi|_U\) 在 \(U\) 的某组基下的表示矩阵为某个首一多项式的友阵.
\end{theorem}
\begin{proof}
{\heiti 充分性：}设 \(\varphi|_U\) 在 \(U\) 的一组基 \(\{e_1,e_2,\cdots,e_r\}\) 下的表示矩阵是友阵 \(C(d(\lambda))\)，其中 \(d(\lambda)=\lambda^r + a_1\lambda^{r - 1}+\cdots + a_{r - 1}\lambda + a_r\)，则由\hyperref[proposition:多项式的友矩和Frobenius块]{友阵的定义}可知 \(\varphi(e_i)=e_{i + 1}(1\leqslant  i\leqslant  r - 1)\)，\(\varphi(e_r)=-\sum_{i = 1}^{r}a_{r - i + 1}e_i\)。因此 \(e_i=\varphi^{i - 1}(e_1)(2\leqslant  i\leqslant  r)\)，\(U = L(e_1,e_2,\cdots,e_r)=C(\varphi,e_1)\) 为循环子空间。

{\heiti 必要性：}设 \(U = C(\varphi,\alpha)\) 是 \(r\) 维循环子空间，则由\refthe{theorem:循环子空间的基}可知，\(\{\alpha,\varphi(\alpha),\cdots,\varphi^{r - 1}(\alpha)\}\) 是 \(U\) 的一组基。设 
\[
\varphi^r(\alpha)=-a_r\alpha - a_{r - 1}\varphi(\alpha)-\cdots - a_1\varphi^{r - 1}(\alpha)
\]
令 \(d(\lambda)=\lambda^r + a_1\lambda^{r - 1}+\cdots + a_{r - 1}\lambda + a_r\)，容易验证：\(\varphi|_U\) 在基 \(\{\alpha,\varphi(\alpha),\cdots,\varphi^{r - 1}(\alpha)\}\) 下的表示矩阵就是友阵 \(C(d(\lambda))\)。

\end{proof}

\begin{theorem}[有理标准型的几何意义]\label{theorem:有理标准型的几何意义}
设 \(V\) 是数域 \(\mathbb{K}\) 上的 \(n\) 维线性空间，\(\varphi\) 是 \(V\) 上的线性变换, 且 \(\varphi\) 的不变因子组是 \(1,\cdots,1,d_1(\lambda),\cdots,d_k(\lambda)\)，其中 \(d_i(\lambda)\) 是非常数首一多项式，$d_i(\lambda)$ $\mid$ $d_{i + 1}(\lambda)$ $(1$ $\leqslant $ $i\leqslant $  $k - 1)$，则\(V\) 存在一个循环子空间的直和分解：
\begin{align}
V = C(\varphi,\alpha_1)\oplus C(\varphi,\alpha_2)\oplus\cdots\oplus C(\varphi,\alpha_k)\label{equation---:::::7.6}
\end{align}
使得 \(\varphi|_{C(\varphi,\alpha_i)}\) 在基 \(\{\alpha_i,\varphi(\alpha_i),\cdots,\varphi^{r_i - 1}(\alpha_i)\}\) 下的表示矩阵就是友阵 \(C(d_i(\lambda))\)，其中 \(r_i = \dim C(\varphi,\alpha_i)\)。
\end{theorem}
\begin{note}
线性变换 \(\varphi\) 的有理标准型诱导的 \(V\) 的上述循环子空间直和分解 \eqref{equation---:::::7.6}就是有理标准型的几何意义。 
\end{note}
\begin{proof}
由\refthe{theorem:有理标准型核心定理}可知，存在 \(V\) 的一组基$\{e_1,e_2,\cdots,e_n\}$，使得 \(\varphi\) 在这组基下的表示矩阵为
\[
C=\mathrm{diag}\{C(d_1(\lambda)),C(d_2(\lambda)),\cdots,C(d_k(\lambda))\}
\]
其中\(\varphi|_{L(e_{i1},\cdots,e_{ir_i})}\) 的表示矩阵就是友阵 \(C(d_i(\lambda))\)，\(i = 1,2,\cdots,k\)。再结合\refthe{theorem:不变子空间是循环子空间的充要条件}的讨论可知，\(L(e_{i1},\cdots,e_{ir_i})\) 就是一个循环子空间。于是任取 \(\alpha_i\in L(e_{i1},\cdots,e_{ir_i})\) 作为循环向量，则
\[
C(\varphi,\alpha_i)=L(e_{i1},\cdots,e_{ir_i})=L(\alpha_i,\varphi(\alpha_i),\cdots,\varphi^{r_i - 1}(\alpha_i))
\]
其中 \(\dim C(\varphi,\alpha_i)=r_i\)。

综上可知,此时 \(V\) 存在一个循环子空间的直和分解：
\begin{align*}
V = C(\varphi,\alpha_1)\oplus C(\varphi,\alpha_2)\oplus\cdots\oplus C(\varphi,\alpha_k)
\end{align*}
使得 \(\varphi|_{C(\varphi,\alpha_i)}\) 在基 \(\{\alpha_i,\varphi(\alpha_i),\cdots,\varphi^{r_i - 1}(\alpha_i)\}\) 下的表示矩阵就是友阵 \(C(d_i(\lambda))\)，其中 \(r_i = \dim C(\varphi,\alpha_i)\)。

\end{proof}

\begin{theorem}[循环子空间的刻画]\label{theorem:循环子空间的刻画}
设 \(A\) 是数域 \(\mathbb{K}\) 上 \(n\) 维线性空间 \(V\) 上的线性变换，\(A\) 的特征多项式和极小多项式分别为 \(f(x)\) 和 \(m(x)\)，证明以下 几个结论等价：
\begin{enumerate}[(1)]
\item \(A\) 的行列式因子组或不变因子组为 \(1,\cdots,1,f(x)\)；

\item \(A\) 的初等因子组为 \(P_1(x)^{r_1},P_2(x)^{r_2},\cdots,P_k(x)^{r_k}\)，其中 \(P_i(x)\) 是 \(\mathbb{K}\) 上互异的首一不可约多项式，\(r_i\geqslant 1\)，\(1\leqslant  i\leqslant  k\)； 

\item \(A\) 的极小多项式 \(m(x)\) 等于特征多项式 \(f(x)\)； 

\item \(V\) 是关于线性变换 \(A\) 的循环空间;

\item 存在 \( \alpha \in V \)，使得 \( \{ \alpha, A\alpha, \cdots, A^{n - 1}\alpha \} \) 为 \( V \) 一组基;

\item \(A\) 的任一特征值 \( \lambda \)的几何重数都是1.
\end{enumerate}
\end{theorem}
\begin{proof}
\((1)\Leftrightarrow(2)\)：由不变因子和初等因子之间的相互转换即得。

\((1)\Leftrightarrow(3)\)：由极小多项式等于最大的不变因子，以及所有不变因子的乘积等于特征多项式即得。 

\((1)\Leftrightarrow(4)\)：若 \(V\) 是循环空间，则由\refthe{theorem:不变子空间是循环子空间的充要条件}可知，\(A\) 在某组基下的表示矩阵是友阵 \(C(g(x))\)，再由友阵的性质(\reflem{lemma:Frobenius标准型矩阵的极小多项式和不变因子})可知，\(A\) 的行列式因子组和不变因子组均为 \(1,\cdots,1,g(x)=f(x)\)。若 \(A\) 的不变因子组为 \(1,\cdots,1,f(x)\)，则由有理标准型的几何意义(\refthe{theorem:有理标准型的几何意义})可知，\(V\) 是循环空间.

\((4)\Leftrightarrow(5)\):由\refthe{theorem:循环子空间的基}知必要性成立.充分性由\hyperref[definition:循环子空间和循环空间]{循环子空间的定义}立得.

\((3)\Leftrightarrow(6)\):{\heiti 充分性:}设$A$的特征多项式等于极小多项式为$f\left( x \right)$,不妨设
\begin{align*}
f\left( x \right) =\prod_{i=1}^s{\left( x-\lambda _i \right) ^{n_i}},1\leqslant n_i\leqslant n.
\end{align*}
则由\refpro{proposition:极小多项式对应Jordan标准型的最大块}可知，$n_i$是$A$的Jordan标准型中所有特征值为$\lambda _i$的Jordan块的最大阶数.而$\lambda_i$的代数重数也是$n_i$,即所有特征值为$\lambda_i$的Jordan块的阶数之和为$n_i$.因此特征值为$\lambda_i$的Jordan块只有一个,即$\lambda_i(1\leqslant i\leqslant s)$的几何重数为1.

{\heiti 必要性:}设$A$的特征多项式为$f\left( x \right)$，极小多项式为$m\left( x \right)$，不妨设
\begin{align*}
f\left( x \right) =\prod_{i=1}^s{\left( x-\lambda _i \right) ^{n_i}},m\left( x \right) =\prod_{i=1}^s{\left( x-\lambda _i \right) ^{c_i}},1\leqslant n_i\leqslant n.
\end{align*}
则由条件可知$A$的Jordan标准型中特征值为$\lambda _i$的Jordan块只有一个，且阶数为$n_i$。又由\refpro{proposition:极小多项式对应Jordan标准型的最大块}可知，$c_i$是$A$的Jordan标准型中所有特征值为$\lambda _i$的Jordan块的最大阶数，但是特征值为$\lambda _i$的Jordan块只有一个，故$c_i=n_i\left( 1\leqslant i\leqslant s \right)$。因此$f\left( x \right) =m\left( x \right)$。

\((5)\Leftrightarrow(6)\):{\heiti 必要性:}
由条件知存在$(a_1,a_2,\cdots,a_{n})^T \in \mathbb{C}^n$，使得
\begin{align*}
A^n\alpha = -a_{n}\alpha -a_{n-1}A\alpha -\cdots -a_1A^{n-1}\alpha.
\end{align*}
则$A$在基$\{\alpha,A\alpha,\cdots,A^{n-1}\alpha\}$下的表示矩阵为
$$A=\begin{pmatrix} 0 & 0 & \cdots & 0 & -a_n \\ 1 & 0 & \cdots & 0 & -a_{n-1} \\ 0 & 1 & \cdots & 0 & -a_{n-2} \\ \vdots & \vdots & \ddots & \vdots & \vdots \\ 0 & 0 & \cdots & 1 & -a_1 \end{pmatrix} \Longrightarrow \lambda E - A = \begin{pmatrix} \lambda & 0 & \cdots & 0 & a_n \\ -1 & \lambda & \cdots & 0 & a_{n-1} \\ 0 & -1 & \cdots & 0 & a_{n-2} \\ \vdots & \vdots & \ddots & \vdots & \vdots \\ 0 & 0 & \cdots & -1 & \lambda + a_1 \end{pmatrix}.$$
注意到$\lambda E - A$有一个不为0的$n-1$阶子式，且此时$|\lambda E - A| = 0$，故$r(A) = n-1$。因此$\lambda$的几何重数为$n - r(\lambda E - A) = 1$。

{\heiti 充分性：}反证，设$ \alpha \in V$有$\{\alpha, A\alpha, \cdots, A^n\alpha\}$线性相关，则存在$(a_0, a_1, \cdots, a_{n-1})^T \neq 0$，使
$$a_0\alpha + a_1A\alpha + \cdots + a_{n-1}A^{n-1}\alpha = 0.$$
记$g(x) = a_0 + a_1x + \cdots + a_{n-1}x^{n-1}$，则$f(A) = 0$。由条件知$A$的Jordan标准型为
\begin{align*}
J=\left( \begin{matrix}
J_{r_1}(\lambda _1)&		&		\\
&		\ddots&		\\
&		&		J_{r_s}(\lambda _s)\\
\end{matrix} \right) ,\,\text{其中}J_{r_i}(\lambda _i)=\left( \begin{matrix}
\lambda _i&		1&		&		\\
&		\lambda _i&		\ddots&		\\
&		&		\ddots&		1\\
&		&		&		\lambda _i\\
\end{matrix} \right) _{r_i\times r_i},\,\sum_{i=1}^s{r_i}=n\text{且}\lambda _i\text{互不相同}.
\end{align*}
于是由\hyperref[proposition:极小多项式的性质]{极小多项式的性质(6)}知$A$的极小多项式等于
$$m(x) = (x - \lambda_1)^{r_1} \cdots (x - \lambda_s)^{r_s}=f(x).$$
又$g(A) = 0$，故$m(x) \mid f(x)$，但$\deg m = n > \deg g = n-1$，因此$f \equiv 0$。
即$(a_1, \cdots, a_{n-1})^T = 0$，矛盾！

\end{proof}









\end{document}
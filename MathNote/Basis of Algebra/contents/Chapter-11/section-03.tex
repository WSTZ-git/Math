\documentclass[../../main.tex]{subfiles}
\graphicspath{{\subfix{../../image/}}} % 指定图片目录,后续可以直接使用图片文件名。

% 例如:
% \begin{figure}[H]
% \centering
% \includegraphics[scale=0.4]{图.png}
% \caption{}
% \label{figure:图}
% \end{figure}
% 注意:上述\label{}一定要放在\caption{}之后,否则引用图片序号会只会显示??.

\begin{document}

\section{其他}

\begin{theorem}\label{theorem:中国剩余定理推广(模不互质的情况)}
设$\mathbb{F}$是一个域,$m_i,a_i\in \mathbb{F}[x],i=1,2,\cdots,n$,且$\mathrm{gcd}\left( m_i,m_j \right) |\left( a_i-a_j \right) ,i,j\in \left\{ 1,2,\cdots ,n \right\}$,则存在$f\in\mathbb{F}[x]$使得
$$
f(x)\equiv a_i(x)\pmod{m_i(x)},i=1,2,\cdots,n,
$$
即存在$k_i\in\mathbb{F}[x]$使得
$$
f(x)=k_i(x)m_i(x)+a_i(x),i=1,2,\cdots,n.
$$
\end{theorem}
\begin{proof}


\end{proof}

\begin{example}
设 \( \boldsymbol{A}_1, \boldsymbol{A}_2, \cdots, \boldsymbol{A}_m \in M_n(\mathbb{K}) \)，\( g(x) \in \mathbb{K}[x] \)，使得 \( g(\boldsymbol{A}_1), g(\boldsymbol{A}_2), \cdots, g(\boldsymbol{A}_m) \) 都是非异阵. 试用两种方法证明: 存在 \( h(x) \in \mathbb{K}[x] \)，使得 \( g(\boldsymbol{A}_i)^{-1} = h(\boldsymbol{A}_i) \) 对所有的 \( 1 \leq i \leq m \) 都成立.
\end{example}
\begin{proof}
{\color{blue}证法一:}由\refpro{proposition:矩阵的逆可以用其多项式表示}可知，对\(\forall i\in \{1,2,\cdots ,m\}\)，存在\(h_i\in \mathbb{K}[x]\)，使得
\begin{align}
g^{-1}(A_i) = h_i(A_i). \label{eq:107.105}
\end{align}
记\(A_i\)的极小多项式为\(n_i(x)\)，\(i=1,2,\cdots,m\)。考虑\(\gcd(n_i,n_j)\)（\(i,j\in \{1,2,\cdots ,m\}\)），设\(x_0\in \mathbb{C}\)是\(\gcd(n_i,n_j)\)的根，则\((x-x_0)|n_i,n_j\)，即\(x_0\)是\(A_i\)和\(A_j\)的公共特征值。
由\refpro{proposition:矩阵多项式的特征值就是原特征值代入多项式得到的数}和\refpro{proposition:逆矩阵的特征值}可知，\(h_i(x_0)\)是\(h_i(A_i)\)的特征值，\(\frac{1}{g(x_0)}\)是\(g^{-1}(A_i)\)的特征值。再由\eqref{eq:107.105}式可知
\begin{align*}
g^{-1}(A_i) = h_i(A_i) \Longrightarrow \frac{1}{g(x_0)} = h_i(x_0),\quad i=1,2,\cdots,m.
\end{align*}
于是
\begin{align*}
h_i(x_0) - h_j(x_0) = \frac{1}{g(x_0)} - \frac{1}{g(x_0)} = 0.
\end{align*}
因此\((x-x_0)|(h_i - h_j)\)。故在\(\mathbb{C}\)上就有\(\gcd(n_i,n_j)|(h_i - h_j)\)。又因为整除不随数域扩张而改变，所以在\(\mathbb{K}\)上也有\(\gcd(n_i,n_j)|(h_i(x) - h_j(x))\)。于是由\hyperref[theorem:中国剩余定理推广(模不互质的情况)]{中国剩余定理的推广}可知，方程
\begin{align*}
h(x) \equiv h_i(x) \pmod{n_i(x)},\quad i=1,2,\cdots,m
\end{align*}
在\(\mathbb{K}\)上有解。故存在\(h\in \mathbb{K}[x]\)，使得
\begin{align*}
h(A_i) = h_i(A_i) = g^{-1}(A_i),\quad i=1,2,\cdots,m.
\end{align*}

{\color{blue}证法二:}记\(A_i\)的极小多项式为\(n_i(x)\)，\(i=1,2,\cdots,m\),由\refpro{proposition:g(A)可逆与A的特征多项式与极小多项式的关系}可知
\begin{align*}
(n_i,g)=1,i=1,2,\cdots,m.
\end{align*}
从而$\left( n_1n_2\cdots n_m,g \right) =1$.因此存在$h,k\in \mathbb{F}[x]$,使得
\begin{align*}
h\left( x \right) g\left( x \right) +n_1\left( x \right) n_2\left( x \right) \cdots n_m\left( x \right) k\left( x \right) =1.
\end{align*}
从而
\begin{align*}
h\left( A_i \right) =g^{-1}\left( A_i \right) ,i=1,2,\cdots ,m.
\end{align*}

\end{proof}

\begin{proposition}\label{proposition:与主对角元都为0的上三角阵相似的矩阵一定是幂零阵}
设$n\in \mathbb{N}$且$A\in \mathbb{C}^{n\times n}$,若$A\sim \widetilde{A}$,其中$\widetilde{A}$是主对角元都为0的上三角阵,则$A$是幂零矩阵.
\end{proposition}
\begin{proof}
由条件可知存在可逆阵$P$,使得$A=P^{-1}\widetilde{A}P$.从而根据矩阵乘法易得
\begin{align*}
A^n=P^{-1}\widetilde{A}^nP=O.
\end{align*}
故$A$是幂零矩阵.

\end{proof}

\begin{example}
设 $n \in \mathbb{N}$ 且 $A, B \in \mathbb{C}^{n \times n}$ 满足
\[
AB + A = BA + B.
\]
证明:
\[
(A - B)^n = 0.
\]
\end{example}
\begin{proof}
注意到
\[
AB - BA = B - A.
\]
由\refpro{proposition:两个矩阵可同时上三角化的条件}知 $A, B$ 可同时相似上三角化. 不妨设 $A, B$ 都是上三角矩阵, 由\hyperref[proposition:上三角阵性质]{上三角阵的性质}可知$AB-BA$也是上三角阵且主对角元都为0.再由上式可知$A - B$是对角线全为0的上三角阵,故由\refpro{proposition:与主对角元都为0的上三角阵相似的矩阵一定是幂零阵}知$A-B$是幂零矩阵. 现在我们知道
\[
(A - B)^n = 0.
\]

\end{proof}

\begin{example}
设 \( A \in \mathbb{R}^{n \times n} \) 是对角矩阵. 考虑
\[
S(A) \triangleq \{ P^{-1}AP : P \in \mathbb{R}^{n \times n} \text{是可逆矩阵} \}.
\]
证明: \( S(A) \) 在 \( \mathbb{R}^{n \times n} \) 中是闭集. 反过来, 如果 \( S(A) \) 是闭集, 证明 \( A \) 在 \( \mathbb{C} \) 上一定可对角化.
\end{example}
\begin{proof}
设 \( A \) 的极小多项式为 \( m \), 特征多项式为 \( p \),则由知$m$无重根.设 \( A_k \in S(A), k = 1,2,\cdots \) 满足
\[
\lim_{k \to \infty} A_k = \tilde{A}.
\]
由\refthe{theorem:复矩阵极限的性质}知
\begin{gather*}
m(\tilde{A})=\lim_{k\rightarrow \infty} m(A_k)=0,
\\
\left| \lambda I-\tilde{A} \right|=\left| \lambda I-\lim_{k\rightarrow \infty} A_k \right|=\lim_{k\rightarrow \infty} \left| \lambda I-A_k \right|=\lim_{k\rightarrow \infty} \left| \lambda I-A \right|=\left| \lambda I-A \right|=p\left( \lambda \right) .
\end{gather*}
因此\( \tilde{A} \) 的特征多项式也是 \( p \),\( \tilde{A} \) 极小多项式整除$m$,从而\( \tilde{A} \) 极小多项式也无重根.  因此 \( \tilde{A} \) 和 \( A \) 有相同的特征值且可对角化, 故 \( \tilde{A} \in S(A) \).

反之, 如果 \( S(A) \) 是闭的,
由\hyperref[theorem:实数域上的广义Jordan标准型]{实数域上的广义Jordan标准型}知,$A$ 在实数域$\mathbb{R}$上相似于下列分块对角矩阵:
\begin{align*}
\widetilde{J} = \mathrm{diag}\{J_{r_1}(\lambda_1),\cdots,J_{r_k}(\lambda_k),\widetilde{J}_{s_1}(a_1,b_1),\cdots,\widetilde{J}_{s_l}(a_l,b_l)\},
\end{align*}
其中 $\lambda_1,\cdots,\lambda_k,a_1,b_1,\cdots,a_l,b_l$ 都是实数，$b_1,\cdots,b_l$ 都非零,且$\lambda_j$都是$A$的实特征值,$a_j\pm \mathrm{i}b_j$都是$A$的复特征值,$J_{r_i}(\lambda_i)$ 表示以 $\lambda_i$ 为特征值的通常意义下的 Jordan 块，并且
\begin{gather*}
c_j=-2a_j,d_j=a_j^2+b_j^2,
\quad
R_j = \left( \begin{matrix}
0&		-d_j\\
1&		-c_j\\
\end{matrix} \right),C_2 = \begin{pmatrix}0 & 0 \\ 1 & 0\end{pmatrix},
\\
\widetilde{J}_{s_j}(a_j,b_j) = 
\begin{pmatrix}
R_j & C_2 & & \\
& R_j & C_2 & \\
& & \ddots & \ddots \\
& & & R_j & C_2 \\
& & & & R_j
\end{pmatrix}.
\end{gather*}
对于$J_{r_j}(\lambda_j)$,在实数域上,我们有
\begin{align*}
J_{r_j}\left( \lambda _j \right) \sim \left( \begin{matrix}
\lambda _j&		\frac{1}{n}&		&		\\
&		\lambda _j&		\ddots&		\\
&		&		\ddots&		\frac{1}{n}\\
&		&		&		\lambda _j\\
\end{matrix} \right)\triangleq J_{r_j}^{(n)}(\lambda_j),\forall n\in \mathbb{N} .
\end{align*}
对于$\widetilde{J}_{s_j}(a_j,b_j)$,在实数域上,我们有
\begin{align*}
J_{s_j}\left( a_j,b_j \right) \sim {\scriptsize \left( \begin{matrix}
0&		-d_j&		&		&		&		&		&		&		\\
1&		-c_j&		\frac{1}{n}&		&		&		&		&		&		\\
&		&		0&		-d_j&		&		&		&		&		\\
&		&		1&		-c_j&		\frac{1}{n}&		&		&		&		\\
&		&		&		&		\ddots&		&		&		&		\\
&		&		&		&		&		0&		-d_j&		&		\\
&		&		&		&		&		1&		-c_j&		\frac{1}{n}&		\\
&		&		&		&		&		&		&		0&		-d_j\\
&		&		&		&		&		&		&		1&		-c_j\\
\end{matrix} \right)}\triangleq J_{s_j}^{(n)}(a_j,b_j) ,\forall n\in \mathbb{N} .
\end{align*}
于是在实数域上,就有
\begin{align*}
A\sim \widetilde{J}\sim \mathrm{diag}\{J_{r_1}^{\left( n \right)}(\lambda _1),\cdots ,J_{r_k}^{\left( n \right)}(\lambda _k),\widetilde{J}_{s_1}^{\left( n \right)}(a_1,b_1),\cdots ,\widetilde{J}_{s_l}^{\left( n \right)}(a_l,b_l)\}\triangleq \widetilde{J}^{\left( n \right)},\forall n\in \mathbb{N}.
\end{align*}
故$ \widetilde{J}^{\left( n \right)}\in S(A)$.因为$S(A)$是闭集,所以$\underset{n\rightarrow +\infty}{\lim}\widetilde{J}^{\left( n \right)}\in S\left( A \right) .$
不难发现
\begin{gather*}
\underset{n\rightarrow +\infty}{\lim}J_{r_j}^{(n)}\left( a_j,b_j \right) =\left( \begin{matrix}
\lambda _j&		&		&		\\
&		\lambda _j&		&		\\
&		&		\ddots&		\\
&		&		&		\lambda _j\\
\end{matrix} \right) ,
\\
\underset{n\rightarrow +\infty}{\lim}J_{s_j}^{(n)}\left( a_j,b_j \right) ={\scriptsize \left( \begin{matrix}
0&		-d_j&		&		&		&		&		\\
1&		-c_j&		&		&		&		&		\\
&		&		0&		-d_j&		&		&		\\
&		&		1&		-c_j&		&		&		\\
&		&		&		&		\ddots&		&		\\
&		&		&		&		&		0&		-d_j\\
&		&		&		&		&		1&		-c_j\\
\end{matrix} \right)} =\left( \begin{matrix}
R_j&		&		&		\\
&		R_j&		&		\\
&		&		\ddots&		\\
&		&		&		R_j\\
\end{matrix} \right) ,
\end{gather*}
注意到$R_j$的极小多项式等于
\begin{align*}
x^2+c_jx+d_j=(x-a_j)^2+b_j^2=\left( x-a_j-\mathrm{i}b_j \right) \left( x-a_j+\mathrm{i}b_j \right)
\end{align*}
在复数域$\mathbb{C}$上无重根,故$R_j$在复数域$\mathbb{C}$上可对角化,从而$\underset{n\rightarrow +\infty}{\lim}J_{s_j}^{(n)}\left( a_j,b_j \right)$在复数域$\mathbb{C}$上也可对角化.因此
\begin{align*}
\underset{n\rightarrow +\infty}{\lim}\widetilde{J}^{\left( n \right)}=\mathrm{diag}\{\underset{n\rightarrow +\infty}{\lim}J_{r_1}^{\left( n \right)}(\lambda _1),\cdots ,\underset{n\rightarrow +\infty}{\lim}J_{r_k}^{\left( n \right)}(\lambda _k),\underset{n\rightarrow +\infty}{\lim}\widetilde{J}_{s_1}^{\left( n \right)}(a_1,b_1),\cdots ,\underset{n\rightarrow +\infty}{\lim}\widetilde{J}_{s_l}^{\left( n \right)}(a_l,b_l)\}
\end{align*}
在复数域$\mathbb{C}$上可对角化.又$\underset{n\rightarrow +\infty}{\lim}\widetilde{J}^{\left( n \right)}\in S\left( A \right),$故$A$在复数域$\mathbb{C}$上相似于$\underset{n\rightarrow +\infty}{\lim}\widetilde{J}^{\left( n \right)}$.因此$A$在复数域$\mathbb{C}$上可对角化.

\end{proof}

\begin{example}
设 \( n \geq 2, A \in \mathbb{R}^{n \times n} \) 是实对称矩阵, \( v \in \mathbb{R}^{n \times n} \setminus \{0\} \). 证明:
\[
\text{tr}(A^TA) \geq \frac{2n - 1}{2n - 2} \cdot \frac{\|Av\|^2}{\|v\|^2} - \frac{1}{n - 1}[\text{tr}(A)]^2.
\]
\end{example}
\begin{proof}
不妨设 \( A \) 为实对角矩阵, 即
\[
A = \text{diag}\{\lambda_1, \lambda_2, \cdots, \lambda_n\}, \lambda_i \in \mathbb{R}, i = 1,2,\cdots, n.
\]
现在再设 \( v = \begin{pmatrix} v_1 \\ v_2 \\ \vdots \\ v_n \end{pmatrix} \), 我们有原不等式等价于
\begin{align*}
\sum\limits_{i=1}^n \lambda_i^2 \geq \frac{2n - 1}{2n - 2} \cdot \frac{\sum\limits_{i=1}^n \lambda_i^2 v_i^2}{\sum\limits_{i=1}^n v_i^2} - \frac{1}{n - 1} \left( \sum\limits_{i=1}^n \lambda_i \right)^2. 
\end{align*}
不妨设 \( \lambda_1 \) 是 \( \lambda_i, i = 1,2,\cdots, n \) 的最大值, 则
\[
\sum\limits_{i=1}^n \lambda_i^2 - \frac{2n - 1}{2n - 2} \cdot \frac{\sum\limits_{i=1}^n \lambda_i^2 v_i^2}{\sum\limits_{i=1}^n v_i^2} + \frac{1}{n - 1} \left( \sum\limits_{i=1}^n \lambda_i \right)^2 \geqslant \sum\limits_{i=1}^n \lambda_i^2 - \frac{2n - 1}{2n - 2} \cdot \lambda_1^2 + \frac{1}{n - 1} \left( \sum\limits_{i=1}^n \lambda_i \right)^2.
\]
于是打开上述右边括号知原不等式等价于
\begin{align}
&\quad \quad \sum\limits_{i=1}^n{\lambda _{i}^{2}}-\frac{2n-1}{2n-2}\cdot \lambda _{1}^{2}+\frac{1}{n-1}\left( \sum\limits_{i=1}^n{\lambda _i} \right) ^2\geqslant 0
\nonumber \\
&\Longleftrightarrow \sum\limits_{i=1}^n{\lambda _{i}^{2}}-\frac{2n-1}{2n-2}\cdot \lambda _{1}^{2}+\frac{1}{n-1}\left( \sum\limits_{i=1}^n{\lambda _{i}^{2}}+2\sum\limits_{1\le i<j\le n}{\lambda _i\lambda _j} \right) \geqslant 0
\nonumber \\
&\Longleftrightarrow \frac{1}{2n-2}\lambda _{1}^{2}+\frac{n}{n-1}\sum\limits_{i=2}^n{\lambda _{i}^{2}}+\frac{2}{n-1}\sum\limits_{1\le i<j\le n}{\lambda _i\lambda _j}\geqslant 0
\nonumber \\
&\Longleftrightarrow \lambda _{1}^{2}+2n\sum\limits_{i=2}^n{\lambda _{i}^{2}}+4\sum\limits_{1\le i<j\le n}{\lambda _i\lambda _j}\geqslant 0.\label{eq:::-----1568165435
3615-11}
\end{align}
上述关于 \( \lambda_i \) 的二次型矩阵为
\[
\begin{pmatrix} 1 & 2 & \cdots & 2 \\ 2 & 2n & \cdots & 2 \\ \vdots & \vdots & \ddots & \vdots \\ 2 & 2 & \cdots & 2n \end{pmatrix}.
\]
直接计算行列式得
\begin{align*}
&\left| \begin{matrix}
\lambda -1&		-2&		\cdots&		-2\\
-2&		\lambda -2n&		\cdots&		-2\\
\vdots&		\vdots&		\ddots&		\vdots\\
-2&		-2&		\cdots&		\lambda -2n\\
\end{matrix} \right|\xlongequal[i=2,3,\cdots ,n]{\left( -1 \right) r_1+r_i}\left| \begin{matrix}
\lambda -1&		-2&		\cdots&		-2\\
-\lambda -1&		\lambda -2n+2&		\cdots&		0\\
\vdots&		\vdots&		\ddots&		\vdots\\
-\lambda -1&		0&		\cdots&		\lambda -2n+2\\
\end{matrix} \right|
\\
&\xlongequal{\text{\hyperref["爪"型行列式]{“爪”型行列式}}}\left( \lambda -1 \right) \left( \lambda -2n+2 \right) ^{n-1}-2\left( n-1 \right) \left( \lambda +1 \right) \left( \lambda -2n+2 \right) ^{n-2}
\\
&=\left( \lambda -2n+2 \right) ^{n-2}\left[ \left( \lambda -1 \right) \left( \lambda -2n+2 \right) -2\left( n-1 \right) \left( \lambda +1 \right) \right] 
\\
&=\left( \lambda -2n+2 \right) ^{n-2}\lambda \left( \lambda -4n+3 \right) .
\end{align*}
现在矩阵特征值是
\[
0, 4n - 3, \underbrace{2n - 2, 2n - 2, \cdots, 2n - 2}_{n - 2 \text{个}}.\quad (n\geqslant 2)
\]
故矩阵的特征值全都大于等于0.于是矩阵半正定, 从而这个矩阵对应的二次型大于等于0.这就得到了不等式 \eqref{eq:::-----1568165435
3615-11}.

\end{proof}

\begin{proposition}\label{proposition:有理数域上线性变换与向量组线性无关的命题}
设$\alpha, \beta, \gamma \in \mathbb{Q}^3$且$\alpha \neq 0$. 若$A \in \mathbb{Q}^{3 \times 3}$满足
\begin{align*}
A\alpha =\beta ,A\beta =-\gamma ,A\gamma =\alpha -\beta \Longleftrightarrow A\alpha =\beta ,A\beta =\gamma ,A\gamma =\alpha +\beta .
\end{align*}
证明:$\alpha, \beta, \gamma$在$\mathbb{Q}$上线性无关.
\end{proposition}
\begin{note}
由\refpro{proposition:不可约多项式与向量组线性无关}可立得.
\end{note}
\begin{proof}
若$\alpha, \beta$在$\mathbb{Q}$上线性相关，则存在$k\in \mathbb{Q}$，使得$\beta =k\alpha$。从而由条件可得
\begin{align*}
A\alpha =\beta =k\alpha \Longrightarrow A\beta =kA\alpha =k^2\alpha =-\gamma 
\Longrightarrow A\gamma =\alpha -\beta =\left( 1-k \right) \alpha =-k^2A\alpha =-k^3\alpha .
\end{align*}
于是就有$\left( k^3-k+1 \right) \alpha =0$。又$\alpha \ne 0$，故$k^3-k+1=0$。但这个方程没有有理根，矛盾！故$\alpha, \beta$在$\mathbb{Q}$上线性无关。

若$\alpha, \beta, \gamma$在$\mathbb{Q}$上线性相关，则存在$a,b\in \mathbb{Q}$，使得$\gamma =a\alpha +b\beta$。由条件可得
\begin{align*}
A\gamma =\alpha -\beta =aA\alpha +bA\beta =a\beta -b\gamma =a\beta -b\left( a\alpha +b\beta \right) =-ab\alpha +\left( a+b^2 \right) \beta .
\end{align*}
因此
\begin{align*}
ab=1,\quad a+b^2=-1\Longrightarrow a+\frac{1}{a^2}=-1\Longrightarrow a^3-a^2+1=0,
\end{align*}
而上式无有理根，矛盾！故$\alpha, \beta, \gamma$在$\mathbb{Q}$上线性无关。

\end{proof}

\begin{example}
设$V$是$\mathbb{Q}$上4维空间，$\varphi$是$V$上的线性变换. 若
$$\alpha_i \in V, i = 1,2,3,4,5.$$
且满足
\begin{gather*}
\alpha _1\ne 0,\quad \alpha _4\ne \alpha _1+\alpha _2,\quad \varphi \alpha _1=\alpha _2,\quad \varphi \alpha _2=\alpha _3,
\\
\varphi \alpha _3=\alpha _1+\alpha _2,\quad \varphi \alpha _4=\alpha _5,\quad \varphi \alpha _5=\alpha _3+\alpha _4.
\end{gather*}
求$\det \varphi$.
\end{example}
\begin{proof}
由\refpro{proposition:有理数域上线性变换与向量组线性无关的命题}或\refpro{proposition:不可约多项式与向量组线性无关}可知
$\alpha_1,\alpha_2,\alpha_3$线性无关.若$\alpha_4\in \mathrm{span}\{\alpha_1,\alpha_2,\alpha_3\}$,设
$\alpha_4=a\alpha_1+b\alpha_2+c\alpha_3,\quad a,b,c\in \mathbb{Q}.$
由条件可得
\begin{align*}
\varphi \alpha_4=\alpha_5\Longrightarrow \varphi^2\alpha_4=\varphi \alpha_5=\alpha_3+\alpha_4=a\alpha_1+b\alpha_2+(c+1)\alpha_3,
\end{align*}
\begin{align*}
\varphi^2\alpha_4=\varphi^2(a\alpha_1+b\alpha_2+c\alpha_3)=\varphi\left(c\alpha_1+(a+c)\alpha_2+b\alpha_3\right)=b\alpha_1+(b+c)\alpha_2+(a+c)\alpha_3.
\end{align*}
从而
\begin{align*}
a=b\quad ,b=b+c,\quad c+1=a+c\Longrightarrow a=b=1,\quad c=0.
\end{align*}
故$\alpha_4=\alpha_1+\alpha_2$与条件矛盾!因此$\alpha_1,\alpha_2,\alpha_3,\alpha_4$线性无关.又因为$V$是$\mathbb{Q}$上$4$维空间,所以$\alpha_1,\alpha_2,\alpha_3,\alpha_4$就是$V$的一组基.从而
\begin{align*}
\varphi\left( \alpha_1,\alpha_2,\alpha_3,\alpha_4 \right)=\left( \alpha_1,\alpha_2,\alpha_3,\alpha_4 \right)\begin{pmatrix}
0&		0&		1&		x\\
1&		0&		1&		y\\
0&		1&		0&		z\\
0&		0&		0&		m\\
\end{pmatrix},
\end{align*}
其中$x,y,z,m\in \mathbb{Q}$.由条件可知
\begin{align*}
\varphi^2\alpha_4=\varphi \alpha_5=\alpha_3+\alpha_4.
\end{align*}
于是$\varphi^2\alpha_4$的在基$\alpha_1,\alpha_2,\alpha_3,\alpha_4$下的坐标就是
\begin{align*}
\begin{pmatrix}
0&		0&		1&		x\\
1&		0&		1&		y\\
0&		1&		0&		z\\
0&		0&		0&		m\\
\end{pmatrix}^2 \left( \begin{array}{c}
0\\
0\\
0\\
1\\
\end{array} \right) =\left( \begin{array}{c}
0\\
0\\
1\\
1\\
\end{array} \right) \Longleftrightarrow \left( \begin{array}{c}
z+xm\\
x+z+ym\\
y+zm\\
m^2\\
\end{array} \right) =\left( \begin{array}{c}
0\\
0\\
1\\
1\\
\end{array} \right) .
\end{align*}
解得$(x,y,z,m)^T=(-1,0,1,1)^T$或$(1,2,1,-1)^T$.故
\begin{align*}
\det \varphi=\begin{vmatrix}
0&		0&		1&		-1\\
1&		0&		1&		0\\
0&		1&		0&		1\\
0&		0&		0&		1\\
\end{vmatrix}=-1\text{或}\begin{vmatrix}
0&		0&		1&		1\\
1&		0&		1&		2\\
0&		1&		0&		1\\
0&		0&		0&		-1\\
\end{vmatrix}=1.
\end{align*}

\end{proof}

\begin{example}\label{example:例题238--78971}
$A \in \mathbb{C}^{n \times n}$ 且满足对任何 $k \in \mathbb{N}$ 都有 $|A^k + I_n| = 1$. 证明 $A$ 是幂零矩阵.
\end{example}
\begin{note}
证明的想法类似于\refthe{theorem:幂零矩阵关于迹的充要条件}. 
\end{note}
\begin{remark}
实际上,由\hyperref[theorem:Netwon公式]知\eqref{eq:::--9076921}式只需要对$k=1,2,\cdots,2^n-1$成立,就可以得到结论成立.见\refexa{example:例题028}.
\end{remark}
\begin{proof}
事实上设 $\lambda_1, \lambda_2, \cdots, \lambda_n$ 是 $A$ 的全部特征值. 由题目条件得
\begin{align}\label{eq:::--289034789875109248914--EQ:::-48972489-----12-1--23.113}
\prod_{j=1}^n (1 + \lambda_j^k) = 1, \forall k \in \mathbb{N}.
\end{align}
实际上有
\begin{align}\label{eq:::--289034789875109248914--EQ:::-48972489-----12-1--23.114}
1=\prod_{j=1}^n (1 + \lambda_j) = 1 + \sum\limits_{j=1}^n \lambda_j + \sum\limits_{1 \leqslant i < j \leqslant n} \lambda_i \lambda_j + \cdots + \lambda_1 \lambda_2 \cdots \lambda_n.
\end{align}
展开\eqref{eq:::--289034789875109248914--EQ:::-48972489-----12-1--23.113}得
\begin{align}\label{eq:::--289034789875109248914--EQ:::-48972489-----12-1--23.115}
1=\prod_{j=1}^n (1 + \lambda_j^k) = 1 + \sum_{j=1}^n \lambda_j^k + \sum_{1 \leqslant i < j \leqslant n} \lambda_i^k \lambda_j^k + \cdots + \lambda_1^k \lambda_2^k \cdots \lambda_n^k.
\end{align}
将\eqref{eq:::--289034789875109248914--EQ:::-48972489-----12-1--23.114}中右边除1以外的每项看成 $y_1, y_2, \cdots, y_{2^n - 1}$, 由\eqref{eq:::--289034789875109248914--EQ:::-48972489-----12-1--23.115}\eqref{eq:::--289034789875109248914--EQ:::-48972489-----12-1--23.113}得
\begin{align}
y_1^k + y_2^k + \cdots + y_{2^n - 1}^k = 0, \forall k \in \mathbb{N}.\label{eq:::--9076921}
\end{align}
由\hyperref[theorem:Netwon公式]{Netwon公式}得 $y_1, y_2, \cdots, y_{2^n - 1}$ 所有初等对称多项式为 $0$. 从而由\hyperref[theorem:Vieta定理]{Vieta定理}知 $y_1, y_2, \cdots, y_{2^n - 1}$ 是多项式 $y^{2^n - 1} = 0$ 的全部根. 这就给出了
$$y_i = 0, i = 1, 2, \cdots, 2^n - 1 \Rightarrow \lambda_i = 0, i = 1, 2, \cdots, n,$$
因此由\refpro{proposition:幂零矩阵关于特征值的充要条件}知$A$ 是幂零矩阵.

\end{proof}

\begin{example}\label{example:例题028}
设\( A \)是3阶复矩阵,对\( k = 1,2,\cdots,7 \),我们有
\[
|I + A^k| = 1,
\]
证明\( A \)是幂零矩阵,并问\( k \)是否可只取\( 1,2,\cdots,6 \).
\end{example}
\begin{note}
反例甚至可以完整的刻画出来,因为原题没要求,所以留给读者思考.
\end{note}
\begin{proof}
事实上,设\( \lambda_i,i = 1,2,3 \)是\( A \)的特征值,那么
\[
(1 + \lambda_1^k)(1 + \lambda_2^k)(1 + \lambda_3^k) = 1,k = 1,2,\cdots,7.
\]
于是我们有
\[
(1 + \lambda_1^k)(1 + \lambda_2^k)(1 + \lambda_3^k) = 1 + \sum_{i = 1}^3 \lambda_i^k + \lambda_1^k\lambda_2^k + \lambda_1^k\lambda_3^k + \lambda_2^k\lambda_3^k + \lambda_1^k\lambda_2^k\lambda_3^k,
\]
从而
\[
\sum_{i = 1}^3 \lambda_i^k + \lambda_1^k\lambda_2^k + \lambda_1^k\lambda_3^k + \lambda_2^k\lambda_3^k + \lambda_1^k\lambda_2^k\lambda_3^k = 0,k = 1,2,\cdots,7.
\]
上面一共有7项,这7个数字的小于等于7次的幂和为0,由\hyperref[theorem:Netwon公式]{Netwon公式}他们是\( \lambda^7 = 0 \)的七个根(类似\refexa{example:例题238--78971}),因此我们推出了
\[
\lambda_1 = \lambda_2 = \lambda_3 = 0,
\]
这就说明了\( A \)幂零.

如果\( k \)只能取\( 1,2,3\cdots,6 \),反例可取
\[
A = \begin{pmatrix}
e^{\frac{2\pi i}{7}} & 0 & 0 \\
0 & e^{\frac{4\pi i}{7}} & 0 \\
0 & 0 & e^{\frac{8\pi i}{7}}
\end{pmatrix}.
\]

\end{proof}

\begin{example}
设\( f,g \)是互素多项式且\( A \)是一个\( n \)阶矩阵,证明\( f(A)g(A)=0 \)的充要条件是\( f(A) \)的秩和\( g(A) \)的秩之和为\( n \).
\end{example}
\begin{note}
这题也可以用Jordan标准型解决,可以得到$f(A),g(A)$的0特征值的个数即代数重数之和为$n$,从而$n-r(f(A))+n-r(g(A))=n$,故结论得证.
\end{note}
\begin{proof}
由裴蜀等式,存在多项式\( a,b \)使得\( af + bg = 1 \).于是
\begin{align*}
&\left( \begin{matrix}
f(A)&		0\\
0&		g(A)\\
\end{matrix} \right) \rightarrow \left( \begin{matrix}
f(A)&		b(A)g(A)\\
0&		g(A)\\
\end{matrix} \right) 
\\
&\rightarrow \left( \begin{matrix}
f(A)&		a(A)f(A)+b(A)g(A)\\
0&		g(A)\\
\end{matrix} \right) 
\\
&=\left( \begin{matrix}
f(A)&		E\\
0&		g(A)\\
\end{matrix} \right) \rightarrow \left( \begin{matrix}
f(A)&		E\\
-f(A)g(A)&		0\\
\end{matrix} \right) 
\\
&\rightarrow \left( \begin{matrix}
0&		E\\
-f(A)g(A)&		0\\
\end{matrix} \right) \rightarrow \left( \begin{matrix}
0&		E\\
f(A)g(A)&		0\\
\end{matrix} \right) 
\\
&\rightarrow \left( \begin{matrix}
f(A)g(A)&		0\\
0&		E\\
\end{matrix} \right) ,
\end{align*}
即\( f(A)g(A)=0 \)的充要条件是\( f(A) \)的秩和\( g(A) \)的秩之和为\( n \).

\end{proof}

\begin{example}
设\( A \)是\( n \)阶幂零矩阵，\( B \)是\( n \)阶方阵满足\( AB = BA \)且\( r(AB) = r(B) \)，证明\( B = 0 \)。
\end{example}
\begin{proof}
由\refpro{proposition:乘法可交换的线性变换值域和核互为不变子空间}知\( AB = BA \)表明\( \text{Im}\, B \)是\( A \)不变子空间。于是可以考虑\( A|_{\text{Im}\, B} \),显然$\mathrm{Im} A\mid_{\mathrm{Im} B}=\mathrm{Im} AB$.由\hyperref[theorem:交和空间维数公式]{维数公式}有
\begin{align*}
\mathrm{dimIm}\,B=\mathrm{dimker}A|_{\mathrm{Im}\,B}+\mathrm{dimIm}\,AB=\mathrm{dimker}A|_{\mathrm{Im}\,B}+\mathrm{dimIm}\,B,
\end{align*}
即\( \ker A|_{\text{Im}\, B} = 0 \)。现在\( A|_{\text{Im}\, B} \)也是\( \text{Im}\, B \)上的单射。由\refcor{corollary:线性变换自同构的充要条件}知\( A|_{\text{Im}\, B} \)是双射.又因为双射的复合还是双射,所以\( (A|_{\text{Im}\, B})^n = A^n|_{\text{Im}\, B} = 0 \)也是双射.从而可知\( \text{Im}\, B = 0 \)，这就完成了证明。

\end{proof}

\begin{example}
设\( A,B \in \mathbb{C}^{n \times n} \)且\( \text{rank}(AB - BA + I) = 1 \)，证明
\begin{align}
\text{tr}(ABAB) - \text{tr}(A^2B^2) = \frac{n(n - 1)}{2}. \label{EQ:::-48972489-----12-1--23.116}
\end{align}
\end{example}
\begin{proof}
由\hyperref[lemma:秩1矩阵的列向量分解]{秩1矩阵性质}，我们知道存在\( \alpha,\beta \in \mathbb{R}^n \)使得\( AB - BA + I = \alpha\beta^T \)，于是我们有
\[
n = \text{tr}(AB - BA + I) = \text{tr}(\alpha\beta^T) = \text{tr}(\beta^T\alpha)
\]
现在
\[
\begin{aligned}
\text{tr}\left((AB - BA)^2\right) &= \text{tr}(ABAB - AB^2A - BA^2B + BABA) \\
&= \text{tr}(ABAB - A^2B^2 - A^2B^2 + ABAB) \\
&= 2\text{tr}(ABAB - A^2B^2) = \text{tr}\left((\alpha\beta^T - I)^2\right)
\end{aligned}
\]
利用\refthe{theorem:AB和BA的非0Jordan完全一致}，我们有\( \alpha\beta^T \)特征值为\( \beta^T\alpha,\underbrace{0,\cdots,0}_{n-1个} \)。故\( (\alpha\beta^T - I)^2 \)特征值为\( (\beta^T\alpha - 1)^2,\underbrace{1,\cdots,1}_{n-1个} \)。于是
\[
\text{tr}(ABAB) - \text{tr}(A^2B^2) = \frac{(n - 1)^2 + (n - 1)}{2} = \frac{n(n - 1)}{2}。
\]

\end{proof}

\begin{example}
设\( n \)为奇数,证明行列式
\[
D = \begin{vmatrix}
1 & 2 & 3 & \cdots & n-1 & n \\
2^2 & 3^2 & 4^2 & \cdots & n^2 & (n+1)^2 \\
3^3 & 4^3 & 5^3 & \cdots & (n+1)^3 & (n+1)^3 \\
\vdots & \vdots & \vdots & \cdots & \vdots & \vdots \\
n^n & (n+1)^n & (n+1)^n & \cdots & (n+1)^n & (n+1)^n
\end{vmatrix}
\]
不为0.
\end{example}
\begin{note}
行列式 \(\bmod p\)技巧,基本固定套路,应该练成肌肉反应.行列式是元素的多元多项式操作,因此求余数也会保持.
\end{note}
\begin{remark}
行列式左上角元素不变的原因:(1)对行列式整体做$\bmod 2$运算,左上角元素无论变化还是不变都不影响行列式的值,因为此时行列式是个对角阵,其值只与对角元有关.

(2)我们在有限域\( \mathbb{Z}_w \)上考虑行列式\( D \),这样$3=5=\cdots =1,2=4=\cdots =0$,因此无论各个元素的形式如何,最终的结果是一样的,都等于1.故$D$的值不可能是0!
\end{remark}
\begin{proof}
我们将行列式\( D \)的元素 \(\bmod 2\),因为\( (n+1)^n \)是偶数,所以
\[
D = \begin{vmatrix}
1 & 2 & 3 & \cdots & n-1 & n \\
2^2 & 3^2 & 4^2 & \cdots & n^2 & 0 \\
3^3 & 4^3 & 5^3 & \cdots & 0 & 0 \\
\vdots & \vdots & \vdots & \cdots & \vdots & \vdots \\
n^n & 0 & 0 & \cdots & 0 & 0
\end{vmatrix}
\]
这个行列式当然就是对角线之积\(\left( -1 \right) ^{\frac{n\left( n-1 \right)}{2}}n\cdot n^2\cdots n^n\)还是奇数,故$D=2k+\left( -1 \right) ^{\frac{n\left( n-1 \right)}{2}}n\cdot n^2\cdots n^n(k\in \mathbb{Z})$,奇数加偶数当然还是奇数.因此行列式\( D \)也是奇数,所以\( D \)不为0.证毕!

\end{proof}

\begin{example}
设\( n \geqslant 3 \)阶矩阵\( A = (a_{ij}) \),\( a_{ij} = \begin{cases}
3i, & i = j \\
3i + 1, & i < j \\
2 - 3j, & i > j
\end{cases} \)证明\( \det A \)是3的倍数当且仅当\( n \)是奇数.
\end{example}
\begin{note}
\(\bmod p\)技巧几乎快直接怼脸了.本题同样需要积累一种特别的求行列式方法.
\end{note}
\begin{proof}
我们在有限域\( \mathbb{Z}_3 \)上考虑矩阵\( A \),即
\[
A = (a_{ij}),a_{ij} = \begin{cases}
0, & i = j \\
1, & i < j \\
2, & i > j
\end{cases},
\]
故\( A = \begin{pmatrix}
0 & 1 & \cdots & 1 \\
2 & 0 & \ddots & \vdots \\
\vdots & \ddots & \ddots & 1 \\
2 & \cdots & 2 & 0
\end{pmatrix} \).(行列式$A$的计算可见\refpro{proposition:常见行列式1},下面计算用的是大拆分法)现在定义
\[
f(x) = \begin{vmatrix}
x & x + 1 & \cdots & x + 1 \\
x + 2 & x & \ddots & \vdots \\
\vdots & \ddots & \ddots & x + 1 \\
x + 2 & \cdots & x + 2 & x
\end{vmatrix},
\]
则显然\( f \)是关于\( x \)的一次函数且
\[
f(-1) = (-1)^n,f(-2) = (-2)^n \Rightarrow f(x) = ((-1)^n - (-2)^n)(x + 1) + (-1)^n.
\]
现在
\[
|A| = f(0) = 2(-1)^n - (-2)^n = \begin{cases}
2 - 4^m, & n = 2m \\
-2 + 2^{2m - 1}, & n = 2m - 1
\end{cases},
\]
注意到
\[
4 \equiv 1\ (\text{mod}3) \Rightarrow 4^m \equiv 1\ (\text{mod}3) \Rightarrow 2 - 4^m \equiv 1\ (\text{mod}3),
\]
以及
\[
4 \equiv 1\ (\text{mod}3) \Rightarrow 2^{2m - 2} \equiv 1\ (\text{mod}3) \Rightarrow 2(2^{2m - 2} - 1) \equiv 0\ (\text{mod}3) \Rightarrow -2 + 2^{2m - 1} \equiv 0\ (\text{mod}3),
\]
这就完成了证明.

\end{proof}

\begin{example}
设$A = (a_{ij}) \in \mathbb{R}^{2025 \times 2025}$满足
\[
a_{ii} = i^3 + 3i^2 + 2i, \ a_{ij} = \begin{cases}
3(i - j) + 1, & i < j \\
3(i + j) + 2, & i > j
\end{cases}.
\]
证明:$3 \mid \det A$.
\end{example}
\begin{proof}
在有限域$\mathbb{Z}_3$上考虑。注意到
\begin{align*}
i^3+3i^2+2i=i(i+1)(i+2)=0,\ \forall i\in\mathbb{N}.
\end{align*}
故
\begin{align*}
|A|=\begin{vmatrix}
0&1&1&\cdots&1&1\\
2&0&1&\cdots&1&1\\
2&2&0&\cdots&1&1\\
\vdots&\vdots&\vdots&\ddots&\vdots&\vdots\\
2&2&2&\cdots&0&1\\
2&2&2&\cdots&2&0
\end{vmatrix},
\end{align*}
记$\alpha=(1,1,\cdots,1)^T$，$|A(t)|=|A+t\alpha\alpha^T|$，则
\begin{align*}
|A(t)|=|A|+t\sum_{i,j=1}^n A_{ij},
\end{align*}
其中$A_{ij}$为$A$的$(i,j)$元的代数余子式。从而
\begin{align*}
|A|-\sum_{i,j=1}^n A_{ij}&=|A(-1)|=\begin{vmatrix}
-1&0&0&\cdots&0&0\\
1&-1&0&\cdots&0&0\\
1&1&-1&\cdots&0&0\\
\vdots&\vdots&\vdots&\ddots&\vdots&\vdots\\
1&1&1&\cdots&-1&0\\
1&1&1&\cdots&1&-1
\end{vmatrix}=-1=2;\\
|A|-2\sum_{i,j=1}^n A_{ij}&=|A(-2)|=\begin{vmatrix}
-2&-1&-1&\cdots&-1&-1\\
0&-2&-1&\cdots&-1&-1\\
0&0&-2&\cdots&-1&-1\\
\vdots&\vdots&\vdots&\ddots&\vdots&\vdots\\
0&0&0&\cdots&-2&-1\\
0&0&0&\cdots&0&-2
\end{vmatrix}=-2^{2025}=1^{2025}=1.
\end{align*}
于是$|A|=2\times 2-1=3=0$。故$3|\det A$。


\end{proof}

\begin{example}
设 \( A,B \) 为正定矩阵, 证明关于 \( X \) 的矩阵方程 \( AX + XA = B \) 有唯一解, 且解也为正定矩阵.
\end{example}
\begin{proof}
考虑映射 \( T: \mathbb{R}^{n \times n} \to \mathbb{R}^{n \times n}, X \mapsto AX + XA \). 由\refcor{corollary:二次型式(半)正定型(负定型)的充要条件}知\( A \) 特征值为正, \( -A \) 特征值为负.于是由\refpro{AX=XB相关命题1},我们知道 \( AX = X(-A) \) 只有 0 解,即$\ker T=\{0\}$.因此 \( T \) 为单射, 从而由\refcor{corollary:线性变换自同构的充要条件}知 \( T \) 也是满射. 故矩阵方程 \( AX + XA = B \) 有唯一解 \( X \). 此外
\[
A^T X^T + X^T A^T = B^T \implies AX^T + X^T A = B,
\]
故解 \( X \) 是实对称的. 设 \( X\alpha = \lambda\alpha, \alpha \in \mathbb{R}^n \setminus \{0\}, \lambda \in \mathbb{R} \). 我们有
\[
2\lambda\alpha^T A\alpha = \alpha^T AX\alpha + \alpha^T XA\alpha = \alpha^T B\alpha > 0 \implies \lambda = \frac{\alpha^T B\alpha}{2\alpha^T A\alpha} > 0,
\]
从而由\refcor{corollary:二次型式(半)正定型(负定型)的充要条件}知\( X \) 是正定矩阵.

\end{proof}

\begin{example}
设 \( \mathbb{F} \) 是一数域且 \( AB = BA \). 设方程组 \( ABX = 0, AX = 0, BX = 0 \) 的解空间分别是 \( V, V_1, V_2 \). 证明 \( V = V_1 \oplus V_2 \) 的充要条件是存在 \( C, D \in \mathbb{F}^{n \times n} \) 使得 \( CA + DB = I_n \).
\end{example}
\begin{proof}
初等变换得
\[
\begin{pmatrix} A^T & B^T & I_n \end{pmatrix} \to \begin{pmatrix} 0 & 0 & I_n \end{pmatrix}.
\]
于是注意到
\[
\begin{aligned}
&\exists C, D \in \mathbb{F}^{n \times n}, \text{使得} CA + DB = I_n \iff \exists C, D \in \mathbb{F}^{n \times n}, \text{使得} \begin{pmatrix} C & D \end{pmatrix} \begin{pmatrix} A \\ B \end{pmatrix} = I_n \\
&\iff \begin{pmatrix} A^T & B^T \end{pmatrix} X = I_n \text{在} \mathbb{F}^{2n \times n} \text{有解} \iff r\left( \begin{pmatrix} A^T & B^T \end{pmatrix} \right) = r\left( \begin{pmatrix} A^T & B^T & I_n \end{pmatrix} \right) \\
&\iff r\left( \begin{pmatrix} A^T & B^T \end{pmatrix} \right) = n \iff r\left( \begin{pmatrix} A \\ B \end{pmatrix} \right) = n \iff AX = 0, BX = 0 \text{公共解只有} 0 \text{解} \\
&\iff V_1 \bigcap V_2 = \{0\}.
\end{aligned}
\]
容易看到必要性得证.

对于充分性, 由上面的推导我们知道 \( V_1 + V_2 \) 是直和. 由 \( AB = BA \) 我们知道 \( V_1 \oplus V_2 \subset V \Rightarrow \), 于是
\[
n-r(AB)\geqslant n-r(A)+n-r(B)\Rightarrow r(AB)\leqslant r(A)+r(B)-n.
\]
由\hyperref[proposition:Sylvester(西尔维斯特)不等式]{Sylvester(西尔维斯特)不等式}我们得
\[
n - r(AB) = n - r(A) + n - r(B),
\]
即 \( V = V_1 \oplus V_2 \)。

\end{proof}

\begin{example}
在 \( n \) 维欧式空间 \( V \) 中, 两两夹角为钝角的非 0 向量个数至多只有 \( n+1 \) 个.
\end{example}
\begin{proof}
先构造 \( n+1 \) 个两两夹角为钝角的单位向量. \( n=1 \) 是显然的, 假定对维数小于 \( n \) 为空间, 的确是存在的, 则对 \( n \), 在 \( V \) 的一个 \( n-1 \) 维子空间中取 \( n \) 个两两夹角为钝角的向量, 记为 \( \alpha_1, \alpha_2, \cdots, \alpha_n \). 考虑这个子空间的正交补空间的一个单位向量 \( \beta \). 待定$\lambda$,使得$n+1$个不同向量
\begin{align}
\alpha_1 - \lambda\beta, \alpha_2 - \lambda\beta, \cdots, \alpha_n - \lambda\beta, \beta. \label{eq:---8923789820--123.117}
\end{align}
两两夹角为钝角.从而现在我们有
\[
\begin{aligned}
&(\alpha_i - \lambda\beta, \beta) = -\lambda < 0, \forall i = 1, 2, \cdots, n \Leftrightarrow \lambda > 0; \\
&(\alpha_i - \lambda\beta, \alpha_j - \lambda\beta) = (\alpha_i, \alpha_j) + \lambda^2 < 0, \forall 1 \leqslant i < j \leqslant n \Leftrightarrow \lambda^2 < \min_{1 \leqslant i < j \leqslant n} \{ -(\alpha_i, \alpha_j) \}.
\end{aligned}
\]
于是这样的 \( \lambda \) 肯定存在. 又若 \( \alpha_i - \lambda\beta = \beta \), 则 \( \beta = \frac{\alpha_i}{1+\lambda} \in \mathrm{span}\left\{ \alpha _1,\alpha _2,\cdots ,\alpha _n \right\} \), 矛盾! \( \alpha_i - \lambda\beta = \alpha_j - \lambda\beta \Leftrightarrow \alpha_i = \alpha_j \), 这也是矛盾! 于是我们证明了 \eqref{eq:---8923789820--123.117} 中向量的确互不相同, 这就归纳完成了构造.

再证明两两夹角为钝角的非 0 向量个数不超过 \( n+1 \) 个. \( n=1 \) 显然, 假定对维数小于 \( n \) 为空间, 的确成立, 在 \( n \) 时, 假定有 \( n+2 \) 个不同的向量 \( \alpha_1, \alpha_2, \cdots, \alpha_{n+2} \) 两两夹角为钝角. 受存在性构造的启发, 我们把 \( \alpha_1, \alpha_2, \cdots, \alpha_{n+1} \) 正交化, 但不必单位化. 即令
\[
\beta_i = \alpha_i - (\alpha_i, \alpha_{n+2}) \alpha_{n+2}, i = 1, 2, \cdots, n+1.
\]
注意到
\[
\begin{aligned}
&(\beta_i, \alpha_{n+2}) = 0, i = 1, 2, \cdots, n+1; \\
&(\beta_i, \beta_j) = (\alpha_i, \alpha_j) - (\alpha_i, \alpha_{n+2})(\alpha_j, \alpha_{n+2}) < 0, 1 \leqslant i < j \leqslant n+1,
\end{aligned}
\]
我们有两两夹角为钝角的向量组\( \beta_1, \beta_2, \cdots, \beta_{n+1} \) 张成的空间至多是 \( n-1 \) 维, 由归纳假设, 他应该至多只有 \( n \) 个向量两两夹角为钝角, 这是一个矛盾! 至此我们完成了证明.

\end{proof}

\begin{example}
设 \( A,B \in \mathbb{R}^{n \times n} \) 且存在 \( n+1 \) 个不同实数 \( t_1,t_2,\cdots,t_{n+1} \) 使得
\[
A + t_i B, i = 1,2,\cdots,n+1
\]
是幂零矩阵, 证明 \( A,B \) 都是幂零矩阵.
\end{example}
\begin{proof}
定义 \( p(\lambda,\mu) \triangleq |\lambda I - A - \mu B| \). 由 \( A + t_i B, i = 1,2,\cdots,n+1 \) 都是幂零矩阵及\refpro{幂零矩阵关于特征值的充要条件}得
\[
p(\lambda,t_i) = \lambda^n, i = 1,2,\cdots,n+1.
\]
对固定的 \( \lambda \in \mathbb{C} \), 注意到不超过 \( n \) 次的多项式 \( p(\lambda,\mu)-\lambda^n \) 有 \( n+1 \) 个不同实根 \( t_1,t_2,\cdots,t_{n+1} \), 于是 \( p(\lambda,\mu)-\lambda^n \equiv 0 \), 即
\[
|\lambda I - A - \mu B| = \lambda^n, \forall \lambda, \mu \in \mathbb{C}.
\]
让 \( \mu = 0 \) 得 \( |\lambda I - A| = \lambda^n, \forall \lambda \in \mathbb{C} \), 即 \( A \) 是幂零矩阵. 注意到
\[
\mu^n \left| \frac{\lambda}{\mu} I - \frac{A}{\mu} - B \right| = \lambda^n,\,\, \forall \mu >0,\forall \lambda \in \mathbb{R}.
\]
把 \( \lambda \) 用 \( \mu\lambda \) 替换得
\[
\left| \lambda I - \frac{A}{\mu} - B \right| = \lambda^n.
\]
让 \( \mu \to +\infty \) 得 \( |\lambda I - B| = \lambda^n \), 即 \( B \) 也是幂零矩阵.

\end{proof}

\begin{example}
设 \( A,B \in \mathbb{C}^{n \times n} \) 满足 \( A - E \) 幂零且对某个 \( k \in \mathbb{N} \) 有 \( A^k B = BA^k \), 证明: \( AB = BA \).
\end{example}
\begin{proof}
由$A-E$幂零可知$A$的特征值为$1$,不妨设
\begin{align*}
A=\begin{pmatrix}
J_{n_1}(1)&&&\\
&J_{n_2}(1)&&\\
&&\ddots&\\
&&&J_{n_s}(1)
\end{pmatrix},\quad B=\begin{pmatrix}
B_{11}&B_{12}&\cdots&B_{1s}\\
B_{21}&B_{22}&\cdots&B_{2s}\\
\vdots&\vdots&\ddots&\vdots\\
B_{s1}&B_{s2}&\cdots&B_{ss}
\end{pmatrix},
\end{align*}
其中$B_{ii}\in \mathbb{C} ^{n_i\times n_i},\,\,i=1,2,\cdots ,s.$
由\nrefpro{proposition:特征值为1的Jordan块可由其k次幂的多项式表示}{(1)}可知
\begin{align}
f\left( J_{n_i}^{k}(1) \right) =J_{n_i}(1),\quad i=1,2,\cdots ,s.
\label{eq:200.3}
\end{align}
这里$J_{n_i}(1)$是$n_i$阶特征值$1$对应的Jordan块.于是由$A^kB=BA^k$及\eqref{eq:200.3}式得,对$\forall i,j\in [1,s] \cap \mathbb{N}$,都有
\[
J_{n_i}^{k}(1) B_{ij}=B_{ij}J_{n_j}^{k}(1) \Longrightarrow f\left( J_{n_i}^{k}(1) \right) B_{ij}=B_{ij}f\left( J_{n_j}^{k}(1) \right) \Longrightarrow J_{n_i}(1) B_{ij}=B_{ij}J_{n_j}(1),
\]
故$AB=BA$.

\end{proof}

\begin{example}
设 \( A,B \in \mathbb{C}^{n \times n} \) 满足 \( A \) 的不同特征值模长互不相同且 \( r(A) = r(A^2) \). 若对某个 \( k \in \mathbb{N} \) 有 \( A^k B = BA^k \), 证明 \( AB = BA \).
\end{example}
\begin{proof}
由$r(A) = r(A^2)$及\refthe{theorem:Jordan块的个数与秩的关系}知，$A$的$\text{Jordan}$标准型中$0$特征值对应的$1$阶$\text{Jordan}$块的个数有
\[
r(A^2) + r(A^0) - 2r(A) = n - r(A).
\]
因为$n - r(A)$就是$0$特征值的几何重数，即$A$的$\text{Jordan}$标准型中$0$特征值对应的$\text{Jordan}$块只有$n - r(A)$个，所以$A$的$0$特征值对应的$\text{Jordan}$块都是$1$阶的。
因此可不妨设
\[
A = \begin{pmatrix}
C & O \\
O & O
\end{pmatrix}, \quad B = \begin{pmatrix}
B_1 & B_2 \\
B_3 & B_4
\end{pmatrix},
\]
其中$C$是$A$的所有非零特征值对应的$\text{Jordan}$块组成的分块对角阵。由条件可得
\[
A^k B = B A^k \Longleftrightarrow \begin{pmatrix}
C^k B_1 & C^k B_2 \\
O & O
\end{pmatrix} = \begin{pmatrix}
B_1 C^k & O \\
B_3 C^k & O
\end{pmatrix}.
\]
从而$B_2 = B_3 = O$，$C^k B_1 = B_1 C^k$，即
\[
B = \begin{pmatrix}
B_1 & O \\
O & B_4
\end{pmatrix}, \quad C^k B_1 = B_1 C^k.
\]
于是
\[
A B = B A \Longleftrightarrow \begin{pmatrix}
C B_1 & O \\
O & O
\end{pmatrix} = \begin{pmatrix}
B_1 C & O \\
O & O
\end{pmatrix} \Longleftrightarrow C B_1 = B_1 C.
\]
因此只需证$C B_1 = B_1 C$。现设
\[
C = \begin{pmatrix}
J_{\lambda_1} & & & \\
& J_{\lambda_2} & & \\
& & \ddots & \\
& & & J_{\lambda_s}
\end{pmatrix}, \quad B_1 = (B_{ij}),
\]
这里$J_{\lambda_i}$是属于$A$的特征值$\lambda_i$的所有$\text{Jordan}$块构成的分块对角矩阵，$\lambda_i$互不相同。从而我们有
\begin{align}
C^k B_1 = B_1 C^k \Longleftrightarrow J_{\lambda_i}^k B_{ij} = B_{ij} J_{\lambda_j}^k, \quad \forall i,j \in [1,s] \cap \mathbb{N}.
\label{eq:200.5}
\end{align}
由条件知$\lambda_i$的模长互不相同，从而$\lambda_i^k \ne \lambda_j^k$，$\forall i \ne j$。于是由\refpro{AX=XB相关命题1}可知$J_{\lambda_i}^k X = X J_{\lambda_j}^k$，$\forall i \ne j$只有零解。因此再结合\eqref{eq:200.5}式知$B_{ij} = O$，$\forall i \ne j$。故
\[
C^k B_1 = B_1 C^k \Longleftrightarrow J_{\lambda_i}^k B_{ii} = B_{ii} J_{\lambda_i}^k, \quad i = 1,2,\cdots,s.
\]
由\nrefpro{proposition:特征值为1的Jordan块可由其k次幂的多项式表示}{(2)}知，对$\forall i \in [1,s] \cap \mathbb{N}$，都存在次数不超过$n - 1$次的实系数多项式$f$，使得
\[
f\left( \frac{J_{\lambda_i}^k}{\lambda_i^k} \right) = \frac{J_{\lambda_i}}{\lambda_i}.
\]
进而
\begin{align*}
&C^k B_1 = B_1 C^k \Longleftrightarrow J_{\lambda_i}^k B_{ii} = B_{ii} J_{\lambda_i}^k \Longleftrightarrow \left( \frac{J_{\lambda_i}^k}{\lambda_i^k} \right) B_{ii} = B_{ii} \left( \frac{J_{\lambda_i}^k}{\lambda_i^k} \right)
\\
&\Longleftrightarrow f\left( \frac{J_{\lambda_i}^k}{\lambda_i^k} \right) B_{ii} = B_{ii} f\left( \frac{J_{\lambda_i}^k}{\lambda_i^k} \right) 
\Longleftrightarrow \frac{J_{\lambda_i}}{\lambda_i} B_{ii} = B_{ii} \frac{J_{\lambda_i}}{\lambda_i} \Longleftrightarrow J_{\lambda_i} B_{ii} = B_{ii} J_{\lambda_i} \quad i = 1,2,\cdots,s.
\end{align*}
因此$C B_1 = B_1 C$，从而结论得证。

\end{proof}

\begin{example}
设 \( A \in \mathbb{R}^{n \times n} \)，\( u, v \in \mathbb{R}^n \) 且 \( A, u, v \) 元素都是正数并满足 \( Au = v \)，\( Av = u \). 证明: \( u = v \).
\end{example}
\begin{proof}
记$u=(u_1,u_2,\cdots,u_n)^T$，$v=(v_1,v_2,\cdots,v_n)^T$，$t^*\triangleq\min\left\{\frac{u_i}{v_i}\mid 1\leqslant i\leqslant n\right\}$，$\tau\triangleq u-t^*v=(\tau_1,\tau_2,\cdots,\tau_n)^T$，则$\tau$元素非负.

设$u_{i'}=t^*v_{i'}$，则$\tau_{i'}=0$.于是
\begin{align*}
A\tau=Au-t^*Av=v-t^*v,
\end{align*}
\begin{align*}
A^2\tau=Av-t^*Av=u-t^*v=\tau.
\end{align*}
设$A^2=(a_{ij})$，则由$A^2\tau=\tau$可得
\begin{align*}
\sum_{j=1}^n a_{i'j}\tau_j=\tau_{i'}=0.
\end{align*}
再结合$A^2$是正数，$\tau$元素都非负可知
\begin{align*}
\tau_1=\tau_2=\cdots=\tau_n=0\Longrightarrow u=t^*v.
\end{align*}
从而由条件可得
\begin{align*}
v=Au=t^*Av=t^*u=(t^*)^2v\Longrightarrow t^{*2}=1\Longrightarrow u=v.
\end{align*}

\end{proof}

\begin{example}
设 \( n,m \in \mathbb{N} \)，设 \( n \geqslant 1 \) 次不可约多项式 \( f \in \mathbb{Q}[x] \) 的 \( n \) 个根是实数且成等差数列，证明: \( n \leqslant 2 \).
\end{example}
\begin{proof}
设$f(x)=a(x-x_1)(x-x_2)\cdots(x-x_n)$，等差数列$\{x_n\}\subseteq\mathbb{R}$且$d$为公差。反证，设$n\geqslant 3$，则只需证此时$f$在$\mathbb{Q}$上可约，即上述部分一次因式乘积为有理多项式。下证$(x-x_1)(x-x_n)\in\mathbb{Q}[x]$，即证$x_1+x_n,x_1x_n\in\mathbb{Q}$。由$f\in\mathbb{Q}[x]$知$f(x)$的常数项为有理数，即
\begin{align*}
x_1+x_2+\cdots+x_n=\frac{(x_1+x_n)n}{2}\in\mathbb{Q}\Longrightarrow x_1+x_n\in\mathbb{Q}.
\end{align*}
注意到
\begin{align*}
x_1x_n=\frac{(x_1+x_n)^2-(x_n-x_1)^2}{4}=\frac{(x_1+x_n)^2-(n-1)^2d^2}{4},
\end{align*}
故只须证的$d^2\in\mathbb{Q}$。由$f\in\mathbb{Q}[x]$和Vieta定理知
\begin{align*}
\sum_{k=1}^n x_k^2=\left(\sum_{k=1}^n x_k\right)^2-2\sum_{1\leqslant i<j\leqslant n}^n x_ix_j\in\mathbb{Q}.
\end{align*}
于是
\begin{align*}
\sum_{k=1}^n x_k^2&=\frac{1}{2}\left[\sum_{k=1}^n x_k^2+\sum_{k=1}^n x_{n-k+1}^2\right]=\sum_{k=1}^n \frac{\left[(x_k+x_{n-k+1})^2+(x_k-x_{n-k+1})^2\right]}{4}\\
&=\sum_{k=1}^n \frac{\left[(x_1+x_n)^2+(n-2k+1)^2d^2\right]}{4}\triangleq q\in\mathbb{Q}.
\end{align*}
从而
\begin{align*}
d^2=\frac{4q-\sum\limits_{k=1}^n (x_1+x_n)^2}{\sum\limits_{k=1}^n (n-2k+1)^2}\in\mathbb{Q}.
\end{align*}
故$x_1x_n\in\mathbb{Q}$，进而$(x-x_1)(x-x_n)\in\mathbb{Q}[x]$，此时$(x-x_1)(x-x_n)\mid f(x)$，故此时$f$在$\mathbb{Q}$上可约，矛盾！

\end{proof}

\begin{example}
设 \( n \geq 2 \) 为一个正整数, \( A,B \in \mathbb{R}^{n \times n} \) 为两个 \( n \) 阶实矩阵, 已知 \( A^2 = -I_n \) ( \( I_n \) 为 \( n \) 阶单位矩阵), 且 \( AB = BA \), 证明: \( B \) 的行列式 \( \det(B) \geq 0 \).
\end{example}
\begin{proof}
{\color{blue} 证法一:} 由\(A^2 = -I_n\)和\(x^2 + 1\)不可约知\(A\)的极小多项式为\(x^2 + 1\)，从而\(A\)的特征值只有\(\pm \mathrm{i}\)，于是\(|A| = 1\)，且\(n\)为偶数。进而\(A\)的特征多项式为\((x^2 + 1)^{\frac{n}{2}}\)。由\hyperref[theorem:实数域上的广义Jordan标准型]{实数域上的广义Jordan标准型}知，存在可逆阵\(P \in \mathbb{R}^{n \times n}\)，使得
\begin{align*}
P^{-1}AP = J = \begin{pmatrix}
R & I_2 &  &  &  \\
 & R & I_2 &  &  \\
 &  & \ddots & \ddots &  \\
 &  &  & R & I_2 \\
 &  &  &  & R
\end{pmatrix},\text{其中}R = \begin{pmatrix} 0 & 1 \\ -1 & 0 \end{pmatrix},I_2 = \begin{pmatrix} 1 & 0 \\ 0 & 1 \end{pmatrix}.
\end{align*}
由于命题和结论在实数域上的相似下保持不变，故可不妨设\(A = J\)，\(B = (B_{ij})\)为相应分块矩阵，\(B_{ij} \in \mathbb{R}^{2 \times 2}\)。由\(AB = BA\)可得
\begin{align}
&\quad \begin{pmatrix}
RB_{11} + B_{21} & * & \cdots & * & * \\
RB_{21} + B_{31} & RB_{22} + B_{32} & \cdots & * & * \\
\vdots & \vdots &  & \vdots & \vdots \\
RB_{\frac{n}{2}-1,1} + B_{\frac{n}{2},1} & RB_{\frac{n}{2}-1,2} + B_{\frac{n}{2},2} & \cdots & RB_{\frac{n}{2}-1,\frac{n}{2}-1} + B_{\frac{n}{2},\frac{n}{2}-1} & * \\
RB_{\frac{n}{2},1} & RB_{\frac{n}{2},2} & \cdots & RB_{\frac{n}{2},\frac{n}{2}-1} & RB_{\frac{n}{2},\frac{n}{2}}
\end{pmatrix}
\nonumber \\
&= \begin{pmatrix}
B_{11}R & * & \cdots & * & * \\
B_{21}R & B_{21} + B_{22}R & \cdots & * & * \\
\vdots & \vdots &  & \vdots & \vdots \\
B_{\frac{n}{2}-1,1}R & B_{\frac{n}{2}-1,1} + B_{\frac{n}{2}-1,2}R & \cdots & B_{\frac{n}{2},\frac{n}{2}-2} + B_{\frac{n}{2}-1,\frac{n}{2}-1}R & * \\
B_{\frac{n}{2},1}R & B_{\frac{n}{2},1} + B_{\frac{n}{2},2}R & \cdots & B_{\frac{n}{2},\frac{n}{2}-2} + B_{\frac{n}{2},\frac{n}{2}-1}R & B_{\frac{n}{2},\frac{n}{2}-1} + B_{\frac{n}{2},\frac{n}{2}}R
\end{pmatrix} \label{eq:198.....--2394820u1234}
\end{align}
比较第一列和最后一行元素得
\begin{align*}
RB_{\frac{n}{2},1} = B_{\frac{n}{2},1}R,
\end{align*}
\begin{align*}
RB_{i1} + B_{i+1,1} = B_{i1}R, \quad i = 1,2,\cdots,\frac{n}{2}-1.
\end{align*}
\begin{align*}
RB_{\frac{n}{2},i+1} = B_{\frac{n}{2},i} + B_{\frac{n}{2},i+1}R, \quad i = 1,2,\cdots,\frac{n}{2}-1.
\end{align*}
于是
\begin{align*}
B_{\frac{n}{2},1} = B_{\frac{n}{2}-1,1}R - RB_{\frac{n}{2}-1,1} = RB_{\frac{n}{2},2} - B_{\frac{n}{2},2}R.
\end{align*}
又因为\(R^2 = -I_2\)且\(R\)可逆，所以
\begin{align*}
RB_{\frac{n}{2},1} = B_{\frac{n}{2},1}R \Longleftrightarrow RB_{\frac{n}{2}-1,1}R + B_{\frac{n}{2}-1,1} = -B_{\frac{n}{2}-1,1} - RB_{\frac{n}{2}-1,1}R
\end{align*}
\begin{align*}
\Longrightarrow RB_{\frac{n}{2},1} = RB_{\frac{n}{2}-1,1}R + B_{\frac{n}{2}-1,1} = O \Longrightarrow B_{\frac{n}{2},1} = O.
\end{align*}
因此\(B_{\frac{n}{2}-1,1}R = RB_{\frac{n}{2}-1,1}\)，\(RB_{\frac{n}{2},2} = B_{\frac{n}{2},2}R\)，同理可得\(B_{\frac{n}{2}-1,1} = B_{\frac{n}{2},2} = O\)。依此类推可得
\begin{align*}
B_{\frac{n}{2},1} = B_{\frac{n}{2}-1,1} = \cdots = B_{21} = O, \quad B_{\frac{n}{2},1} = B_{\frac{n}{2},2} = \cdots = B_{\frac{n}{2},\frac{n}{2}-1} = O, \quad RB_{11} = B_{11}R.
\end{align*}
再比较\eqref{eq:198.....--2394820u1234}式第2列和倒数第2行主对角线以下元素，同理可得
\begin{align*}
B_{\frac{n}{2}-1,i} = O, \quad i = 2,3,\cdots,\frac{n}{2}-2,
\end{align*}
\begin{align*}
B_{i,2} = O, \quad i = 3,4,\cdots,\frac{n}{2}-1,
\end{align*}
\begin{align*}
RB_{22} = B_{22}R.
\end{align*}
依此类推最终可得\(B_{ij} = O\)，\(i > j\)，即\(B\)为分块上三角阵，并且
\begin{align}
RB_{ii} = B_{ii}R, \quad i = 1,2,\cdots,\frac{n}{2}. \label{eq:198.....--23942353c.12}
\end{align}
对\(\forall i \in \{1,2,\cdots,\frac{n}{2}\}\)，设\(B_{ii} = \begin{pmatrix} a & b \\ c & d \end{pmatrix} \in \mathbb{R}^{2 \times 2}\)，则由\eqref{eq:198.....--23942353c.12}式得
\begin{align*}
RB_{ii} = B_{ii}R \Longleftrightarrow \begin{pmatrix} c & d \\ -a & -b \end{pmatrix} = \begin{pmatrix} -b & a \\ -d & c \end{pmatrix} \Longrightarrow a = d, c = -b.
\end{align*}
从而
\begin{align*}
B_{ii} = \begin{pmatrix} a & b \\ -b & a \end{pmatrix} \Longrightarrow |B_{ii}| = a^2 + b^2 \geqslant 0.
\end{align*}
因此\(|B| = \prod_{i=1}^{\frac{n}{2}} |B_{ii}| \geqslant 0\)。

{\color{blue} 证法二:}由\(A^2 = -I_n\)和\(x^2 + 1\)不可约知\(A\)的极小多项式为\(x^2 + 1\)，从而\(A\)的特征值只有\(\pm \mathrm{i}\)，于是\(|A| = 1\)，且\(n\)为偶数。进而\(A\)的特征多项式为\((x^2 + 1)^r\),其中$r=\frac{n}{2}$.由\hyperref[theorem:实数域上的广义Jordan标准型]{实数域上的广义Jordan标准型}知，存在可逆阵\(P \in \mathbb{R}^{n \times n}\)，使得
\begin{align*}
P^{-1}AP = J = \begin{pmatrix}
R & I_2 &  &  &  \\
 & R & I_2 &  &  \\
 &  & \ddots & \ddots &  \\
 &  &  & R & I_2 \\
 &  &  &  & R
\end{pmatrix},\text{其中}R = \begin{pmatrix} 0 & 1 \\ -1 & 0 \end{pmatrix},I_2 = \begin{pmatrix} 1 & 0 \\ 0 & 1 \end{pmatrix}.
\end{align*}
又注意到实矩阵$C = \begin{pmatrix} O & E_r \\ -E_r & O \end{pmatrix}$的特征多项式也为\((x^2 + 1)^r\),进而由\hyperref[theorem:实数域上的广义Jordan标准型]{实数域上的广义Jordan标准型}知,$C$在实数域上也相似于$J$.因此$A$在实数域上相似于实矩阵$C = \begin{pmatrix} O & E_r \\ -E_r & O \end{pmatrix}$，从而存在可逆矩阵$P$，满足$A = P^{-1}CP$.由于命题和结论在实数域上的相似下保持不变，故可不妨设$A=C$,$B = \begin{pmatrix} B_1 & B_2 \\ B_3 & B_4 \end{pmatrix}$，其中$B_1$为$r$阶矩阵，由$AB=BA$可得
$$
\begin{pmatrix} B_3 & B_4 \\ -B_1 & -B_2 \end{pmatrix} = \begin{pmatrix} -B_2 & B_4 \\ -B_4 & B_3 \end{pmatrix},
$$
此时$B_3 = -B_2$，$B_1 = B_4$，从而
\begin{align*}
|B| & = \begin{vmatrix} B_1 & B_2 \\ -B_2 & B_1 \end{vmatrix} = \begin{vmatrix} B_1 - \text{i}B_2 & B_2 + \text{i}B_1 \\ -B_2 & B_1 \end{vmatrix} = \begin{vmatrix} B_1 -  \text{i}B_2 & O \\ -B_2 & B_1 + \text{i}B_2 \end{vmatrix} \\
&= |B_1 - \text{i}B_2| \, |B_1 +  \text{i}B_2| = |B_1 - \text{i}B_2| \, |\overline{B_1 -  \text{i}B_2}| \geqslant 0.
\end{align*}

\end{proof}

\begin{example}
设\(\sigma\)为\(n\)维复向量空间\(\mathbb{C}^n\)的一个线性变换.\(\mathbf{1}\)表示恒等变换. 证明以下两条等价:

(1) \(\sigma = k\mathbf{1}, k \in \mathbb{C}\);

(2) 存在\(\sigma\)的\(n + 1\)个特征向量: \(v_1, \dots, v_{n+1}\)，这\(n + 1\)个向量中任何\(n\)个向量均线性无关.
\end{example}
\begin{proof}
(1)$\Longrightarrow$ (2): 记
$$e_1=(1,0,\cdots,0)^T,\cdots,e_n=(0,0,\cdots,1)^T,$$
$e=e_1+\cdots+e_n$.
由$\sigma$是纯量变换知上述$n+1$个向量都是其特征向量。任取其中$n$个向量，因为$e_1,\cdots,e_n$显然是线性无关的，
所以可不妨设这$n$个向量为$\{e_1,\cdots,e_{i-1},e,e_{i+1},\cdots,e_n\}$，于是
\begin{align*}
&\quad \quad a_1e_1+\cdots +a_{i-1}e_{i-1}+a_ie+a_{i+1}e_{i+1}+\cdots +a_ne_n=0
\\
&\Longleftrightarrow \left( \begin{array}{c}
a_1+a_i\\
\vdots\\
a_{i-1}+a_i\\
a_i\\
a_{i+1}+a_i\\
\vdots\\
a_n+a_i\\
\end{array} \right) =0\Longleftrightarrow a_1=\cdots =a_{i-1}=a_i=a_{i+1}=\cdots =a_n=0.
\end{align*}
故$\{e_1,\cdots,e_{i-1},e,e_{i+1},\cdots,e_n\}$线性无关。

(2) $\Longrightarrow$ (1): 假设这$n+1$个向量分别属于$k$（$k\leqslant n+1$）个不同特征值的特征子空间$V_1,\cdots,V_k$中。不妨设
\begin{gather*}
1=t_0<t_1<\cdots<t_k=k,\quad t_i\in \mathbb{N};
\\
v_{t_{i-1}},\cdots,v_{t_i}\in V_i,\quad i=1,2,\cdots,k.
\end{gather*}
显然$V_i$中至多含有$n$个$\{v_1,\cdots,v_{n+1}\}$中向量。任取$\{v_1,\cdots,v_{n+1}\}\setminus\{v_{t_{i-1}},\cdots,v_{t_i}\}$中$n-(t_i-t_{i-1}+1)$个向量，则由假设可知$v_{t_{i-1}},\cdots,v_{t_i}$和这$n-(t_i-t_{i-1}+1)$个向量组成的向量组线性无关，进而$v_{t_{i-1}},\cdots,v_{t_i}$也线性无关。又因为属于不同特征值的特征向量必线性无关，所以由$\{v_{t_{i-1}},\cdots,v_{t_i}\},i=1,2,\cdots,k$组成的向量组$\{v_1,\cdots,v_{n+1}\}$也线性无关，这与$\mathbb{C}^n$中至多只有$n$个线性无关向量矛盾！因此这个$n+1$个向量都属于同一个特征子空间，由于其中任意$n$个向量线性无关，故这个特征子空间就是全空间，即$\sigma$是纯量变换。

\end{proof}

\begin{example}
设$A,B$为$n$阶实方阵, 证明: $r\left(\begin{pmatrix} A & BA \\ O & A^{\mathrm{T}}A \end{pmatrix}\right)=2r(A)$.
\end{example}
\begin{proof}
由\hyperref[proposition:矩阵秩的基本公式]{矩阵秩的基本公式}和\refpro{proposition:r(AA')=r(A)}可知
$\mathrm{r}\left( A \right) =\mathrm{r}\left( A^TA \right) \leqslant \mathrm{r}\left( A^TA\,\,BA \right) =\mathrm{r}\left( \left( A^T\,\,B \right) A \right) \leqslant \mathrm{r}\left( A \right) .$
从而$\mathrm{r}\left( A^TA \right) =\mathrm{r}\left( A^TA\,\,BA \right) $, 于是$A^TAX=BA$存在非零解$X_0$. 故
$$\left( \begin{matrix}
E&		-X_0\\
O&		E\\
\end{matrix} \right) \left( \begin{matrix}
A&		BA\\
O&		A^{\mathrm{T}}A\\
\end{matrix} \right) =\left( \begin{matrix}
A&		BA-A^TAX_0\\
O&		A^{\mathrm{T}}A\\
\end{matrix} \right) =\left( \begin{matrix}
A&		O\\
O&		A^{\mathrm{T}}A\\
\end{matrix} \right) .$$
因此
$$\mathrm{r}\left( \left( \begin{matrix}
A&		BA\\
O&		A^{\mathrm{T}}A\\
\end{matrix} \right) \right) =2\mathrm{r(}A).$$

\end{proof}

\begin{example}
设$\mathbb{F}$是一个数域，$A,B,M \in \mathbb{F}^{n \times n}$满足$AM = MB$且$A,B$有相同的特征多项式，证明：对任何$X \in \mathbb{F}^{n \times n}$都有
\[
\det (A - MX) = \det (B - XM). 
\]
\end{example}
\begin{proof}
设有理数列$t_n\rightarrow 0$，使得$A_n=t_nE+A$，$B_n=t_nE+B$可逆。因为$A,B$有相同特征多项式，所以$A_n,B_n$也有相同的特征多项式,且$A_nM=MB_n$.从而 $|A_n|=|B_n|\ne 0,\forall n\in \mathbb{N}$。
于是由降价公式可得
\begin{align*}
|A_n - MX| &= |A_n| |E - X A_n^{-1} M| = |A_n| |E - X M B_n^{-1}| \\
&= |E - M X B_n^{-1}| |B_n| = |B_n - X M|.
\end{align*}
因为上式两边都是关于$t_n$的连续函数，所以令$n\rightarrow \infty$得 $|A - MX| = |B - X M|$。

\end{proof}

\begin{example}
设 $\mathbb{F}$ 为数域且 $A,B,C \in \mathbb{F}^{n \times n}$，证明同构
\begin{align}
\mathrm{Ker}(A + B - ACB) \cong \mathrm{Ker} (A + B - BCA). \label{eq:::2390578238023442234523}
\end{align}
\end{example}
\begin{proof}
{\color{blue}证法一:}
注意到初等变换
\[
\begin{pmatrix}
E & 0 \\
0 & A + B - BCA
\end{pmatrix} \to \begin{pmatrix}
E & A \\
0 & A + B - BCA
\end{pmatrix} \to \begin{pmatrix}
-E & A \\
-E + BC & B
\end{pmatrix} \to \begin{pmatrix}
E - AC & A \\
-E & B
\end{pmatrix}
\]
\[
\to \begin{pmatrix}
AC - E & A \\
E & B
\end{pmatrix} \to \begin{pmatrix}
E & B \\
AC - E & A
\end{pmatrix} \to \begin{pmatrix}
E & B \\
0 & B + A - ACB
\end{pmatrix} \to \begin{pmatrix}
E & 0 \\
0 & B + A - ACB
\end{pmatrix}.
\]
于是我们证明了 $\operatorname{rank}(A + B - ACB) = \operatorname{rank}(A + B - BCA)$，这恰好由维数公式是\eqref{eq:::2390578238023442234523}.

{\color{blue}证法二:}不妨设 $A = \begin{pmatrix} E_r & 0 \\ 0 & 0 \end{pmatrix}$，否则用可逆矩阵 $P, Q \in \mathbb{F}^{n \times n}$ 使得 $A = P^{-1} \begin{pmatrix} E_r & 0 \\ 0 & 0 \end{pmatrix} Q^{-1}$，然后用 $PAQ$ 代替 $A$，$PBQ$ 代替 $B$，$Q^{-1}CP^{-1}$ 代替 $C$. 我们对应分块
\[
B = \begin{pmatrix} B_1 & B_2 \\ B_3 & B_4 \end{pmatrix}, C = \begin{pmatrix} C_1 & C_2 \\ C_3 & C_4 \end{pmatrix}.
\]
注意到恒等式
\[
\begin{pmatrix}
E_r & C_2 \\
0 & E_{n - r}
\end{pmatrix}(A + B - ACB) = E_n + \begin{pmatrix}
E_r - C_1 & 0 \\
0 & E_{n - r}
\end{pmatrix}\begin{pmatrix}
B_1 & B_2 \\
B_3 & B_4 - E_{n - r}
\end{pmatrix},
\]
\[
(A + B - BCA)\begin{pmatrix}
E_r & 0 \\
C_3 & E_{n - r}
\end{pmatrix} = E_n + \begin{pmatrix}
B_1 & B_2 \\
B_3 & B_4 - E_{n - r}
\end{pmatrix}\begin{pmatrix}
E_r - C_1 & 0 \\
0 & E_{n - r}
\end{pmatrix}.
\]
利用可逆矩阵乘矩阵不改变矩阵的秩和\refcor{corollary:E+MN和E+NM秩相同}知 $\operatorname{rank}(A + B - ACB) = \operatorname{rank}(A + B - BCA)$, 这恰好由维数公式是\eqref{eq:::2390578238023442234523}. 

\end{proof}

\begin{example}
设$a_1,a_2,a_3$为满足$a_1^2 + a_2^2 + a_3^2 = 1$的一组实数，$b_1,b_2$为满足$b_1^2 + b_2^2 = 1$的一组实数。又设$M_1$为$5 \times 3$矩阵，其每一行都为$a_1,a_2,a_3$的一个排列；$M_2$是$5 \times 2$矩阵，其每一行都为$b_1,b_2$的一个排列。令$M = (M_1,M_2)$，它为$5 \times 5$矩阵。证明：
\begin{enumerate}[(1)]
\item $(\operatorname{tr} M)^2 \leq (5 + 2\sqrt{6})\operatorname{rank} M$；

\item $M$必有绝对值小于或等于$\sqrt{2} + \sqrt{3}$的实特征值$\lambda$。
\end{enumerate}
\end{example}
\begin{proof}
\begin{enumerate}[(1)]
\item 由$a_{1}^{2}+a_{2}^{2}+a_{3}^{2}=1$,$b_{1}^{2}+b_{2}^{2}=1$知$a_1,a_2,a_3,b_1,b_2\leqslant 1$.从而
\begin{align*}
\left( \mathrm{tr}M \right) ^2\leqslant 5^2=25.
\end{align*}
且有均值不等式可得
\begin{align}
a_1+a_2+a_3\leqslant 3\sqrt{\frac{a_{1}^{2}+a_{2}^{2}+a_{3}^{2}}{3}}=\sqrt{3},\quad b_1+b_2\leqslant 2\sqrt{\frac{b_{1}^{2}+b_{2}^{2}}{2}}=\sqrt{2}.\label{166.223}
\end{align}
当$\mathrm{r}\left( M \right) \geqslant 3$时,就有
\begin{align*}
\left( \mathrm{tr}M \right) ^2\leqslant 25<\left( 5+2\sqrt{6} \right) \cdot 3\leqslant \left( 5+2\sqrt{6} \right) \mathrm{r}\left( M \right)
\end{align*}
恒成立.故只需考虑$\mathrm{r}\left( M \right) =1,2$的情形.
当$\mathrm{r}\left( M \right) =1$时,不妨设
\begin{align*}
M=\begin{pmatrix}
a_1&	a_2&	a_3&	b_1&	b_2\\
a_1&	a_2&	a_3&	b_1&	b_2\\
a_1&	a_2&	a_3&	b_1&	b_2\\
a_1&	a_2&	a_3&	b_1&	b_2\\
a_1&	a_2&	a_3&	b_1&	b_2\\
\end{pmatrix},
\end{align*}
则由\eqref{166.223}式可得
\begin{align*}
\left( \mathrm{tr}M \right) ^2=\left( a_1+a_2+a_3+b_1+b_2 \right) ^2\leqslant \left( \sqrt{3}+\sqrt{2} \right) ^2=5+4\sqrt{6}.
\end{align*}
当$\mathrm{r}\left( M \right) =2$时,不妨设
\begin{align*}
M=\begin{pmatrix}
a_1&	a_2&	a_3&	b_1&	b_2\\
a_1&	a_3&	a_2&	b_2&	b_1\\
a_1&	a_2&	a_3&	b_1&	b_2\\
a_1&	a_3&	a_2&	b_2&	b_1\\
a_1&	a_2&	a_3&	b_1&	b_2\\
\end{pmatrix},
\end{align*}
其中$a_3=\max\limits_{i=1,2,3}a_i$,$b_2=\max\limits_{i=1,2}b_i$.否则,$\mathrm{tr}M$都没有上述矩阵的迹大.则
\begin{align*}
a_1+2a_3&\leqslant 3\sqrt{\frac{a_{1}^{2}+2a_{3}^{2}}{3}}=\sqrt{3}\sqrt{\left( a_{1}^{2}+a_{2}^{2}+a_{3}^{2} \right) +a_{3}^{2}-a_{2}^{2}}\\
&=\sqrt{3}\sqrt{\left( a_{1}^{2}+a_{2}^{2}+a_{3}^{2} \right) +a_{3}^{2}-a_{2}^{2}}=\sqrt{3}\sqrt{1+a_{3}^{2}-a_{2}^{2}}\\
&\leqslant \sqrt{6}.
\end{align*}
于是
\begin{align*}
\left( \mathrm{tr}M \right) ^2=\left( a_1+2a_3+2b_2 \right) ^2\leqslant \left( \sqrt{6}+2 \right) ^2=\left( 5+2\sqrt{6} \right) \mathrm{r}\left( M \right).
\end{align*}
综上,我们有
\begin{align*}
\left( \mathrm{tr}M \right) ^2\leqslant \left( 5+2\sqrt{6} \right) \mathrm{r}\left( M \right).
\end{align*}

\item 注意到
\begin{align*}
M\left( \begin{array}{c}
1\\
1\\
\vdots\\
1\\
\end{array} \right) =\left( a_1+a_2+a_3+b_1+b_2 \right) \left( \begin{array}{c}
1\\
1\\
\vdots\\
1\\
\end{array} \right) ,
\end{align*}
故$\left( a_1+a_2+a_3+b_1+b_2 \right)$是$M$的一个特征值,并且由\eqref{166.223}式可得$$a_1+a_2+a_3+b_1+b_2\leqslant \sqrt{3}+\sqrt{2}.$$
\end{enumerate}

\end{proof}

\begin{example}
设 $A \in M_2(\mathbf{R})$ 是行列式为 $d$ 的可逆矩阵，且满足 $\det(A + dA^* ) = 0$，其中 $A^*$ 是 $A$ 的伴随矩阵。求 $\det(A - dA^* ).$
\end{example}
\begin{proof}
设$A=\begin{pmatrix}
x&		y\\
z&		w\\
\end{pmatrix}$,则$A^*=\begin{pmatrix}
w&		-y\\
-z&		x\\
\end{pmatrix}$.由$A$可逆知
$d=|A^*|=|A|=xw-yz\ne 0.$
从而
\begin{align*}
|A+dA^*|&=\begin{vmatrix}
x+dw&		(1-d) y\\
(1-d) z&		w+dx\\
\end{vmatrix}=(x+dw)(dx+w)-(1-d)^2yz=0
\\
&\Longleftrightarrow (1+d^2)xw+d(x^2+w^2)=(1-d)^2yz
\\
&\Longleftrightarrow d(x^2+w^2)=(1-d)^2yz-(1+d^2)xw.
\end{align*}
于是
\begin{align*}
|A-dA^*|&=\begin{vmatrix}
x-dw&		(1+d) y\\
(1+d) z&		w-dx\\
\end{vmatrix}=(x-dw)(w-dx)-(1+d)^2yz
\\
&=(1+d^2)xw-d(x^2+w^2)-(d^2yz+2dyz+yz)
\\
&=(1+d^2)(xw-yz)-(1-d)^2yz+(1+d^2)xw-2dyz
\\
&=(1+d^2)(xw-yz)+(1+d^2)(xw-yz)
\\
&=2(1+d^2)d.
\end{align*}

\end{proof}

\begin{proposition}\label{proposition:二次极小多项式由单因式分解必存在公共不变子空间}
设 \( A,B \in \mathbb{C}^{n \times n} \)，\( \lambda_1,\lambda_2,\mu_1,\mu_2 \in \mathbb{C} \)。若 \( A,B \) 的极小多项式分别是
\[ f_A(x) = (x - \lambda_1)(x - \lambda_2), f_B(x) = (x - \mu_1)(x - \mu_2), \]
证明 \( A,B \) 至少有一个维数 1 或者 2 的公共不变子空间。
\end{proposition}
\begin{note}
\textbf{构造思路}: 我希望找到$a,b,c,d\in \mathbb{C}$使得线性方程组
\begin{align}
\left( \begin{array}{c}
B-aA-bE\\
BA-cA-dE\\
\end{array} \right) x=0 \label{eq:1889.23ioiou349052352341}
\end{align}
有非零解$\alpha$. 从而$\mathrm{span}\left( \alpha ,A\alpha \right)$就是$A$和$B$的一个维数为$1$或$2$的公共不变子空间. 而\eqref{eq:1889.23ioiou349052352341}式有非零解等价于$\mathrm{r}\left( \begin{array}{c}
B-aA-bE\\
BA-cA-dE\\
\end{array} \right) <n$. 故现在只需找到$a,b,c,d\in \mathbb{C}$使得$\mathrm{r}\left( \begin{array}{c}
B-aA-bE\\
BA-cA-dE\\
\end{array} \right) <n$.

我们的想法是: 用第一行分块阵将第二行分块消掉, 因此需要第二行分块阵是第一行分块阵的倍数.
然后是第一行分块的秩小于$n$, 即不满秩. 注意到取$a=1,b$为$B-A$的特征值, 则
$| B-A-bE |=0\Longleftrightarrow \mathrm{r}\left( B-A-bE \right) <n.$
由条件可设$B$的极小多项式$f_B\left( x \right) =x^2+kx+r$. 由Cayley-Hamilton定理知
$B^2+kB+rE=O\Longleftrightarrow kB=-\left( 1+r \right) E.$
于是待定$c,d\in \mathbb{C}$, 使得
\begin{align*}
BA-cA-dE-\left( B-A-bE \right) A=k\left( B-A-bE \right) 
\Longleftrightarrow \left( b-c \right) A+\left( 1-d \right) E=-\left( 1+r+kb \right) E-kA.
\end{align*}
只要取$c=kb+b+r+1,d=k+1$就有上式成立. 从而\eqref{eq:1889.23ioiou349052352341}式成立.
\end{note}
\begin{proof}
由条件可设$f_B\left( x \right) =x^2+kx+r$, 则
$B^2+kB+rE=O\Longleftrightarrow kB=-\left( 1+r \right) E.$
取$b$为$B-A$的一个特征值, $c=kb+b+r+1,d=k+1$. 于是
\begin{align*}
BA-cA-dE-\left( B-A-bE \right) A=k\left( B-A-bE \right) ,
\end{align*}
$| B-A-bE |=0\Longleftrightarrow \mathrm{r}\left( B-A-bE \right) <n.$
考虑如下分块矩阵的初等变换
\begin{align*}
\left( \begin{array}{c}
B-aA-bE\\
BA-cA-dE\\
\end{array} \right) =\left( \begin{array}{c}
B-A-bE\\
k\left( B-A-bE \right)\\
\end{array} \right) \xrightarrow{-kr_1+r_2}\left( \begin{array}{c}
B-A-bE\\
O\\
\end{array} \right) .
\end{align*}
于是
\begin{align*}
\mathrm{r}\left( \begin{array}{c}
B-aA-bE\\
BA-cA-dE\\
\end{array} \right) =\mathrm{r}\left( \begin{array}{c}
B-A-bE\\
O\\
\end{array} \right) =\mathrm{r}\left( B-A-bE \right) <n.
\end{align*}
因此线性方程组
\begin{align*}
\left( \begin{array}{c}
B-aA-bE\\
BA-cA-dE\\
\end{array} \right) x=0
\end{align*}
有非零解$\alpha$. 考虑$\mathrm{span}\left( \alpha ,A\alpha \right)$. 显然$\mathrm{span}\left( \alpha ,A\alpha \right)$是$A-$不变子空间. 并且由上式可得
\begin{align*}
B\alpha =aA\alpha +b\alpha \in \mathrm{span}\left( \alpha ,A\alpha \right) ;\quad B\left( A\alpha \right) =cA\alpha +d\alpha \in \mathrm{span}\left( \alpha ,A\alpha \right) .
\end{align*}
所以$\mathrm{span}\left( \alpha ,A\alpha \right)$也是$B-$不变子空间. 又$\mathrm{span}\left( \alpha ,A\alpha \right)$是由两个非零向量生成的, 故维数显然等于$1$或$2$.

\end{proof}

\begin{example}
设 \( \mathscr{A},\mathscr{B} \) 是 \( \mathbb{C}^{n \times n} \) 上的线性变换，且 \( \mathscr{A}^2 = \mathscr{B}^2 = \mathscr{E} \)，其中 \( \mathscr{E} \) 为恒等变换。证明：
\begin{enumerate}[(1)]
\item 若 \( n \) 为奇数，则 \( \mathscr{A},\mathscr{B} \) 有公共的特征向量；

\item 若 \( n \) 为偶数，则存在一子空间 \( W \) 同时是 \( \mathscr{A} \) 和 \( \mathscr{B} \) 的不变子空间，且 \( \dim W = 1 \) 或 \( 2 \)。
\end{enumerate}
\end{example}
\begin{proof}
\begin{enumerate}[(1)]
\item 由条件可知, $\mathscr{A},\mathscr{B}$ 适合 $x^2-1$. 显然 $x^2-1$ 无重根. 从而 $\mathscr{A},\mathscr{B}$ 的极小多项式也无重根,
进而 $\mathscr{A},\mathscr{B}$ 都可对角化, 并且特征值只可能有 $\pm 1$. 于是
\begin{align*}
V=V_{1}^{\mathscr{A}}\oplus V_{-1}^{\mathscr{A}}=V_{1}^{\mathscr{B}}\oplus V_{-1}^{\mathscr{B}},
\end{align*}
其中 $V_{1}^{\mathscr{A}},V_{1}^{\mathscr{B}}$ 分别为 $\mathscr{A},\mathscr{B}$ 的特征值 $1$ 的特征子空间, $V_{-1}^{\mathscr{A}},V_{-1}^{\mathscr{B}}$ 分别为 $\mathscr{A},\mathscr{B}$ 的特征值 $-1$ 的特征子空间. 从而
\begin{align*}
n=\dim\mathbb{C} ^n=\dim V_{1}^{\mathscr{A}}+\dim V_{-1}^{\mathscr{A}}=\dim V_{1}^{\mathscr{B}}+\dim V_{-1}^{\mathscr{B}}.
\end{align*}
又因为 $n$ 为奇数, 所以存在 $i,j\in \{ 1,-1 \}$, 使得
\begin{align*}
\dim V_{i}^{\mathscr{A}},\,\,\dim V_{j}^{\mathscr{B}}>\frac{n}{2}.
\end{align*}
因此由维数公式可得
\begin{align*}
\dim V_{i}^{\mathscr{A}}\cap V_{j}^{\mathscr{B}}=\dim V_{i}^{\mathscr{A}}+\dim V_{j}^{\mathscr{B}}-\dim\left( V_{i}^{\mathscr{A}}+V_{j}^{\mathscr{B}} \right) >\frac{n}{2}+\frac{n}{2}-n=0.
\end{align*}
故 $V_{i}^{\mathscr{A}}\cap V_{j}^{\mathscr{B}}\ne \{ 0 \}$. 任取 $\alpha \in V_{i}^{\mathscr{A}}\cap V_{j}^{\mathscr{B}}$, 则 $\alpha$ 就是 $\mathscr{A},\mathscr{B}$ 的公共特征向量.

\item 当 $\mathscr{A},\mathscr{B}$ 中至少有一个为纯量变换时, 不妨设 $\mathscr{A}$ 为纯量变换, 则全空间 $\mathbb{C} ^n$ 都是 $\mathscr{A}-$不变子空间. 任取 $\mathscr{B}$ 的一个特征向量 $\alpha$, 则 $\mathrm{span}\{ \alpha \}$ 就是 $\mathscr{A},\mathscr{B}$ 的公共不变子空间, 且维数为 $1$.

当 $\mathscr{A},\mathscr{B}$ 都不是纯量变换时, 则 $\mathscr{A},\mathscr{B}$ 都不适合 $x\pm 1$, 故此时 $\mathscr{A},\mathscr{B}$ 的极小多项式都是 $x^2-1$. 于是由\refpro{proposition:二次极小多项式由单因式分解必存在公共不变子空间}立得.
\end{enumerate}
\end{proof}

\begin{example}
设$n$阶方阵$A,B$满足$A^3 = O$,$B = (I + A)^3$($I$为单位方阵)，求一多项式$f(x)$，使得$f(B) = A$.
\end{example}
\begin{proof}
由条件知
\begin{align*}
B&=(I + A)^3 = I + 3A + 3A^2\Longrightarrow 3A^2 = B - 3A - I.
\end{align*}
于是
\begin{align*}
B^2&=(I + 3A + 3A^2)^2 = I + 6A + 15A^2\\
&=I + 6A + 5(B - 3A - I)\\
&=5B - 9A - 4I.
\end{align*}
从而
\begin{align*}
A&=\frac{-B^2 + 5B - 4I}{9}.
\end{align*}
故取$f(x) = \frac{-x^2 + 5x - 4}{9}$即可.

\end{proof}

\begin{example}
设\( A,B \)为\( n \)阶矩阵，\( A_i \)为\( A \)的第\( i \)列，\( \lambda_1,\lambda_2,\dots,\lambda_n \)为\( B \)的特征值。
证明：
\begin{gather*}
\sum_{i=1}^n{\det \left( A_1,\cdots ,BA_i,\cdots ,A_n \right)}=\det A\sum_{1\le i<j\le n}{\lambda _i\lambda _j},
\\
\sum_{1\le i<j\le n}{\det \left( A_1,\cdots ,BA_i,\cdots ,BA_j,\cdots ,A_n \right)}=\det A\sum_{1\le i<j\le n}{\lambda _i\lambda _j},
\\
\sum_{1\le i<j<k\le n}{\det \left( A_1,\cdots ,BA_i,\cdots ,BA_j,\cdots ,BA_k,\cdots ,A_n \right)}=\det A\sum_{1\le i<j<k\le n}{\lambda _i\lambda _j\lambda _k},
\\
\vdots 
\\
\det \left( BA_1,BA_2,\cdots ,BA_n \right) =\det A\cdot \lambda _1\lambda _2\cdots \lambda _n.
\end{gather*}
\end{example}
\begin{proof}
设\( B \)的特征多项式为
\begin{align*}
f_B(x) = x^n + a_1x^{n-1} + \cdots + a_n,
\end{align*}
其中
\begin{align*}
a_1 = -\sum_{i=1}^n \lambda_i,\, a_2 = \sum_{1 \leq i < j \leq n} \lambda_i\lambda_j,\, \cdots,\, a_n = (-1)^n \lambda_1\lambda_2\cdots\lambda_n.
\end{align*}
注意到
\begin{align*}
A(xI + B) = xA + BA = (xA_1 + BA_1, \cdots, xA_n + BA_n),
\end{align*}
并且
\begin{align}
|A(xI + B)| = (-1)^n |A| |-xI - B| = |A| \cdot (-1)^n f_B(-x) = |A| \left[ x^n - a_1x^{n-1} + \cdots + (-1)^n a_n \right]. \label{eq19892.1}
\end{align}
又由行列式的基本性质，按列拆分可得
\begin{align}
|xA_1 + BA_1, \cdots, xA_n + BA_n| = |A|x^n + x^{n-1} \sum_{i=1}^n \det(A_1, \cdots, BA_i, \cdots, A_n) + \cdots + \det(BA_1, BA_2, \cdots, BA_n). \label{eq19892.2}
\end{align}
比较\eqref{eq19892.1}和\eqref{eq19892.2}式各项系数即得结论.

\end{proof}

\begin{example}
\( n \) 维欧式空间 \( V \) 中 \( s \) 个向量\(\alpha_i, i = 1,2,\cdots,s\)满足
\[
\sum_{i=1}^{s} c_i \alpha_i = 0, c_i \geqslant 0, i = 1,2,\cdots,s \Rightarrow c_1 = c_2 = \cdots = c_s = 0.
\]
证明: 存在\(\alpha \in V\), 使得\((\alpha, \alpha_i) > 0, i = 1,2,\cdots,s\).
\end{example}
\begin{proof}
考虑\( f(t_1, t_2, \cdots, t_s) = \| t_1 \alpha_1 + t_2 \alpha_2 + \cdots + t_s \alpha_s \|_{\mathbb{R}^n}^2 \)是紧集
\[
K = \left\{ (t_1, t_2, \cdots, t_s) \in \mathbb{R}^s: \sum_{i=1}^s t_i = 1, t_i \geqslant 0, i = 1, 2, \cdots, s \right\}
\]
上的连续函数，故存在\( (t_1^0, t_2^0, \cdots, t_s^0) \in \mathbb{R}^s \)使得\( f \)在\( (t_1^0, t_2^0, \cdots, t_s^0) \in \mathbb{R}^s \)上达到\( f \)在\( K \)上的最小值。因为条件，我们知道\( f \)在\( K \)上的最小值为正数。下证\( \alpha = \sum_{i=1}^s t_i^0 \alpha_i \neq 0 \)为所求。

事实上，对\( i = 1, 2, \cdots, n \)，我们有
\[
\| (1 - t) \alpha + t \alpha_i \|^2 \geqslant \| \alpha \|^2, \forall t \in [0, 1].
\]
展开计算就有
\[
(t^2 - 2t) (\alpha, \alpha) + 2t (1 - t) (\alpha, \alpha_i) + t^2 (\alpha_i, \alpha_i) \geqslant 0, \forall t \in [0, 1],
\]
即
\[
(t - 2) (\alpha, \alpha) + 2 (1 - t) (\alpha, \alpha_i) + t (\alpha_i, \alpha_i) \geqslant 0, \forall t \in [0, 1].
\]
让\( t \to 0^+ \)就有
\[
(\alpha, \alpha_i) \geqslant (\alpha, \alpha) > 0,
\]
这就证明了\( (\alpha, \alpha_i) > 0, i = 1, 2, \cdots, s \).

\end{proof}

\begin{example}
设\(\varGamma = \{\boldsymbol{W}_1, \boldsymbol{W}_2, \cdots, \boldsymbol{W}_r\}\)为\(r\)个互不相同的可逆\(n\)阶复方阵构成的集合. 若该集合关于矩阵乘法封闭 (即\(\forall \boldsymbol{M}, \boldsymbol{N} \in \varGamma\), 有\(\boldsymbol{MN} \in \varGamma\)). 证明
\begin{align*}
\sum_{i=1}^r \boldsymbol{W}_i = \boldsymbol{O} \text{ 当且仅当 } \sum_{i=1}^r \operatorname{tr}\left( \boldsymbol{W}_i \right) = 0.
\end{align*}
\end{example}
\begin{proof}
必要性是显然的,下证充分性.
首先, 对于可逆矩阵\( W_i \in \varGamma \), 有\( W_iW_1, \dots, W_iW_r \)各不相同. 故有
\[
W_i\varGamma \equiv \{ W_iW_1, W_iW_2, \dots, W_iW_r \} = \{ W_1, W_2, \dots, W_r \}
\]
即\( W_i\varGamma = \varGamma, \forall W \in \varGamma \).
记\( S = \sum_{i=1}^r W_i \), 则\( W_iS = S, \forall W_i \in \varGamma \). 进而
\[
S^2=\sum_{i=1}^r{W_i\sum_{j=1}^r{W_j}}=\sum_{i=1}^r{W_iS}=\sum_{i=1}^r{S}=rS,
\]
即$S^2-rS=0$.若\( \lambda \)为\( S \)的特征值, 则\( \lambda^2 - r\lambda = 0 \), 即\( \lambda = 0 \)或\( r \).
结合条件\( \sum_{i=1}^r \operatorname{tr}\left( W_i \right) = 0 \)知, \( S \)的特征值只能为\( 0 \). 因此有\( S - rI \)可逆.
再次注意到\( S(S - rI) = S^2 - rS = 0 \), 此时右乘\( (S - rI)^{-1} \), 即得\( S = 0 \). 证毕.

\end{proof}

\begin{example}
设 $f_i(x) = a_{i0} + a_{i1}x + a_{i2}x^2 + \cdots + a_{in}x^n (i = 0,1,\cdots,n)$. 并且 $a_{ij} \in \mathbb{Z}, i,j = 0,1,\cdots,n$. 记 $A = (a_{ij})$ 是 $n+1$ 阶矩阵, 证明:
\begin{enumerate}[(1)]
\item 对于任意的整数 $k$, 有 $(f_0(k), f_1(k), \cdots, f_n(k)) \mid \det(A)$.

\item 存在 $n+1$ 阶整数矩阵 $B$ 使得 $AB = I_{n+1}$ 的充要条件是存在 $n+1$ 个互不相同的整数 $b_0, b_1, \cdots, b_n$ 使得 $n+1$ 阶方阵 $(f_i(b_j))$ 使得 $|\det(f_i(b_j))| = \prod_{0 \leq i < j \leq n} (b_j - b_i)$.
\end{enumerate}
\end{example}
\begin{proof}
\begin{enumerate}[(1)]
\item 对$\forall k\in \mathbb{Z}$，设$d=(f_0(k),\cdots,f_n(k))$，$f_i(k)=c_id$，则$c_i\in \mathbb{Z}$. 由行列式的基本性质可知
\begin{align*}
\det(A)&=\begin{vmatrix}
a_{00}&a_{01}&\cdots&a_{0n}\\
a_{10}&a_{11}&\cdots&a_{1n}\\
\vdots&\vdots&\ddots&\vdots\\
a_{n0}&a_{n1}&\cdots&a_{nn}
\end{vmatrix}=\begin{vmatrix}
f_0(k)&a_{01}&\cdots&a_{0n}\\
f_1(k)&a_{11}&\cdots&a_{1n}\\
\vdots&\vdots&\ddots&\vdots\\
f_n(k)&a_{n1}&\cdots&a_{nn}
\end{vmatrix}\\
&\xlongequal{\text{按第一列展开}}\sum_{i=0}^n f_i(k)A_{i0}=d\sum_{i=0}^n c_iA_{i0},
\end{align*}
其中$A_{ij}$表示$A$的$(i,j)$元的代数余子式. 因为$A\in \mathbb{Z}^{(n+1)\times(n+1)}$，所以$A_{ij}\in \mathbb{Z}$. 又$c_i\in \mathbb{Z}$，故$d|\det(A)$.

\item {\heiti 充分性：}注意到
\begin{align*}
\det(f_i(b_j))&=\begin{vmatrix}
f_0(b_0)&f_0(b_1)&\cdots&f_0(b_n)\\
f_1(b_0)&f_1(b_1)&\cdots&f_1(b_n)\\
\vdots&\vdots&\ddots&\vdots\\
f_n(b_0)&f_n(b_1)&\cdots&f_n(b_n)
\end{vmatrix}=|A|\begin{vmatrix}
1&1&\cdots&1\\
b_0&b_1&\cdots&b_n\\
\vdots&\vdots&\ddots&\vdots\\
b_0^n&b_1^n&\cdots&b_n^n
\end{vmatrix}\\
&=|A|\prod_{0\le i<j\le n}(b_j-b_i),
\end{align*}
故由$|\det(f_i(b_j))|=\prod_{0\le i<j\le n}(b_j-b_i)$知$|A|=\pm 1$，因此$A$可逆，从而存在$A^{-1}$使得$AA^{-1}=I_{n+1}$. 又因为$A\in \mathbb{Z}^{(n+1)\times(n+1)}$，所以$A^*\in \mathbb{Z}^{(n+1)\times(n+1)}$，故$A^{-1}=\frac{1}{|A|}A^*=\pm A^*\in \mathbb{Z}^{(n+1)\times(n+1)}$. 因此取$B=A^{-1}$，则$AB=I_{n+1}$且$B\in \mathbb{Z}^{(n+1)\times(n+1)}$.

{\heiti 必要性：}由$AB=I_{n+1}$且$A,B\in \mathbb{Z}^{(n+1)\times(n+1)}$知
\begin{align*}
|A||B|=1\Longrightarrow |A|=\pm 1.
\end{align*}
任取$n+1$个互不相同的整数$b_0,b_1,\cdots,b_n$，则
\begin{align*}
\det(f_i(b_j))&=\begin{vmatrix}
f_0(b_0)&f_0(b_1)&\cdots&f_0(b_n)\\
f_1(b_0)&f_1(b_1)&\cdots&f_1(b_n)\\
\vdots&\vdots&\ddots&\vdots\\
f_n(b_0)&f_n(b_1)&\cdots&f_n(b_n)
\end{vmatrix}=|A|\begin{vmatrix}
1&1&\cdots&1\\
b_0&b_1&\cdots&b_n\\
\vdots&\vdots&\ddots&\vdots\\
b_0^n&b_1^n&\cdots&b_n^n
\end{vmatrix}\\
&=\pm \prod_{0\le i<j\le n}(b_j-b_i).
\end{align*}
故$|\det(f_i(b_j))|=\prod_{0\le i<j\le n}(b_j-b_i)$.
\end{enumerate}

\end{proof}

\begin{example}
设整数$n \geq 2$，$A = (a_{ij}) \in \mathbb{C}^{n \times n}$是对称的且满足
$$\sum_{i=1}^n a_{ij} = 0, j = 1, 2, \cdots, n.$$
对$k = 1, 2, \cdots, n$，设$A_k \in \mathbb{C}^{(n-1) \times (n-1)}$是$A$删去第$k$行第$k$列之后得到的子矩阵．证明
$$\det A_k, k = 1, 2, \cdots, n$$
是相等的．
\end{example}
\begin{remark}
回顾\refpro{proposition:奇异系数矩阵Ax=0的解空间}.
\end{remark}
\begin{proof}
记$\alpha = (1,1,\cdots,1)^T$，则由条件知
\begin{align}
A^T \alpha = O, \label{eq::eirij23423}
\end{align}
故$|A| = |A^T| = 0$。因此$\text{r}(A) < n$。若$\text{r}(A) \leq n-2$，则$A^* = O$，此时
$\det A_k = 0, k = 1,2,\cdots,n$。
下设$\text{r}(A) = n-1$。此时$\dim \ker A = 1$，再结合\eqref{eq::eirij23423}式知$Ax = O$的解都形如$k\alpha, k \in \mathbb{C}$。又注意到
$$A\begin{pmatrix} A_{i1} \\ A_{i2} \\ \vdots \\ A_{in} \end{pmatrix} = O, \quad i = 1,2,\cdots,n.$$
其中$A_{ij}$为$A$的$(i,j)$元的代数余子式。故
$$\begin{pmatrix} A_{i1} \\ A_{i2} \\ \vdots \\ A_{in} \end{pmatrix} = k\alpha \Longrightarrow A_{i1} = A_{i2} = \cdots = A_{in}, \quad i = 1,2,\cdots,n.$$
又因为$A$是对称阵，所以$A^*$也是对称阵，再结合上式可知$A^*$的元素全相同。因此
$\det A_k = A_{kk}, \quad k = 1,2,\cdots,n$
都相等。

\end{proof}

\begin{example}\label{example:例题9.3112223444}
设 $\boldsymbol{Q}$ 为 $n$ 阶对称正定矩阵，$\boldsymbol{P}$ 为 $m$ 阶实对称正定矩阵，$\boldsymbol{B}$ 为 $n \times m$ 实矩阵，则
$$0 \leqslant |\boldsymbol{B}^{\mathrm{T}}(\boldsymbol{Q} + \boldsymbol{B}\boldsymbol{P}\boldsymbol{B}^{\mathrm{T}})^{-1}\boldsymbol{B}| < \frac{1}{|\boldsymbol{P}|}.$$
\end{example}
\begin{proof}
由条件可知$\boldsymbol{P} = \boldsymbol{P}^{\frac{1}{2}}\boldsymbol{P}^{\frac{1}{2}}$，$\boldsymbol{Q} = \boldsymbol{Q}^{\frac{1}{2}}\boldsymbol{Q}^{\frac{1}{2}}$。记$\boldsymbol{A} = \left( \boldsymbol{Q}^{\frac{1}{2}} \right)^{-1}\boldsymbol{B}\boldsymbol{P}^{\frac{1}{2}}$，则
\begin{align*}
&\qquad\,\,\, 0 \leqslant |\boldsymbol{B}^{\mathrm{T}}(\boldsymbol{Q} + \boldsymbol{B}\boldsymbol{P}\boldsymbol{B}^{\mathrm{T}})^{-1}\boldsymbol{B}| < \frac{1}{|\boldsymbol{P}|}
\\
&\Longleftrightarrow 0 \leqslant \left| \boldsymbol{P}^{\frac{1}{2}} \right| \left| \boldsymbol{B}^{\mathrm{T}} \left( \boldsymbol{Q}^{\frac{1}{2}}\boldsymbol{Q}^{\frac{1}{2}} + \boldsymbol{B}\boldsymbol{P}^{\frac{1}{2}}\boldsymbol{P}^{\frac{1}{2}}\boldsymbol{B}^{\mathrm{T}} \right)^{-1}\boldsymbol{B} \right| \left| \boldsymbol{P}^{\frac{1}{2}} \right| < 1 \\
&\Longleftrightarrow 0 \leqslant \left| \boldsymbol{P}^{\frac{1}{2}}\boldsymbol{B}^{\mathrm{T}} \left( \boldsymbol{Q}^{\frac{1}{2}} \right)^{-1} \left( \boldsymbol{I}_n + \left( \boldsymbol{Q}^{\frac{1}{2}} \right)^{-1}\boldsymbol{B}\boldsymbol{P}^{\frac{1}{2}}\boldsymbol{P}^{\frac{1}{2}}\boldsymbol{B}^{\mathrm{T}} \left( \boldsymbol{Q}^{\frac{1}{2}} \right)^{-1} \right)^{-1} \left( \boldsymbol{Q}^{\frac{1}{2}} \right)^{-1}\boldsymbol{B}\boldsymbol{P}^{\frac{1}{2}} \right| < 1 \\
&\Longleftrightarrow 0 \leqslant \left| \boldsymbol{A}^{\mathrm{T}}(\boldsymbol{I}_n + \boldsymbol{A}\boldsymbol{A}^{\mathrm{T}})^{-1}\boldsymbol{A} \right| < 1.
\end{align*}
由降阶公式可得
\begin{align*}
\left| \lambda \boldsymbol{I}_m - \boldsymbol{A}^{\mathrm{T}} \left( \boldsymbol{I}_n + \boldsymbol{A}\boldsymbol{A}^{\mathrm{T}} \right)^{-1}\boldsymbol{A} \right| = \lambda^m \left| \boldsymbol{I}_n - \boldsymbol{A} \left( \lambda \boldsymbol{I}_m \right)^{-1}\boldsymbol{A}^{\mathrm{T}} \left( \boldsymbol{I}_n + \boldsymbol{A}\boldsymbol{A}^{\mathrm{T}} \right)^{-1} \right| = \lambda^{m-n} \left| \lambda \boldsymbol{I}_n - \boldsymbol{A}\boldsymbol{A}^{\mathrm{T}} \left( \boldsymbol{I}_n + \boldsymbol{A}\boldsymbol{A}^{\mathrm{T}} \right)^{-1} \right|.
\end{align*}
故$\boldsymbol{A}^{\mathrm{T}} \left( \boldsymbol{I}_n + \boldsymbol{A}\boldsymbol{A}^{\mathrm{T}} \right)^{-1}\boldsymbol{A}$的非零特征值与$\boldsymbol{A}\boldsymbol{A}^{\mathrm{T}} \left( \boldsymbol{I}_n + \boldsymbol{A}\boldsymbol{A}^{\mathrm{T}} \right)^{-1}$相同。由\refpro{proposition:正定和半正定阵的判定准则}知$\boldsymbol{A}\boldsymbol{A}^{\mathrm{T}}$是半正定阵，任取$\boldsymbol{A}\boldsymbol{A}^{\mathrm{T}}$的特征值$\lambda$，则$\lambda \geqslant 0$。再由\hyperref[proposition:矩阵的逆可以用其多项式表示]{矩阵的逆可以用其多项式表示}以及\refpro{proposition:矩阵多项式的特征值就是原特征值代入多项式得到的数}和\refpro{proposition:逆矩阵的特征值}知$\boldsymbol{A}\boldsymbol{A}^{\mathrm{T}} \left( \boldsymbol{I}_n + \boldsymbol{A}\boldsymbol{A}^{\mathrm{T}} \right)^{-1}$的特征值为
$$\frac{\lambda}{1 + \lambda} \in [0, 1).$$
因此$\boldsymbol{A}^{\mathrm{T}}(\boldsymbol{I}_n + \boldsymbol{A}\boldsymbol{A}^{\mathrm{T}})^{-1}\boldsymbol{A}$的特征值也都属于$[0,1)$.又因为矩阵行列式为其全体特征值乘积，所以
$$0 \leqslant \left| \boldsymbol{A}^{\mathrm{T}}(\boldsymbol{I}_n + \boldsymbol{A}\boldsymbol{A}^{\mathrm{T}})^{-1}\boldsymbol{A} \right| < 1.$$
结论得证。

\end{proof}

\begin{example}
设 $\boldsymbol{A}$ 为 $n$ 阶实对称矩阵，求证:
\begin{enumerate}[(1)]
\item 若 $\boldsymbol{A}$ 正定，则对任意的 $\boldsymbol{B} \in M_{n \times m}(\mathbb{R})$，有 $0 \leqslant |\boldsymbol{B}'(\boldsymbol{A} + \boldsymbol{B}\boldsymbol{B}')^{-1}\boldsymbol{B}| < 1$，并且左边等号成立的充要条件是 $\text{r}(\boldsymbol{B}) < m$；

\item 若 $\boldsymbol{A}$ 半正定，则存在 $\boldsymbol{B} \in M_{n \times m}(\mathbb{R})$，使得 $\boldsymbol{A} + \boldsymbol{B}\boldsymbol{B}'$ 正定且 $|\boldsymbol{B}'(\boldsymbol{A} + \boldsymbol{B}\boldsymbol{B}')^{-1}\boldsymbol{B}| = 1$ 的充要条件是 $\text{r}(\boldsymbol{A}) = n - m$。
\end{enumerate}
\end{example}
\begin{proof}
\begin{enumerate}[(1)]
\item {\color{blue}证法一:}因为$\boldsymbol{B}$是实矩阵，所以$\boldsymbol{BB}'$半正定。又$\boldsymbol{A}$正定，故$\boldsymbol{A}+\boldsymbol{BB}'$也正定。由\refpro{proposition:正定和半正定阵的判定准则}知存在可逆阵$\boldsymbol{C}$，使得$\boldsymbol{A}+\boldsymbol{BB}'=\boldsymbol{C}'\boldsymbol{C}$，进而
$$\boldsymbol{B}'\left( \boldsymbol{A}+\boldsymbol{BB}' \right) ^{-1}\boldsymbol{B}=\left( \boldsymbol{CB} \right) '\boldsymbol{CB},$$
其中$\boldsymbol{CB}$是实矩阵。故由\refpro{proposition:正定和半正定阵的判定准则}知$\boldsymbol{B}'\left( \boldsymbol{A}+\boldsymbol{BB}' \right) ^{-1}\boldsymbol{B}$是半正定阵。设$\lambda$为$\boldsymbol{B}'\left( \boldsymbol{A}+\boldsymbol{BB}' \right) ^{-1}\boldsymbol{B}$的特征值，则$\lambda \geqslant 0$。考虑如下正定矩阵的初等合同变换
\begin{align*}
\begin{pmatrix} 
\boldsymbol{A} & \boldsymbol{O} \\ 
\boldsymbol{O} & \boldsymbol{I}_m 
\end{pmatrix} 
\xrightarrow[\boldsymbol{B}' \cdot j_2 + j_1]{\boldsymbol{B} \cdot r_2 + r_1} 
\begin{pmatrix} 
\boldsymbol{A} + \boldsymbol{BB}' & \boldsymbol{B} \\ 
\boldsymbol{B}' & \boldsymbol{I}_m 
\end{pmatrix} 
\xrightarrow[-\boldsymbol{B}'(\boldsymbol{A} + \boldsymbol{BB}')^{-1} \cdot j_1 + j_2]{-\boldsymbol{B}'(\boldsymbol{A} + \boldsymbol{BB}')^{-1} \cdot r_1 + r_2} 
\begin{pmatrix} 
\boldsymbol{A} + \boldsymbol{BB}' & \boldsymbol{O} \\ 
\boldsymbol{O} & \boldsymbol{I}_m - \boldsymbol{B}'(\boldsymbol{A} + \boldsymbol{BB}')^{-1}\boldsymbol{B} 
\end{pmatrix}
\end{align*}
由命题知$\boldsymbol{I}_m-\boldsymbol{B}'\left( \boldsymbol{A}+\boldsymbol{BB}' \right) ^{-1}\boldsymbol{B}$也是正定阵。于是$\boldsymbol{I}_m-\boldsymbol{B}'\left( \boldsymbol{A}+\boldsymbol{BB}' \right) ^{-1}\boldsymbol{B}$的特征值为
$$1-\lambda >0\Longrightarrow \lambda <1.$$
因此$\lambda \in \left[ 0,1 \right)$。又因为矩阵的行列式等于全体特征值的乘积，所以
$$0\leqslant \left| \boldsymbol{B}'\left( \boldsymbol{A}+\boldsymbol{BB}' \right) ^{-1}\boldsymbol{B} \right|<1.$$
由\refpro{proposition:第8章解答题6}知上式等号成立的充要条件是$\mathrm{r}\left( \boldsymbol{B} \right) <m$。

{\color{blue}证法二(类似\refexa{example:例题9.3112223444}):}由$\boldsymbol{A}$正定知$\boldsymbol{A} = \boldsymbol{A}^{\frac{1}{2}}\boldsymbol{A}^{\frac{1}{2}}$，记$\boldsymbol{C} = \left( \boldsymbol{A}^{\frac{1}{2}} \right)^{-1}\boldsymbol{B}$，则
\begin{align}
0 \leqslant \left| \boldsymbol{B}' \left( \boldsymbol{A} + \boldsymbol{BB}' \right)^{-1}\boldsymbol{B} \right| < 1
&\Longleftrightarrow 0 \leqslant \left| \boldsymbol{B}' \left( \boldsymbol{A}^{\frac{1}{2}}\boldsymbol{A}^{\frac{1}{2}} + \boldsymbol{BB}' \right)^{-1}\boldsymbol{B} \right| < 1 \nonumber \\
&\Longleftrightarrow 0 \leqslant \left| \boldsymbol{B}' \left( \boldsymbol{A}^{\frac{1}{2}} \right)^{-1} \left( \boldsymbol{I}_n + \left( \boldsymbol{A}^{\frac{1}{2}} \right)^{-1}\boldsymbol{BB}' \left( \boldsymbol{A}^{\frac{1}{2}} \right)^{-1} \right)^{-1} \left( \boldsymbol{A}^{\frac{1}{2}} \right)^{-1}\boldsymbol{B} \right| < 1 \nonumber \\
&\Longleftrightarrow 0 \leqslant \left| \boldsymbol{C}' \left( \boldsymbol{I}_n + \boldsymbol{CC}' \right)^{-1}\boldsymbol{C} \right| < 1. \label{eq::::--234235325534522}
\end{align}
由降阶公式可得
\begin{align*}
\left| \lambda \boldsymbol{I}_m - \boldsymbol{C}^{\mathrm{T}} \left( \boldsymbol{I}_n + \boldsymbol{CC}' \right)^{-1}\boldsymbol{C} \right| &= \lambda^m \left| \boldsymbol{I}_n - \boldsymbol{C} \left( \lambda \boldsymbol{I}_m \right)^{-1}\boldsymbol{C}' \left( \boldsymbol{I}_n + \boldsymbol{CC}' \right)^{-1} \right| \\
&= \lambda^{m-n} \left| \lambda \boldsymbol{I}_n - \boldsymbol{CC}' \left( \boldsymbol{I}_n + \boldsymbol{CC}' \right)^{-1} \right|.
\end{align*}
故$\boldsymbol{C}^{\mathrm{T}} \left( \boldsymbol{I}_n + \boldsymbol{CC}' \right)^{-1}\boldsymbol{C}$的非零特征值与$\boldsymbol{CC}' \left( \boldsymbol{I}_n + \boldsymbol{CC}' \right)^{-1}$相同。设$\boldsymbol{CC}'$的特征值为$\lambda$，则由\refpro{proposition:正定和半正定阵的判定准则}知$\boldsymbol{CC}'$半正定，故$\lambda \geqslant 0$。再由\hyperref[proposition:矩阵的逆可以用其多项式表示]{矩阵的逆可以用其多项式表示}以及\refpro{proposition:矩阵多项式的特征值就是原特征值代入多项式得到的数}和\refpro{proposition:逆矩阵的特征值}知$\boldsymbol{CC}' \left( \boldsymbol{I}_n + \boldsymbol{CC}' \right)^{-1}$的特征值为
$$\frac{\lambda}{1 + \lambda} \in [0, 1).$$
因此$\boldsymbol{C}^{\mathrm{T}} \left( \boldsymbol{I}_n + \boldsymbol{CC}' \right)^{-1}\boldsymbol{C}$的特征值也都属于$[0, 1)$。又因为矩阵的行列式等于其全体特征值的乘积，所以
$$0 \leqslant \left| \boldsymbol{C}' \left( \boldsymbol{I}_n + \boldsymbol{CC}' \right)^{-1}\boldsymbol{C} \right| < 1.$$
由\eqref{eq::::--234235325534522}式知
$$0 \leqslant \left| \boldsymbol{B}' \left( \boldsymbol{A} + \boldsymbol{BB}' \right)^{-1}\boldsymbol{B} \right| < 1.$$
又由$\boldsymbol{A}$正定和\refpro{proposition:正定和半正定阵的判定准则}知$\boldsymbol{A} + \boldsymbol{BB}'$也正定，故由\refpro{proposition:第8章解答题6}知上式等号成立的充要条件是$\mathrm{r}\left( \boldsymbol{B} \right) < m$。

\item {\heiti 必要性：}由于$\boldsymbol{A}+\boldsymbol{BB}'$正定，故由\refpro{proposition:正定和半正定阵的判定准则}知存在可逆阵$\boldsymbol{C}$，使得$\boldsymbol{A}+\boldsymbol{BB}'=\boldsymbol{C}'\boldsymbol{C}$，进而
$$\boldsymbol{B}'\left( \boldsymbol{A}+\boldsymbol{BB}' \right) ^{-1}\boldsymbol{B}=\left( \boldsymbol{CB} \right) '\boldsymbol{CB},$$
其中$\boldsymbol{CB}$是实矩阵。故由\refpro{proposition:正定和半正定阵的判定准则}知$\boldsymbol{B}'\left( \boldsymbol{A}+\boldsymbol{BB}' \right) ^{-1}\boldsymbol{B}$是半正定阵。设$\lambda$为$\boldsymbol{B}'\left( \boldsymbol{A}+\boldsymbol{BB}' \right) ^{-1}\boldsymbol{B}$的特征值，则$\lambda \geqslant 0$。考虑如下半正定矩阵的初等合同变换
\begin{align}
\begin{pmatrix} 
\boldsymbol{A} & \boldsymbol{O} \\ 
\boldsymbol{O} & \boldsymbol{I}_m 
\end{pmatrix} 
\xrightarrow[\boldsymbol{B}' \cdot j_2 + j_1]{\boldsymbol{B} \cdot r_2 + r_1} 
\begin{pmatrix} 
\boldsymbol{A} + \boldsymbol{BB}' & \boldsymbol{B} \\ 
\boldsymbol{B}' & \boldsymbol{I}_m 
\end{pmatrix} 
\xrightarrow[-\boldsymbol{B}'(\boldsymbol{A} + \boldsymbol{BB}')^{-1} \cdot j_1 + j_2]{-\boldsymbol{B}'(\boldsymbol{A} + \boldsymbol{BB}')^{-1} \cdot r_1 + r_2} 
\begin{pmatrix} 
\boldsymbol{A} + \boldsymbol{BB}' & \boldsymbol{O} \\ 
\boldsymbol{O} & \boldsymbol{I}_m - \boldsymbol{B}'(\boldsymbol{A} + \boldsymbol{BB}')^{-1}\boldsymbol{B} 
\end{pmatrix}. \label{eq::ioejtw905935235234wt525}
\end{align}
由命题知$\boldsymbol{I}_m-\boldsymbol{B}'\left( \boldsymbol{A}+\boldsymbol{BB}' \right) ^{-1}\boldsymbol{B}$也是半正定阵。于是$\boldsymbol{I}_m-\boldsymbol{B}'\left( \boldsymbol{A}+\boldsymbol{BB}' \right) ^{-1}\boldsymbol{B}$的特征值为
$$1-\lambda \geqslant 0\Longrightarrow \lambda \leqslant 1.$$
因此$\lambda \in \left[ 0,1 \right]$。又因为$\left| \boldsymbol{B}'\left( \boldsymbol{A}+\boldsymbol{BB}' \right) ^{-1}\boldsymbol{B} \right|=1$，所以$\lambda =1$，即$\boldsymbol{B}'\left( \boldsymbol{A}+\boldsymbol{BB}' \right) ^{-1}\boldsymbol{B}$的特征值全为$1$。又由$\boldsymbol{B}'\left( \boldsymbol{A}+\boldsymbol{BB}' \right) ^{-1}\boldsymbol{B}$是半正定阵知，$\boldsymbol{B}'\left( \boldsymbol{A}+\boldsymbol{BB}' \right) ^{-1}\boldsymbol{B}$可对角化，故$\boldsymbol{B}'\left( \boldsymbol{A}+\boldsymbol{BB}' \right) ^{-1}\boldsymbol{B}=\boldsymbol{I}_m$。再利用\eqref{eq::ioejtw905935235234wt525}式和$\boldsymbol{A}+\boldsymbol{BB}'$正定知
$$\mathrm{r}\left( \boldsymbol{A} \right) +m=\mathrm{r}\left( \boldsymbol{A}+\boldsymbol{BB}' \right) =n\Longrightarrow \mathrm{r}\left( \boldsymbol{A} \right) =n-m.$$


{\heiti 充分性：}由$\mathrm{r}\left( \boldsymbol{A} \right) =n-m$和$\boldsymbol{A}$半正定知，存在$n$阶正交矩阵$\boldsymbol{C}$，使得
$$\boldsymbol{A}=\boldsymbol{C}\begin{pmatrix} \boldsymbol{I}_{n-m}&\boldsymbol{O}\\ \boldsymbol{O}&\boldsymbol{O} \end{pmatrix}\boldsymbol{C}'.$$
取$\boldsymbol{B}=\boldsymbol{C}\begin{pmatrix} \boldsymbol{O}\\ \boldsymbol{I}_m \end{pmatrix} \in \boldsymbol{M}_{n\times m}\left( \mathbb{R} \right)$，则
$$\boldsymbol{A}+\boldsymbol{BB}'=\boldsymbol{C}\begin{pmatrix} \boldsymbol{I}_{n-m}&\boldsymbol{O}\\ \boldsymbol{O}&\boldsymbol{O} \end{pmatrix}\boldsymbol{C}'+\boldsymbol{C}\begin{pmatrix} \boldsymbol{O}&\boldsymbol{O}\\ \boldsymbol{O}&\boldsymbol{I}_m \end{pmatrix}\boldsymbol{C}'=\boldsymbol{CC}',$$
从而由\refpro{proposition:正定和半正定阵的判定准则}知$\boldsymbol{A}+\boldsymbol{BB}'$正定。并且
\begin{align*}
\left| \boldsymbol{B}' \left( \boldsymbol{A}+\boldsymbol{BB}\prime \right) ^{-1}\boldsymbol{B} \right|&=\left| \left( \begin{matrix}
\boldsymbol{O}&		\boldsymbol{I}_m\\
\end{matrix} \right) \boldsymbol{C}' \left( \boldsymbol{CC}' \right) ^{-1}\boldsymbol{C}\left( \begin{array}{c}
\boldsymbol{O}\\
\boldsymbol{I}_m\\
\end{array} \right) \right|
\\
&=\left| \left( \begin{matrix}
\boldsymbol{O}&		\boldsymbol{I}_m\\
\end{matrix} \right) \left( \begin{array}{c}
\boldsymbol{O}\\
\boldsymbol{I}_m\\
\end{array} \right) \right|=\left| \boldsymbol{I}_m \right|=1.
\end{align*}
\end{enumerate}

\end{proof}

\begin{example}
对于二阶矩阵$A,B_1,B_2,B_3,B_4$，$A \neq O$，若
$$\det(A + B_i) = \det(A) + \det(B_i),\ i = 1,2,3,4.$$
证明: 矩阵$B_1,B_2,B_3,B_4$线性相关.
\end{example}
\begin{proof}
设$V$是由全体$4$阶矩阵构成的线性空间. 反证，假设$B_1,B_2,B_3,B_4$线性无关，则其构成$V$的一组基. 从而存在一组不全为$0$的数$c_1,c_2,c_3,c_4$，使得
\begin{align*}
A=c_1B_1+c_2B_2+c_3B_3+c_4B_4.
\end{align*}
记
\begin{align*}
A=\begin{pmatrix}
a_1&		a_2\\
a_3&		a_4\\
\end{pmatrix},\quad B_i=\begin{pmatrix}
b_{1}^{i}&		b_{2}^{i}\\
b_{3}^{i}&		b_{4}^{i}\\
\end{pmatrix},\quad i=1,2,3,4.
\end{align*}
则
\begin{align*}
a_j=\sum_{i=1}^4{c_ib_{j}^{i}},\quad j=1,2,3,4.
\end{align*}
根据条件，将行列式按列拆分可得
\begin{align*}
\left| A+B_i \right|=\begin{vmatrix}
a_1+b_{1}^{i}&		a_2+b_{2}^{i}\\
a_3+b_{3}^{i}&		a_4+b_{4}^{i}\\
\end{vmatrix}=\left| A \right|+\left| B_i \right|+\begin{vmatrix}
a_1&		b_{2}^{i}\\
a_3&		b_{4}^{i}\\
\end{vmatrix}+\begin{vmatrix}
b_{1}^{i}&		a_2\\
b_{3}^{i}&		a_4\\
\end{vmatrix}=\left| A \right|+\left| B_i \right|.
\end{align*}
进而
\begin{align*}
\begin{vmatrix}
a_1&		b_{2}^{i}\\
a_3&		b_{4}^{i}\\
\end{vmatrix}+\begin{vmatrix}
b_{1}^{i}&		a_2\\
b_{3}^{i}&		a_4\\
\end{vmatrix}=0,\quad i=1,2,3,4.
\end{align*}
于是
\begin{align*}
0=\sum_{i=1}^4{c_i\left( \begin{vmatrix}
a_1&		b_{2}^{i}\\
a_3&		b_{4}^{i}\\
\end{vmatrix}+\begin{vmatrix}
b_{1}^{i}&		a_2\\
b_{3}^{i}&		a_4\\
\end{vmatrix} \right)}=\begin{vmatrix}
a_1&		\sum_{i=1}^4{c_ib_{2}^{i}}\\
a_3&		\sum_{i=1}^4{c_ib_{4}^{i}}\\
\end{vmatrix}+\begin{vmatrix}
\sum_{i=1}^4{c_ib_{1}^{i}}&		a_2\\
\sum_{i=1}^4{c_ib_{3}^{i}}&		a_4\\
\end{vmatrix}
=\begin{vmatrix}
a_1&		a_2\\
a_3&		a_4\\
\end{vmatrix}+\begin{vmatrix}
a_1&		a_2\\
a_3&		a_4\\
\end{vmatrix}=2\left| A \right|.
\end{align*}
故$\left| A \right|=0$. 又因为$A\ne O$，所以$\text{r}\left( A \right) =1$. 因此$A$的$0$特征值的几何重数为$1$，故$A$的$\text{Jordan}$标准型只有两种，即
\begin{align*}
A\sim \begin{pmatrix}
1&		0\\
0&		0\\
\end{pmatrix}\text{或}\begin{pmatrix}
0&		1\\
0&		0\\
\end{pmatrix}.
\end{align*}
注意条件和结论在同一个相似变换下保持不变，故可不妨设
\begin{align*}
A=\begin{pmatrix}
1&		0\\
0&		0\\
\end{pmatrix}\text{或}\begin{pmatrix}
0&		1\\
0&		0\\
\end{pmatrix}.
\end{align*}
$\left( \mathrm{i} \right)$ 当$A=\begin{pmatrix}
1&		0\\
0&		0\\
\end{pmatrix}$时，由条件可得
\begin{align*}
\left| A+B_i \right|=\left| A \right|+\left| B_i \right|=\left| B_i \right|\Longleftrightarrow \begin{vmatrix}
1+b_{1}^{i}&		b_{2}^{i}\\
b_{3}^{i}&		b_{4}^{i}\\
\end{vmatrix}=\begin{vmatrix}
b_{1}^{i}&		b_{2}^{i}\\
b_{3}^{i}&		b_{4}^{i}\\
\end{vmatrix}
\Longleftrightarrow \begin{vmatrix}
1&		b_{2}^{i}\\
0&		b_{4}^{i}\\
\end{vmatrix}=0\Longleftrightarrow b_{4}^{i}=0,i=1,2,3,4.
\end{align*}
从而$\begin{pmatrix}
0&		0\\
0&		1\\
\end{pmatrix}$就不可能由$B_1,B_2,B_3,B_4$线性表出，但$\begin{pmatrix}
0&		0\\
0&		1\\
\end{pmatrix} \in V$，这与$B_1,B_2,B_3,B_4$是$V$的一组基矛盾！
$\left( \mathrm{ii} \right)$ 当$A=\begin{pmatrix}
0&		1\\
0&		0\\
\end{pmatrix}$时，由条件可得
\begin{align*}
\left| A+B_i \right|=\left| A \right|+\left| B_i \right|=\left| B_i \right|\Longleftrightarrow \begin{vmatrix}
b_{1}^{i}&		1+b_{2}^{i}\\
b_{3}^{i}&		b_{4}^{i}\\
\end{vmatrix}=\begin{vmatrix}
b_{1}^{i}&		b_{2}^{i}\\
b_{3}^{i}&		b_{4}^{i}\\
\end{vmatrix}
\Longleftrightarrow \begin{vmatrix}
b_{1}^{i}&		1\\
b_{3}^{i}&		0\\
\end{vmatrix}=0\Longleftrightarrow b_{3}^{i}=0,i=1,2,3,4.
\end{align*}
从而$\begin{pmatrix}
0&		0\\
1&		0\\
\end{pmatrix}$就不可能由$B_1,B_2,B_3,B_4$线性表出，但$\begin{pmatrix}
0&		0\\
1&		0\\
\end{pmatrix} \in V$，这与$B_1,B_2,B_3,B_4$是$V$的一组基矛盾！

\end{proof}

\begin{example}
设$\alpha,\beta,\gamma$是欧氏空间$\mathbb{R}^n$中三个非零向量，已知它们两两正交. 记矩阵$A = \alpha\beta' + \beta\gamma' + \gamma\alpha'$.
\begin{enumerate}[(1)]
\item 证明: $\text{rank}(A) = 3$.

\item $A$是否可以相似对角化？请证明你的结论.
\end{enumerate}
\end{example}
\begin{proof}
\begin{enumerate}[(1)]
\item 记$B=(\alpha,\beta,\gamma)$，则由条件可知$\text{r}(B)=3$. 由\hyperref[proposition:Sylvester(西尔维斯特)不等式]{Sylvester不等式}知
\begin{align*}
3=\text{r}(B)\geqslant \text{r}(A)=\text{r}(BB^T)\geqslant \text{r}(B)+\text{r}(B^T)-3=3.
\end{align*}
故$\text{r}(A)=3.$

\item 注意到
\begin{align*}
A\alpha=|\alpha|^2\gamma,\quad A\beta=|\beta|^2\alpha,\quad A\gamma=|\gamma|^2\beta.
\end{align*}
将$\{\alpha,\beta,\gamma\}$扩充为$\mathbb{R}^n$的一组基$\mathscr{H}$，设$A$在基$\mathscr{H}$下的表示阵为
\begin{align*}
\begin{pmatrix}
M&N\\
O& P
\end{pmatrix},
\end{align*}
其中$M=\begin{pmatrix}
0&|\beta|^2&0\\
0&0&|\gamma|^2\\
|\alpha|^2&0&0
\end{pmatrix}$.
显然$M$可逆，从而可做实数域上的分块初等变换得
\begin{align*}
\begin{pmatrix}
M&N\\
O& P
\end{pmatrix}\rightarrow \begin{pmatrix}
M&O\\
O& P
\end{pmatrix}.
\end{align*}
又由(1)知$\text{r}(A)=3$，因此
\begin{align*}
3=\text{r}(A)=\text{r}\begin{pmatrix}
M&O\\
O& P
\end{pmatrix}=\text{r}(M)+\text{r}(P)=3+\text{r}(P)\Longrightarrow P=O.
\end{align*}
故$A$在实数域上相似于
\begin{align*}
\begin{pmatrix}
M&O\\
O&O
\end{pmatrix}.
\end{align*}
注意到$M$的特征多项式为$\lambda^3-|\alpha|^2|\beta|^2|\gamma|^2$，从而$M$有三个互不相同的特征值，其中两个为复数. 故$M$在复数域上可对角化，在实数域上不可对角化. 因此$A$在复数域上可对角化，但在实数域上不可对角化.
\end{enumerate}

\end{proof}

\begin{proposition}\label{proposition:矩阵开方的秩等于其秩则幂零Jordan块均为1阶}
设$A$为$n$阶奇异阵,且$r(A)=r(A^2)$,则存在可逆阵$M$,使得
\begin{align*}
A\sim \left( \begin{matrix}
M&		O\\
O&		O\\
\end{matrix} \right) .
\end{align*}
\end{proposition}
\begin{proof}
设$A$的Jordan标准型为
\begin{align*}
J=\begin{pmatrix}
J_{r_1}(\lambda_1)&		&		&		\\
&		\ddots&		&		\\
&		&		J_{r_k}(\lambda_k)&		\\
&		&		&		J_{r_0}(0)\\
\end{pmatrix},
\end{align*}
其中$J_{r_i}(\lambda_i)$表示属于特征值$\lambda_i$的$r_i$阶根子空间块. 因为$A$不可逆，所以$r_0>0$. 从而
\begin{align*}
A^2\sim J^2=\begin{pmatrix}
J_{r_1}^{2}(\lambda_1)&		&		&		\\
&		\ddots&		&		\\
&		&		J_{r_k}^{2}(\lambda_k)&		\\
&		&		&		J_{r_0}^{2}(0)\\
\end{pmatrix}.
\end{align*}
注意到
\begin{align*}
r(A)=r(J)=r(J_{r_0}(0))+\sum\limits_{i=1}^k r(J_{r_i}(\lambda_i)),
\end{align*}
\begin{align*}
r(A^2)=r(J^2)=r(J_{r_0}^{2}(0))+\sum\limits_{i=1}^k r(J_{r_i}^{2}(\lambda_i)).
\end{align*}
若$J_{r_0}(0)\ne O$，则$r(J_{r_0}^{2}(0))<r(J_{r_0}(0))$. 从而$r(A^2)<r(A)$矛盾！故$J_{r_0}(0)=O$. 记
\begin{align*}
M=\begin{pmatrix}
J_{r_1}(\lambda_1)&		&		\\
&		\ddots&		\\
&		&		J_{r_k}(\lambda_k)\\
\end{pmatrix},
\end{align*}
于是
\begin{align*}
A\sim J=\begin{pmatrix}
J_{r_1}(\lambda_1)&		&		&		\\
&		\ddots&		&		\\
&		&		J_{r_k}(\lambda_k)&		\\
&		&		&		O\\
\end{pmatrix}=\begin{pmatrix}
M&		O\\
O&		O\\
\end{pmatrix}.
\end{align*}

\end{proof}

\begin{example}
设$A,B$为$n$阶矩阵，且$r(A)=r(B)$，证明：$A^2B = A$的充要条件是$B^2A = B$.
\end{example}
\begin{proof}
当$A$或$B$可逆时,结论显然成立.下设$A,B$均不可逆.

{\heiti 必要性:} 注意到
\begin{align*}
\mathrm{r}(A^2) \leqslant \mathrm{r}(A) = \mathrm{r}(A^2B) \leqslant \mathrm{r}(A^2),
\end{align*}
故\(\mathrm{r}(A) = \mathrm{r}(A^2)\). 因此由\refpro{proposition:矩阵开方的秩等于其秩则幂零Jordan块均为1阶}可知，存在可逆阵\(M\)，使得
\begin{align*}
A \sim \begin{pmatrix}
M&		O\\
O&		O\\
\end{pmatrix}.
\end{align*}
因为条件和结论在相似变换下不变，所以不妨设
\begin{align*}
A = \begin{pmatrix}
M&		O\\
O&		O\\
\end{pmatrix},\quad B = \begin{pmatrix}
B_1&		B_2\\
B_3&		B_4\\
\end{pmatrix}.
\end{align*}
由\(A^2B = A\)可得
\begin{align*}
\begin{pmatrix}
M^2&		O\\
O&		O\\
\end{pmatrix} \begin{pmatrix}
B_1&		B_2\\
B_3&		B_4\\
\end{pmatrix} = \begin{pmatrix}
M&		O\\
O&		O\\
\end{pmatrix} \Longleftrightarrow \begin{pmatrix}
M(MB_1 - I)&		M^2B_2\\
O&		O\\
\end{pmatrix} = \begin{pmatrix}
O&		O\\
O&		O\\
\end{pmatrix}.
\end{align*}
再结合\(M\)可逆知\(B_2 = O\)，\(B_1 = M^{-1}\)，故\(B = \begin{pmatrix}
M^{-1}&		O\\
B_3&		B_4\\
\end{pmatrix}\). 于是
\begin{align}
B^2A = B &\Longleftrightarrow \begin{pmatrix}
M^{-1}&		O\\
B_3&		B_4\\
\end{pmatrix}^2 \begin{pmatrix}
M&		O\\
O&		O\\
\end{pmatrix} = \begin{pmatrix}
M^{-1}&		O\\
B_3&		B_4\\
\end{pmatrix} \notag \\
&\Longleftrightarrow \begin{pmatrix}
O&		O\\
B_4B_3M&		-B_4\\
\end{pmatrix} = \begin{pmatrix}
O&		O\\
O&		O\\
\end{pmatrix} \notag \\
&\Longleftrightarrow B_4 = O. \label{eq:21.234892n389tu234tger231}
\end{align}
又\(r(A) = r(B)\)，故由\hyperref[proposition:矩阵秩的基本公式]{矩阵秩的基本公式}知
\begin{align*}
r(A) = r(B) = r\left( \begin{pmatrix}
M^{-1}&		O\\
B_3&		B_4\\
\end{pmatrix} \right) \geqslant r(M^{-1}) + r(B_4) = r(A) + r(B_4).
\end{align*}
从而\(r(B_4) = 0\)，进而\(B_4 = O\). 再由\(\eqref{eq:21.234892n389tu234tger231}\)知必要性成立.

{\heiti 充分性:} 注意到
\begin{align*}
\mathrm{r}(B^2) \leqslant \mathrm{r}(B) = \mathrm{r}(B^2A) \leqslant \mathrm{r}(B^2),
\end{align*}
故\(\mathrm{r}(B) = \mathrm{r}(B^2)\). 因此由\refpro{proposition:矩阵开方的秩等于其秩则幂零Jordan块均为1阶}可知，存在可逆阵\(M\)，使得
\begin{align*}
B \sim \begin{pmatrix}
M&		O\\
O&		O\\
\end{pmatrix}.
\end{align*}
因为条件和结论在相似变换下不变，所以不妨设
\begin{align*}
B = \begin{pmatrix}
M&		O\\
O&		O\\
\end{pmatrix},\quad A = \begin{pmatrix}
A_1&		A_2\\
A_3&		A_4\\
\end{pmatrix}.
\end{align*}
由\(B^2A = B\)可得
\begin{align*}
\begin{pmatrix}
M^2&		O\\
O&		O\\
\end{pmatrix} \begin{pmatrix}
A_1&		A_2\\
A_3&		A_4\\
\end{pmatrix} = \begin{pmatrix}
M&		O\\
O&		O\\
\end{pmatrix} \Longleftrightarrow \begin{pmatrix}
M(MA_1 - I)&		M^2A_2\\
O&		O\\
\end{pmatrix} = \begin{pmatrix}
O&		O\\
O&		O\\
\end{pmatrix}.
\end{align*}
再结合\(M\)可逆知\(A_2 = O\)，\(A_1 = M^{-1}\)，故\(A = \begin{pmatrix}
M^{-1}&		O\\
A_3&		A_4\\
\end{pmatrix}\). 于是
\begin{align}
A^2B = A &\Longleftrightarrow \begin{pmatrix}
M^{-1}&		O\\
A_3&		A_4\\
\end{pmatrix}^2 \begin{pmatrix}
M&		O\\
O&		O\\
\end{pmatrix} = \begin{pmatrix}
M^{-1}&		O\\
A_3&		A_4\\
\end{pmatrix} \notag \\
&\Longleftrightarrow \begin{pmatrix}
O&		O\\
A_4A_3M&		-A_4\\
\end{pmatrix} = \begin{pmatrix}
O&		O\\
O&		O\\
\end{pmatrix} \notag \\
&\Longleftrightarrow A_4 = O. \label{eq:21.234892n389tu234tger232}
\end{align}
又\(r(A) = r(B)\)，故由\hyperref[proposition:矩阵秩的基本公式]{矩阵秩的基本公式}知
\begin{align*}
r(A) = r(B) = r\left( \begin{pmatrix}
M^{-1}&		O\\
A_3&		A_4\\
\end{pmatrix} \right) \geqslant r(M^{-1}) + r(A_4) = r(A) + r(A_4).
\end{align*}
从而\(r(A_4) = 0\)，进而\(A_4 = O\). 再由\(\eqref{eq:21.234892n389tu234tger232}\)知充分性成立.

\end{proof}

\begin{example}
证明：一个$n$元实二次型可以分解成两个实系数1次齐次多项式的乘积当且仅当它的秩等于2且符号差为0, 或者它的秩等于1.
\end{example}
\begin{note}
根据必要性条件,不能直接由$X^TAX=( X^T\alpha ) ( \beta ^TX ) =X^T( \alpha \beta ^T ) X$推出$A=\alpha \beta ^T$,因为$\alpha \beta ^T$不一定是对称阵.
不过我们可以根据多项式的可交换性,将右式中矩阵转变成对称阵,具体操作见下述必要性证明.

本题关键就是注意到必要性条件等价于
\begin{align*}
A=\frac{\alpha \beta ^T+\beta \alpha ^T}{2}.
\end{align*}
然后验证即可.
\end{note}
\begin{proof}
设$X=( x_1,x_2,\cdots ,x_n ) ^T$.

{\heiti 充分性:}若$r( A ) =1,$则存在非零实向量$\alpha ,\beta ,$使得
\begin{align*}
A=\alpha \beta ^T\Longrightarrow X^TAX=X^T( \alpha \beta ^T ) X=( X^T\alpha ) ( \beta ^TX ).
\end{align*}
若$r( A ) =2$且$A$的符号差为$0,$注意到条件和结论在相似变换下不改变,故不妨设
\begin{align*}
A=\begin{pmatrix}
1&		&		&		&		\\
&		-1&		&		&		\\
&		&		0&		&		\\
&		&		&		\ddots&		\\
&		&		&		&		0\\
\end{pmatrix},
\end{align*}
此时
\begin{align*}
X^TAX=x_{1}^{2}-x_{2}^{2}=( x_1+x_2 ) ( x_1-x_2 ).
\end{align*}

{\heiti 必要性:}设$0\ne \alpha =( a_1,a_2,\cdots ,a_n ) ^T,\beta =( b_1,b_2,\cdots ,b_n ) ^T\in \mathbb{R} ^n,$且满足$X^TAX=( X^T\alpha ) ( \beta ^TX ),$则
\begin{align*}
X^TAX=( X^T\alpha ) ( \beta ^TX ) =X^T( \alpha \beta ^T ) X,\\
X^TAX=( X^T\beta ) ( \alpha ^TX ) =X^T( \beta \alpha ^T ) X,
\end{align*}
故
\begin{align*}
X^TAX=\frac{X^TAX+X^TAX}{2}=\frac{X^T( \alpha \beta ^T ) X+X^T( \beta \alpha ^T ) X}{2}=X^T\frac{\alpha \beta ^T+\beta \alpha ^T}{2}X.
\end{align*}
注意到$\frac{\alpha \beta ^T+\beta \alpha ^T}{2}$是实对称阵,故由上式可得
\begin{align*}
A&=\frac{\alpha \beta ^T+\beta \alpha ^T}{2}=\frac{1}{2}\begin{pmatrix}
a_1\\
a_2\\
\vdots\\
a_n\\
\end{pmatrix}\begin{pmatrix}
b_1&		b_2&		\cdots&		b_n\\
\end{pmatrix} +\frac{1}{2}\begin{pmatrix}
b_1\\
b_2\\
\vdots\\
b_n\\
\end{pmatrix}\begin{pmatrix}
a_1&		a_2&		\cdots&		a_n\\
\end{pmatrix} 
\\
&=\frac{1}{2}\begin{pmatrix}
a_1&		b_1\\
a_2&		b_2\\
\vdots&		\vdots\\
a_n&		b_n\\
\end{pmatrix}\begin{pmatrix}
b_1&		b_2&		\cdots&		b_n\\
a_1&		a_2&		\cdots&		a_n\\
\end{pmatrix}.
\end{align*}
于是由降阶公式可得
\begin{align*}
| \lambda I_n-A |&=\lambda ^{n-2}\left| \lambda I_2-\frac{1}{2}\begin{pmatrix}
b_1&		b_2&		\cdots&		b_n\\
a_1&		a_2&		\cdots&		a_n\\
\end{pmatrix}\begin{pmatrix}
a_1&		b_1\\
a_2&		b_2\\
\vdots&		\vdots\\
a_n&		b_n\\
\end{pmatrix} \right|=\lambda ^{n-2}\left| \begin{pmatrix}
\lambda -\frac{\sum\limits_{i=1}^n{a_ib_i}}{2}&		-\frac{\sum\limits_{i=1}^n{b_{i}^{2}}}{2}\\
-\frac{\sum\limits_{i=1}^n{a_{i}^{2}}}{2}&		\lambda -\frac{\sum\limits_{i=1}^n{a_ib_i}}{2}\\
\end{pmatrix} \right|
\\
&=\frac{1}{4}\lambda ^{n-2}\left( 4\lambda ^2-4\lambda \sum\limits_{i=1}^n{a_ib_i}+\left( \sum\limits_{i=1}^n{a_ib_i} \right) ^2-\left( \sum\limits_{i=1}^n{a_{i}^{2}} \right) \left( \sum\limits_{i=1}^n{b_{i}^{2}} \right) \right).
\end{align*}
当$\alpha$与$\beta$线性相关时,由Cauchy-Schwarz不等式知
\begin{align*}
\left( \sum\limits_{i=1}^n{a_ib_i} \right) ^2=\left( \sum\limits_{i=1}^n{a_{i}^{2}} \right) \left( \sum\limits_{i=1}^n{b_{i}^{2}} \right),
\end{align*}
于是
\begin{align*}
| \lambda I_n-A |=\lambda ^{n-2}\left( \lambda ^2-\lambda \sum\limits_{i=1}^n{a_ib_i} \right) =\lambda ^{n-1}\left( \lambda -\sum\limits_{i=1}^n{a_ib_i} \right).
\end{align*}
注意到$\sum\limits_{i=1}^n{a_ib_i}\ne 0,$否则$( \alpha ,\beta ) =0,$即$\alpha ,\beta$正交,因此$\alpha$与$\beta$线性无关,矛盾!故此时$A$只有一个非零特征值,从而$r( A ) =1.$

当$\alpha$与$\beta$线性无关时,同理由Cauchy-Schwarz不等式知
\begin{align*}
\left( \sum\limits_{i=1}^n{a_ib_i} \right) ^2<\left( \sum\limits_{i=1}^n{a_{i}^{2}} \right) \left( \sum\limits_{i=1}^n{b_{i}^{2}} \right),
\end{align*}
于是
\begin{align*}
| \lambda I_n-A |=\frac{1}{4}\lambda ^{n-2}\left( 4\lambda ^2-4\lambda \sum\limits_{i=1}^n{a_ib_i}+\left( \sum\limits_{i=1}^n{a_ib_i} \right) ^2-\left( \sum\limits_{i=1}^n{a_{i}^{2}} \right) \left( \sum\limits_{i=1}^n{b_{i}^{2}} \right) \right).
\end{align*}
此时$A$必有两个特征值$\lambda _1,\lambda _2$满足
\begin{align*}
\lambda _1\lambda _2=\frac{\left( \sum\limits_{i=1}^n{a_ib_i} \right) ^2-\left( \sum\limits_{i=1}^n{a_{i}^{2}} \right) \left( \sum\limits_{i=1}^n{b_{i}^{2}} \right)}{4}<0\Longrightarrow \lambda _1,\lambda _2\ne 0\text{且异号}.
\end{align*}
故$A$只有两个异号的非零特征值.又$A$是实对称阵,故$A$必可对角化,即
\begin{align*}
A\sim \begin{pmatrix}
\lambda _1&		&		&		&		\\
&		\lambda _2&		&		&		\\
&		&		0&		&		\\
&		&		&		\ddots&		\\
&		&		&		&		0\\
\end{pmatrix}.
\end{align*}
此时$r( A ) =2$且$A$的符号差为$0.$

\end{proof}

\begin{example}
已知 $\mathscr{A},\mathscr{B},\mathscr{C}$ 是有限维线性空间上的三个线性变换, 证明: $\mathscr{A} + \mathscr{B} - \mathscr{A}\mathscr{C}\mathscr{B}$ 和 $\mathscr{A} + \mathscr{B} - \mathscr{B}\mathscr{C}\mathscr{A}$ 核空间是同构的.
\end{example}
\begin{proof}
设$\mathscr{A} ,\mathscr{B} ,\mathscr{C} $都是$n$维线性空间上的线性变换,并且在同一组基下的表示矩阵分别为$A,B,C$.注意到
\begin{align*}
\begin{pmatrix}
E&		-B\\
E-AC&		A\\
\end{pmatrix} \xrightarrow{j_1\cdot B+j_2}\begin{pmatrix}
E&		O\\
E-AC&		A+B-ACB\\
\end{pmatrix} \xrightarrow{-( E-AC ) \cdot r_1+r_2}\begin{pmatrix}
E&		O\\
O&		A+B-ACB\\
\end{pmatrix},
\end{align*}
\begin{align*}
\begin{pmatrix}
E&		-B\\
E-AC&		A\\
\end{pmatrix} \xrightarrow{j_2\cdot C+j_1}\begin{pmatrix}
E-BC&		-B\\
E&		A\\
\end{pmatrix} \xrightarrow{j_1\cdot ( -A ) +j_2}\begin{pmatrix}
E-BC&		-A-B+BCA\\
E&		O\\
\end{pmatrix} \xrightarrow[(-1) \cdot j_2]{-( E-BC ) \cdot r_2+r_1}\begin{pmatrix}
O&		A+B-BCA\\
E&		O\\
\end{pmatrix}.
\end{align*}
故
\begin{align*}
r\begin{pmatrix}
E&		-B\\
E-AC&		A\\
\end{pmatrix} =r\begin{pmatrix}
E&		O\\
O&		A+B-ACB\\
\end{pmatrix} =r\begin{pmatrix}
O&		A+B-BCA\\
E&		O\\
\end{pmatrix},
\end{align*}
进而
\begin{align*}
r( A+B-ACB ) =r( A+B-BCA ) \Longleftrightarrow \mathrm{dim}\,\mathrm{Ker}( \mathscr{A} +\mathscr{B} -\mathscr{A} \mathscr{C} \mathscr{B} ) =\mathrm{dim}\,\mathrm{Ker}( \mathscr{A} +\mathscr{B} -\mathscr{B} \mathscr{C} \mathscr{A} ).
\end{align*}

\end{proof}

\begin{example}

\end{example}
\begin{proof}


\end{proof}

\begin{example}

\end{example}
\begin{proof}


\end{proof}

\begin{example}

\end{example}
\begin{proof}


\end{proof}

\begin{example}

\end{example}
\begin{proof}


\end{proof}

\begin{example}

\end{example}
\begin{proof}


\end{proof}

\begin{example}

\end{example}
\begin{proof}


\end{proof}

\begin{example}

\end{example}
\begin{proof}


\end{proof}

\begin{example}

\end{example}
\begin{proof}


\end{proof}

\begin{example}

\end{example}
\begin{proof}


\end{proof}

\begin{example}

\end{example}
\begin{proof}


\end{proof}

\begin{example}

\end{example}
\begin{proof}


\end{proof}



























\end{document}
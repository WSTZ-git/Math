% contents/chapter-03/section-07.tex 第三章第三节
\documentclass[../../main.tex]{subfiles}
\graphicspath{{\subfix{../../image/}}} % 指定图片目录,后续可以直接使用图片文件名。

% 例如:
% \begin{figure}[H]
% \centering
% \includegraphics[scale=0.4]{图.png}
% \caption{}
% \label{figure:图}
% \end{figure}
% 注意:上述\label{}一定要放在\caption{}之后,否则引用图片序号会只会显示??.

\begin{document}

\section{相抵标准型及其应用}

\begin{theorem}[矩阵的相抵标准型]\label{theorem:矩阵的相抵标准型}
对任意一个秩为\(r\)的\(m\times n\)矩阵\(\boldsymbol{A}\),总存在\(m\)阶非异阵\(\boldsymbol{P}\)和\(n\)阶非异阵\(\boldsymbol{Q}\),使得
\[
\boldsymbol{P}\boldsymbol{A}\boldsymbol{Q}=\begin{pmatrix}
\boldsymbol{I}_r&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{O}
\end{pmatrix}.
\]
\end{theorem}
\begin{proof}

\end{proof}

\begin{proposition}[矩阵的秩1分解]\label{proposition:矩阵的秩1分解}
求证: 秩等于\(r\)的矩阵可以表示为\(r\)个秩等于\(1\)的矩阵之和,但不能表示为少于\(r\)个秩为\(1\)的矩阵之和.
\end{proposition}
\begin{proof}
将\(\boldsymbol{A}\)化为相抵标准型,即存在非异矩阵\(\boldsymbol{P}\)及\(\boldsymbol{Q}\),使得
\begin{align*}
\boldsymbol{A}&=\boldsymbol{P}\left( \begin{matrix}
\boldsymbol{I}_r&		\boldsymbol{O}\\
\boldsymbol{O}&		\boldsymbol{O}\\
\end{matrix} \right) \boldsymbol{Q}=\boldsymbol{P}\left( \boldsymbol{E}_{11}+\boldsymbol{E}_{22}+\cdots +\boldsymbol{E}_{rr} \right) \boldsymbol{Q}
\\
&=\boldsymbol{PE}_{11}\boldsymbol{Q}+\boldsymbol{PE}_{22}\boldsymbol{Q}+\cdots +\boldsymbol{PE}_{rr}\boldsymbol{Q}.
\end{align*}
于是记$\boldsymbol{A}_1=\boldsymbol{PE}_{11}\boldsymbol{Q},\boldsymbol{A}_2=\boldsymbol{PE}_{22}\boldsymbol{Q},\cdots ,\boldsymbol{A}_r=\boldsymbol{PE}_{rr}\boldsymbol{Q}$,则每个$\boldsymbol{A}_i$的秩都等于1.故$\boldsymbol{A}$可以化为$r$个秩等于1的矩阵之和.

若\(\boldsymbol{A}=\boldsymbol{B}_1+\boldsymbol{B}_2+\cdots+\boldsymbol{B}_k,k < r\),且每个\(\boldsymbol{B}_i\)的秩都等于\(1\),则由\hyperref[矩阵秩的基本公式5]{命题\ref{proposition:矩阵秩的基本公式}\ref{矩阵秩的基本公式5}}可知\(\mathrm{r}(\boldsymbol{A})\leqslant \mathrm{r}(\boldsymbol{B}_1)+\mathrm{r}(\boldsymbol{B}_2)+\cdots+\mathrm{r}(\boldsymbol{B}_k)=k\),这与\(\mathrm{r}(\boldsymbol{A}) = r\)矛盾,故不可能.
\end{proof}

\begin{example}\label{example:3.251111}
设\(\boldsymbol{A},\boldsymbol{B},\boldsymbol{C}\)分别为\(m\times n,p\times q\)和\(m\times q\)矩阵,\(\boldsymbol{M}=\begin{pmatrix}
\boldsymbol{A}&\boldsymbol{C}\\
\boldsymbol{O}&\boldsymbol{B}
\end{pmatrix}\). 证明:\(\mathrm{r}(\boldsymbol{M})=\mathrm{r}(\boldsymbol{A})+\mathrm{r}(\boldsymbol{B})\)成立的充要条件是矩阵方程\(\boldsymbol{A}\boldsymbol{X}+\boldsymbol{Y}\boldsymbol{B}=\boldsymbol{C}\)有解,其中\(\boldsymbol{X},\boldsymbol{Y}\)分别是\(n\times q\)和\(m\times p\)未知矩阵.
\end{example}
\begin{note}
证明必要性时不妨设的原因:假设当\(\boldsymbol{A}=\begin{pmatrix}
\boldsymbol{I}_r & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{O}
\end{pmatrix}\),\(\boldsymbol{B}=\begin{pmatrix}
\boldsymbol{I}_s & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{O}
\end{pmatrix}\)时,结论成立.则当\(\boldsymbol{A}\neq\begin{pmatrix}
\boldsymbol{I}_r & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{O}
\end{pmatrix}\),\(\boldsymbol{B}\neq\begin{pmatrix}
\boldsymbol{I}_s & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{O}
\end{pmatrix}\)时,记\(\boldsymbol{A}_1 = \boldsymbol{P}_1\boldsymbol{AQ}_1=\begin{pmatrix}
\boldsymbol{I}_r & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{O}
\end{pmatrix}\),\(\boldsymbol{B}_1 = \boldsymbol{P}_2\boldsymbol{BQ}_2=\begin{pmatrix}
\boldsymbol{I}_{s} & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{O}
\end{pmatrix}\),\(\boldsymbol{C}_1 = \boldsymbol{P}_1\boldsymbol{CQ}_2\),\(\boldsymbol{M}_1=\begin{pmatrix}
\boldsymbol{A}_1 & \boldsymbol{C}_1 \\
\boldsymbol{O} & \boldsymbol{B}_1
\end{pmatrix}\).

由于矩阵乘可逆矩阵不改变其秩,因此
\begin{align*}
\mathrm{r}(\boldsymbol{A})&=\mathrm{r}(\boldsymbol{P}_1\boldsymbol{AQ}_1)=\mathrm{r}\begin{pmatrix}
\boldsymbol{I}_r & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{O}
\end{pmatrix}=\mathrm{r}(\boldsymbol{A}_1),\\
\mathrm{r}(\boldsymbol{B})&=\mathrm{r}(\boldsymbol{P}_2\boldsymbol{BQ}_2)=\mathrm{r}\begin{pmatrix}
\boldsymbol{I}_s & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{O}
\end{pmatrix}=\mathrm{r}(\boldsymbol{B}_1),\\
\mathrm{r}(\boldsymbol{M})&=\mathrm{r}\begin{pmatrix}
\boldsymbol{A} & \boldsymbol{C} \\
\boldsymbol{O} & \boldsymbol{B}
\end{pmatrix}=\mathrm{r}\left(\begin{pmatrix}
\boldsymbol{P}_1 & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{P}_2
\end{pmatrix}\begin{pmatrix}
\boldsymbol{A} & \boldsymbol{C} \\
\boldsymbol{O} & \boldsymbol{B}
\end{pmatrix}\begin{pmatrix}
\boldsymbol{Q}_1 & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{Q}_2
\end{pmatrix}\right)
=\mathrm{r}\begin{pmatrix}
\boldsymbol{P}_1\boldsymbol{AQ}_1 & \boldsymbol{P}_1\boldsymbol{CQ}_2 \\
\boldsymbol{O} & \boldsymbol{P}_2\boldsymbol{BQ}_2
\end{pmatrix}=\mathrm{r}(\boldsymbol{M}_1).
\end{align*}
从而
\[
\mathrm{r}(\boldsymbol{M})=\mathrm{r}(\boldsymbol{A})+\mathrm{r}(\boldsymbol{B})\Leftrightarrow\mathrm{r}(\boldsymbol{M}_1)=\mathrm{r}\begin{pmatrix}
\boldsymbol{A}_1 & \boldsymbol{C}_1 \\
\boldsymbol{O} & \boldsymbol{B}_1
\end{pmatrix}=\mathrm{r}(\boldsymbol{A}_1)+\mathrm{r}(\boldsymbol{B}_1).
\]
于是由假设可知\(\boldsymbol{A}_1\boldsymbol{X}_1+\boldsymbol{Y}_1\boldsymbol{B}_1=\boldsymbol{C}_1\)有解\(\boldsymbol{X}_1,\boldsymbol{Y}_1\).记\(\boldsymbol{X}=\boldsymbol{Q}_1\boldsymbol{X}_1\boldsymbol{Q}_{2}^{-1}\),\(\boldsymbol{Y}=\boldsymbol{P}_{1}^{-1}\boldsymbol{Y}_1\boldsymbol{P}_2\),则
\begin{align*}
&\boldsymbol{A}_1\boldsymbol{X}_1+\boldsymbol{Y}_1\boldsymbol{B}_1=\boldsymbol{C}_1\text{有解}\boldsymbol{X}_1,\boldsymbol{Y}_1\\
\Leftrightarrow&\boldsymbol{P}_1\boldsymbol{AQ}_1\boldsymbol{X}_1+\boldsymbol{Y}_1\boldsymbol{P}_2\boldsymbol{BQ}_2=\boldsymbol{P}_1\boldsymbol{CQ}_2\text{有解}\boldsymbol{X}_1,\boldsymbol{Y}_1\\
\Leftrightarrow&\boldsymbol{AQ}_1\boldsymbol{X}_1\boldsymbol{Q}_{2}^{-1}+\boldsymbol{P}_{1}^{-1}\boldsymbol{Y}_1\boldsymbol{P}_2\boldsymbol{B}=\boldsymbol{C}\text{有解}\boldsymbol{X}_1,\boldsymbol{Y}_1\\
\Leftrightarrow&\boldsymbol{AX}+\boldsymbol{YB}=\boldsymbol{C}\text{有解}\boldsymbol{X},\boldsymbol{Y}
\end{align*}
故可以不妨设\(\boldsymbol{A}=\begin{pmatrix}
\boldsymbol{I}_r & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{O}
\end{pmatrix}\),\(\boldsymbol{B}=\begin{pmatrix}
\boldsymbol{I}_s & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{O}
\end{pmatrix}\).
\end{note}
\begin{proof}
先证充分性. 设\(\boldsymbol{X}=\boldsymbol{X}_0,\boldsymbol{Y}=\boldsymbol{Y}_0\)是矩阵方程\(\boldsymbol{A}\boldsymbol{X}+\boldsymbol{Y}\boldsymbol{B}=\boldsymbol{C}\)的解,则将\(\boldsymbol{M}\)的第一分块列右乘\(-\boldsymbol{X}_0\)加到第二分块列上,再将第二分块行左乘\(-\boldsymbol{Y}_0\)加到第一分块行上,可得分块对角阵\(\begin{pmatrix}
\boldsymbol{A}&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{B}
\end{pmatrix}\),于是\(\mathrm{r}(\boldsymbol{M})=\mathrm{r}\begin{pmatrix}
\boldsymbol{A}&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{B}
\end{pmatrix}=\mathrm{r}(\boldsymbol{A})+\mathrm{r}(\boldsymbol{B})\).

再证必要性. 设\(\boldsymbol{P}_1\boldsymbol{A}\boldsymbol{Q}_1=\begin{pmatrix}
\boldsymbol{I}_r&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{O}
\end{pmatrix},\boldsymbol{P}_2\boldsymbol{B}\boldsymbol{Q}_2=\begin{pmatrix}
\boldsymbol{I}_s&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{O}
\end{pmatrix}\),其中\(\boldsymbol{P}_1,\boldsymbol{Q}_1,\boldsymbol{P}_2,\boldsymbol{Q}_2\)为非异阵,\(r = \mathrm{r}(\boldsymbol{A}),s=\mathrm{r}(\boldsymbol{B})\). 注意到问题的条件和结论在相抵变换:
\(\boldsymbol{A}\mapsto\boldsymbol{P}_1\boldsymbol{A}\boldsymbol{Q}_1,\boldsymbol{B}\mapsto\boldsymbol{P}_2\boldsymbol{B}\boldsymbol{Q}_2,\boldsymbol{C}\mapsto\boldsymbol{P}_1\boldsymbol{C}\boldsymbol{Q}_2,\boldsymbol{X}\mapsto\boldsymbol{Q}_1^{-1}\boldsymbol{X}\boldsymbol{Q}_2,\boldsymbol{Y}\mapsto\boldsymbol{P}_1\boldsymbol{Y}\boldsymbol{P}_2^{-1}\)
下保持不变,故不妨从一开始就假设\(\boldsymbol{A}=\begin{pmatrix}
\boldsymbol{I}_r&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{O}
\end{pmatrix},\boldsymbol{B}=\begin{pmatrix}
\boldsymbol{I}_s&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{O}
\end{pmatrix}\)都是相抵标准型. 设\(\boldsymbol{C}=\begin{pmatrix}
\boldsymbol{C}_1&\boldsymbol{C}_2\\
\boldsymbol{C}_3&\boldsymbol{C}_4
\end{pmatrix},\boldsymbol{X}=\begin{pmatrix}
\boldsymbol{X}_1&\boldsymbol{X}_2\\
\boldsymbol{X}_3&\boldsymbol{X}_4
\end{pmatrix},\boldsymbol{Y}=\begin{pmatrix}
\boldsymbol{Y}_1&\boldsymbol{Y}_2\\
\boldsymbol{Y}_3&\boldsymbol{Y}_4
\end{pmatrix}\)为对应的分块. 考虑\(\boldsymbol{M}\)的如下分块初等变换:
\[
\boldsymbol{M}=\begin{pmatrix}
\boldsymbol{I}_r&\boldsymbol{O}&\boldsymbol{C}_1&\boldsymbol{C}_2\\
\boldsymbol{O}&\boldsymbol{O}&\boldsymbol{C}_3&\boldsymbol{C}_4\\
\boldsymbol{O}&\boldsymbol{O}&\boldsymbol{I}_s&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{O}&\boldsymbol{O}&\boldsymbol{O}
\end{pmatrix}\to\begin{pmatrix}
\boldsymbol{I}_r&\boldsymbol{O}&\boldsymbol{O}&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{O}&\boldsymbol{O}&\boldsymbol{C}_4\\
\boldsymbol{O}&\boldsymbol{O}&\boldsymbol{I}_s&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{O}&\boldsymbol{O}&\boldsymbol{O}
\end{pmatrix},
\]
由于\(\mathrm{r}(\boldsymbol{M})=\mathrm{r}(\boldsymbol{A})+\mathrm{r}(\boldsymbol{B})=r + s\),故\(\boldsymbol{C}_4=\boldsymbol{O}\). 于是矩阵方程\(\boldsymbol{A}\boldsymbol{X}+\boldsymbol{Y}\boldsymbol{B}=\boldsymbol{C}\),即
\[
\begin{pmatrix}
\boldsymbol{X}_1&\boldsymbol{X}_2\\
\boldsymbol{O}&\boldsymbol{O}
\end{pmatrix}+\begin{pmatrix}
\boldsymbol{Y}_1&\boldsymbol{O}\\
\boldsymbol{Y}_3&\boldsymbol{O}
\end{pmatrix}=\begin{pmatrix}
\boldsymbol{X}_1+\boldsymbol{Y}_1&\boldsymbol{X}_2\\
\boldsymbol{Y}_3&\boldsymbol{O}
\end{pmatrix}=\begin{pmatrix}
\boldsymbol{C}_1&\boldsymbol{C}_2\\
\boldsymbol{C}_3&\boldsymbol{O}
\end{pmatrix}
\]
有解,例如\(\boldsymbol{X}_1=\boldsymbol{C}_1,\boldsymbol{X}_2=\boldsymbol{C}_2,\boldsymbol{Y}_1=\boldsymbol{O},\boldsymbol{Y}_3=\boldsymbol{C}_3\),其余分块取法任意.
\end{proof}

\begin{proposition}[行/列满秩矩阵性质]\label{proposition:行/列满秩矩阵性质}
由\hyperref[theorem:相抵标准型]{矩阵的相抵标准型}可设\(\boldsymbol{A}\)是\(m\times n\)矩阵,则
\begin{enumerate}[(1)]
\item 若\(\mathrm{r}(\boldsymbol{A}) = n\),即\(\boldsymbol{A}\)是列满秩阵,则必存在秩等于\(n\)的\(n\times m\)矩阵\(\boldsymbol{B}\)(行满秩),使得\(\boldsymbol{B}\boldsymbol{A}=\boldsymbol{I}_n\)(这样的矩阵\(\boldsymbol{B}\)称为\(\boldsymbol{A}\)的左逆);
\item 若\(\mathrm{r}(\boldsymbol{A}) = m\),即\(\boldsymbol{A}\)是行满秩阵,则必存在秩等于\(m\)的\(n\times m\)矩阵\(\boldsymbol{C}\)(列满秩),使得\(\boldsymbol{A}\boldsymbol{C}=\boldsymbol{I}_m\)(这样的矩阵\(\boldsymbol{C}\)称为\(\boldsymbol{A}\)的右逆).
\end{enumerate}
\end{proposition}
\begin{proof}
\begin{enumerate}[(1)]
\item 设\(\boldsymbol{P}\)为\(m\)阶非异阵,\(\boldsymbol{Q}\)为\(n\)阶非异阵,使得
\[
\boldsymbol{P}\boldsymbol{A}\boldsymbol{Q}=\begin{pmatrix}
\boldsymbol{I}_n\\
\boldsymbol{O}
\end{pmatrix},
\]
因此\((\boldsymbol{I}_n,\boldsymbol{O})\boldsymbol{P}\boldsymbol{A}\boldsymbol{Q}=\boldsymbol{I}_n\),即\((\boldsymbol{I}_n,\boldsymbol{O})\boldsymbol{P}\boldsymbol{A}=\boldsymbol{Q}^{-1}\),于是\(\boldsymbol{Q}(\boldsymbol{I}_n,\boldsymbol{O})\boldsymbol{P}\boldsymbol{A}=\boldsymbol{I}_n\). 令\(\boldsymbol{B}=\boldsymbol{Q}(\boldsymbol{I}_n,\boldsymbol{O})\boldsymbol{P}\)即可.

\item 同理可证,或者考虑\(\boldsymbol{A}'\)并利用(1)的结论.
\end{enumerate}
\end{proof}

\begin{corollary}\label{corollary:列满秩矩阵适合左消去律/行满秩矩阵适合右消去律}
列满秩矩阵适合左消去律,即若\(\boldsymbol{A}\)列满秩且\(\boldsymbol{A}\boldsymbol{D}=\boldsymbol{A}\boldsymbol{E}\),则\(\boldsymbol{D}=\boldsymbol{E}\). 同理,行满秩矩阵适合右消去律,即若\(\boldsymbol{A}\)行满秩且\(\boldsymbol{D}\boldsymbol{A}=\boldsymbol{E}\boldsymbol{A}\),则\(\boldsymbol{D}=\boldsymbol{E}\).
\end{corollary}

\begin{proposition}[满秩分解]\label{proposition:矩阵的满秩分解}
设\(m\times n\)矩阵\(\boldsymbol{A}\)的秩为\(r\),证明:
\begin{enumerate}[(1)]
\item \(\boldsymbol{A}=\boldsymbol{B}\boldsymbol{C}\),其中\(\boldsymbol{B}\)是\(m\times r\)(列满秩)矩阵且\(\mathrm{r}(\boldsymbol{B}) = r\),\(\boldsymbol{C}\)是\(r\times n\)(行满秩)矩阵且\(\mathrm{r}(\boldsymbol{C}) = r\),这种分解称为\(\boldsymbol{A}\)的满秩分解；
\item 若\(\boldsymbol{A}\)有两个满秩分解\(\boldsymbol{A}=\boldsymbol{B}_1\boldsymbol{C}_1=\boldsymbol{B}_2\boldsymbol{C}_2\),则存在\(r\)阶非异阵\(\boldsymbol{P}\),使得\(\boldsymbol{B}_2=\boldsymbol{B}_1\boldsymbol{P}\),\(\boldsymbol{C}_2=\boldsymbol{P}^{-1}\boldsymbol{C}_1\).
\end{enumerate}
\end{proposition}
\begin{proof}
\begin{enumerate}[(1)]
\item 设\(\boldsymbol{P}\)为\(m\)阶非异阵,\(\boldsymbol{Q}\)为\(n\)阶非异阵,使得
\[
\boldsymbol{A}=\boldsymbol{P}\begin{pmatrix}
\boldsymbol{I}_r&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{O}
\end{pmatrix}\boldsymbol{Q}=\boldsymbol{P}\begin{pmatrix}
\boldsymbol{I}_r\\
\boldsymbol{O}
\end{pmatrix}(\boldsymbol{I}_r,\boldsymbol{O})\boldsymbol{Q}.
\]
令\(\boldsymbol{B}=\boldsymbol{P}\begin{pmatrix}
\boldsymbol{I}_r\\
\boldsymbol{O}
\end{pmatrix}\),\(\boldsymbol{C}=(\boldsymbol{I}_r,\boldsymbol{O})\boldsymbol{Q}\),即得结论.

\item  由\hyperref[proposition:行/列满秩矩阵性质]{行/列满秩矩阵性质}可知,存在\(r\times m\)行满秩阵\(\boldsymbol{S}_2\),\(n\times r\)列满秩阵\(\boldsymbol{T}_2\),使得\(\boldsymbol{S}_2\boldsymbol{B}_2=\boldsymbol{I}_r\),\(\boldsymbol{C}_2\boldsymbol{T}_2=\boldsymbol{I}_r\),于是
\begin{align*}
\boldsymbol{B}_2&=\boldsymbol{B}_2(\boldsymbol{C}_2\boldsymbol{T}_2)=(\boldsymbol{B}_2\boldsymbol{C}_2)\boldsymbol{T}_2=(\boldsymbol{B}_1\boldsymbol{C}_1)\boldsymbol{T}_2=\boldsymbol{B}_1(\boldsymbol{C}_1\boldsymbol{T}_2),\\
\boldsymbol{C}_2&=(\boldsymbol{S}_2\boldsymbol{B}_2)\boldsymbol{C}_2=\boldsymbol{S}_2(\boldsymbol{B}_2\boldsymbol{C}_2)=\boldsymbol{S}_2(\boldsymbol{B}_1\boldsymbol{C}_1)=(\boldsymbol{S}_2\boldsymbol{B}_1)\boldsymbol{C}_1,\\
(\boldsymbol{S}_2\boldsymbol{B}_1)(\boldsymbol{C}_1\boldsymbol{T}_2)&=\boldsymbol{S}_2(\boldsymbol{B}_1\boldsymbol{C}_1)\boldsymbol{T}_2=\boldsymbol{S}_2(\boldsymbol{B}_2\boldsymbol{C}_2)\boldsymbol{T}_2=(\boldsymbol{S}_2\boldsymbol{B}_2)(\boldsymbol{C}_2\boldsymbol{T}_2)=\boldsymbol{I}_r.
\end{align*}
令\(\boldsymbol{P}=\boldsymbol{C}_1\boldsymbol{T}_2\),即得结论.
\end{enumerate}
\end{proof}

\begin{proposition}\label{proposition:几何观点下的矩阵满秩分解}
\(\boldsymbol{A}=\boldsymbol{B}\boldsymbol{C}\)是满秩分解当且仅当\(\boldsymbol{B}\)的\(r\)个列向量是\(\boldsymbol{A}\)的\(n\)个列向量张成线性空间的一组基,也当且仅当\(\boldsymbol{C}\)的\(r\)个行向量是\(\boldsymbol{A}\)的\(m\)个行向量张成线性空间的一组基.
\end{proposition}

\begin{proof}

\end{proof}

\begin{example}\label{example:3.26111}
设\(\boldsymbol{A}\)为\(m\times n\)矩阵,证明:存在\(n\times m\)矩阵\(\boldsymbol{B}\),使得\(\boldsymbol{A}\boldsymbol{B}\boldsymbol{A}=\boldsymbol{A}\).
\end{example}
\begin{note}
{\color{blue}证法一}的不妨设原因与\hyperref[example:3.251111]{例题\ref{example:3.251111}}类似.
\end{note}
\begin{proof}
{\color{blue}证法一:}
设\(\boldsymbol{P}\boldsymbol{A}\boldsymbol{Q}=\begin{pmatrix}
\boldsymbol{I}_r&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{O}
\end{pmatrix}\),其中\(\boldsymbol{P}\)是\(m\)阶非异阵,\(\boldsymbol{Q}\)是\(n\)阶非异阵. 注意到问题的条件和结论在相抵变换:\(\boldsymbol{A}\mapsto\boldsymbol{P}\boldsymbol{A}\boldsymbol{Q},\boldsymbol{B}\mapsto\boldsymbol{Q}^{-1}\boldsymbol{B}\boldsymbol{P}^{-1}\)下保持不变,故不妨从一开始就假设\(\boldsymbol{A}=\begin{pmatrix}
\boldsymbol{I}_r&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{O}
\end{pmatrix}\)是相抵标准型. 设\(\boldsymbol{B}=\begin{pmatrix}
\boldsymbol{B}_1&\boldsymbol{B}_2\\
\boldsymbol{B}_3&\boldsymbol{B}_4
\end{pmatrix}\)为对应的分块,由\(\boldsymbol{A}\boldsymbol{B}\boldsymbol{A}=\boldsymbol{A}\)可得\(\boldsymbol{B}_1=\boldsymbol{I}_r\),其余分块取法任意.

{\color{blue}证法二:}设\(\boldsymbol{A}=\boldsymbol{C}\boldsymbol{D}\)为\(\boldsymbol{A}\)的满秩分解,\(\boldsymbol{E}\)为列满秩阵\(\boldsymbol{C}\)的左逆,\(\boldsymbol{F}\)是行满秩阵\(\boldsymbol{D}\)的右逆. 令\(\boldsymbol{B}=\boldsymbol{F}\boldsymbol{E}\),则
\[
\boldsymbol{A}\boldsymbol{B}\boldsymbol{A}=(\boldsymbol{C}\boldsymbol{D})(\boldsymbol{F}\boldsymbol{E})(\boldsymbol{C}\boldsymbol{D})=\boldsymbol{C}(\boldsymbol{D}\boldsymbol{F})(\boldsymbol{E}\boldsymbol{C})\boldsymbol{D}=\boldsymbol{C}\boldsymbol{D}=\boldsymbol{A}.
\]
\end{proof}

\begin{example}
设\(\boldsymbol{A},\boldsymbol{B}\)分别是\(3\times2,2\times3\)矩阵且满足
\[
\boldsymbol{A}\boldsymbol{B}=\begin{pmatrix}
8&2&-2\\
2&5&4\\
-2&4&5
\end{pmatrix},
\]
试求\(\boldsymbol{B}\boldsymbol{A}\).
\end{example}
\begin{proof}
{\color{blue}解法一:}
通过简单的计算可得\(\mathrm{r}(\boldsymbol{A}\boldsymbol{B}) = 2\),从而\(\mathrm{r}(\boldsymbol{A})\geqslant 2,\mathrm{r}(\boldsymbol{B})\geqslant 2\). 又因为矩阵的秩不超过行数和列数的最小值,故\(\mathrm{r}(\boldsymbol{A})=\mathrm{r}(\boldsymbol{B}) = 2\),即\(\boldsymbol{A}\)是列满秩阵,\(\boldsymbol{B}\)是行满秩阵. 又注意到\((\boldsymbol{A}\boldsymbol{B})^2 = 9\boldsymbol{A}\boldsymbol{B}\),经整理可得\(\boldsymbol{A}(\boldsymbol{B}\boldsymbol{A}-9\boldsymbol{I}_2)\boldsymbol{B}=\boldsymbol{O}\). 根据\hyperref[corollary:列满秩矩阵适合左消去律/行满秩矩阵适合右消去律]{推论\ref{corollary:列满秩矩阵适合左消去律/行满秩矩阵适合右消去律}},可以在上式的左边消去\(\boldsymbol{A}\),右边消去\(\boldsymbol{B}\),从而可得\(\boldsymbol{B}\boldsymbol{A}=9\boldsymbol{I}_2\).

{\color{blue}解法二:}由{\color{blue}解法一}中矩阵秩的计算可知,\(\boldsymbol{A}\boldsymbol{B}\)是题中\(3\)阶矩阵\(\boldsymbol{C}\)的满秩分解. 注意到\(\boldsymbol{C}\)的后两列线性无关,因此可取另一种满秩分解为
\[
\boldsymbol{C}=\begin{pmatrix}
2&-2\\
5&4\\
4&5
\end{pmatrix}\begin{pmatrix}
2&1&0\\
-2&0&1
\end{pmatrix}=\boldsymbol{A}_1\boldsymbol{B}_1.
\]
由\hyperref[proposition:矩阵的满秩分解]{矩阵的满秩分解(2)}可知,存在可逆矩阵$\boldsymbol{P}$,使得$\boldsymbol{A}_1=\boldsymbol{AP},\boldsymbol{B}_1=\boldsymbol{P}^{-1}\boldsymbol{B}$.于是$\boldsymbol{B}_1\boldsymbol{A}_1=\boldsymbol{P}^{-1}\boldsymbol{BAP}$,故
\(\boldsymbol{B}\boldsymbol{A}\)相似于\(\boldsymbol{B}_1\boldsymbol{A}_1 = 9\boldsymbol{I}_2\),从而\(\boldsymbol{B}\boldsymbol{A}=\boldsymbol{P}^{-1}(9\boldsymbol{I}_2)\boldsymbol{P}=9\boldsymbol{I}_2\). 

{\color{blue}解法三:}
经简单的计算可得\(|\lambda\boldsymbol{I}_3 - \boldsymbol{A}\boldsymbol{B}| = \lambda(\lambda - 9)^2\), 且特征值\(9\)的几何重数也等于\(2\), 因此\(\boldsymbol{A}\boldsymbol{B}\)可对角化. 由\hyperref[theorem:特征值的降价公式]{特征值的降价公式}可得\(|\lambda\boldsymbol{I}_2 - \boldsymbol{B}\boldsymbol{A}| = (\lambda - 9)^2\), 从而\(\boldsymbol{B}\boldsymbol{A}\)的两个特征值都是\(9\), 于是\(\boldsymbol{B}\boldsymbol{A}\)是可逆矩阵(特征值都非零). 因此由\hyperref[proposition:矩阵乘积可对角化且可逆则交换后也可对角化]{命题\ref{proposition:矩阵乘积可对角化且可逆则交换后也可对角化}}可知\(\boldsymbol{B}\boldsymbol{A}\)也可对角化, 于是\(\boldsymbol{B}\boldsymbol{A}\)相似于\(9\boldsymbol{I}_2\), 即存在可逆矩阵\(\boldsymbol{P}\), 使得\(\boldsymbol{B}\boldsymbol{A} = \boldsymbol{P}^{-1}(9\boldsymbol{I}_2)\boldsymbol{P} = 9\boldsymbol{I}_2\). 
\end{proof}

\begin{proposition}[幂等矩阵关于满秩分解的刻画]\label{proposition:幂等矩阵关于满秩分解的刻画}
设\(\boldsymbol{A}\)是\(n\)阶方阵且\(\mathrm{r}(\boldsymbol{A}) = r\),求证:\(\boldsymbol{A}^2=\boldsymbol{A}\)的充要条件是存在秩等于\(r\)的\(n\times r\)矩阵\(\boldsymbol{S}\)和秩等于\(r\)的\(r\times n\)矩阵\(\boldsymbol{T}\),使得\(\boldsymbol{A}=\boldsymbol{S}\boldsymbol{T},\boldsymbol{T}\boldsymbol{S}=\boldsymbol{I}_r\).
\end{proposition}
\begin{proof}
充分性显然,现证必要性. 设\(\boldsymbol{P},\boldsymbol{Q}\)为\(n\)阶非异阵,使得
\[
\boldsymbol{A}=\boldsymbol{P}\begin{pmatrix}
\boldsymbol{I}_r&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{O}
\end{pmatrix}\boldsymbol{Q}.
\]
代入\(\boldsymbol{A}^2=\boldsymbol{A}\)消去两侧的非异阵\(\boldsymbol{P}\)和\(\boldsymbol{Q}\),可得
\[
\begin{pmatrix}
\boldsymbol{I}_r&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{O}
\end{pmatrix}=\begin{pmatrix}
\boldsymbol{I}_r&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{O}
\end{pmatrix}\boldsymbol{Q}\boldsymbol{P}\begin{pmatrix}
\boldsymbol{I}_r&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{O}
\end{pmatrix}.
\]
只需令
\[
\boldsymbol{S}=\boldsymbol{P}\begin{pmatrix}
\boldsymbol{I}_r&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{O}
\end{pmatrix}\begin{pmatrix}
\boldsymbol{I}_r\\
\boldsymbol{O}
\end{pmatrix},\boldsymbol{T}=(\boldsymbol{I}_r,\boldsymbol{O})\begin{pmatrix}
\boldsymbol{I}_r&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{O}
\end{pmatrix}\boldsymbol{Q},
\]
则$\boldsymbol{S}$列满秩,$\boldsymbol{I}$行满秩,经简单计算即得结论.
\end{proof}

\begin{corollary}[幂等矩阵的迹和秩相等]\label{corollary:幂等矩阵的迹和秩相等}
设\(\boldsymbol{A}\)为\(n\)阶幂等矩阵,则\(\mathrm{tr}(\boldsymbol{A})=\mathrm{r}(\boldsymbol{A})\).
\end{corollary}
\begin{proof}
{\color{blue}证法一:}由\hyperref[proposition:幂等矩阵关于满秩分解的刻画]{命题\ref{proposition:幂等矩阵关于满秩分解的刻画}}可知,\(\mathrm{tr}(\boldsymbol{A})=\mathrm{tr}(\boldsymbol{S}\boldsymbol{T})=\mathrm{tr}(\boldsymbol{T}\boldsymbol{S})=\mathrm{tr}(\boldsymbol{I}_r)=r=\mathrm{r}(\boldsymbol{A})\).

{\color{blue}证法二(相似标准型):}事实上,由\(\boldsymbol{A}^2=\boldsymbol{A}\)可知,存在可逆矩阵\(\boldsymbol{P}\),使得
\[
\boldsymbol{A}=\boldsymbol{P}\begin{pmatrix}
\boldsymbol{I}_r&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{O}
\end{pmatrix}\boldsymbol{P}^{-1}=\boldsymbol{P}\begin{pmatrix}
\boldsymbol{I}_r\\
\boldsymbol{O}
\end{pmatrix}(\boldsymbol{I}_r,\boldsymbol{O})\boldsymbol{P}^{-1},
\]
令\(\boldsymbol{S}=\boldsymbol{P}\begin{pmatrix}
\boldsymbol{I}_r\\
\boldsymbol{O}
\end{pmatrix},\boldsymbol{T}=(\boldsymbol{I}_r,\boldsymbol{O})\boldsymbol{P}^{-1}\),可得\(\mathrm{tr}(\boldsymbol{A})=\mathrm{tr}(\boldsymbol{S}\boldsymbol{T})=\mathrm{tr}(\boldsymbol{T}\boldsymbol{S})=\mathrm{tr}(\boldsymbol{I}_r)=r=\mathrm{r}(\boldsymbol{A})\).
\end{proof}

\begin{proposition}\label{proposition:矩阵和的秩等于秩的和可同时相抵标准化}
\begin{enumerate}
\item 设 $\boldsymbol{A},\boldsymbol{B}$ 均为 $m \times n$ 矩阵, 满足 ${\rm r}(\boldsymbol{A} + \boldsymbol{B}) = {\rm r}(\boldsymbol{A}) + {\rm r}(\boldsymbol{B})$, 证明: 存在 $m$ 阶非异阵 $\boldsymbol{P}$, $n$ 阶非异阵 $\boldsymbol{Q}$, 使得
$$
\boldsymbol{P}\boldsymbol{A}\boldsymbol{Q} = \begin{pmatrix}
\boldsymbol{I}_r & \boldsymbol{O} & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{O} & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{O} & \boldsymbol{O}
\end{pmatrix}, \quad \boldsymbol{P}\boldsymbol{B}\boldsymbol{Q} = \begin{pmatrix}
\boldsymbol{O} & \boldsymbol{O} & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{I}_s & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{O} & \boldsymbol{O}
\end{pmatrix}.
$$

\item 设 $\boldsymbol{A},\boldsymbol{B}$ 均为$n$阶实对称矩阵, 满足 ${\rm r}(\boldsymbol{A} + \boldsymbol{B}) = {\rm r}(\boldsymbol{A}) + {\rm r}(\boldsymbol{B})$, 证明: 存在$n$阶非异阵 $\boldsymbol{P}$,使得
$$
\boldsymbol{PAP}^{-1}=\left( \begin{matrix}
\boldsymbol{I}_r&		\boldsymbol{O}&		\boldsymbol{O}\\
\boldsymbol{O}&		\boldsymbol{O}&		\boldsymbol{O}\\
\boldsymbol{O}&		\boldsymbol{O}&		\boldsymbol{O}\\
\end{matrix} \right) ,\quad \boldsymbol{PBP}^{-1}=\left( \begin{matrix}
\boldsymbol{O}&		\boldsymbol{O}&		\boldsymbol{O}\\
\boldsymbol{O}&		\boldsymbol{I}_s&		\boldsymbol{O}\\
\boldsymbol{O}&		\boldsymbol{O}&		\boldsymbol{O}\\
\end{matrix} \right) .
$$
\end{enumerate}
\end{proposition}
\begin{note}
这个命题中的$\boldsymbol{I}_r$和$\boldsymbol{I}_s$都可以替换为主对角元都为相应矩阵特征值的对角阵(两边同乘主对角元为对应特征值根式的对角阵和其逆矩阵即可).
\end{note}
\begin{proof}
\begin{enumerate}
\item {\color{blue}证法一(代数方法):}设 ${\rm r}(\boldsymbol{A}) = r$, ${\rm r}(\boldsymbol{B}) = s$, 则 ${\rm r}(\boldsymbol{A} + \boldsymbol{B}) = r + s$, 且存在 $m$ 阶非异阵 $\boldsymbol{S}$, $n$ 阶非异阵 $\boldsymbol{T}$, 使得
$$
\boldsymbol{S}\boldsymbol{A}\boldsymbol{T} = \begin{pmatrix}
\boldsymbol{I}_r & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{O}
\end{pmatrix}, \quad \boldsymbol{S}\boldsymbol{B}\boldsymbol{T} = \begin{pmatrix}
\boldsymbol{B}_{11} & \boldsymbol{B}_{12} \\
\boldsymbol{B}_{21} & \boldsymbol{B}_{22}
\end{pmatrix}, \quad \boldsymbol{S}(\boldsymbol{A} + \boldsymbol{B})\boldsymbol{T} = \begin{pmatrix}
\boldsymbol{I}_r + \boldsymbol{B}_{11} & \boldsymbol{B}_{12} \\
\boldsymbol{B}_{21} & \boldsymbol{B}_{22}
\end{pmatrix}.
$$
因为 ${\rm r}(\boldsymbol{A} + \boldsymbol{B}) = r + s$, 故删去 $\boldsymbol{S}(\boldsymbol{A} + \boldsymbol{B})\boldsymbol{T}$ 的前 $r$ 行, 可得后 $m - r$ 行的秩必大于等于 $s$, 即 ${\rm r}(\boldsymbol{B}_{21}, \boldsymbol{B}_{22}) \geq s$. 另一方面, 我们还有 ${\rm r}(\boldsymbol{B}_{21}, \boldsymbol{B}_{22}) \leq {\rm r}(\boldsymbol{B}) = s$, 故 ${\rm r}(\boldsymbol{B}_{21}, \boldsymbol{B}_{22}) = {\rm r}(\boldsymbol{B}) = s$, 从而 $(\boldsymbol{B}_{21}, \boldsymbol{B}_{22})$ 的行向量的极大无关组也是 $\boldsymbol{S}\boldsymbol{B}\boldsymbol{T}$ 的行向量组的极大无关组. 因此利用 $\boldsymbol{S}\boldsymbol{B}\boldsymbol{T}$ 的后 $m - r$ 行的初等行变换可以消去 $\boldsymbol{S}\boldsymbol{B}\boldsymbol{T}$ 的前 $r$ 行. 同理可证利用 $\boldsymbol{S}\boldsymbol{B}\boldsymbol{T}$ 的后 $n - r$ 列的初等列变换可以消去 $\boldsymbol{S}\boldsymbol{B}\boldsymbol{T}$ 的前 $r$ 列, 即存在 $m$ 阶非异阵 $\boldsymbol{U}$, $n$ 阶非异阵 $\boldsymbol{V}$, 使得
$$
\boldsymbol{U}\boldsymbol{S}\boldsymbol{A}\boldsymbol{T}\boldsymbol{V} = \begin{pmatrix}
\boldsymbol{I}_r & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{O}
\end{pmatrix}, \quad \boldsymbol{U}\boldsymbol{S}\boldsymbol{B}\boldsymbol{T}\boldsymbol{V} = \begin{pmatrix}
\boldsymbol{O} & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{B}_{22}
\end{pmatrix}.
$$
此时存在 $m - r$ 阶非异阵 $\boldsymbol{C}$, $n - r$ 阶非异阵 $\boldsymbol{D}$, 使得 $\boldsymbol{C}\boldsymbol{B}_{22}\boldsymbol{D} = \begin{pmatrix}
\boldsymbol{I}_s & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{O}
\end{pmatrix}$. 令 $\boldsymbol{P} = \begin{pmatrix}
\boldsymbol{I}_r & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{C}
\end{pmatrix}\boldsymbol{U}\boldsymbol{S}$, $\boldsymbol{Q} = \boldsymbol{T}\boldsymbol{V}\begin{pmatrix}
\boldsymbol{I}_r & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{D}
\end{pmatrix}$, 则 $\boldsymbol{P}$ 为 $m$ 阶非异阵, $\boldsymbol{Q}$ 为 $n$ 阶非异阵, 且满足结论.

{\color{blue}证法二(几何方法):}将问题转换成几何的语言: 设 $V = \mathbb{K}^n$ 为 $n$ 维列向量空间, $U = \mathbb{K}^m$ 为 $m$ 维列向量空间, $\varphi_{\boldsymbol{A}}, \varphi_{\boldsymbol{B}}: V \to U$ 分别是矩阵 $\boldsymbol{A}, \boldsymbol{B}$ 左乘诱导的线性映射, 满足 ${\rm r}(\varphi_{\boldsymbol{A}} + \varphi_{\boldsymbol{B}}) = {\rm r}(\varphi_{\boldsymbol{A}}) + {\rm r}(\varphi_{\boldsymbol{B}})$, 证明: 存在 $V$ 的一组基, $U$ 的一组基, 使得 $\varphi_{\boldsymbol{A}}, \varphi_{\boldsymbol{B}}$ 在这两组基下的表示矩阵分别是题中的两个矩阵. 

设 ${\rm r}(\boldsymbol{A}) = r$, ${\rm r}(\boldsymbol{B}) = s$, 则 ${\rm r}(\boldsymbol{A} + \boldsymbol{B}) = r + s$. 由\nrefpro{proposition:矩阵秩的基本公式}{(5)}知
$$
{\rm r}(\boldsymbol{A} + \boldsymbol{B}) \leq {\rm r}\begin{pmatrix}
\boldsymbol{A} \\
\boldsymbol{B}
\end{pmatrix} \leq {\rm r}(\boldsymbol{A}) + {\rm r}(\boldsymbol{B}),$$
因此 ${\rm r}\begin{pmatrix}
\boldsymbol{A} \\
\boldsymbol{B}
\end{pmatrix} = r + s$, 从而 $\dim({\rm Ker}\varphi_{\boldsymbol{A}} \cap {\rm Ker}\varphi_{\boldsymbol{B}}) = n - (r + s)$. 由\hyperref[theorem:交和空间维数公式]{交和空间的维数公式}可得 
$$\dim({\rm Ker}\varphi_{\boldsymbol{A}} + {\rm Ker}\varphi_{\boldsymbol{B}}) = (n - r) + (n - s) - (n - r - s) = n,$$
又显然有$V\supset  {\rm Ker}\varphi_{\boldsymbol{A}} + {\rm Ker}\varphi_{\boldsymbol{B}}$,故有$V = {\rm Ker}\varphi_{\boldsymbol{A}} + {\rm Ker}\varphi_{\boldsymbol{B}}.$
另一方面, 注意到 
$${\rm r}(\boldsymbol{A} + \boldsymbol{B}) = \dim{\rm Im}(\varphi_{\boldsymbol{A}} + \varphi_{\boldsymbol{B}}) \leq \dim({\rm Im}\varphi_{\boldsymbol{A}} + {\rm Im}\varphi_{\boldsymbol{B}}) \leq \dim{\rm Im}\varphi_{\boldsymbol{A}} + \dim{\rm Im}\varphi_{\boldsymbol{B}} = {\rm r}(\boldsymbol{A}) + {\rm r}(\boldsymbol{B}),$$
因此 ${\rm Im}(\varphi_{\boldsymbol{A}} + \varphi_{\boldsymbol{B}}) = {\rm Im}\varphi_{\boldsymbol{A}} \oplus {\rm Im}\varphi_{\boldsymbol{B}}$. 

设 ${\rm Ker}\varphi_{\boldsymbol{A}} \cap {\rm Ker}\varphi_{\boldsymbol{B}}$ 的一组基为 $\{e_{r + s + 1}, \cdots, e_n\}$, 将其扩张为 ${\rm Ker}\varphi_{\boldsymbol{A}}$ 的一组基 $\{e_{r + 1},\cdots, e_n\},$再将其扩张为${\rm Ker}\varphi_{\boldsymbol{B}}$ 的一组基 $\{e_1,\cdots,e_r,e_{r+s+1},\cdots, e_n\}.$
根据\refcor{corollary:空间分解关于基的结论}可知, $\{e_1, \cdots, e_n\}$ 恰好是 $V = {\rm Ker}\varphi_{\boldsymbol{A}} + {\rm Ker}\varphi_{\boldsymbol{B}}$ 的一组基. 又由\refcor{corollary:由核的基导出值域的基}可知, $\boldsymbol{A}e_1, \cdots, \boldsymbol{A}e_r$ 是 ${\rm Im}\varphi_{\boldsymbol{A}}$ 的一组基, $\boldsymbol{B}e_{r + 1}, \cdots, \boldsymbol{B}e_{r + s}$ 是 ${\rm Im}\varphi_{\boldsymbol{B}}$ 的一组基.因为${\rm Im}(\varphi_{\boldsymbol{A}} + \varphi_{\boldsymbol{B}}) = {\rm Im}\varphi_{\boldsymbol{A}} \oplus {\rm Im}\varphi_{\boldsymbol{B}}$,所以$\boldsymbol{A}e_1$, $\cdots$, $\boldsymbol{A}e_r$, $\boldsymbol{B}e_{r + 1}$, $\cdots$, $\boldsymbol{B}e_{r + s}$ 线性无关,从而可扩张为 $U$ 的一组基 $$\{\boldsymbol{A}e_1,\cdots,\boldsymbol{A}e_r,\boldsymbol{B}e_{r + 1},\cdots, \boldsymbol{B}e_{r + s}, f_{r + s + 1}, \cdots, f_m\}.$$ 最后容易验证 $\varphi_{\boldsymbol{A}}, \varphi_{\boldsymbol{B}}$ 在 $V$ 的一组基$\{e_1, \cdots, e_n\}$, $U$ 的一组基$\{\boldsymbol{A}e_1$, $\cdots$, $\boldsymbol{A}e_r$, $\boldsymbol{B}e_{r + 1}$, $\cdots$, $\boldsymbol{B}e_{r + s}$, $f_{r + s + 1}$, $\cdots$, $f_m\}$下的表示矩阵即为所要求的矩阵.

\item 类似第1问的证明可得.
\end{enumerate}
\end{proof}






\end{document}
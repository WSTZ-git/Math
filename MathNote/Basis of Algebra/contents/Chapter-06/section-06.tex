\documentclass[../../main.tex]{subfiles}
\graphicspath{{\subfix{../../image/}}} % 指定图片目录,后续可以直接使用图片文件名。

% 例如:
% \begin{figure}[h]
% \centering
% \includegraphics{image-01.01}
% \caption{图片标题}
% \label{fig:image-01.01}
% \end{figure}
% 注意:上述\label{}一定要放在\caption{}之后,否则引用图片序号会只会显示??.

\begin{document}

\section{可对角化的判定}

\subsection{可对角化的基本知识}

\begin{definition}[可对角化线性变换]
若 $n$ 维线性空间 $V$ 上的线性变换 $\varphi$ 在某组基 $\{e_1, e_2, \cdots, e_n\}$ 下的表示矩阵为对角阵：
\[
\begin{pmatrix}
\lambda_1 & & & \\
& \lambda_2 & & \\
& & \ddots & \\
& & & \lambda_n
\end{pmatrix},
\]
则称 $\varphi$ 为\textbf{可对角化线性变换}.
\end{definition}

\begin{theorem}[线性变换可对角化的充要条件]\label{theorem:线性变换可对角化的充要条件}
设 $\varphi$ 是 $n$ 维线性空间 $V$ 上的线性变换，则 $\varphi$ 可对角化的充分必要条件是 $\varphi$ 有 $n$ 个线性无关的特征向量。
\end{theorem}
\begin{proof}
若$\varphi$ 是$V$上可对角化线性变换,则可设$\varphi$ 在某组基 $\{e_1, e_2, \cdots, e_n\}$ 下的表示矩阵为对角阵：
\[
\begin{pmatrix}
\lambda_1 & & & \\
& \lambda_2 & & \\
& & \ddots & \\
& & & \lambda_n
\end{pmatrix},
\]
此时 $\varphi(e_i) = \lambda_i e_i$，即 $e_1, e_2, \cdots, e_n$ 是 $\varphi$ 的特征向量，于是 $\varphi$ 有 $n$ 个线性无关的特征向量。

反过来，若 $n$ 维线性空间 $V$ 上的线性变换 $\varphi$ 有 $n$ 个线性无关的特征向量 $e_1, e_2, \cdots, e_n$，则这组向量构成了 $V$ 的一组基，且 $\varphi$ 在这组基下的表示矩阵显然是一个对角阵。
\end{proof}

\begin{definition}[可对角化矩阵]
设 $A$ 是 $n$ 阶矩阵, 若 $A$ 相似于对角阵, 即存在可逆阵 $P$, 使 $P^{-1}AP$ 为对角阵, 则称 $A$ 为\textbf{可对角化矩阵}.
\end{definition}

\begin{lemma}\label{lemma:线性变换与矩阵的可对角化等价,特征值相同}
设$A$是$n$阶矩阵,$\varphi$ 是线性空间 $V$ 上由矩阵 $A$ 乘法诱导的线性变换，即 $\varphi(\alpha) = A\alpha, \forall \alpha \in V$。设 $\{e_1, e_2, \cdots, e_n\}$ 是 $V$ 的一组标准基，则 $\varphi$ 在这组基下的矩阵就是 $A$。证明：
\begin{enumerate}[(1)]
\item 矩阵 $A$ 与线性变换 $\varphi$ 的特征值相同；

\item 矩阵 $A$ 可对角化等价于线性变换 $\varphi$ 可对角化。
\end{enumerate}
\end{lemma}
\begin{proof}
\begin{enumerate}[(1)]
\item 若 $\lambda$ 为矩阵 $A$ 的特征值，则存在 $\xi \in V$，使得 $\varphi(\xi) = A\xi = \lambda \xi$，因此矩阵 $A$ 的特征值也是线性变换 $\varphi$ 的特征值。

若 $\lambda$ 为线性变换 $\varphi$ 的特征值，则存在 $\eta \in V$，使得 $\varphi(\eta) = A\eta = \lambda \eta$，因此线性变换 $\varphi$ 的特征值也是矩阵 $A$ 的特征值。

故矩阵 $A$ 与线性变换 $\varphi$ 的特征值相同。

\item 若矩阵 $A$ 可对角化，则存在可逆矩阵 $P$，使得 $P^{-1}AP$ 为对角矩阵。

从而 $(e_1, e_2, \cdots, e_n)P$ 的列向量也是 $V$ 的一组基，于是由\hyperref[proposition:线性映射与过渡矩阵]{命题\ref{proposition:线性映射与过渡矩阵}} 可知 $\varphi$ 在这组基下的矩阵为 $P^{-1}AP$ 是对角矩阵，故 $\varphi$ 也可对角化。

若线性变换 $\varphi$ 可对角化，则存在 $V$ 的一组基 $\{f_1, f_2, \cdots, f_n\}$，使得 $\varphi$ 在这组基下的矩阵 $B$ 为对角矩阵。设基 $\{e_1, e_2, \cdots, e_n\}$ 到基 $\{f_1, f_2, \cdots, f_n\}$ 的过渡矩阵为 $G$，则由\hyperref[proposition:线性映射与过渡矩阵]{命题\ref{proposition:线性映射与过渡矩阵}}可知 $B = G^{-1}AG$。因此矩阵 $A$ 也可对角化。

故矩阵 $A$ 可对角化等价于线性变换 $\varphi$ 可对角化。
\end{enumerate}
\end{proof}

\begin{theorem}[矩阵可对角化的充要条件]\label{theorem:矩阵可对角化的充要条件}
设 $A$ 是 $n$ 阶矩阵, 则 $A$ 可对角化的充分必要条件是 $A$ 有 $n$ 个线性无关的特征向量.
\end{theorem}
\begin{proof}
设 $\varphi$ 是线性空间 $V$ 上由矩阵 $A$ 乘法诱导的线性变换.

若矩阵 $A$ 有 $n$ 个线性无关的特征值，则由\hyperref[lemma:线性变换与矩阵的可对角化等价,特征值相同]{引理\ref{lemma:线性变换与矩阵的可对角化等价,特征值相同}(1)}可知线性变换 $\varphi$ 也有相同的 $n$ 个线性无关的特征值，于是由\hyperref[theorem:线性变换可对角化的充要条件]{定理\ref{theorem:线性变换可对角化的充要条件}}可知线性变换 $\varphi$ 可对角化，从而再由\hyperref[lemma:线性变换与矩阵的可对角化等价,特征值相同]{引理\ref{lemma:线性变换与矩阵的可对角化等价,特征值相同}(2)} 可知矩阵 $A$ 也可对角化.

若矩阵 $A$ 可对角化，则由\hyperref[lemma:线性变换与矩阵的可对角化等价,特征值相同]{引理\ref{lemma:线性变换与矩阵的可对角化等价,特征值相同}(2)}可知线性变换 $\varphi$ 也可对角化，从而由\hyperref[theorem:线性变换可对角化的充要条件]{定理\ref{theorem:线性变换可对角化的充要条件}}可知 $\varphi$ 有 $n$ 个线性无关的特征值，于是由\hyperref[lemma:线性变换与矩阵的可对角化等价,特征值相同]{引理\ref{lemma:线性变换与矩阵的可对角化等价,特征值相同}(1)}可知矩阵 $A$ 也有相同的 $n$ 个线性无关的特征值。
\end{proof}

\begin{theorem}\label{theorem:不同特征值的特征子空间的和必是直和}
若 $\lambda_1, \lambda_2, \cdots, \lambda_k$ 为 $n$ 维线性空间 $V$ 上的线性变换 $\varphi$ 的不同的特征值,记$\lambda_i$的特征子空间为$V_i(1\leq i\leq k)$,则
\[
V_1 + V_2 + \cdots + V_k = V_1 \oplus V_2 \oplus \cdots \oplus V_k.
\]
\end{theorem}
\begin{proof}
对 $k$ 用数学归纳法. 若 $k = 1$, 结论显然成立. 现设对 $k - 1$ 个不同的特征值 $\lambda_1, \lambda_2, \cdots, \lambda_{k-1}$, 它们相应的特征子空间 $V_1, V_2, \cdots, V_{k-1}$ 之和是直和. 我们要证明 $V_1, V_2, \cdots, V_{k-1}, V_k$ 之和为直和, 这只需证明:
\begin{align}\label{theorem6.6-0.1}
V_k \cap (V_1 + V_2 + \cdots + V_{k-1}) = 0.
\end{align}
即可. 设 $v \in V_k \cap (V_1 + V_2 + \cdots + V_{k-1})$, 则
\begin{align}\label{theorem6.6-1.1}
v = v_1 + v_2 + \cdots + v_{k-1},
\end{align}
其中 $v_i \in V_i (i = 1, 2,\cdots, k - 1)$. 在\eqref{theorem6.6-1.1}式两边作用 $\varphi$,得
\begin{align}\label{theorem6.6-1.2}
\varphi(v) = \varphi(v_1) + \varphi(v_2) + \cdots + \varphi(v_{k-1}).   
\end{align}
但 $v, v_1, v_2, \cdots, v_{k-1}$ 都是 $\varphi$ 的特征向量或零向量, 因此
\begin{align}\label{theorem6.6-1.3}
\lambda_k v = \lambda_1 v_1 + \lambda_2 v_2 + \cdots + \lambda_{k-1} v_{k-1}.    
\end{align}
在\eqref{theorem6.6-1.2}式两边乘以 $\lambda_k$ 减去\eqref{theorem6.6-1.3}式得
\[
0 = (\lambda_k - \lambda_1) v_1 + (\lambda_k - \lambda_2) v_2 + \cdots + (\lambda_k - \lambda_{k-1}) v_{k-1}.
\]
由于 $v_1, v_2, \cdots, v_{k-1}$ 是直和, 因此 $(\lambda_k - \lambda_i) v_i = 0$, 而 $\lambda_k - \lambda_i \neq 0$, 从而 $v_i = 0 (i = 1, 2, \cdots, k - 1)$. 这就证明了\eqref{theorem6.6-0.1}式.
\end{proof}

\begin{corollary}\label{corollary:线性变换属于不同特征值的特征向量必线性无关}
线性变换 $\varphi$ 属于不同特征值的特征向量必线性无关.
\end{corollary}
\begin{proof}
设 $\lambda_1, \lambda_2, \cdots, \lambda_k$ 是线性变换 $\varphi$ 的 $k$ 个不同特征值，由\hyperref[theorem:不同特征值的特征子空间的和必是直和]{定理\ref{theorem:不同特征值的特征子空间的和必是直和}}可知$V_{\lambda_1} \oplus V_{\lambda_2} \oplus \cdots \oplus V_{\lambda_k}$。于是任取 $\alpha_i \in V_{\lambda_i} \ (1 \leqslant i \leqslant k)$ 且 $\alpha_i \ne 0$，假设 $\alpha_1, \alpha_2, \cdots, \alpha_k$ 线性无关，则存在一组不全为零的数 $b_1, b_2, \cdots, b_k$，使得
\begin{align*}
b_1 \alpha_1 + b_2 \alpha_2 + \cdots + b_k \alpha_k = 0.
\end{align*}
不妨设 $b_1 \ne 0$，则
\begin{align*}
\alpha_1 = \frac{b_2}{b_1} \alpha_2 + \frac{b_3}{b_1} \alpha_3 + \cdots + \frac{b_k}{b_1} \alpha_k \in V_{\lambda_1} \cap \left( V_{\lambda_2} \oplus \cdots \oplus V_{\lambda_k} \right).
\end{align*}
又由 $V_{\lambda_1} \oplus V_{\lambda_2} \oplus \cdots \oplus V_{\lambda_k}$ 及直和的等价条件可知，
\begin{align*}
V_{\lambda_1} \cap \left( V_{\lambda_2} \oplus \cdots \oplus V_{\lambda_k} \right) = \{ 0 \},
\end{align*}
从而 $\alpha_1 = 0$，这与 $\alpha_i \ne 0 \ (1 \leqslant i \leqslant k)$ 矛盾！
\end{proof}

\begin{corollary}
若$n$维线性空间$V$上的线性变换 $\varphi$有$n$个不同的特征值,则 $\varphi$ 必可对角化.
\end{corollary}
\begin{note}
注意这个推论只是可对角化的充分条件而非必要条件, 比如说纯量变换 $\varphi = cI_V$ 当然可对角化,但 $\varphi$ 的 $n$ 个特征值都是$c$.
\end{note}
\begin{proof}
设 $\lambda_1, \lambda_2, \cdots, \lambda_n$ 是线性变换 $\varphi$ 的 $n$ 个不同特征值，则任取 $\alpha_i \in V_{\lambda_i} \ (1 \leqslant i \leqslant n)$，由\hyperref[corollary:线性变换属于不同特征值的特征向量必线性无关]{推论\ref{corollary:线性变换属于不同特征值的特征向量必线性无关}}可知 $\alpha_1, \alpha_2, \cdots, \alpha_n$ 一定线性无关。从而由\hyperref[theorem:线性变换可对角化的充要条件]{定理\ref{theorem:线性变换可对角化的充要条件}}可知，$\varphi$ 一定可对角化。
\end{proof}

\begin{theorem}[线性变换可对角化的充要条件]\label{theorem:线性变换可对角化的充要条件2}
设 $\varphi$ 是 $n$ 维线性空间 $V$ 上的线性变换, $\lambda_1, \lambda_2, \cdots, \lambda_k$ 是 $\varphi$ 的全部不同的特征值, $V_i (i = 1, 2, \cdots, k)$ 是特征值 $\lambda_i$ 的特征子空间, 则 $\varphi$ 可对角化的充要条件是
\begin{align*}
V = V_1 \oplus V_2 \oplus \cdots \oplus V_k.
\end{align*}
\end{theorem}
\begin{proof}
先证充分性. 设
\begin{align*}
V = V_1 \oplus V_2 \oplus \cdots \oplus V_k,
\end{align*}
分别取 $V_i$ 的一组基 $\{e_{i1}, e_{i2}, \cdots, e_{it_i}\} (i = 1, 2, \cdots, k)$, 则由\hyperref[theorem:直和的等价条件]{直和的等价条件(4)} 知这些向量拼成了 $V$ 的一组基, 并且它们都是 $\varphi$ 的特征向量. 因此 $\varphi$ 有 $n$ 个线性无关的特征向量, 从而\hyperref[theorem:线性变换可对角化的充要条件]{定理\ref{theorem:线性变换可对角化的充要条件}}可知$\varphi$可对角化.

再证必要性. 设 $\varphi$ 可对角化, 则由\hyperref[theorem:线性变换可对角化的充要条件]{定理\ref{theorem:线性变换可对角化的充要条件}}可知$\varphi$ 有 $n$ 个线性无关的特征向量 $\{e_1, e_2, \cdots, e_n\}$, 它们构成了 $V$ 的一组基. 不失一般性, 可设这组基中前 $t_1$ 个是关于特征值 $\lambda_1$ 的特征向量; 接下去的 $t_2$ 个是关于特征值 $\lambda_2$ 的特征向量; $\cdots$; 最后 $t_k$ 个是关于特征值 $\lambda_k$ 的特征向量. 对任一 $\alpha \in V$, 设 $\alpha = a_1 e_1 + a_2 e_2 + \cdots + a_n e_n$, 则 $\alpha$ 可写成 $V_1, V_2, \cdots, V_k$ 中向量之和, 因此由\hyperref[theorem:不同特征值的特征子空间的和必是直和]{定理\ref{theorem:不同特征值的特征子空间的和必是直和}}可知
\begin{align*}
V = V_1 + V_2 + \cdots + V_k = V_1 \oplus V_2 \oplus \cdots \oplus V_k.
\end{align*}
\end{proof}


\begin{definition}[线性变换的几何重数与代数重数]
设 $\lambda_0$ 是 $n$ 维线性空间 $V$ 上的线性变换 $\varphi$ 的一个特征值, $V_0$ 是属于 $\lambda_0$ 的特征子空间, 称 $\dim V_0$ 为 $\lambda_0$ 的\textbf{度数或几何重数}. $\lambda_0$ 作为 $\varphi$ 的特征多项式根的重数称为 $\lambda_0$ 的\textbf{重数或代数重数}.
\end{definition}
\begin{note}
由线性映射的维数公式可知,特征值$\lambda_0$的度数$\dim V_0 = \dim \operatorname{Ker}(\lambda_0 I_V - \varphi) = n - r(\lambda_0 I_V - \varphi)$,而特征值$\lambda_0$的重数则由特征多项式$|\lambda I_V - \varphi|$的因式分解决定.
\end{note}

\begin{definition}[矩阵的几何重数与代数重数]
设 $\lambda_0$ 是$n$阶方阵的$A$的一个特征值, $V_0$ 是属于 $\lambda_0$ 的特征子空间, 称 $\dim V_0$ 为 $\lambda_0$ 的\textbf{度数或几何重数}.$\lambda_0$ 作为 $A$ 的特征多项式根的重数称为 $\lambda_0$ 的\textbf{重数或代数重数}.
\end{definition}
\begin{note}
由线性方程组的理论可知,特征值$\lambda_0$的度数$\dim V_0  = n - r(\lambda_0 I_n - A)$,若将$A$看作由矩阵$A$乘法诱导的$V$上的线性变换,则由线性变换的维数公式可知$\dim V_0  =\dim \operatorname{Ker}(\lambda_0 I_V - A)= n - r(\lambda_0 I_V - A)$.
而特征值$\lambda_0$的重数则由特征多项式$|\lambda I_n - A|$的因式分解决定.
\end{note}

\begin{lemma}[特征值的几何重数数总小于代数重数]\label{lemma:特征值的度数总小于重数}
设$\varphi$是$n$维线性空间$V$上的线性变换, $\lambda_0$是$\varphi$的一个特征值, 则$\lambda_0$的度数总是小于等于$\lambda_0$的重数.
\end{lemma}
\begin{proof}
设特征值$\lambda_0$的重数为$m$, 度数为$t$, 又$V_0$是属于$\lambda_0$的特征子空间, 则$\dim V_0 = t$. 设$\{e_1, \cdots, e_t\}$是$V_0$的一组基. 由于$V_0$中的非零向量都是$\varphi$关于$\lambda_0$的特征向量, 故
\begin{align*}
\varphi(e_i) = \lambda_0 e_i, \quad i = 1, \cdots, t.
\end{align*}
将$\{e_1, \cdots, e_t\}$扩充为$V$的一组基, 记为$\{e_1, \cdots, e_t, e_{t+1}, \cdots, e_n\}$, 则$\varphi$在这组基下的表示矩阵为
\begin{align*}
A = \begin{pmatrix}
\lambda_0 I_t & * \\
O & B
\end{pmatrix},
\end{align*}
其中$B$是一个$n-t$阶方阵. 因此, 线性变换$\varphi$的特征多项式具有如下形式:
\begin{align*}
|\lambda I_V - \varphi| = |\lambda I_n - A| = (\lambda - \lambda_0)^t |\lambda I_{n-t} - B|,
\end{align*}
这表明$\lambda_0$的重数至少为$t$, 即$t \leq m$.
\end{proof}

\begin{definition}[完全的特征向量系]
设 $\lambda_0$ 是 $\varphi$ (或 $A$) 的 $m$ 重特征值, 即它是 $\varphi$ (或 $A$) 的特征多项式的 $m$ 重根.此时若有 $m = \dim V_{\lambda_0}$, 即 $\lambda_0$ 的代数重数和几何重数相等, 则称  \textbf{$\lambda_0$有完全的特征向量系}。若对 $\varphi$ (或 $A$) 的任一特征值, 其代数重数和几何重数都相等, 则称  \textbf{$\varphi$ (或 $A$) 有完全的特征向量系}.
\end{definition}

\begin{theorem}[线性变换可对角化的充要条件]\label{theorem:线性变换可对角化的充要条件3}
设$\varphi$是$n$维线性空间$V$上的线性变换, 则$\varphi$可对角化的充分必要条件是$\varphi$有完全的特征向量系.
\end{theorem}
\begin{proof}
设$\lambda_1, \lambda_2, \cdots, \lambda_k$是$\varphi$的全部不同的特征值, 它们对应的特征子空间、重数和度数分别记为$V_i, m_i, t_i (i = 1, 2, \cdots, k)$. 由重数的定义以及\hyperref[lemma:特征值的度数总小于重数]{引理\ref{lemma:特征值的度数总小于重数}}可知
$m_1 + m_2 + \cdots + m_k = n, t_i \leq m_i, i = 1, 2, \cdots, k$.

由\hyperref[theorem:线性变换可对角化的充要条件2]{定理\ref{theorem:线性变换可对角化的充要条件2}}可知,我们只要证明$\varphi$有完全的特征向量系当且仅当$V = V_1 \oplus V_2 \oplus \cdots \oplus V_k$.

若$V = V_1 \oplus V_2 \oplus \cdots \oplus V_k$, 则
\begin{align*}
n &= \dim V = \dim(V_1 \oplus V_2 \oplus \cdots \oplus V_k) \\
&= \dim V_1 + \dim V_2 + \cdots + \dim V_k \\
&= \sum_{i=1}^{k} t_i \leq \sum_{i=1}^{k} m_i = n,
\end{align*}
因此$t_i = m_i (i = 1, 2, \cdots, k)$, 即$\varphi$有完全的特征向量系. 反过来, 若$\varphi$有完全的特征向量系, 则
\begin{align*}
\dim(V_1 \oplus V_2 \oplus \cdots \oplus V_k) = \sum_{i=1}^{k} t_i = \sum_{i=1}^{k} m_i = n = \dim V,
\end{align*}
又$V_1\oplus V_2\oplus \cdots \oplus V_k\subset V$,故$V = V_1 \oplus V_2 \oplus \cdots \oplus V_k$成立.
\end{proof}

\begin{theorem}\label{theorem:矩阵可对角化一定相似于由其全体特征值构成的对角阵}
设$A$为$n$阶复矩阵,其全体特征值为$\lambda_1,\lambda_2,\cdots,\lambda_r$,并且$\lambda_i\left( 1\le i\le r \right)$的代数重数为$n_i$,则$\sum_{i=1}^{r}n_i=n$. 若$A$可对角化,则$A$一定相似于$\mathrm{diag}\left\{ A_1,A_2,\cdots ,A_r \right\}$,其中$A_i=\mathrm{diag}\left\{ \lambda _i,\lambda _i,\cdots ,\lambda _i \right\} \left( 1\le i\le r \right)$并且阶数为$n_i$.
\end{theorem}
\begin{proof}
由于$A$可对角化,因此其特征值的代数重数等于几何重数.记$V_i$为$\lambda_i$的特征子空间,则任取$V_i$中一组基$\{e_i1,e_i2,\cdots,e_{i,n_i}\}$.由\hyperref[theorem:可对角化的判定条件]{可对角化的判定条件(3)}及直和的等价条件可知,$\{e_i1,e_i2,\cdots,e_{i,n_i}\}\left( 1\le i\le r \right)$可以拼成$\mathbb{C}^n$的一组基.于是记$P=(e_{11},\cdots,e_{1,n_1},\cdots,e_{r1},\cdots,e_{r,n_r})$,则$P$可逆,并且
\begin{align*}
&AP=A\left( e_{11},\cdots ,e_{1,n_1},\cdots ,e_{r1},\cdots ,e_{r,n_r} \right) =\left( \lambda _1e_{11},\cdots ,\lambda _1e_{1,n_1},\cdots ,\lambda _re_{r1},\cdots ,\lambda _re_{r,n_r} \right) 
\\
&=\left( e_{11},\cdots ,e_{1,n_1},\cdots ,e_{r1},\cdots ,e_{r,n_r} \right) \mathrm{diag}\left\{ A_1,A_2,\cdots ,A_r \right\} =P\mathrm{diag}\left\{ A_1,A_2,\cdots ,A_r \right\} .
\end{align*}
故$P^{-1}AP=\mathrm{diag}\left\{ A_1,A_2,\cdots ,A_r \right\} .$结论得证.
\end{proof}


\begin{theorem}[可对角化的判定条件]\label{theorem:可对角化的判定条件}
判定\(n\)阶复矩阵\(\boldsymbol{A}\) (或\(n\)维复线性空间\(V\)上的线性变换\(\varphi\)) 是否可对角化, 通常有以下\(7\)种方法:
\begin{enumerate}[(1)]
\item  \(\boldsymbol{A}\)可对角化的充要条件是\(\boldsymbol{A}\)有\(n\)个线性无关的特征向量;

\item 若\(\boldsymbol{A}\)有\(n\)个不同的特征值, 则\(\boldsymbol{A}\)可对角化;

\item \(\boldsymbol{A}\)可对角化的充要条件是\(\mathbb{C}^{n}\)是\(\boldsymbol{A}\)的特征子空间的直和;

\item \(\boldsymbol{A}\)可对角化的充要条件是\(\boldsymbol{A}\)有完全的特征向量系, 即对\(\boldsymbol{A}\)的任一特征值, 其几何重数等于其代数重数;

\item \(\boldsymbol{A}\)可对角化的充要条件是\(\boldsymbol{A}\)的极小多项式无重根;

\item \(\boldsymbol{A}\)可对角化的充要条件是\(\boldsymbol{A}\)的Jordan块都是一阶的 (或\(\boldsymbol{A}\)的初等因子都是一次多项式);

\item 若\(\boldsymbol{A}\)相似于实对称矩阵或复正规矩阵, 则\(\boldsymbol{A}\)可对角化.
\end{enumerate}
\end{theorem}
\begin{remark}
上述第五、第六种方法将放在\(\S7.5\)进行探讨, 另外\hyperref[proposition:可对角化的补充]{命题\ref{proposition:可对角化的补充}}也是可对角化判定准则的一个补充; 第七种方法将放在\(\S9.7.4\)进行探讨;本节主要阐述可对角化判定的前\(4\)种方法.
\end{remark}
\begin{proof}
{\heiti 几何形式:}(即\(n\)维复线性空间\(V\)上的线性变换\(\varphi\)可对角化的条件)
\begin{enumerate}[(1)]
\item 证明见\hyperref[theorem:线性变换可对角化的充要条件]{定理\ref{theorem:线性变换可对角化的充要条件}}.

\item 证明见\hyperref[theorem:线性变换可对角化的充要条件2]{定理\ref{theorem:线性变换可对角化的充要条件2}}.

\item 

\item 证明见\hyperref[theorem:线性变换可对角化的充要条件3]{定理\ref{theorem:线性变换可对角化的充要条件3}}.

\item 

\item 

\item 
\end{enumerate}
{\heiti 代数形式:}(即\(n\)阶复矩阵可对角化的条件)
由上述几何形式的结论及\hyperref[lemma:线性变换与矩阵的可对角化等价,特征值相同]{引理\ref{lemma:线性变换与矩阵的可对角化等价,特征值相同}}立即得到证明.
\end{proof}
\begin{remark}
若要考虑数域\(\mathbb{F}\)上的\(n\)阶矩阵\(\boldsymbol{A}\) (或\(\mathbb{F}\)上\(n\)维线性空间\(V\)上的线性变换\(\varphi\)) 在\(\mathbb{F}\)上的可对角化问题, 那么首先需要验证\(\boldsymbol{A}\) (或\(\varphi\)) 的特征值都在\(\mathbb{F}\)中, 否则由可对角化的定义可知, \(\boldsymbol{A}\) (或\(\varphi\)) 在\(\mathbb{F}\)上必不可对角化. 若假设\(\boldsymbol{A}\) (或\(\varphi\)) 的特征值都在\(\mathbb{F}\)中, 则\(\boldsymbol{A}\) (或\(\varphi\)) 在\(\mathbb{F}\)上的可对角化判定准则也是上述前\(6\)种方法. 因此, 为了突出重点, 本节总是在复数域\(\mathbb{C}\)上考虑可对角化问题. 请读者自行将某些例题推广到数域\(\mathbb{F}\)的情形. 
\end{remark}



\subsection{有$n$个线性无关的特征向量}

寻找\(\boldsymbol{A}\)的\(n\)个线性无关的特征向量, 等价于寻找\(n\)阶可逆矩阵\(\boldsymbol{P}\), 使得\(\boldsymbol{P}^{-1}\boldsymbol{AP}\)为对角矩阵.

\begin{proposition}[循环矩阵一定可对角化]\label{proposition:循环矩阵一定可对角化}
求证: 复数域上\(n\)阶循环矩阵
\begin{align*}
\boldsymbol{A}=\begin{pmatrix}
a_{1}&a_{2}&a_{3}&\cdots&a_{n}\\
a_{n}&a_{1}&a_{2}&\cdots&a_{n - 1}\\
\vdots&\vdots&\vdots&&\vdots\\
a_{2}&a_{3}&a_{4}&\cdots&a_{1}
\end{pmatrix}
\end{align*}
可对角化, 并求出它相似的对角矩阵及过渡矩阵.
\end{proposition}
\begin{note}
这个命题实际上就是\hyperref[proposition:循环行列式计算公式]{命题\ref{proposition:循环行列式计算公式}}.
\end{note}
\begin{proof}
设\(f(x)=a_{1}+a_{2}x+\cdots+a_{n}x^{n - 1},\omega_{k}=\cos\frac{2k\pi}{n}+\mathrm{i}\sin\frac{2k\pi}{n}(0\leq k\leq n - 1)\), 则
\begin{align*}
\begin{pmatrix}
a_{1}&a_{2}&a_{3}&\cdots&a_{n}\\
a_{n}&a_{1}&a_{2}&\cdots&a_{n - 1}\\
\vdots&\vdots&\vdots&&\vdots\\
a_{2}&a_{3}&a_{4}&\cdots&a_{1}
\end{pmatrix}\begin{pmatrix}
1\\
\omega_{k}\\
\vdots\\
\omega_{k}^{n - 1}
\end{pmatrix}=f(\omega_{k})\begin{pmatrix}
1\\
\omega_{k}\\
\vdots\\
\omega_{k}^{n - 1}
\end{pmatrix}.
\end{align*}
这表明\((1,\omega_{k},\cdots,\omega_{k}^{n - 1})^{\prime}\)是\(\boldsymbol{A}\)的属于特征值\(f(\omega_{k})\)的特征向量. 令
\begin{align*}
\boldsymbol{P}=\begin{pmatrix}
1&1&\cdots&1\\
1&\omega_{1}&\cdots&\omega_{n - 1}\\
\vdots&\vdots&&\vdots\\
1&\omega_{1}^{n - 1}&\cdots&\omega_{n - 1}^{n - 1}
\end{pmatrix},
\end{align*}
由Vandermonde行列式可知\(\vert\boldsymbol{P}\vert\neq 0\), 从而这\(n\)个特征向量线性无关, 因此\(\boldsymbol{A}\)可对角化, 且有
\begin{align*}
\boldsymbol{P}^{-1}\boldsymbol{AP}=\mathrm{diag}\{f(1),f(\omega_{1}),\cdots,f(\omega_{n - 1})\}.
\end{align*} 
\end{proof}

\begin{example}
设\(n\)阶复矩阵\(\boldsymbol{A}\)可对角化, 证明: 矩阵\(\begin{pmatrix}
\boldsymbol{A}&\boldsymbol{A}^{2}\\
\boldsymbol{A}^{2}&\boldsymbol{A}
\end{pmatrix}\)也可对角化.
\end{example}
\begin{proof}
{\color{blue}证法一:}
因为\(\boldsymbol{A}\)可对角化, 故可设\(\boldsymbol{\alpha}_{1},\boldsymbol{\alpha}_{2},\cdots,\boldsymbol{\alpha}_{n}\)是\(\boldsymbol{A}\)的\(n\)个线性无关的特征向量, 满足\(\boldsymbol{A}\boldsymbol{\alpha}_{i}=\lambda_{i}\boldsymbol{\alpha}_{i}(1\leq i\leq n)\). 注意到
\begin{align*}
\begin{pmatrix}
\boldsymbol{A}&\boldsymbol{A}^{2}\\
\boldsymbol{A}^{2}&\boldsymbol{A}
\end{pmatrix}\begin{pmatrix}
\boldsymbol{\alpha}_{i}\\
\boldsymbol{\alpha}_{i}
\end{pmatrix}=(\lambda_{i}+\lambda_{i}^{2})\begin{pmatrix}
\boldsymbol{\alpha}_{i}\\
\boldsymbol{\alpha}_{i}
\end{pmatrix}, \begin{pmatrix}
\boldsymbol{A}&\boldsymbol{A}^{2}\\
\boldsymbol{A}^{2}&\boldsymbol{A}
\end{pmatrix}\begin{pmatrix}
\boldsymbol{\alpha}_{i}\\
-\boldsymbol{\alpha}_{i}
\end{pmatrix}=(\lambda_{i}-\lambda_{i}^{2})\begin{pmatrix}
\boldsymbol{\alpha}_{i}\\
-\boldsymbol{\alpha}_{i}
\end{pmatrix}.
\end{align*}
通过定义不难验证\(\begin{pmatrix}
\boldsymbol{\alpha}_{i}\\
\boldsymbol{\alpha}_{i}
\end{pmatrix},\begin{pmatrix}
\boldsymbol{\alpha}_{i}\\
-\boldsymbol{\alpha}_{i}
\end{pmatrix}(1\leq i\leq n)\)是线性无关的, 因此\(\begin{pmatrix}
\boldsymbol{A}&\boldsymbol{A}^{2}\\
\boldsymbol{A}^{2}&\boldsymbol{A}
\end{pmatrix}\)有\(2n\)个线性无关的特征向量, 从而可对角化. 

{\color{blue}证法二:}
容易验证$\begin{pmatrix}I_n&I_n\\I_n&-I_n\end{pmatrix}$的逆矩阵为$\frac{1}{2}\begin{pmatrix}I_n&I_n\\I_n&-I_n\end{pmatrix}$. 考虑如下相似变换:
\begin{align*}
\frac{1}{2}\begin{pmatrix}I_n&I_n\\I_n&-I_n\end{pmatrix}\begin{pmatrix}A&A^2\\A^2&A\end{pmatrix}\begin{pmatrix}I_n&I_n\\I_n&-I_n\end{pmatrix}=\begin{pmatrix}A + A^2&O\\O&A - A^2\end{pmatrix}.
\end{align*}
由\hyperref[proposition:矩阵A可对角化则f(A)也可对角化]{命题\ref{proposition:矩阵A可对角化则f(A)也可对角化}}可知,$A + A^2,A - A^2$作为$A$的多项式也可对角化,故原矩阵可对角化. 具体地,设$P$为可逆矩阵,使得$P^{-1}AP=\Lambda$为对角矩阵,则
\begin{align*}
\begin{pmatrix}P^{-1}&O\\O&P^{-1}\end{pmatrix}\begin{pmatrix}A + A^2&O\\O&A - A^2\end{pmatrix}\begin{pmatrix}P&O\\O&P\end{pmatrix}=\begin{pmatrix}\Lambda+\Lambda^2&O\\O&\Lambda - \Lambda^2\end{pmatrix}
\end{align*}
为对角矩阵,因此原矩阵可对角化.
\end{proof}

\begin{example}
设\(V\)为\(n\)阶矩阵全体构成的线性空间, \(V\)上的线性变换\(\varphi\)定义为\(\varphi(\boldsymbol{X})=\boldsymbol{A}\boldsymbol{X}\boldsymbol{A}\), 其中\(\boldsymbol{A}\in V\). 证明: 若\(\boldsymbol{A}\)可对角化, 则\(\varphi\)也可对角化.
\end{example}
\begin{proof}
{\color{blue}证法一:}
设\(\boldsymbol{P}\)为\(n\)阶可逆矩阵, 使得\(\boldsymbol{P}^{-1}\boldsymbol{AP}=\boldsymbol{\Lambda}=\mathrm{diag}\{\lambda_{1},\lambda_{2},\cdots,\lambda_{n}\}\), 则\(\boldsymbol{P}^{\prime}\boldsymbol{A}^{\prime}(\boldsymbol{P}^{\prime})^{-1}=\boldsymbol{\Lambda}\), 即\(\boldsymbol{A}^{\prime}\)也可对角化. 设
\begin{align*}
\boldsymbol{P}=(\boldsymbol{\alpha}_{1},\boldsymbol{\alpha}_{2},\cdots,\boldsymbol{\alpha}_{n}), (\boldsymbol{P}^{\prime})^{-1}=(\boldsymbol{\beta}_{1},\boldsymbol{\beta}_{2},\cdots,\boldsymbol{\beta}_{n})
\end{align*}
分别为两个矩阵的列分块, 则
\begin{align*}
\boldsymbol{A}\boldsymbol{\alpha}_{i}=\lambda_{i}\boldsymbol{\alpha}_{i}, \boldsymbol{A}^{\prime}\boldsymbol{\beta}_{j}=\lambda_{j}\boldsymbol{\beta}_{j}, 1\leq i,j\leq n,
\end{align*}
且\(\boldsymbol{\alpha}_{1},\boldsymbol{\alpha}_{2},\cdots,\boldsymbol{\alpha}_{n}\)线性无关, \(\boldsymbol{\beta}_{1},\boldsymbol{\beta}_{2},\cdots,\boldsymbol{\beta}_{n}\)线性无关. 由\hyperref[proposition:线性无关的向量组与另一个转置的乘积积生成的矩阵也线性无关]{命题\ref{proposition:线性无关的向量组与另一个转置的乘积积生成的矩阵也线性无关}}可知, \(\{\boldsymbol{\alpha}_{i}\boldsymbol{\beta}_{j}^{\prime},1\leq i,j\leq n\}\)是\(V\)中\(n^{2}\)个线性无关的矩阵. 注意到
\begin{align*}
\varphi(\boldsymbol{\alpha}_{i}\boldsymbol{\beta}_{j}^{\prime})=\boldsymbol{A}\boldsymbol{\alpha}_{i}\boldsymbol{\beta}_{j}^{\prime}\boldsymbol{A}=(\boldsymbol{A}\boldsymbol{\alpha}_{i})(\boldsymbol{A}^{\prime}\boldsymbol{\beta}_{j})^{\prime}=\lambda_{i}\lambda_{j}\boldsymbol{\alpha}_{i}\boldsymbol{\beta}_{j}^{\prime},
\end{align*}
故\(\varphi\)有\(n^{2}\)个线性无关的特征向量, 从而可对角化. 

{\color{blue}证法二:}
由于 $A$ 可对角化，故存在可逆矩阵 $P$，使得 $P^{-1}AP = \varLambda$ 为对角矩阵. 由\refproposition{proposition:线性变换AXB的特征值}可知，$\varphi$ 在基础矩阵这组基下的表示矩阵为 $A\otimes A'$，于是
\begin{align*}
(P\otimes (P')^{-1})^{-1}(A\otimes A')(P\otimes (P')^{-1})=\varLambda\otimes\varLambda
\end{align*}
由\hyperref[矩阵的Kronecker积的基本性质(11)]{矩阵的Kronecker积的基本性质(11)}可知$\varLambda\otimes\varLambda$为对角矩阵，即 $A\otimes A'$ 可对角化，从而 $\varphi$ 可对角化. 
\end{proof}

\begin{example}
设\(V\)为\(n\)阶矩阵全体构成的线性空间, \(V\)上的线性变换\(\varphi\)定义为\(\varphi(\boldsymbol{X})=\boldsymbol{A}\boldsymbol{X}-\boldsymbol{X}\boldsymbol{A}\), 其中\(\boldsymbol{A}\in V\). 证明: 若\(\boldsymbol{A}\)可对角化, 则\(\varphi\)也可对角化.
\end{example}
\begin{proof}
{\color{blue}证法一:}
设\(\boldsymbol{P}\)为\(n\)阶可逆矩阵, 使得\(\boldsymbol{P}^{-1}\boldsymbol{AP}=\boldsymbol{\Lambda}=\mathrm{diag}\{\lambda_{1},\lambda_{2},\cdots,\lambda_{n}\}\), 则\(\boldsymbol{P}^{\prime}\boldsymbol{A}^{\prime}(\boldsymbol{P}^{\prime})^{-1}=\boldsymbol{\Lambda}\), 即\(\boldsymbol{A}^{\prime}\)也可对角化. 设
\begin{align*}
\boldsymbol{P}=(\boldsymbol{\alpha}_{1},\boldsymbol{\alpha}_{2},\cdots,\boldsymbol{\alpha}_{n}), (\boldsymbol{P}^{\prime})^{-1}=(\boldsymbol{\beta}_{1},\boldsymbol{\beta}_{2},\cdots,\boldsymbol{\beta}_{n})
\end{align*}
分别为两个矩阵的列分块, 则
\begin{align*}
\boldsymbol{A}\boldsymbol{\alpha}_{i}=\lambda_{i}\boldsymbol{\alpha}_{i}, \boldsymbol{A}^{\prime}\boldsymbol{\beta}_{j}=\lambda_{j}\boldsymbol{\beta}_{j}, 1\leq i,j\leq n,
\end{align*}
且\(\boldsymbol{\alpha}_{1},\boldsymbol{\alpha}_{2},\cdots,\boldsymbol{\alpha}_{n}\)线性无关, \(\boldsymbol{\beta}_{1},\boldsymbol{\beta}_{2},\cdots,\boldsymbol{\beta}_{n}\)线性无关. 由\hyperref[proposition:线性无关的向量组与另一个转置的乘积积生成的矩阵也线性无关]{命题\ref{proposition:线性无关的向量组与另一个转置的乘积积生成的矩阵也线性无关}}可知, \(\{\boldsymbol{\alpha}_{i}\boldsymbol{\beta}_{j}^{\prime},1\leq i,j\leq n\}\)是\(V\)中\(n^{2}\)个线性无关的矩阵. 注意到
\begin{align*}
\varphi(\boldsymbol{\alpha}_{i}\boldsymbol{\beta}_{j}^{\prime})=\boldsymbol{A}\boldsymbol{\alpha}_{i}\boldsymbol{\beta}_{j}^{\prime}-\boldsymbol{\alpha}_{i}\boldsymbol{\beta}_{j}^{\prime}\boldsymbol{A}=(\boldsymbol{A}\boldsymbol{\alpha}_{i})\boldsymbol{\beta}_{j}^{\prime}-\boldsymbol{\alpha}_{i}(\boldsymbol{A}^{\prime}\boldsymbol{\beta}_{j})^{\prime}=(\lambda_{i}-\lambda_{j})\boldsymbol{\alpha}_{i}\boldsymbol{\beta}_{j}^{\prime},
\end{align*}
故\(\varphi\)有\(n^{2}\)个线性无关的特征向量, 从而可对角化.

{\color{blue}证法二:}
由于 $A$ 可对角化，故存在可逆矩阵 $\boldsymbol{P}$，使得 $\boldsymbol{P}^{-1}\boldsymbol{AP} = \boldsymbol{\Lambda}$ 为对角矩阵。
由\refproposition{proposition:线性变换AX-XB的表示矩阵和特征值}可知，$\varphi$ 在基础矩阵这组基下的表示矩阵为 $\boldsymbol{A} \otimes \boldsymbol{I}_n - \boldsymbol{I}_n \otimes \boldsymbol{A}'$，于是
\begin{align*}
(\boldsymbol{P} \otimes (\boldsymbol{P}')^{-1})^{-1}(\boldsymbol{A} \otimes \boldsymbol{I}_n - \boldsymbol{I}_n \otimes \boldsymbol{A}')(\boldsymbol{P} \otimes (\boldsymbol{P}')^{-1}) 
&= \boldsymbol{\Lambda} \otimes \boldsymbol{I}_n - \boldsymbol{I}_n \otimes \boldsymbol{\Lambda}
\end{align*}
为对角矩阵，即 $\boldsymbol{A} \otimes \boldsymbol{I}_n - \boldsymbol{I}_n \otimes \boldsymbol{A}'$ 可对角化，从而 $\varphi$ 可对角化。
\end{proof}

\subsection{有$n$个不同特征值}

由于属于不同特征值的特征向量线性无关, 故若$\boldsymbol{A}$有$n$个不同的特征值, 则$\boldsymbol{A}$必有$n$个线性无关的特征向量, 从而可对角化. 请注意$\boldsymbol{A}$有$n$个不同的特征值只是可对角化的充分条件, 而并非必要条件. 

\begin{example}
设$\boldsymbol{A}$是实二阶矩阵且$|\boldsymbol{A}|< 0$, 求证: $\boldsymbol{A}$实相似于对角矩阵.
\end{example}
\begin{proof}
设
\begin{align*}
\boldsymbol{A}=\begin{pmatrix}
a&b\\
c&d
\end{pmatrix},
\end{align*}
由$|\boldsymbol{A}|< 0$可得$ad - bc< 0$. 又$\boldsymbol{A}$的特征多项式
\begin{align*}
|\lambda\boldsymbol{I}_2-\boldsymbol{A}|=\lambda^2-(a + d)\lambda+(ad - bc),
\end{align*}
上述关于$\lambda$的二次方程其判别式大于零, 从而$\boldsymbol{A}$有两个不相等的实特征值, 因此$\boldsymbol{A}$实相似于对角矩阵.
\end{proof}

\begin{example}
设$\boldsymbol{A},\boldsymbol{B},\boldsymbol{C}$都是$n$阶矩阵, $\boldsymbol{A},\boldsymbol{B}$各有$n$个不同的特征值, 又$f(\lambda)$是$\boldsymbol{A}$的特征多项式, 且$f(\boldsymbol{B})$是可逆矩阵. 求证: 矩阵
\begin{align*}
\boldsymbol{M}=\begin{pmatrix}
\boldsymbol{A}&\boldsymbol{C}\\
\boldsymbol{O}&\boldsymbol{B}
\end{pmatrix}
\end{align*}
相似于对角矩阵.
\end{example}
\begin{proof}
任取$\boldsymbol{B}$的一个特征值$\mu_0$, 则$f(\mu_0)$是$f(\boldsymbol{B})$的特征值. 由于$f(\boldsymbol{B})$可逆, 故$f(\boldsymbol{B})$的特征值非零, 从而$f(\mu_0)\neq 0$, 即$\mu_0$不是$\boldsymbol{A}$的特征值, 于是$\boldsymbol{A}$和$\boldsymbol{B}$的特征值互不相同. 注意到
\begin{align*}
|\lambda\boldsymbol{I}_{2n}-\boldsymbol{M}|=\begin{vmatrix}
\lambda\boldsymbol{I}_n-\boldsymbol{A}&-\boldsymbol{C}\\
\boldsymbol{O}&\lambda\boldsymbol{I}_n-\boldsymbol{B}
\end{vmatrix}=|\lambda\boldsymbol{I}_n-\boldsymbol{A}||\lambda\boldsymbol{I}_n-\boldsymbol{B}|,
\end{align*}
故矩阵$\boldsymbol{M}$有$2n$个不同的特征值, 从而相似于对角矩阵.
\end{proof}

\begin{example}
设$n$阶矩阵$\boldsymbol{A},\boldsymbol{B}$有相同的特征值, 且这$n$个特征值互不相等. 求证: 存在$n$阶矩阵$\boldsymbol{P},\boldsymbol{Q}$, 使得$\boldsymbol{A}=\boldsymbol{P}\boldsymbol{Q}, \boldsymbol{B}=\boldsymbol{Q}\boldsymbol{P}$.~
\end{example}
\begin{proof}
由假设以及\hyperref[theorem:矩阵可对角化一定相似于由其全体特征值构成的对角阵]{定理\ref{theorem:矩阵可对角化一定相似于由其全体特征值构成的对角阵}}和\hyperref[example6.22]{例题\ref{example6.22}}可知, 矩阵$\boldsymbol{A},\boldsymbol{B}$相似于同一个对角矩阵, 因此$\boldsymbol{A}$和$\boldsymbol{B}$相似. 不妨设$\boldsymbol{B}=\boldsymbol{P}^{-1}\boldsymbol{A}\boldsymbol{P}$, 令$\boldsymbol{Q}=\boldsymbol{P}^{-1}\boldsymbol{A}$, 则$\boldsymbol{P}\boldsymbol{Q}=\boldsymbol{A}, \boldsymbol{Q}\boldsymbol{P}=\boldsymbol{B}$. 
\end{proof}

\begin{proposition}\label{proposition:可对角化矩阵与其他矩阵乘法可交换诱导可同时对角化}
设$A,B$是$n$阶矩阵,$A$有$n$个不同的特征值,并且$AB = BA$,求证:$B$相似于对角矩阵,并且$A$与$B$可同时对角化.
\end{proposition}
\begin{proof}
{\color{blue}证法一(几何方法):} 因为$A$有$n$个不同的特征值,故$A$可对角化. 令$V$是$n$维复列向量空间,将$A,B$看成是$V$上的线性变换. 又设$A$的特征值为$\lambda_1,\lambda_2,\cdots,\lambda_n$,对应的特征向量为$\alpha_1,\alpha_2,\cdots,\alpha_n$,则$\lambda_i$的特征子空间$V_i = L(\alpha_i)(1 \leq i \leq n)$,且
\begin{align*}
V = V_1 \oplus V_2 \oplus \cdots \oplus V_n.
\end{align*}
注意到$AB = BA$,故由\hyperref[proposition:特征子空间互为不变子空间]{命题\ref{proposition:特征子空间互为不变子空间}}可知,$A$的特征子空间$V_i$是$B$的不变子空间. 将$B$限制在$V_i$上,这是一维线性空间$V_i$上的线性变换,从而只能是纯量变换,即存在$\mu_i$,使得$B\alpha_i = \mu_i\alpha_i(1 \leq i \leq n)$,于是$\alpha_1,\alpha_2,\cdots,\alpha_n$也是$B$的特征向量. 因此,$B$有$n$个线性无关的特征向量,从而$B$可对角化. 事实上,我们得到了一个更强的结果:$A$和$B$可同时对角化,即存在可逆矩阵$P = (\alpha_1,\alpha_2,\cdots,\alpha_n)$,使得$P^{-1}AP = \mathrm{diag}\{\lambda_1,\lambda_2,\cdots,\lambda_n\}$和$P^{-1}BP = \mathrm{diag}\{\mu_1,\mu_2,\cdots,\mu_n\}$都是对角矩阵.

{\color{blue}证法二(代数方法):}
 因为$A$有$n$个不同的特征值,故$A$可对角化,即存在可逆矩阵$P$,使得$P^{-1}AP = \mathrm{diag}\{\lambda_1,\lambda_2,\cdots,\lambda_n\}$. 注意到问题的条件和结论在同时相似变换:$A \mapsto P^{-1}AP,B \mapsto P^{-1}BP$下保持不变,故不妨从一开始就假设$A = \mathrm{diag}\{\lambda_1,\lambda_2,\cdots,\lambda_n\}$为对角矩阵. 设$B = (b_{ij})$,则
\begin{align*}
AB=\begin{pmatrix}
\lambda_1b_{11}&\lambda_1b_{12}&\cdots&\lambda_1b_{1n}\\
\lambda_2b_{21}&\lambda_2b_{22}&\cdots&\lambda_2b_{2n}\\
\vdots&\vdots&&\vdots\\
\lambda_nb_{n1}&\lambda_nb_{n2}&\cdots&\lambda_nb_{nn}
\end{pmatrix}=\begin{pmatrix}
\lambda_1b_{11}&\lambda_2b_{12}&\cdots&\lambda_nb_{1n}\\
\lambda_1b_{21}&\lambda_2b_{22}&\cdots&\lambda_nb_{2n}\\
\vdots&\vdots&&\vdots\\
\lambda_1b_{n1}&\lambda_2b_{n2}&\cdots&\lambda_nb_{nn}
\end{pmatrix}=BA,
\end{align*}
比较元素可得$\lambda_ib_{ij} = \lambda_jb_{ij}$. 注意到$\lambda_1,\lambda_2,\cdots,\lambda_n$互不相同,故$b_{ij} = 0(i \neq j)$,即$B$为对角矩阵.
\end{proof}

\begin{proposition}\label{proposition:有n个不同特征值的矩阵乘法可交换诱导多项式表示}
设$A,B$是$n$阶矩阵,$A$有$n$个不同的特征值,并且$AB = BA$,求证:存在次数不超过$n - 1$的多项式$f(x)$,使得$B = f(A)$.
\end{proposition}
\begin{proof}
由\hyperref[proposition:可对角化矩阵与其他矩阵乘法可交换诱导可同时对角化]{命题\ref{proposition:可对角化矩阵与其他矩阵乘法可交换诱导可同时对角化}}可知$A$和$B$可以同时对角化,即存在可逆矩阵$P$,使得
\begin{align*}
P^{-1}AP=\mathrm{diag}\{\lambda_1,\lambda_2,\cdots,\lambda_n\}, P^{-1}BP=\mathrm{diag}\{\mu_1,\mu_2,\cdots,\mu_n\},
\end{align*}
其中$\lambda_i,\mu_i$分别是$A,B$的特征值. 因为$\lambda_i$互不相同,故由\hyperref[theorem:Lagrange插值公式]{Lagrange插值公式}可知,存在次数不超过$n - 1$的多项式$f(x)$,使得$f(\lambda_i)=\mu_i(1\leq i\leq n)$. 于是
\begin{align*}
P^{-1}BP=\mathrm{diag}\{f(\lambda_1),f(\lambda_2),\cdots,f(\lambda_n)\}=f(P^{-1}AP)=P^{-1}f(A)P,
\end{align*}
从而$B = f(A)$.
\end{proof}

\begin{proposition}\label{proposition:矩阵A可对角化则f(A)也可对角化}
若$A$可对角化,则对任意的多项式$f(x)$,$f(A)$也可对角化.
\end{proposition}
\begin{note}
这一结论提醒我们: 在处理可对角化问题时,如能将矩阵写成可对角化矩阵的多项式,则往往讨论起来更加方便.
\end{note}
\begin{proof}
事实上,设$P$为可逆矩阵,使得$P^{-1}AP=\mathrm{diag}\{\lambda_1,\lambda_2,\cdots,\lambda_n\}$为对角矩阵,则$P^{-1}f(A)P=f(P^{-1}AP)=\mathrm{diag}\{f(\lambda_1),f(\lambda_2),\cdots,f(\lambda_n)\}$也为对角矩阵.
\end{proof}

\begin{proposition}\label{proposition:有n个不同特征值的矩阵与另一个矩阵可对角化的关系}
设$A$是$n$阶复矩阵且有$n$个不同的特征值,求证:$n$阶复矩阵$B$可对角化的充要条件是存在次数不超过$n - 1$的多项式$f(x)$,使得$B$相似于$f(A)$.
\end{proposition}
\begin{proof}
先证充分性. 由于$A$有$n$个不同的特征值, 故$A$可对角化,从而由\hyperref[proposition:矩阵A可对角化则f(A)也可对角化]{命题\ref{proposition:矩阵A可对角化则f(A)也可对角化}}$f(A)$也可对角化,又$B$相似于$f(A)$,于是$B$也可对角化. 

再证必要性. 设$P,Q$为可逆矩阵,使得
\begin{align*}
P^{-1}AP=\mathrm{diag}\{\lambda_1,\lambda_2,\cdots,\lambda_n\}, Q^{-1}BQ=\mathrm{diag}\{\mu_1,\mu_2,\cdots,\mu_n\},
\end{align*}
其中$\lambda_i,\mu_i$分别是$A,B$的特征值. 因为$\lambda_i$互不相同,故由\hyperref[theorem:Lagrange插值公式]{Lagrange插值公式}可知,存在次数不超过$n - 1$的多项式$f(x)$,使得$f(\lambda_i)=\mu_i(1\leq i\leq n)$. 于是
\begin{align*}
Q^{-1}BQ=\mathrm{diag}\{f(\lambda_1),f(\lambda_2),\cdots,f(\lambda_n)\}=f(P^{-1}AP)=P^{-1}f(A)P,
\end{align*}
即有$B=(PQ^{-1})^{-1}f(A)(PQ^{-1})$, 从而$B$相似于$f(A)$. 
\end{proof}

\begin{corollary}\label{corollary:}
$n$阶复方阵$B$可对角化的充要条件是$B$相似于某个循环矩阵.
\end{corollary}
\begin{proof}
设$J=\begin{pmatrix}O&I_{n - 1}\\1&O\end{pmatrix}$,经简单计算可得$|\lambda I_n - J|=\lambda^n - 1$, 于是$J$有$n$个不同的特征值. 对任一循环矩阵$C$,由\hyperref[proposition:循环矩阵的性质]{循环矩阵的性质2}可知,存在次数不超过$n - 1$的多项式$f(x)$,使得$C = f(J)$,故由\hyperref[proposition:有n个不同特征值的矩阵与另一个矩阵可对角化的关系]{命题\ref{proposition:有n个不同特征值的矩阵与另一个矩阵可对角化的关系}}即得本推论.
\end{proof}

\begin{proposition}\label{proposition:三对角矩阵必可对角化}
设$a,b,c$为复数且$bc\neq0$,证明下列$n$阶矩阵$A$可对角化:
\[
A = 
\begin{pmatrix}
a&b&&&\\
c&a&b&&\\
&c&a&b&\\
&&\ddots&\ddots&\ddots\\
&&&c&a&b\\
&&&&c&a
\end{pmatrix}
\]
\end{proposition}
\begin{note}
当$(\lambda-a)^2=4bc$时,利用摄动法,设$t>0$,则当$(\lambda-a)^2-4bc=0$时,$(\lambda+t-a)^2-4bc>0$,由下述证明可知,$\lambda+t$有$n$个不同取值,从而令$t \to 0$,则此时$(\lambda-a)^2-4bc=0$,并且$\lambda$仍有$n$个不同取值.
\end{note}
\begin{proof}
我们先来计算$A$的特征多项式$|\lambda I_n - A|$. 设$x_1,x_2$是二次方程$x^2 - (\lambda - a)x + bc = 0$的两个根,则当$(\lambda-a)^2\ne 4bc$时,由\hyperref[corollary:对角线元素相同的三对角行列式]{推论\ref{corollary:对角线元素相同的三对角行列式}}可得
\begin{align*}
|\lambda I_n - A|=\frac{x_1^{n + 1}-x_2^{n + 1}}{x_1 - x_2}.
\end{align*}
注意到$x_1,x_2$都是关于$\lambda$的连续函数,要求$A$的特征值$\lambda$,即是求$\lambda$的值,使得$|\lambda I_n - A| = 0$, 而这也等价于$x_1^{n + 1}=x_2^{n + 1}$. 令$\omega=\cos\frac{2\pi}{n + 1}+\mathrm{i}\sin\frac{2\pi}{n + 1}$为$1$的$n + 1$次方根, 则由$x_1^{n + 1}=x_2^{n + 1}$可得$x_1 = x_2\omega^k(1\leq k\leq n)$. 由\hyperref[theorem:Vieta定理]{Vieta定理}可得$x_1x_2 = bc$, 在选定$bc$的某一平方根$\sqrt{bc}$之后, 可解出
\[
x_1=\sqrt{bc}\left(\cos\frac{k\pi}{n + 1}+\mathrm{i}\sin\frac{k\pi}{n + 1}\right), x_2=\sqrt{bc}\left(\cos\frac{k\pi}{n + 1}-\mathrm{i}\sin\frac{k\pi}{n + 1}\right), 1\leq k\leq n.
\]
再次由\hyperref[theorem:Vieta定理]{Vieta定理}可得$\lambda - a = x_1 + x_2 = 2\sqrt{bc}\cos\frac{k\pi}{n + 1}$,即
\begin{align*}
\lambda=a + 2\sqrt{bc}\cos\frac{k\pi}{n + 1}, 1\leq k\leq n.
\end{align*}
容易验证上述$n$个数的确是$A$的$n$个不同的特征值,从而$A$可对角化. 
\end{proof}


\subsection{全空间等于特征子空间的直和}

矩阵或线性变换可对角化当且仅当全空间等于特征子空间的直和这一判定准则, 不仅给了我们很多几何想象的空间, 而且与矩阵或线性变换适合的多项式密切相关.

\begin{proposition}\label{proposition:适合的多项式无重根则可对角化}
设\(n\)阶矩阵\(\boldsymbol{A}\)适合首一多项式\(g(x)\),并且\(g(x)\)在复数域中无重根,证明:\(\boldsymbol{A}\)可对角化.
\end{proposition}
\begin{proof}
设\(g(x) = (x - a_1)(x - a_2)\cdots(x - a_m)\)是复数域上的因式分解,其中\(a_1,a_2,\cdots,a_m\)是互异的复数. 我们先来证明:
\begin{align}
\mathbb{C}^n = \mathrm{Ker}(\boldsymbol{A} - a_1\boldsymbol{I}_n)\oplus \mathrm{Ker}(\boldsymbol{A} - a_2\boldsymbol{I}_n)\oplus\cdots\oplus \mathrm{Ker}(\boldsymbol{A} - a_m\boldsymbol{I}_n). \label{proposition0.7-6.5}
\end{align}
设\(g_i(x) = \prod_{j\neq i}(x - a_j)\), 则\((g_1(x),g_2(x),\cdots,g_m(x)) = 1\), 故存在\(u_i(x)(1\leq i\leq m)\),使得
\begin{align*}
g_1(x)u_1(x) + g_2(x)u_2(x) + \cdots + g_m(x)u_m(x) = 1.
\end{align*}
代入\(x = \boldsymbol{A}\),可得恒等式
\begin{align}
g_1(\boldsymbol{A})u_1(\boldsymbol{A}) + g_2(\boldsymbol{A})u_2(\boldsymbol{A}) + \cdots + g_m(\boldsymbol{A})u_m(\boldsymbol{A}) = \boldsymbol{I}_n. \label{proposition0.7-6.6}
\end{align}
对任一\(\boldsymbol{\alpha}\in \mathbb{C}^n\),由上式可知\(\boldsymbol{\alpha} = \sum_{i = 1}^{m}g_i(\boldsymbol{A})u_i(\boldsymbol{A})\boldsymbol{\alpha}\). 注意到\((\boldsymbol{A}-a_i\boldsymbol{I}_n)g_i(\boldsymbol{A})u_i(\boldsymbol{A})\boldsymbol{\alpha} = g(\boldsymbol{A})u_i(\boldsymbol{A})\boldsymbol{\alpha} = \boldsymbol{0}\), 故\(g_i(\boldsymbol{A})u_i(\boldsymbol{A})\boldsymbol{\alpha}\in \mathrm{Ker}(\boldsymbol{A} - a_i\boldsymbol{I}_n)\), 于是
\begin{align}
\mathbb{C}^n = \mathrm{Ker}(\boldsymbol{A} - a_1\boldsymbol{I}_n) + \mathrm{Ker}(\boldsymbol{A} - a_2\boldsymbol{I}_n) + \cdots + \mathrm{Ker}(\boldsymbol{A} - a_m\boldsymbol{I}_n). \label{proposition0.7-6.7}
\end{align}
任取\(\boldsymbol{\alpha}\in \mathrm{Ker}(\boldsymbol{A}-a_1\boldsymbol{I}_n)\cap(\mathrm{Ker}(\boldsymbol{A}-a_2\boldsymbol{I}_n)+\cdots+\mathrm{Ker}(\boldsymbol{A}-a_m\boldsymbol{I}_n))\), 则\(\boldsymbol{\alpha} = \boldsymbol{\alpha}_2+\cdots+\boldsymbol{\alpha}_m\),其中\(\boldsymbol{\alpha}_i\in \mathrm{Ker}(\boldsymbol{A} - a_i\boldsymbol{I}_n)(i\geq 2)\). 由\eqref{proposition0.7-6.6}式可知
\begin{align*}
\boldsymbol{\alpha} = u_1(\boldsymbol{A})g_1(\boldsymbol{A})(\boldsymbol{\alpha}_2 + \cdots + \boldsymbol{\alpha}_m) + u_2(\boldsymbol{A})g_2(\boldsymbol{A})\boldsymbol{\alpha} + \cdots + u_m(\boldsymbol{A})g_m(\boldsymbol{A})\boldsymbol{\alpha} = \boldsymbol{0}.
\end{align*}
注意到下指标可任意选,故\eqref{proposition0.7-6.7}式是直和.

由于\(\boldsymbol{A}\)适合\(g(x)\),故\(\boldsymbol{A}\)的特征值也适合\(g(x)\),从而只可能是\(a_1,a_2,\cdots,a_m\)中的一部分. 
不妨设$a_1$不是$\boldsymbol{A}$的特征值,则对$\forall \alpha\ne 0$,都有$(\boldsymbol{A}-a_1\boldsymbol{I_n})\alpha \ne 0,$故$\mathrm{Ker}(\boldsymbol{A} - a_1\boldsymbol{I}_n)=0$.于是在\eqref{proposition0.7-6.5}式中剔除等于零的直和分量,这就证明了全空间等于特征子空间的直和,从而\(\boldsymbol{A}\)可对角化.
\end{proof}

\begin{example}\label{example0.7qew}
求证:
\begin{enumerate}[(1)]
\item 若\(n\)阶矩阵\(\boldsymbol{A}\)适合\(\boldsymbol{A}^2 = \boldsymbol{I}_n\), 则\(\boldsymbol{A}\)必可对角化;

\item 若\(n\)阶矩阵\(\boldsymbol{A}\)适合\(\boldsymbol{A}^2 = \boldsymbol{A}\), 则\(\boldsymbol{A}\)必可对角化.

\item \(M_n(\mathbb{F})\)上的线性变换\(\boldsymbol{\eta}\)满足\(\boldsymbol{\eta}^2 = \boldsymbol{I}_V\), 则\(\boldsymbol{\eta}\)可对角化.
\end{enumerate}
\end{example}
\begin{proof}
\begin{enumerate}[(1)]
\item 对合矩阵\(\boldsymbol{A}\)适合多项式\(x^2 - 1\),它在复数域中无重根,故由\hyperref[proposition:适合的多项式无重根则可对角化]{命题\ref{proposition:适合的多项式无重根则可对角化}}即得结论.

\item 幂等矩阵\(\boldsymbol{A}\)适合多项式\(x^2 - x\),它在复数域中无重根,故由\hyperref[proposition:适合的多项式无重根则可对角化]{命题\ref{proposition:适合的多项式无重根则可对角化}}即得结论.

\item 线性变换\(\boldsymbol{\eta}\)适合多项式$x^2-1$,它在复数域中无重根,故由\hyperref[proposition:适合的多项式无重根则可对角化]{命题\ref{proposition:适合的多项式无重根则可对角化}}即得结论.
\end{enumerate}
\end{proof}


\subsection{有完全的特征向量系}

矩阵或线性变换有完全的特征向量系, 即任一特征值的代数重数等于其几何重数,也就是特征值与线性无关的特征向量完全一一对应.

\begin{proposition}\label{example-6.38}
若矩阵\(\boldsymbol{A},\boldsymbol{B}\)有完全的特征向量系, 求证:\(\begin{pmatrix}
\boldsymbol{A}&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{B}
\end{pmatrix}\)也有完全的特征向量系.
\end{proposition}
\begin{proof}
因为\(\boldsymbol{A},\boldsymbol{B}\)有完全的特征向量系, 故相似于对角矩阵. 设\(\boldsymbol{P}^{-1}\boldsymbol{AP}\)和\(\boldsymbol{Q}^{-1}\boldsymbol{BQ}\)是对角矩阵, 则
\begin{align*}
\begin{pmatrix}
\boldsymbol{P}&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{Q}
\end{pmatrix}^{-1}
\begin{pmatrix}
\boldsymbol{A}&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{B}
\end{pmatrix}
\begin{pmatrix}
\boldsymbol{P}&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{Q}
\end{pmatrix}
=
\begin{pmatrix}
\boldsymbol{P}^{-1}\boldsymbol{AP}&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{Q}^{-1}\boldsymbol{BQ}
\end{pmatrix}
\end{align*}
是对角矩阵. 因此\(\begin{pmatrix}
\boldsymbol{A}&\boldsymbol{O}\\
\boldsymbol{O}&\boldsymbol{B}
\end{pmatrix}\)有完全的特征向量系. 
\end{proof}

\begin{example}
设\(n\)阶矩阵\(\boldsymbol{A} = \begin{pmatrix}
\boldsymbol{I}_r&\boldsymbol{B}\\
\boldsymbol{O}&-\boldsymbol{I}_{n - r}
\end{pmatrix}\), 求证: \(\boldsymbol{A}\)可对角化.
\end{example}
\begin{proof}
{\color{blue}证法一:}
显然\(\boldsymbol{A}\)有特征值\(1\) (\(r\)重) 与\(-1\) (\(n - r\)重). 注意到矩阵\(\boldsymbol{I}_n - \boldsymbol{A} = \begin{pmatrix}
\boldsymbol{O}&-\boldsymbol{B}\\
\boldsymbol{O}&2\boldsymbol{I}_{n - r}
\end{pmatrix}\)的秩等于\(n - r\), 因此特征值\(1\)的几何重数等于\(n - \mathrm{r}(\boldsymbol{I}_n - \boldsymbol{A}) = r\), 与其代数重数相等. 同理可证特征值\(-1\)的几何重数为\(n - r\), 与其代数重数相同. 因此\(\boldsymbol{A}\)可对角化,且相似于对角矩阵\(\mathrm{diag}\{\boldsymbol{I}_r,-\boldsymbol{I}_{n - r}\}\). 

{\color{blue}证法二:}
容易算出\(\boldsymbol{A}^2 = \boldsymbol{I}_n\), 由\hyperref[example0.7qew]{例题\ref{example0.7qew}(1)}可知\(\boldsymbol{A}\)可对角化.

{\color{blue}证法三:}
做第三种初等相似变换,
由\(\begin{pmatrix}
\boldsymbol{I}_r&\frac{1}{2}\boldsymbol{B}\\
\boldsymbol{O}&\boldsymbol{I}_{n - r}
\end{pmatrix}
\begin{pmatrix}
\boldsymbol{I}_r&\boldsymbol{B}\\
\boldsymbol{O}&-\boldsymbol{I}_{n - r}
\end{pmatrix}
\begin{pmatrix}
\boldsymbol{I}_r&-\frac{1}{2}\boldsymbol{B}\\
\boldsymbol{O}&\boldsymbol{I}_{n - r}
\end{pmatrix}
=
\begin{pmatrix}
\boldsymbol{I}_r&\boldsymbol{O}\\
\boldsymbol{O}&-\boldsymbol{I}_{n - r}
\end{pmatrix}\)即得. 
\end{proof}

\begin{proposition}\label{proposition:没有公共的特征值的可对角化矩阵的分块也可对角化}
设\(m\)阶矩阵\(\boldsymbol{A}\)与\(n\)阶矩阵\(\boldsymbol{B}\)没有公共的特征值, 且\(\boldsymbol{A},\boldsymbol{B}\)均可对角化, 又\(\boldsymbol{C}\)为\(m\times n\)矩阵, 求证: \(\boldsymbol{M} = \begin{pmatrix}
\boldsymbol{A}&\boldsymbol{C}\\
\boldsymbol{O}&\boldsymbol{B}
\end{pmatrix}\)也可对角化.
\end{proposition}
\begin{proof}
{\color{blue}证法一:}
任取\(\boldsymbol{A}\)的特征值\(\lambda_0\), 记其代数重数为\(m_{\boldsymbol{A}}(\lambda_0)\), 几何重数为\(t_{\boldsymbol{A}}(\lambda_0)\). 首先注意到\(\boldsymbol{A},\boldsymbol{B}\)没有公共的特征值, 故\(\lambda_0\)不是\(\boldsymbol{B}\)的特征值, 又\(|\lambda\boldsymbol{I} - \boldsymbol{M}| = |\lambda\boldsymbol{I} - \boldsymbol{A}||\lambda\boldsymbol{I} - \boldsymbol{B}|\), 从而\(m_{\boldsymbol{M}}(\lambda_0) = m_{\boldsymbol{A}}(\lambda_0)\). 由于\(\lambda_0\boldsymbol{I} - \boldsymbol{B}\)是非异阵, 故有如下分块矩阵的初等变换:
\begin{align*}
\lambda_0\boldsymbol{I} - \boldsymbol{M} = \begin{pmatrix}
\lambda_0\boldsymbol{I} - \boldsymbol{A}&-\boldsymbol{C}\\
\boldsymbol{O}&\lambda_0\boldsymbol{I} - \boldsymbol{B}
\end{pmatrix} \to \begin{pmatrix}
\lambda_0\boldsymbol{I} - \boldsymbol{A}&\boldsymbol{O}\\
\boldsymbol{O}&\lambda_0\boldsymbol{I} - \boldsymbol{B}
\end{pmatrix}.
\end{align*}
因为矩阵的秩在分块初等变换下不变, 故由矩阵秩的等式可得
\begin{align*}
\mathrm{r}(\lambda_0\boldsymbol{I} - \boldsymbol{M}) = \mathrm{r}(\lambda_0\boldsymbol{I} - \boldsymbol{A}) + \mathrm{r}(\lambda_0\boldsymbol{I} - \boldsymbol{B}) = \mathrm{r}(\lambda_0\boldsymbol{I} - \boldsymbol{A}) + n,
\end{align*}
于是\(t_{\boldsymbol{M}}(\lambda_0) = (m + n) - \mathrm{r}(\lambda_0\boldsymbol{I} - \boldsymbol{M}) = m - \mathrm{r}(\lambda_0\boldsymbol{I} - \boldsymbol{A}) = t_{\boldsymbol{A}}(\lambda_0)\). 因为\(\boldsymbol{A}\)可对角化, 所以\(\boldsymbol{A}\)有完全的特征向量系, 从而\(m_{\boldsymbol{A}}(\lambda_0) = t_{\boldsymbol{A}}(\lambda_0)\), 于是\(m_{\boldsymbol{M}}(\lambda_0) = t_{\boldsymbol{M}}(\lambda_0)\). 同理可证, 对\(\boldsymbol{B}\)的任一特征值\(\mu_0\), 成立\(m_{\boldsymbol{M}}(\mu_0) = t_{\boldsymbol{M}}(\mu_0)\). 因此\(\boldsymbol{M}\)有完全的特征向量系, 从而可对角化.

{\color{blue}证法二:}
由\hyperref[proposition:AX-XB相关命题1]{命题\ref{proposition:AX-XB相关命题1}}可知，矩阵方程 \(\boldsymbol{AX - XB = C}\) 存在唯一解 \(\boldsymbol{X = X_0}\)。考虑如下相似变换：
\begin{align*}
\begin{pmatrix}
\boldsymbol{I}_m & \boldsymbol{X}_0 \\
\boldsymbol{O} & \boldsymbol{I}_n
\end{pmatrix}
\begin{pmatrix}
\boldsymbol{A} & \boldsymbol{C} \\
\boldsymbol{O} & \boldsymbol{B}
\end{pmatrix}
\begin{pmatrix}
\boldsymbol{I}_m & -\boldsymbol{X}_0 \\
\boldsymbol{O} & \boldsymbol{I}_n
\end{pmatrix}
&=
\begin{pmatrix}
\boldsymbol{A} & -\boldsymbol{AX}_0 + \boldsymbol{X}_0\boldsymbol{B} + \boldsymbol{C} \\
\boldsymbol{O} & \boldsymbol{B}
\end{pmatrix}
=
\begin{pmatrix}
\boldsymbol{A} & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{B}
\end{pmatrix},
\end{align*}
由\hyperref[example-6.38]{命题\ref{example-6.38}}可知上式最右边的分块对角矩阵可对角化，于是原矩阵也可对角化。
\end{proof}

\begin{proposition}\label{proposition:没有公共的特征值的可对角化矩阵的分块也可对角化 逆命题}
设\(\boldsymbol{A}\)为\(m\)阶矩阵, \(\boldsymbol{B}\)为\(n\)阶矩阵, \(\boldsymbol{C}\)为\(m\times n\)矩阵, \(\boldsymbol{M} = \begin{pmatrix}
\boldsymbol{A}&\boldsymbol{C}\\
\boldsymbol{O}&\boldsymbol{B}
\end{pmatrix}\), 求证: 若\(\boldsymbol{M}\)可对角化, 则\(\boldsymbol{A},\boldsymbol{B}\)均可对角化.
\end{proposition}
\begin{remark}
这个命题的几何版本是: 设\(\boldsymbol{\varphi}\)是复线性空间\(V\)上的线性变换, \(U\)是\(\boldsymbol{\varphi}\) -不变子空间, 若\(\boldsymbol{\varphi}\)可对角化, 则\(\boldsymbol{\varphi}\)在不变子空间\(U\)上的限制变换\(\boldsymbol{\varphi}|_U\)以及\(\boldsymbol{\varphi}\)在商空间\(V/U\)上的诱导变换\(\overline{\boldsymbol{\varphi}}\)均可对角化. 
\end{remark}
\begin{proof} 
任取\(\boldsymbol{M}\)的特征值\(\lambda_0\),记其代数重数为\(m_{\boldsymbol{A}}(\lambda_0)\), 几何重数为\(t_{\boldsymbol{A}}(\lambda_0)\).  由\(|\lambda\boldsymbol{I}-\boldsymbol{M}| = |\lambda\boldsymbol{I} - \boldsymbol{A}||\lambda\boldsymbol{I} - \boldsymbol{B}|\)可得\(m_{\boldsymbol{M}}(\lambda_0) = m_{\boldsymbol{A}}(\lambda_0)+m_{\boldsymbol{B}}(\lambda_0)\). 考虑如下分块矩阵:
\begin{align*}
\lambda_0\boldsymbol{I} - \boldsymbol{M} = \begin{pmatrix}
\lambda_0\boldsymbol{I} - \boldsymbol{A}&-\boldsymbol{C}\\
\boldsymbol{O}&\lambda_0\boldsymbol{I} - \boldsymbol{B}
\end{pmatrix},
\end{align*}
由\hyperref[矩阵秩的基本公式4]{矩阵秩的基本公式(4)}可得
\begin{align*}
\mathrm{r}(\lambda_0\boldsymbol{I} - \boldsymbol{M})\geq \mathrm{r}(\lambda_0\boldsymbol{I} - \boldsymbol{A})+\mathrm{r}(\lambda_0\boldsymbol{I} - \boldsymbol{B}),
\end{align*}
于是\(t_{\boldsymbol{M}}(\lambda_0) = (m + n) - \mathrm{r}(\lambda_0\boldsymbol{I} - \boldsymbol{M})\leq (m - \mathrm{r}(\lambda_0\boldsymbol{I} - \boldsymbol{A}))+(n - \mathrm{r}(\lambda_0\boldsymbol{I} - \boldsymbol{B})) = t_{\boldsymbol{A}}(\lambda_0)+t_{\boldsymbol{B}}(\lambda_0)\). 由于几何重数总是小于等于代数重数, 故有
\begin{align*}
t_{\boldsymbol{M}}(\lambda_0)\leq t_{\boldsymbol{A}}(\lambda_0)+t_{\boldsymbol{B}}(\lambda_0)\leq m_{\boldsymbol{A}}(\lambda_0)+m_{\boldsymbol{B}}(\lambda_0) = m_{\boldsymbol{M}}(\lambda_0).
\end{align*}
因为\(\boldsymbol{M}\)可对角化, 所以\(\boldsymbol{M}\)有完全的特征向量系, 从而\(t_{\boldsymbol{M}}(\lambda_0) = m_{\boldsymbol{M}}(\lambda_0)\), 再由上述不等式可得\(t_{\boldsymbol{A}}(\lambda_0) = m_{\boldsymbol{A}}(\lambda_0)\), \(t_{\boldsymbol{B}}(\lambda_0) = m_{\boldsymbol{B}}(\lambda_0)\). 由\(\lambda_0\)的任意性即知, \(\boldsymbol{A},\boldsymbol{B}\)均有完全的特征向量系, 从而均可对角化. 
\end{proof}

\begin{proposition}\label{proposition:矩阵乘积可对角化且可逆则交换后也可对角化}
设\(\boldsymbol{A}\)为\(m\times n\)矩阵, \(\boldsymbol{B}\)为\(n\times m\)矩阵, 又\(|\boldsymbol{B}\boldsymbol{A}|\neq 0\), 求证: \(\boldsymbol{A}\boldsymbol{B}\)可对角化的充要条件是\(\boldsymbol{B}\boldsymbol{A}\)可对角化.
\end{proposition}
\begin{proof}
记其代数重数为\(m_{\boldsymbol{A}}(\lambda_0)\), 几何重数为\(t_{\boldsymbol{A}}(\lambda_0)\)(其他记号同理). 
由\hyperref[theorem:特征值的降价公式]{特征值的降价公式}可得\(|\lambda\boldsymbol{I}_m - \boldsymbol{A}\boldsymbol{B}| = \lambda^{m - n}|\lambda\boldsymbol{I}_n - \boldsymbol{B}\boldsymbol{A}|\), 因此\(\boldsymbol{A}\boldsymbol{B}\)的特征值为\(\boldsymbol{B}\boldsymbol{A}\)的特征值以及\(0\). 由于\(\boldsymbol{B}\boldsymbol{A}\)非异, 故其特征值全部非零, 从而\(0\)作为\(\boldsymbol{A}\boldsymbol{B}\)的特征值, 其代数重数为\(m - n\). 另一方面, 我们有
\begin{align*}
n = \mathrm{r}(\boldsymbol{B}\boldsymbol{A})\leq \min\{\mathrm{r}(\boldsymbol{A}),\mathrm{r}(\boldsymbol{B})\}\leq \max\{\mathrm{r}(\boldsymbol{A}),\mathrm{r}(\boldsymbol{B})\}\leq \min\{m,n\} = n,
\end{align*}
从而\(\mathrm{r}(\boldsymbol{A}) = \mathrm{r}(\boldsymbol{B}) = n\). 再由\hyperref[proposition:Sylvester不等式]{Sylvester不等式}可得
\begin{align*}
n = \mathrm{r}(\boldsymbol{A})+\mathrm{r}(\boldsymbol{B}) - n\leq \mathrm{r}(\boldsymbol{A}\boldsymbol{B})\leq \min\{\mathrm{r}(\boldsymbol{A}),\mathrm{r}(\boldsymbol{B})\} = n,
\end{align*}
从而\(\mathrm{r}(\boldsymbol{A}\boldsymbol{B}) = n\). 因此\(0\)作为\(\boldsymbol{A}\boldsymbol{B}\)的特征值, 其几何重数为\(m - \mathrm{r}(\boldsymbol{A}\boldsymbol{B}) = m - n\), 即特征值\(0\)的代数重数等于几何重数. 任取\(\boldsymbol{B}\boldsymbol{A}\)的特征值\(\lambda_0\), 它也是\(\boldsymbol{A}\boldsymbol{B}\)的非零特征值, 显然\(m_{\boldsymbol{A}\boldsymbol{B}}(\lambda_0) = m_{\boldsymbol{B}\boldsymbol{A}}(\lambda_0)\). 考虑分块矩阵\(\begin{pmatrix}
\boldsymbol{I}_m&\boldsymbol{A}\\
\boldsymbol{B}&\lambda_0\boldsymbol{I}_n
\end{pmatrix}\), 由\hyperref[proposition:秩的降阶公式]{秩的降阶公式}可得
\begin{align*}
m + \mathrm{r}(\lambda_0\boldsymbol{I}_n - \boldsymbol{B}\boldsymbol{A}) = n + \mathrm{r}(\boldsymbol{I}_m - \frac{1}{\lambda_0}\boldsymbol{A}\boldsymbol{B}) = n + \mathrm{r}(\lambda_0\boldsymbol{I}_m - \boldsymbol{A}\boldsymbol{B}),
\end{align*}
于是\(t_{\boldsymbol{A}\boldsymbol{B}}(\lambda_0) = m - \mathrm{r}(\lambda_0\boldsymbol{I}_m - \boldsymbol{A}\boldsymbol{B}) = n - \mathrm{r}(\lambda_0\boldsymbol{I}_n - \boldsymbol{B}\boldsymbol{A}) = t_{\boldsymbol{B}\boldsymbol{A}}(\lambda_0)\). 由\(\lambda_0\)的任意性即知, \(\boldsymbol{A}\boldsymbol{B}\)有完全的特征向量系当且仅当\(\boldsymbol{B}\boldsymbol{A}\)有完全的特征向量系, 从而\(\boldsymbol{A}\boldsymbol{B}\)可对角化当且仅当\(\boldsymbol{B}\boldsymbol{A}\)可对角化.
\end{proof}

\subsection{利用反证法证明不可对角化}

\begin{example}\label{example-0.10}
求证:
\begin{enumerate}[(1)]
\item 若\(n\)阶矩阵\(\boldsymbol{A}\)的特征值都是\(\lambda_0\), 但\(\boldsymbol{A}\)不是纯量矩阵, 则\(\boldsymbol{A}\)不可对角化. 特别地, 非零的幂零矩阵不可对角化.

\item 若\(n\)阶实矩阵\(\boldsymbol{A}\)适合\(\boldsymbol{A}^2 + \boldsymbol{A} + \boldsymbol{I}_n = \boldsymbol{O}\), 则\(\boldsymbol{A}\)在实数域上不可对角化.
\end{enumerate}
\end{example}
\begin{proof}
\begin{enumerate}[(1)]
\item 用反证法, 设\(\boldsymbol{A}\)可对角化, 则存在可逆矩阵\(\boldsymbol{P}\), 使得\(\boldsymbol{P}^{-1}\boldsymbol{A}\boldsymbol{P} = \boldsymbol{\Lambda}\)为对角矩阵. 由假设\(\boldsymbol{\Lambda}\)的主对角元素全为\(\lambda_0\), 故\(\boldsymbol{\Lambda} = \lambda_0\boldsymbol{I}_n\), 于是\(\boldsymbol{A} = \boldsymbol{P}(\lambda_0\boldsymbol{I}_n)\boldsymbol{P}^{-1} = \lambda_0\boldsymbol{I}_n\), 这与假设矛盾.特别地,幂零矩阵的特征值都是零(特征值适合$x^k=0$),因此也不可对角化.

\item 用反证法, 设\(\boldsymbol{A}\)在实数域上可对角化, 则\(\boldsymbol{A}\)的特征值都是实数. 因为\(\boldsymbol{A}\)适合多项式\(x^2 + x + 1\), 故由\hyperref[proposition:矩阵适合的多项式其特征值也适合]{命题\ref{proposition:矩阵适合的多项式其特征值也适合}}可知, \(\boldsymbol{A}\)的特征值也适合\(x^2 + x + 1\), 从而不可能是实数, 矛盾.
\end{enumerate}
\end{proof}

\begin{lemma}[秩1矩阵的列向量分解]\label{lemma:秩1矩阵的列向量分解}
设\(n(n > 1)\)阶矩阵\(\boldsymbol{A}\)的秩为\(1\),则存在非零列向量\(\boldsymbol{\alpha},\boldsymbol{\beta}\), 使得\(\boldsymbol{A} = \boldsymbol{\alpha}\boldsymbol{\beta}'\).
\end{lemma}
\begin{proof}
由于$\mathrm{r}(\boldsymbol{A}) = 1$,因此$\boldsymbol{A}$的列向量成比例,从而存在非零列向量$\boldsymbol{\alpha }$,使得$\boldsymbol{A}$的列分块为
\begin{align*}
\boldsymbol{A}=\left( \boldsymbol{k}_{\mathbf{1}}\boldsymbol{\alpha },\boldsymbol{k}_{\mathbf{2}}\boldsymbol{\alpha },\cdots ,\boldsymbol{k}_{\boldsymbol{n}}\boldsymbol{\alpha } \right)  .
\end{align*}
其中$\boldsymbol{k}_{\mathbf{1}},\boldsymbol{k}_{\mathbf{2}},\cdots ,\boldsymbol{k}_{\boldsymbol{n}}$为不全为零的实数.否则,$\boldsymbol{A}=\boldsymbol{O}$矛盾!于是令$\boldsymbol{\beta }=\left( \boldsymbol{k}_{\mathbf{1}},\boldsymbol{k}_{\mathbf{2}},\cdots ,\boldsymbol{k}_{\boldsymbol{n}} \right)'\ne \mathbf{0}$,则
\begin{align*}
\boldsymbol{A}=\left( \boldsymbol{k}_1\boldsymbol{\alpha },\boldsymbol{k}_2\boldsymbol{\alpha },\cdots ,\boldsymbol{k}_{\boldsymbol{n}}\boldsymbol{\alpha } \right) =\boldsymbol{\alpha \beta }' .
\end{align*}
\end{proof}

\begin{proposition}\label{proposition:矩阵可对角化迹必不为零}
设\(n(n > 1)\)阶矩阵\(\boldsymbol{A}\)的秩为\(1\), 求证: \(\boldsymbol{A}\)可对角化的充要条件是\(\mathrm{tr}(\boldsymbol{A})\neq 0\).
\end{proposition}
\begin{note}
这个命题告诉我们\hyperref[proposition:矩阵乘积可对角化且可逆则交换后也可对角化]{命题\ref{proposition:矩阵乘积可对角化且可逆则交换后也可对角化}}的条件$|BA|\ne 0$是必要的.
\end{note}
\begin{proof}
由\(\mathrm{r}(\boldsymbol{A}) = 1\)及\hyperref[lemma:秩1矩阵的列向量分解]{秩1矩阵的列向量分解}可知, 存在非零列向量\(\boldsymbol{\alpha},\boldsymbol{\beta}\), 使得\(\boldsymbol{A} = \boldsymbol{\alpha}\boldsymbol{\beta}'\), 于是由迹的交换性可得\(\mathrm{tr}(\boldsymbol{A}) = \mathrm{tr}(\boldsymbol{\alpha}\boldsymbol{\beta}') = \mathrm{tr}(\boldsymbol{\beta}'\boldsymbol{\alpha}) = \boldsymbol{\beta}'\boldsymbol{\alpha}\).

{\color{blue}证法一:}
由\hyperref[example-6.10]{例题\ref{example-6.10}}及其可对角化的讨论可知,令\hyperref[example-6.10]{例题\ref{example-6.10}}条件中的$\boldsymbol{A}=\boldsymbol{I_n}$即可得到$A$可对角化的充要条件是$\mathrm{tr}(\boldsymbol{A})=\boldsymbol{\beta}'\boldsymbol{\alpha}\ne 0$或$A=O$,而$\boldsymbol{A}=\boldsymbol{O}$与$\mathrm{r}(\boldsymbol{A}) = 1$矛盾,故$A$可对角化的充要条件是$\mathrm{tr}(\boldsymbol{A})=\ne 0$.

{\color{blue}证法二:}
注意到\(\boldsymbol{A}^2 = (\boldsymbol{\alpha}\boldsymbol{\beta}')(\boldsymbol{\alpha}\boldsymbol{\beta}') = \boldsymbol{\alpha}(\boldsymbol{\beta}'\boldsymbol{\alpha})\boldsymbol{\beta}' = (\boldsymbol{\beta}'\boldsymbol{\alpha})\boldsymbol{\alpha}\boldsymbol{\beta}' = \mathrm{tr}(\boldsymbol{A})\boldsymbol{A}\), 故\(\boldsymbol{A}\)适合多项式\(x^2-\mathrm{tr}(\boldsymbol{A})x\). 若\(\mathrm{tr}(\boldsymbol{A})\neq 0\), 则由\hyperref[proposition:适合的多项式无重根则可对角化]{命题\ref{proposition:适合的多项式无重根则可对角化}}可知\(\boldsymbol{A}\)可对角化; 若\(\mathrm{tr}(\boldsymbol{A}) = 0\), 则\(\boldsymbol{A}\)是幂零矩阵, 又\(\boldsymbol{A}\neq \boldsymbol{O}\), 故由\hyperref[example-0.10]{例题\ref{example-0.10}(1)}可知\(\boldsymbol{A}\)不可对角化.
\end{proof}









\end{document}
\documentclass[../../main.tex]{subfiles}% 注意这里的文件路径不能用 ./main.tex ,否则用latexmk编译子文件会报错
\graphicspath{{\subfix{./image/}}} % 指定图片目录,后续可以直接使用图片文件名
% 注意这里的文件路径不能用 ../../image/ ,否则用latexmk编译子文件会报错

% 例如:
% \begin{figure}[H]
% \centering
% \includegraphics[scale=0.3]{图.png}
% \caption{}
% \label{figure:图}
% \end{figure}
% 注意:上述\label{}一定要放在\caption{}之后,否则引用图片序号会只会显示??.

\begin{document}

\section{矩阵空间上的经典线性映射}

\begin{theorem}[AB和BA的非0 Jordan完全一致]\label{theorem:AB和BA的非0Jordan完全一致}
设 \( A \in \mathbb{C}^{m \times n}, B \in \mathbb{C}^{n \times m} \)，则 \( AB \) 和 \( BA \) 的非0 Jordan完全一致,即$AB$和$BA$的非零特征值对应的Jordan块的形状和数量完全一样.
\end{theorem}
\begin{remark}
由\refcor{corollary:打洞原理推论}可得,$AB$和$BA$有完全一样的非$0$特征值且重数也相同．但这个定理的结论显然更强.
\end{remark}
\begin{proof}
考虑 \( PAQQ^{-1}BP^{-1}, Q^{-1}BP^{-1}PAQ \) 可不妨设
\[
A = \begin{pmatrix}
E_r & 0_{r \times (n - r)} \\
0_{(m - r) \times r} & 0_{(m - r) \times (n - r)}
\end{pmatrix}, B = \begin{pmatrix}
B_1 & B_2 \\
B_3 & B_4
\end{pmatrix}, B_1 \in \mathbb{C}^{r \times r}, B_3 \in \mathbb{C}^{(n - r) \times r},
\]
这里 \( B \) 的分块和 \( A \) 对应. 于是直接计算有
\begin{align}
AB = \begin{pmatrix}
B_1 & B_2 \\
0 & 0
\end{pmatrix}, BA = \begin{pmatrix}
B_1 & 0 \\
B_3 & 0
\end{pmatrix}. \label{23.11}
\end{align}
从 \(\eqref{23.11}\) 可以看到 \( AB, BA \) 非 0 特征值都集中在 \( B_1 \) 上, 所以非 0 特征值完全一致. 设 \( \lambda \neq 0 \) 是 \( AB, BA \) 特征值. 则回忆\refthe{theorem:Jordan块的个数与秩的关系}, 决定 \( C \) 的Jordan 块分布, 我们知道只需决定 \( (\lambda E - C)^k, k \in \mathbb{N}_0 \) 的秩即可. 于是对每个 \( k \in \mathbb{N}_0 \), 我们有
\[
(\lambda E_m - AB)^k = \begin{pmatrix}
(\lambda E_r - B_1)^k & * \\
0 & \lambda^k E_{m - r}
\end{pmatrix}, (\lambda E_n - BA)^k = \begin{pmatrix}
(\lambda E_r - B_1)^k & 0 \\
* & \lambda^k E_{n - r}
\end{pmatrix}.
\]
作初等变换
\[
\begin{pmatrix}
(\lambda E_r - B_1)^k & * \\
0 & \lambda^k E_{m - r}
\end{pmatrix} \to \begin{pmatrix}
(\lambda E_r - B_1)^k & 0 \\
0 & \lambda^k E_{m - r}
\end{pmatrix}, \begin{pmatrix}
(\lambda E_n - B_1)^k & 0 \\
* & \lambda^k E_{n - r}
\end{pmatrix} \to \begin{pmatrix}
(\lambda E_r - B_1)^k & 0 \\
0 & \lambda^k E_{n - r}
\end{pmatrix},
\]
于是我们证明了
\[
r\left( (\lambda E_m - AB)^k \right) + n = r\left( (\lambda E_n - BA)^k \right) + m, \forall k \in \mathbb{N}_0,
\]
$AB$和$BA$的主对角元为$\lambda_j(\ne 0)$的Jordan块中$k$阶Jordan块的个数分别记为$N_j(k)$和$M_j(k)$,于是由\refthe{theorem:Jordan块的个数与秩的关系}可知
\begin{align*}
N_j\left( k \right) &=r\left( (\lambda E_m-AB)^{k+1} \right) +r\left( (\lambda E_m-AB)^{k-1} \right) -2r\left( (\lambda E_m-AB)^k \right) 
\\
&=r\left( (\lambda E_n-BA)^{k+1} \right) +m-n+r\left( (\lambda E_n-BA)^{k-1} \right) +m-n-2r\left( (\lambda E_n-BA)^k \right) -2\left( m-n \right) 
\\
&=r\left( (\lambda E_n-BA)^{k+1} \right) +r\left( (\lambda E_n-BA)^{k-1} \right) -2r\left( (\lambda E_n-BA)^k \right) ,
\end{align*}
\begin{align*}
M_j\left( k \right) =r\left( (\lambda E_n-BA)^{k+1} \right) +r\left( (\lambda E_n-BA)^{k-1} \right) -2r\left( (\lambda E_n-BA)^k \right) .
\end{align*}
故$N_j(k)=M_j(k).$
这就证明了 \( AB \) 和 \( BA \) 的非 0 Jordan 完全一致.

\end{proof}

\begin{corollary}[$E+MN$和$E+NM$秩相同]\label{corollary:E+MN和E+NM秩相同}
设 \( M \in \mathbb{C}^{n \times n}, N \in \mathbb{C}^{n \times n} \)，则 \( E + MN \) 和 \( E + NM \) 有相同的秩.
\end{corollary}
\begin{proof}
因为 \( E + MN \) 和 \( E + NM \) 的秩分别完全由 \( MN \) 和 \( NM \) 的特征值 \(-1\) 的 Jordan 块块数决定，因此由\refthe{theorem:AB和BA的非0Jordan完全一致}知结论成立.

\end{proof}

\begin{corollary}
设 \( A,B \) 都是 \( n \) 阶复矩阵, 则 \( AB \sim BA \) 充要条件是
\[
r\left( (AB)^i \right) = r\left( (BA)^i \right), i = 1,2,\cdots, n - 1.
\]
\end{corollary}
\begin{proof}
必要性显然成立.再证充分性.由\refthe{theorem:AB和BA的非0Jordan完全一致},只需考虑 0 特征值对应的Jordan块的形状和个数. 因此 再由\refthe{theorem:Jordan块的个数与秩的关系}可知,$AB$和$BA$的0 特征值对应的Jordan块的形状和个数完全一致。于是\( AB \sim BA \) ,故结论成立.

\end{proof}

\begin{example}
\begin{enumerate}
\item 已知
\[
AB = \begin{pmatrix}
8 & 0 & -4 \\
-\frac{3}{2} & 9 & -6 \\
-2 & 0 & 1
\end{pmatrix}, A \in \mathbb{C}^{3 \times 2}, B \in \mathbb{C}^{2 \times 3},
\]
求 \( BA \).

\item 设 \( A \in \mathbb{C}^{4 \times 2}, B \in \mathbb{C}^{2 \times 4} \) 满足
\[
AB = \begin{pmatrix}
1 & 0 & -1 & 0 \\
0 & 1 & 0 & -1 \\
-1 & 0 & 1 & 0 \\
0 & -1 & 0 & 1
\end{pmatrix},
\]
求 \( BA \).
\end{enumerate}
\end{example}
\begin{note}
此类问题肯定就是通过\refthe{theorem:AB和BA的非0Jordan完全一致}来确定.
\end{note}
\begin{remark}
与纯量阵相似的矩阵只有纯量阵,因为$P^{-1}(kI)P=kI$.
\end{remark}
\begin{proof}
\begin{enumerate}
\item 计算得 \( AB \sim \text{diag}\{0, 9, 9\} \). 故 \( BA \sim \text{diag}\{9, 9\} \). 因为与纯量阵相似的矩阵只有纯量阵,且$BA\in \mathbb{C}^{2\times 2}$,所以 \( BA = 9E_2 \).

\item 计算得
\[
AB = \begin{pmatrix}
1 & 0 & -1 & 0 \\
0 & 1 & 0 & -1 \\
-1 & 0 & 1 & 0 \\
0 & -1 & 0 & 1
\end{pmatrix} \sim \begin{pmatrix}
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 \\
0 & 0 & 2 & 0 \\
0 & 0 & 0 & 2
\end{pmatrix}.
\]
又$BA\in \mathbb{C}^{2\times 2}$,故 \( BA \sim \begin{pmatrix} 2 & 0 \\ 0 & 2 \end{pmatrix} \), 因此 \( BA = \begin{pmatrix} 2 & 0 \\ 0 & 2 \end{pmatrix} \).
\end{enumerate}

\end{proof}

\begin{example}
设 \( n \) 阶复矩阵 \( A,B \) 满足 \( r(ABA) = r(B) \), 证明 \( AB \sim BA \).
\end{example}
\begin{proof}
类似\refthe{theorem:AB和BA的非0Jordan完全一致}的证明, 不妨设
\[
A = \begin{pmatrix} E_r & 0 \\ 0 & 0 \end{pmatrix}, B = \begin{pmatrix} B_1 & B_2 \\ B_3 & B_4 \end{pmatrix}, B_1 \in \mathbb{C}^{r \times r}.
\]
则
\[
r(ABA) = r\left( \begin{pmatrix} B_1 & 0 \\ 0 & 0 \end{pmatrix} \right) = r\left( \begin{pmatrix} B_1 & B_2 \\ B_3 & B_4 \end{pmatrix} \right).
\]
于是
\[
r(ABA) = r\left( \begin{pmatrix} B_1 & 0 \\ 0 & 0 \end{pmatrix} \right) = r\left( \begin{pmatrix} B_1 & B_2 \\ B_3 & B_4 \end{pmatrix} \right) \geqslant r\left( \begin{pmatrix} B_1 \\ B_3 \end{pmatrix} \right) \geqslant r(B_1),
\]
以及
\[
r(ABA) = r\left( \begin{pmatrix} B_1 & 0 \\ 0 & 0 \end{pmatrix} \right) = r\left( \begin{pmatrix} B_1 & B_2 \\ B_3 & B_4 \end{pmatrix} \right) \geqslant r\left( \begin{pmatrix} B_1 & B_2 \end{pmatrix} \right) \geqslant r(B_1).
\]
故
\[
r\left( \begin{pmatrix} B_1 \\ B_3 \end{pmatrix} \right) = r(B_1) = r\left( \begin{pmatrix} B_1 & B_2 \end{pmatrix} \right).
\]
由\hyperref[theorem:线性方程组有解的充要条件]{线性方程组有解的充要条件}, 我们知道存在 \( X,Y \) 使得 \( B_2 = B_1X, B_3 = YB_1 \), 从而有
\begin{gather*}
AB = \begin{pmatrix} B_1 & B_2 \\ 0 & 0 \end{pmatrix} = \begin{pmatrix} B_1 & B_1X \\ 0 & 0 \end{pmatrix} \xrightarrow{\hyperref[proposition:相似初等变换]{\text{相似初等变换}}} \begin{pmatrix} B_1 & 0 \\ 0 & 0 \end{pmatrix},
\\
BA = \begin{pmatrix} B_1 & 0 \\ B_3 & 0 \end{pmatrix} = \begin{pmatrix} B_1 & 0 \\ YB_1 & 0 \end{pmatrix} \xrightarrow{\hyperref[proposition:相似初等变换]{\text{相似初等变换}}} \begin{pmatrix} B_1 & 0 \\ 0 & 0 \end{pmatrix}.
\end{gather*}
我们证明了 \( AB \sim BA \).

\end{proof}

\begin{theorem}[Lie映射经典性质]\label{theorem:Lie映射经典性质}
给定 $A \in \mathbb{C}^{n \times n}$, 定义 $l_A: \mathbb{C}^{n \times n} \to \mathbb{C}^{n \times n}, X \to AX - XA$, 我们有

1. $A$ 所有特征值相同等价 $l_A$ 幂零.

2. $l_A$ 可对角化等价于 $A$ 可对角化.
\end{theorem}
\begin{note}
一个处理本题的经典技巧是考虑 $l_A$ 在基 $\{E_{11}, E_{12}, \cdots, E_{1n}, E_{21}, \cdots, E_{2n}, \cdots, E_{n1}, \cdots, E_{nn}\}$ 下的表示矩阵形如 $A \otimes I - I \otimes A^T$, 但我们引入的考虑自然同构的技巧可以完美且简洁的替代这个方法.
\end{note}
\begin{note}
考虑线性映射 $l: \mathbb{C}^{n \times n} \to \mathrm{End}(\mathbb{C}^{n \times n}), A \mapsto l_A$, 则从证明可以看到
\begin{align*}
\ker l = \{A \in \mathbb{C}^{n \times n} : A \text{ 是数量矩阵}\}.
\end{align*}
\end{note}
\begin{proof}
1. {\heiti 必要性:}若 $A$ 所有特征值相同, 则对 $\lambda \neq 0$,
\begin{align*}
l_A X = \lambda X \Leftrightarrow AX = X(\lambda E + A)
\end{align*}
显然$A, A + \lambda E$ 没有公共特征值,由\refpro{AX=XB相关命题1}知我们知道 $l_A X = \lambda X$ 只有 $0$ 解. 现在 $l_A$ 特征值全为 $0$ 知 $l_A$ 是幂零矩阵.

{\heiti 充分性:} 若 $A$ 有两个不同特征值 $\lambda_1, \lambda_2 \in \mathbb{C}$, 则$A$和$(\lambda_2-\lambda_1)E+A$有公共特征值$\lambda_2$.于是由\refpro{AX=XB相关命题1}, 存在$X_0 \in \mathbb{C}^{n \times n} \setminus \{0\}$ 使得
\begin{align*}
A X_0 = X_0((\lambda_2 - \lambda_1)E + A).
\end{align*}
于是 $l_A X_0 = (\lambda_2 - \lambda_1) X_0$. 这表明 $l_A$ 有非 $0$ 特征值, 这就是一个矛盾! 故 $A$ 所有特征值相同.

2. {\heiti 充分性:} 若 $A$ 可对角化, 可不妨设 $A$ 是对角矩阵, 这是因为设可逆矩阵 $P \in \mathbb{C}^{n \times n}$ 使得 $P^{-1} A P = \tilde{A}$ 为对角矩阵, 那么注意到交换图
\[
\begin{tikzcd}
\mathbb{C}^{n\times n} \arrow[d, "\tau"'] \arrow[r, "l_A"] & \mathbb{C}^{n\times n} \arrow[d, "\tau"] \\
\mathbb{C}^{n\times n} \arrow[r, "l_{\tilde{A}}"']                   & \mathbb{C}^{n\times n},                  
\end{tikzcd}
\]
这里 $\tau(X) = P^{-1} X P, \forall X \in \mathbb{C}^{n \times n}$. 从而
\begin{gather*}
\tau \circ l_A\left( X \right) =P^{-1}\left( AX-XA \right) P=\widetilde{A}P^{-1}XP-P^{-1}XP\widetilde{A}.
\\
l_{\widetilde{A}}\circ \tau \left( X \right) =\widetilde{A}P^{-1}XP-P^{-1}XP\widetilde{A}.
\end{gather*}
又因为$\tau$可逆,所以$l_A=\tau ^{-1} \circ l_{\tilde{A}}\circ \tau \sim l_{\tilde{A}}.$
换言之, 在同构 $\tau$ 下, $l_A, l_{\tilde{A}}$ 应该(在相似的等价关系下)有相同的线性代数性质, 所以我们可以不妨设 $A$ 为对角矩阵.
不妨设
\begin{align*}
A = \mathrm{diag}\{\lambda_1, \lambda_2, \cdots, \lambda_n\}, \lambda_i \in \mathbb{C}, i = 1, 2, \cdots, n 
\end{align*}
于是直接计算表明
\begin{align*}
l_A(E_{ij}) = (\lambda_i - \lambda_j) E_{ij}, \forall i, j \in \{1, 2, \cdots, n\}
\end{align*}
这就证明了$l_A$ 是可对角化的.

{\heiti 必要性: }运用 \hyperref[theorem:Jordan-Chevalley分解]{Jordan分解}, 我们知道 $A = B + C, B$ 可对角化, $C$ 幂零, $BC = CB$, 则 $l_A = l_B + l_C$. 由充分性知 $l_B$ 可对角化, 由第一问知 $l_C$ 幂零. 由$BC=CB$,容易验证 $l_C \circ  l_B = l_B \circ  l_C$, 于是我们知道 $l_A = l_B + l_C$ 这是 $l_A$ 的 Jordan 分解. 现在 $l_A = l_A + 0$ 也是一个 Jordan 分解, 故由\hyperref[theorem:Jordan-Chevalley分解]{Jordan分解}的唯一性知$l_B = l_A, l_C = 0$. 现在 $CX = XC, \forall X \in \mathbb{C}^{n \times n}$, 由\nrefpro{proposition:纯量阵的刻画}{(2)}, 我们知道 $C$ 为数量矩阵, 所以结合 $C$ 幂零, 我们知道 $C = O$, 故 $A = B$ 可对角化, 这就完成了证明.


\end{proof}

\begin{example}
\begin{enumerate}
\item 设 $A \in \mathbb{C}^{m \times n}, B \in \mathbb{C}^{k \times p}$, 考虑 $T_{A,B} : \mathbb{C}^{n \times k} \to \mathbb{C}^{m \times p}, X \mapsto AXB$, 求
$$\dim \mathrm{Ker} T_{A,B}, \dim \operatorname{Im} T_{A,B}.$$

\item 设 $A \in \mathbb{C}^{m \times n}, B \in \mathbb{C}^{k \times p}$, 求 $T_{A,B} : \mathbb{C}^{n \times k} \to \mathbb{C}^{m \times p}, X \mapsto AXB$ 在基
$$\{E_{11}, E_{12}, \cdots, E_{1k}, E_{21}, \cdots, E_{2k}, \cdots, E_{n1}, \cdots, E_{nk}\}$$
和基
$$\{E_{11}, E_{12}, \cdots, E_{1p}, E_{21}, \cdots, E_{2p}, \cdots, E_{m1}, \cdots, E_{mp}\}$$
下的表示矩阵.
\end{enumerate}
\end{example}
\begin{proof}
\begin{enumerate}
\item 考虑等价标准型
\begin{align*}
PAQ = \begin{pmatrix} E_r & 0 \\ 0 & 0 \end{pmatrix}, RBS = \begin{pmatrix} E_s & 0 \\ 0 & 0 \end{pmatrix}
\end{align*}
于是记
$$\widetilde{T_{A,B}} = T_{\begin{pmatrix} E_r & 0 \\ 0 & 0 \end{pmatrix} \begin{pmatrix} E_s & 0 \\ 0 & 0 \end{pmatrix}}, \tau : \mathbb{C}^{n \times k} \to \mathbb{C}^{n \times k}, X \mapsto Q^{-1}XR^{-1}, \tau' : \mathbb{C}^{m \times p} \to \mathbb{C}^{m \times p}, X \mapsto PXS$$
就有交换图
\[
\begin{tikzcd}
\mathbb{C}^{n\times k} \arrow[rr, "{T_{A,B}}"] \arrow[d, "\tau"'] &  & \mathbb{C}^{m\times p} \arrow[d, "\tau'"] \\
\mathbb{C}^{n\times k} \arrow[rr, "{\widetilde{T_{A,B}}}"']       &  & \mathbb{C}^{m\times p}                   
\end{tikzcd}.
\]
容易验证在同构映射$\tau ,\tau'$下,$\widetilde{T_{A,B}}$和$T_{A,B}$(相抵)等价,从而$\widetilde{T_{A,B}}$和$T_{A,B}$(在相抵的等价关系下)有相同的线性代数性质.
故可不妨设
$$A = \begin{pmatrix} E_r & 0 \\ 0 & 0 \end{pmatrix}, B = \begin{pmatrix} E_s & 0 \\ 0 & 0 \end{pmatrix}$$
于是对 $X = \begin{pmatrix} X_1 & X_2 \\ X_3 & X_4 \end{pmatrix}, X_1 \in \mathbb{C}^{r \times s}$, 我们有
$$T_{A,B}(X) = \begin{pmatrix} X_1 & 0 \\ 0 & 0 \end{pmatrix} \Rightarrow \dim \operatorname{Im} T_{A,B} = rs,$$
以及
$$T_{A,B}(X) = \begin{pmatrix} X_1 & 0 \\ 0 & 0 \end{pmatrix} \stackrel{\text{维数公式}}{\Rightarrow} \dim \mathrm{Ker} T_{A,B} = nk - rs.$$

\item 注意到
$$(A \otimes B^T)_{((t - 1)p + r, (t' - 1)k + r')} = a_{tr} b_{r'r}, 1 \leqslant  t \leqslant  m, 1 \leqslant  t' \leqslant  n, 1 \leqslant  r \leqslant  k, 1 \leqslant  r' \leqslant  \ell$$
现在表示矩阵 $\widetilde{T}_{A,B}$ 的 $((t - 1)p + r, (t' - 1)k + r')$ 元为
$$(T_{A,B}(E_{t'r'})_{(tr)} = (AE_{t'r'}B)_{(tr)} = a_{tr} b_{r'r} = (A \otimes B^T)_{((t - 1)p + r, (t' - 1)k + r')}$$
因此, 我们知道 $\widetilde{T}_{A,B} = A \otimes B^T$.
\end{enumerate}

\end{proof}

\begin{example}
设 $A \in \mathbb{C}^{n \times n}$, $\varphi : \mathbb{C}^{n \times n} \to \mathbb{C}^{n \times n}, X \mapsto AX$. 证明: $\varphi$ 可对角化的充要条件是 $A$ 可对角化.
\end{example}
\begin{proof}
{\heiti 充分性:}
设可逆矩阵 $P \in \mathbb{C}^{n \times n}$, 考虑 $\psi : \mathbb{C}^{n \times n} \to \mathbb{C}^{n \times n}, X \mapsto PX$, 则
$$\psi^{-1} \circ \varphi \circ \psi (X) = P^{-1}APX, \forall X \in \mathbb{C}^{n \times n}$$
故不妨设 $A$ 为相似标准型. 因此若
$$A = \mathrm{diag}\{\lambda_1, \lambda_2, \cdots, \lambda_n\}, \lambda_i \in \mathbb{C}, i = 1, 2, \cdots, n$$
则 $\varphi(E_{ij}) = \lambda_i E_{ij}, i, j = 1, 2, \cdots, n$. 在基
$$\{E_{11}, E_{12}, \cdots, E_{1n}, E_{21}, \cdots, E_{2n}, \cdots, E_{n1}, \cdots, E_{nn}\}$$
下的矩阵为对角矩阵.

{\heiti 必要性:}
设可逆矩阵 $P = \{\alpha_1, \alpha_2, \cdots, \alpha_n\} \in \mathbb{C}^{n \times n}$ 使得
$$P^{-1}AP = \mathrm{diag}\{J_{n_1}(\lambda_1), J_{n_2}(\lambda_2), \cdots, J_{n_s}(\lambda_s)\}, n_1 > 1$$
设
$$L \triangleq \mathrm{span}\{\alpha_i \alpha_j^T : 1 \leqslant  i, j \leqslant  n_1\}$$
我们有
\begin{align*}
A\alpha_1 \alpha_j^T &= \lambda_1 \alpha_1 \alpha_j^T, 1 \leqslant  j \leqslant  n_1 \\
A\alpha_i \alpha_j^T &= \alpha_{i - 1} \alpha_j^T + \lambda_i \alpha_i \alpha_j^T, 2 \leqslant  i \leqslant  n_1, 1 \leqslant  j \leqslant  n_1
\end{align*}
即 $L$ 是 $\varphi$ 不变子空间. 由\reflem{lemma:可对角化矩阵限制后仍可对角化}知 $\varphi|_L$ 可对角化. 由\refpro{proposition:线性无关的向量组与另一个转置的乘积积生成的矩阵也线性无关}知 $\alpha_i \alpha_j^T, 1 \leqslant  i, j \leqslant  n_1$ 必然线性无关.

在基 $\{\alpha_1 \alpha_1^T, \alpha_1 \alpha_2^T, \cdots, \alpha_1 \alpha_{n_1}^T, \alpha_2 \alpha_1^T, \alpha_2 \alpha_2^T, \cdots, \alpha_2 \alpha_{n_1}^T, \cdots, \alpha_{n_1} \alpha_1^T, \alpha_{n_1} \alpha_2^T, \cdots, \alpha_{n_1} \alpha_{n_1}^T\}$ 下 $\varphi|_L$ 的表示矩阵形如对角线为 $\lambda_1$ 的上三角矩阵且不是对角矩阵, 这就和 $\varphi|_L$ 可对角化矛盾! 我们完成了证明.

\end{proof}













\end{document}
\documentclass[../../main.tex]{subfiles}
\graphicspath{{\subfix{./image/}}} % 指定图片目录,后续可以直接使用图片文件名
% 注意这里的文件路径不能用 ../../image/ ,否则用latexmk编译子文件会报错

% 例如:
% \begin{figure}[H]
% \centering
% \includegraphics[scale=0.4]{图.png}
% \caption{}
% \label{figure:图}
% \end{figure}
% 注意:上述\label{}一定要放在\caption{}之后,否则引用图片序号会只会显示??.

\begin{document}

\section{像空间和核空间}

\begin{proposition}\label{proposition:像空间和核空间的子空间链}
设\(\varphi\)是向量空间\(V\)上的线性变换,则
\[
V\supseteq \mathrm{Im}\varphi \supseteq \mathrm{Im}\varphi^2 \supseteq \cdots \supseteq \mathrm{Im}\varphi^n \supseteq \mathrm{Im}\varphi^{n + 1} \supseteq \cdots,
\]
\[
\mathrm{Ker}\varphi \subseteq \mathrm{Ker}\varphi ^2\subseteq \cdots \subseteq \mathrm{Ker}\varphi ^n\subseteq \mathrm{Ker}\varphi ^{n+1}\subseteq \cdots \subseteq V.
\]
\end{proposition}
\begin{proof}
由像空间和核空间的定义易证.

\end{proof}

\begin{example}
设线性空间\(V\)上的线性变换\(\varphi\)在基\(\{\boldsymbol{e}_1,\boldsymbol{e}_2,\boldsymbol{e}_3,\boldsymbol{e}_4\}\)下的表示矩阵为
\[
\boldsymbol{A}=\begin{pmatrix}
1&0&2&1\\
-1&2&1&3\\
1&2&5&5\\
2&-2&1&-2
\end{pmatrix},
\]
求\(\varphi\)的核空间与像空间(用基的线性组合来表示).
\end{example}
\begin{proof}
像空间通过坐标向量同构于\(\boldsymbol{A}\)的列向量生成的子空间,通过计算可得\(\boldsymbol{A}\)的秩等于\(2\),且\(\boldsymbol{A}\)的第一、第二列向量线性无关,于是\(\text{Im}\varphi\)的基的坐标向量为\((1,-1,1,2)^\prime,(0,2,2,-2)^\prime\),从而\(\text{Im}\varphi = k_1(\boldsymbol{e}_1 - \boldsymbol{e}_2 + \boldsymbol{e}_3 + 2\boldsymbol{e}_4)+k_2(2\boldsymbol{e}_2 + 2\boldsymbol{e}_3 - 2\boldsymbol{e}_4)\). 核空间通过坐标向量同构于齐次线性方程组\(\boldsymbol{A}\boldsymbol{x}=0\)的解空间,通过计算可得该方程组的基础解系为\((-4,-3,2,0)^\prime,(-1,-2,0,1)^\prime\),此即\(\text{Ker}\varphi\)的基的坐标向量,于是\(\text{Ker}\varphi = k_1(-4\boldsymbol{e}_1 - 3\boldsymbol{e}_2 + 2\boldsymbol{e}_3)+k_2(-\boldsymbol{e}_1 - 2\boldsymbol{e}_2 + \boldsymbol{e}_4)\).

\end{proof}

\begin{proposition}\label{proposition:一组有限个非零线性变换一定存在非零像}
设\(V\)是数域\(\mathbb{F}\)上的线性空间,\(\varphi_1,\varphi_2,\cdots,\varphi_k\)是\(V\)上的非零线性变换. 求证:存在\(\boldsymbol{\alpha}\in V\),使得\(\varphi_i(\boldsymbol{\alpha})\neq 0(1\leqslant  i\leqslant  k)\).
\end{proposition}
\begin{proof}
因为\(\varphi_i\neq 0\),所以\(\text{Ker}\varphi_i\)是\(V\)的真子空间. 由\hyperref[proposition:真子空间外仍有向量存在]{命题\ref{proposition:真子空间外仍有向量存在}}可知,有限个真子空间\(\text{Ker}\varphi_i\)不能覆盖全空间\(V\),故必存在\(\boldsymbol{\alpha}\in V\),使得\(\boldsymbol{\alpha}\)不属于任意一个\(\text{Ker}\varphi_i\),从而结论得证.

\end{proof}

\begin{proposition}\label{proposition:一组有限个非零线性变换一定存在互不相同的像}
设\(V\)是数域\(\mathbb{F}\)上的线性空间,\(\varphi_1,\varphi_2,\cdots,\varphi_k\)是\(V\)上互不相同的线性变换. 求证:存在\(\boldsymbol{\alpha}\in V\),使得\(\varphi_1(\boldsymbol{\alpha}),\varphi_2(\boldsymbol{\alpha}),\cdots,\varphi_k(\boldsymbol{\alpha})\)互不相同.
\end{proposition}
\begin{proof}
令\(\varphi_{ij}=\varphi_i - \varphi_j(1\leqslant  i<j\leqslant  k)\),则\(\varphi_{ij}\)是\(V\)上的非零线性变换. 由\hyperref[proposition:一组有限个非零线性变换一定存在非零像]{命题\ref{proposition:一组有限个非零线性变换一定存在非零像}}可知,存在\(\boldsymbol{\alpha}\in V\),使得\(\varphi_{ij}(\boldsymbol{\alpha})\neq 0\),即\(\varphi_i(\boldsymbol{\alpha})\neq\varphi_j(\boldsymbol{\alpha})(1\leqslant  i<j\leqslant  k)\),从而结论得证. 

\end{proof}

\begin{proposition}\label{proposition:矩阵n次方幂秩等式}
设\(\boldsymbol{A}\)是\(n\)阶方阵,求证:\(\text{r}(\boldsymbol{A}^n)=\text{r}(\boldsymbol{A}^{n + 1})=\text{r}(\boldsymbol{A}^{n + 2})=\cdots\).
\end{proposition}
\begin{proof}
{\color{blue}证法一(代数方法):} 由秩的不等式可得
\[
n=\text{r}(\boldsymbol{I}_n)\geqslant \text{r}(\boldsymbol{A})\geqslant \text{r}(\boldsymbol{A}^2)\geqslant \cdots\geqslant \text{r}(\boldsymbol{A}^n)\geqslant \text{r}(\boldsymbol{A}^{n + 1})\geqslant  0.
\]
上述\(n + 2\)个整数都在\([0,n]\)之间,故由抽屉原理可知,存在某个整数\(m\in[0,n]\),使得\(\text{r}(\boldsymbol{A}^m)=\text{r}(\boldsymbol{A}^{m + 1})\). 对任意的\(k\geqslant  m\),由\hyperref[proposition:Frobenius(弗罗贝尼乌斯)不等式]{矩阵秩的Frobenius不等式}可得
\[
\text{r}(\boldsymbol{A}^{k + 1})=\text{r}(\boldsymbol{A}^{k - m}\boldsymbol{A}^m\boldsymbol{A})\geqslant \text{r}(\boldsymbol{A}^{k - m}\boldsymbol{A}^m)+\text{r}(\boldsymbol{A}^m\boldsymbol{A})-\text{r}(\boldsymbol{A}^m)=\text{r}(\boldsymbol{A}^k),
\]
又\(\text{r}(\boldsymbol{A}^{k + 1})\leqslant \text{r}(\boldsymbol{A}^k)\),故\(\text{r}(\boldsymbol{A}^{k + 1})=\text{r}(\boldsymbol{A}^k)\)对任意的\(k\geqslant  m\)成立,结论得证.

{\color{blue}证法二(几何方法):} 令\(\varphi\)为在\(n\)维列向量空间上由矩阵\(\boldsymbol{A}\)乘法诱导的线性变换,则\(\varphi\)在标准基下的表示矩阵就是\(\boldsymbol{A}\),并且不难发现对\(\forall k\in \mathbb{N}\),\(\varphi^k\)在标准基下的表示矩阵是\(\boldsymbol{A}^k\).因此\(\mathrm{r}(\boldsymbol{A}^k) = \mathrm{dim} \,\mathrm{Im}\varphi^k\),故原命题等价于$\mathrm{dim}\,\mathrm{Im}\varphi ^n=\mathrm{dim}\,\mathrm{Im}\varphi ^{n+1}=\mathrm{dim}\,\mathrm{Im}\varphi ^{n+2}=\cdots 
$.注意下列子空间链:
\[
V\supseteq\text{Im}\varphi\supseteq\text{Im}\varphi^2\supseteq\cdots\supseteq\text{Im}\varphi^n\supseteq\text{Im}\varphi^{n + 1}.
\]
上述\(n + 2\)个子空间的维数都在\([0,n]\)之间,故由抽屉原理可知,存在某个整数\(m\in[0,n]\),使得\(\text{Im}\varphi^m=\text{Im}\varphi^{m + 1}\). 现要证明对任意的\(k\geqslant  m\),\(\text{Im}\varphi^k=\text{Im}\varphi^{k + 1}\). 一方面,\(\text{Im}\varphi^{k + 1}\subseteq\text{Im}\varphi^k\)是显然的. 另一方面,任取\(\boldsymbol{\alpha}\in\text{Im}\varphi^k\),则存在\(\boldsymbol{\beta}\in V\),使得\(\boldsymbol{\alpha}=\varphi^k(\boldsymbol{\beta})\). 由于\(\varphi^m(\boldsymbol{\beta})\in\text{Im}\varphi^m=\text{Im}\varphi^{m + 1}\),故存在\(\boldsymbol{\gamma}\in V\),使得\(\varphi^m(\boldsymbol{\beta})=\varphi^{m + 1}(\boldsymbol{\gamma})\),从而
\[
\boldsymbol{\alpha}=\varphi^k(\boldsymbol{\beta})=\varphi^{k - m}(\varphi^m(\boldsymbol{\beta}))=\varphi^{k - m}(\varphi^{m + 1}(\boldsymbol{\gamma}))=\varphi^{k + 1}(\boldsymbol{\gamma})\in\text{Im}\varphi^{k + 1},
\]
故\(\text{Im}\varphi^k=\text{Im}\varphi^{k + 1}\)对任意的\(k\geqslant  m\)成立,取维数后即得结论. 

\end{proof}

\begin{corollary}\label{corollary:n次方幂秩/值域维数等式}
\begin{enumerate}[(1)]
\item 设\(\boldsymbol{A}\)是\(n\)阶方阵,则一定存在整数$m\in[0,n]$,使得\(\text{r}(\boldsymbol{A}^m)=\text{r}(\boldsymbol{A}^{m + 1})=\text{r}(\boldsymbol{A}^{m + 2})=\cdots\).

\item 设\(\varphi\)是\(n\)维线性空间\(V\)上的线性变换,则必存在整数\(m\in[0,n]\),使得
\[
\mathrm{dim}\,\mathrm{Im}\varphi ^m=\mathrm{dim}\,\mathrm{Im}\varphi ^{m+1}=\mathrm{dim}\,\mathrm{Im}\varphi ^{m+2}=\cdots.
\]
\end{enumerate}
\end{corollary}
\begin{proof}
\begin{enumerate}[(1)]
\item {\color{blue}证法一(代数方法):} 由秩的不等式可得
\[
n=\text{r}(\boldsymbol{I}_n)\geqslant \text{r}(\boldsymbol{A})\geqslant \text{r}(\boldsymbol{A}^2)\geqslant \cdots\geqslant \text{r}(\boldsymbol{A}^n)\geqslant \text{r}(\boldsymbol{A}^{n + 1})\geqslant  0.
\]
上述\(n + 2\)个整数都在\([0,n]\)之间,故由抽屉原理可知,存在某个整数\(m\in[0,n]\),使得\(\text{r}(\boldsymbol{A}^m)=\text{r}(\boldsymbol{A}^{m + 1})\). 对任意的\(k\geqslant  m\),由\hyperref[proposition:Frobenius(弗罗贝尼乌斯)不等式]{矩阵秩的Frobenius不等式}可得
\[
\text{r}(\boldsymbol{A}^{k + 1})=\text{r}(\boldsymbol{A}^{k - m}\boldsymbol{A}^m\boldsymbol{A})\geqslant \text{r}(\boldsymbol{A}^{k - m}\boldsymbol{A}^m)+\text{r}(\boldsymbol{A}^m\boldsymbol{A})-\text{r}(\boldsymbol{A}^m)=\text{r}(\boldsymbol{A}^k),
\]
又\(\text{r}(\boldsymbol{A}^{k + 1})\leqslant \text{r}(\boldsymbol{A}^k)\),故\(\text{r}(\boldsymbol{A}^{k + 1})=\text{r}(\boldsymbol{A}^k)\)对任意的\(k\geqslant  m\)成立,结论得证.

{\color{blue}证法二(几何方法):} 令\(\varphi\)为在\(n\)维列向量空间上由矩阵\(\boldsymbol{A}\)乘法诱导的线性变换,则\(\varphi\)在标准基下的表示矩阵就是\(\boldsymbol{A}\),并且不难发现对\(\forall k\in \mathbb{N}\),\(\varphi^k\)在标准基下的表示矩阵是\(\boldsymbol{A}^k\).因此\(\mathrm{r}(\boldsymbol{A}^k) = \mathrm{dim} \,\mathrm{Im}\varphi^k\),故原命题等价于$\mathrm{dim}\,\mathrm{Im}\varphi ^n=\mathrm{dim}\,\mathrm{Im}\varphi ^{n+1}=\mathrm{dim}\,\mathrm{Im}\varphi ^{n+2}=\cdots 
$.注意下列子空间链:
\[
V\supseteq\text{Im}\varphi\supseteq\text{Im}\varphi^2\supseteq\cdots\supseteq\text{Im}\varphi^n\supseteq\text{Im}\varphi^{n + 1}.
\]
上述\(n + 2\)个子空间的维数都在\([0,n]\)之间,故由抽屉原理可知,存在某个整数\(m\in[0,n]\),使得\(\text{Im}\varphi^m=\text{Im}\varphi^{m + 1}\). 现要证明对任意的\(k\geqslant  m\),\(\text{Im}\varphi^k=\text{Im}\varphi^{k + 1}\). 一方面,\(\text{Im}\varphi^{k + 1}\subseteq\text{Im}\varphi^k\)是显然的. 另一方面,任取\(\boldsymbol{\alpha}\in\text{Im}\varphi^k\),则存在\(\boldsymbol{\beta}\in V\),使得\(\boldsymbol{\alpha}=\varphi^k(\boldsymbol{\beta})\). 由于\(\varphi^m(\boldsymbol{\beta})\in\text{Im}\varphi^m=\text{Im}\varphi^{m + 1}\),故存在\(\boldsymbol{\gamma}\in V\),使得\(\varphi^m(\boldsymbol{\beta})=\varphi^{m + 1}(\boldsymbol{\gamma})\),从而
\[
\boldsymbol{\alpha}=\varphi^k(\boldsymbol{\beta})=\varphi^{k - m}(\varphi^m(\boldsymbol{\beta}))=\varphi^{k - m}(\varphi^{m + 1}(\boldsymbol{\gamma}))=\varphi^{k + 1}(\boldsymbol{\gamma})\in\text{Im}\varphi^{k + 1},
\]
故\(\text{Im}\varphi^k=\text{Im}\varphi^{k + 1}\)对任意的\(k\geqslant  m\)成立,取维数后即得结论. 

\item 注意下列子空间链:
\[
V\supseteq\text{Im}\varphi\supseteq\text{Im}\varphi^2\supseteq\cdots\supseteq\text{Im}\varphi^n\supseteq\text{Im}\varphi^{n + 1}.
\]
上述\(n + 2\)个子空间的维数都在\([0,n]\)之间,故由抽屉原理可知,存在某个整数\(m\in[0,n]\),使得\(\text{Im}\varphi^m=\text{Im}\varphi^{m + 1}\). 现要证明对任意的\(k\geqslant  m\),\(\text{Im}\varphi^k=\text{Im}\varphi^{k + 1}\). 一方面,\(\text{Im}\varphi^{k + 1}\subseteq\text{Im}\varphi^k\)是显然的. 另一方面,任取\(\boldsymbol{\alpha}\in\text{Im}\varphi^k\),则存在\(\boldsymbol{\beta}\in V\),使得\(\boldsymbol{\alpha}=\varphi^k(\boldsymbol{\beta})\). 由于\(\varphi^m(\boldsymbol{\beta})\in\text{Im}\varphi^m=\text{Im}\varphi^{m + 1}\),故存在\(\boldsymbol{\gamma}\in V\),使得\(\varphi^m(\boldsymbol{\beta})=\varphi^{m + 1}(\boldsymbol{\gamma})\),从而
\[
\boldsymbol{\alpha}=\varphi^k(\boldsymbol{\beta})=\varphi^{k - m}(\varphi^m(\boldsymbol{\beta}))=\varphi^{k - m}(\varphi^{m + 1}(\boldsymbol{\gamma}))=\varphi^{k + 1}(\boldsymbol{\gamma})\in\text{Im}\varphi^{k + 1},
\]
故\(\text{Im}\varphi^k=\text{Im}\varphi^{k + 1}\)对任意的\(k\geqslant  m\)成立,取维数后即得结论. 
\end{enumerate}

\end{proof}

\begin{proposition}\label{proposition:线性映射像空间与和空间等式链}
设\(\varphi\)是\(n\)维线性空间\(V\)上的线性变换,求证:必存在整数\(m\in[0,n]\),使得
\[
\text{Im}\varphi^m = \text{Im}\varphi^{m + 1} = \text{Im}\varphi^{m + 2} = \cdots, \text{Ker}\varphi^m = \text{Ker}\varphi^{m + 1} = \text{Ker}\varphi^{m + 2} = \cdots, V = \text{Im}\varphi^m\oplus\text{Ker}\varphi^m.
\]
\end{proposition}
\begin{proof}
根据\hyperref[corollary:n次方幂秩/值域维数等式]{推论\ref{corollary:n次方幂秩/值域维数等式}(2)}可知,存在整数\(m\in[0,n]\),使得
\[
\text{Im}\varphi^m = \text{Im}\varphi^{m + 1} = \text{Im}\varphi^{m + 2} = \cdots.
\]
注意到对任意的正整数\(i\),\(\text{Ker}\varphi^i\subseteq\text{Ker}\varphi^{i + 1}\). 再由维数公式可知,对任意的\(i\geqslant  m\),\(\dim\text{Ker}\varphi^i=\dim V - \dim\text{Im}\varphi^i=n - \dim\text{Im}\varphi^m\)是一个不依赖于\(i\)的常数,因此由\hyperref[proposition:与全空间维数相同的子空间等于全空间]{命题\ref{proposition:与全空间维数相同的子空间等于全空间}}可得
\[
\text{Ker}\varphi^m = \text{Ker}\varphi^{m + 1} = \text{Ker}\varphi^{m + 2} = \cdots.
\]
若\(\boldsymbol{\alpha}\in\text{Im}\varphi^m\cap\text{Ker}\varphi^m\),则\(\boldsymbol{\alpha}=\varphi^m(\boldsymbol{\beta})\),\(\varphi^m(\boldsymbol{\alpha}) = 0\). 于是\(0=\varphi^m(\boldsymbol{\alpha})=\varphi^{2m}(\boldsymbol{\beta})\),即\(\boldsymbol{\beta}\in\text{Ker}\varphi^{2m}=\text{Ker}\varphi^m\),从而\(\boldsymbol{\alpha}=\varphi^m(\boldsymbol{\beta}) = 0\),这证明了\(\text{Im}\varphi^m\cap\text{Ker}\varphi^m = 0\). 又对\(V\)中任一向量\(\boldsymbol{\alpha}\),因为\(\varphi^m(\boldsymbol{\alpha})\in\text{Im}\varphi^m=\text{Im}\varphi^{2m}\),所以\(\varphi^m(\boldsymbol{\alpha})=\varphi^{2m}(\boldsymbol{\beta})\),其中\(\boldsymbol{\beta}\in V\). 我们有分解式
\[
\boldsymbol{\alpha}=\varphi^m(\boldsymbol{\beta})+(\boldsymbol{\alpha}-\varphi^m(\boldsymbol{\beta})).
\]
注意到\(\varphi^m(\boldsymbol{\alpha}-\varphi^m(\boldsymbol{\beta})) = 0\),即\(\boldsymbol{\alpha}-\varphi^m(\boldsymbol{\beta})\in\text{Ker}\varphi^m\),这就证明了\(V=\text{Im}\varphi^m+\text{Ker}\varphi^m\). 因此
\[
V = \text{Im}\varphi^m\oplus\text{Ker}\varphi^m.
\]

\end{proof}
\begin{remark}
也可不证明\(\text{Im}\varphi^m\cap\text{Ker}\varphi^m = 0\),改由\hyperref[theorem:值域和核空间维数之和等于原像空间维数]{线性映射维数公式}\(\dim\text{Im}\varphi^m+\dim\text{Ker}\varphi^m=n\)直接得到\(V=\text{Im}\varphi^m\oplus\text{Ker}\varphi^m\).
\end{remark}

\begin{proposition}\label{proposition:像空间和核空间的直和分解}
设\(V\)是数域\(\mathbb{K}\)上的\(n\)维线性空间,\(\varphi\)是\(V\)上的线性变换,证明以下9个结论等价:

(1) \(V=\text{Ker}\varphi\oplus\text{Im}\varphi\);

(2) \(V=\text{Ker}\varphi+\text{Im}\varphi\);

(3) \(\text{Ker}\varphi\cap\text{Im}\varphi = 0\);

(4) \(\text{Ker}\varphi=\text{Ker}\varphi^2\),或等价地,\(\dim\text{Ker}\varphi=\dim\text{Ker}\varphi^2\);

(5) \(\text{Ker}\varphi=\text{Ker}\varphi^2=\text{Ker}\varphi^3=\cdots\),或等价地,\(\dim\text{Ker}\varphi=\dim\text{Ker}\varphi^2=\dim\text{Ker}\varphi^3=\cdots\);

(6) \(\text{Im}\varphi=\text{Im}\varphi^2\),或等价地,\(\text{r}(\varphi)=\text{r}(\varphi^2)\);

(7) \(\text{Im}\varphi=\text{Im}\varphi^2=\text{Im}\varphi^3=\cdots\),或等价地,\(\text{r}(\varphi)=\text{r}(\varphi^2)=\text{r}(\varphi^3)=\cdots\);

(8) \(\text{Ker}\varphi\)存在\(\varphi\)-不变补空间,即存在\(\varphi\)-不变子空间\(U\),使得\(V=\text{Ker}\varphi\oplus U\)(实际上,$U = \text{Im}\varphi$);

(9) \(\text{Im}\varphi\)存在\(\varphi\)-不变补空间,即存在\(\varphi\)-不变子空间\(W\),使得\(V=\text{Im}\varphi\oplus W\)(实际上,$W = \text{Ker}\varphi$).
\end{proposition}
\begin{proof}
由直和的定义可知\((1)\Leftrightarrow(2)+(3)\),于是\((1)\Rightarrow(2)\)和\((1)\Rightarrow(3)\)都是显然的. 根据交空间维数公式和线性映射维数公式可知
\begin{align*}
\dim(\text{Ker}\varphi+\text{Im}\varphi)&=\dim\text{Ker}\varphi+\dim\text{Im}\varphi-\dim(\text{Ker}\varphi\cap\text{Im}\varphi)\\
&=\dim V-\dim(\text{Ker}\varphi\cap\text{Im}\varphi),
\end{align*}
于是\((2)\Leftrightarrow(3)\)成立,从而前3个结论两两等价.

\((3)\Rightarrow(4)\):显然\(\text{Ker}\varphi\subseteq\text{Ker}\varphi^2\)成立. 任取\(\boldsymbol{\alpha}\in\text{Ker}\varphi^2\),则\(\varphi(\boldsymbol{\alpha})\in\text{Ker}\varphi\cap\text{Im}\varphi = 0\),于是\(\varphi(\boldsymbol{\alpha}) = 0\),即\(\boldsymbol{\alpha}\in\text{Ker}\varphi\),从而\(\text{Ker}\varphi^2\subseteq\text{Ker}\varphi\)也成立,故\((4)\)成立.

\((4)\Rightarrow(3)\):任取\(\boldsymbol{\alpha}\in\text{Ker}\varphi\cap\text{Im}\varphi\),则存在\(\boldsymbol{\beta}\in V\),使得\(\boldsymbol{\alpha}=\varphi(\boldsymbol{\beta})\),于是\(0=\varphi(\boldsymbol{\alpha})=\varphi^2(\boldsymbol{\beta})\),即\(\boldsymbol{\beta}\in\text{Ker}\varphi^2=\text{Ker}\varphi\),从而\(\boldsymbol{\alpha}=\varphi(\boldsymbol{\beta}) = 0\),\((3)\)成立.

\((5)\Rightarrow(4)\)是显然的,下证\((4)\Rightarrow(5)\):设\(\text{Ker}\varphi^k=\text{Ker}\varphi^{k + 1}\)已对正整数\(k\)成立,先证\(\text{Ker}\varphi^{k + 1}=\text{Ker}\varphi^{k + 2}\)也成立,然后用归纳法即得结论. \(\text{Ker}\varphi^{k + 1}\subseteq\text{Ker}\varphi^{k + 2}\)是显然的. 任取\(\boldsymbol{\alpha}\in\text{Ker}\varphi^{k + 2}\),即\(0=\varphi^{k + 2}(\boldsymbol{\alpha})=\varphi^{k + 1}(\varphi(\boldsymbol{\alpha}))\),于是\(\varphi(\boldsymbol{\alpha})\in\text{Ker}\varphi^{k + 1}=\text{Ker}\varphi^k\),从而\(\varphi^{k + 1}(\boldsymbol{\alpha})=\varphi^k(\varphi(\boldsymbol{\alpha})) = 0\),即\(\boldsymbol{\alpha}\in\text{Ker}\varphi^{k + 1}\),于是\(\text{Ker}\varphi^{k + 2}\subseteq\text{Ker}\varphi^{k + 1}\)也成立.

\((3)\Leftrightarrow(6)\):考虑\(\varphi\)在不变子空间\(\text{Im}\varphi\)上的限制变换\(\varphi|_{\text{Im}\varphi}:\text{Im}\varphi\to\text{Im}\varphi\),由限制的定义可知它的核等于\(\text{Ker}\varphi\cap\text{Im}\varphi\),它的像等于\(\text{Im}\varphi^2\). 由于有限维线性空间上的线性变换是单射当且仅当它是满射,当且仅当它是同构,故\((3)\Leftrightarrow(6)\)成立.

\((7)\Rightarrow(6)\)是显然的,下证\((6)\Rightarrow(7)\):设\(\text{Im}\varphi^k=\text{Im}\varphi^{k + 1}\)已对正整数\(k\)成立,先证\(\text{Im}\varphi^{k + 1}=\text{Im}\varphi^{k + 2}\)也成立,然后用归纳法即得结论. \(\text{Im}\varphi^{k + 2}\subseteq\text{Im}\varphi^{k + 1}\)是显然的. 任取\(\boldsymbol{\alpha}\in\text{Im}\varphi^{k + 1}\),即存在\(\boldsymbol{\beta}\in V\),使得\(\boldsymbol{\alpha}=\varphi^{k + 1}(\boldsymbol{\beta})\). 由于\(\varphi^k(\boldsymbol{\beta})\in\text{Im}\varphi^k=\text{Im}\varphi^{k + 1}\),故存在\(\boldsymbol{\gamma}\in V\),使得\(\varphi^k(\boldsymbol{\beta})=\varphi^{k + 1}(\boldsymbol{\gamma})\),于是\(\boldsymbol{\alpha}=\varphi^{k + 1}(\boldsymbol{\beta})=\varphi(\varphi^k(\boldsymbol{\beta}))=\varphi(\varphi^{k + 1}(\boldsymbol{\gamma}))=\varphi^{k + 2}(\boldsymbol{\gamma})\in\text{Im}\varphi^{k + 2}\),从而\(\text{Im}\varphi^{k + 1}\subseteq\text{Im}\varphi^{k + 2}\)也成立.

(1) \(\Rightarrow\) (8) 是显然的,下证 (8) \(\Rightarrow\) (1).我们先证 \(\text{Im}\varphi\subseteq U\):任取 \(\varphi(\boldsymbol{v})\in\text{Im}\varphi\),由直和分解可设 \(\boldsymbol{v}=\boldsymbol{v}_1+\boldsymbol{u}\),其中 \(\boldsymbol{v}_1\in\text{Ker}\varphi\),\(\boldsymbol{u}\in U\),则由 \(U\) 的 \(\varphi -\)不变性可得 \(\varphi(\boldsymbol{v})=\varphi(\boldsymbol{v}_1)+\varphi(\boldsymbol{u})=\varphi(\boldsymbol{u})\in U\).考虑不等式
\[
\dim V=\dim(\text{Ker}\varphi\oplus U)=\dim\text{Ker}\varphi+\dim U\geqslant \dim\text{Ker}\varphi+\dim\text{Im}\varphi=\dim V,
\]
从而只能是 \(U = \text{Im}\varphi\),于是 (1) 成立.

(1) \(\Rightarrow\) (9) 是显然的,下证 (9) \(\Rightarrow\) (1).我们先证 \(W\subseteq\text{Ker}\varphi\):任取 \(\boldsymbol{w}\in W\),则由 \(W\) 的 \(\varphi -\)不变性可得 \(\varphi(\boldsymbol{w})\in\text{Im}\varphi\cap W = 0\),即有 \(\boldsymbol{w}\in\text{Ker}\varphi\).考虑不等式
\[
\dim V=\dim(\text{Im}\varphi\oplus W)=\dim\text{Im}\varphi+\dim W\leqslant \dim\text{Im}\varphi+\dim\text{Ker}\varphi=\dim V,
\]
从而只能是 \(W = \text{Ker}\varphi\),于是 (1) 成立.

\end{proof}

\begin{proposition}\label{proposition:由维数公式得到线性映射的存在性}
设\(U,W\)是\(n\)维线性空间\(V\)的子空间且\(\dim U+\dim W=\dim V\). 求证:存在\(V\)上的线性变换\(\varphi\),使得\(\text{Ker}\varphi = U\),\(\text{Im}\varphi = W\).
\end{proposition}
\begin{proof}
取\(U\)的一组基\(\boldsymbol{e}_1,\cdots,\boldsymbol{e}_m\),并将其扩张为\(V\)的一组基\(\boldsymbol{e}_1,\cdots,\boldsymbol{e}_m,\boldsymbol{e}_{m + 1},\cdots,\boldsymbol{e}_n\),再取\(W\)的一组基\(\boldsymbol{f}_{m + 1},\cdots,\boldsymbol{f}_n\). 定义\(\varphi\)为\(V\)上的线性变换,它在基上的作用为:\(\varphi(\boldsymbol{e}_i)=\boldsymbol{0}(1\leqslant  i\leqslant  m)\),\(\varphi(\boldsymbol{e}_j)=\boldsymbol{f}_j(m + 1\leqslant  j\leqslant  n)\). 注意到\(\boldsymbol{f}_{m + 1},\cdots,\boldsymbol{f}_n\)是\(W\)的一组基,故通过简单的验证可得\(\text{Ker}\varphi = U\),\(\text{Im}\varphi = W\). 

\end{proof}

\begin{example}
设\(V = M_n(\mathbb{F})\)是\(\mathbb{F}\)上\(n\)阶矩阵全体构成的线性空间,\(\varphi:V\to\mathbb{F}\)是迹函数,即对任意的\(\boldsymbol{A}=(a_{ij})\in V\),
\[
\varphi(\boldsymbol{A})=a_{11}+a_{22}+\cdots + a_{nn}.
\]
求证:\(\varphi\)是\(V\)到一维空间\(\mathbb{F}\)上的线性映射,并求\(\text{Ker}\varphi\)的维数及其一组基.
\end{example}
\begin{proof}
容易验证\(\varphi\)是线性映射且是映上的. 注意到\(V\)是
$n^2$维线性空间,由线性映射的维数公式可知
\[
\mathrm{dimKer}\varphi =\mathrm{dim}V-\mathrm{dim}\,\mathrm{Im}\varphi =\mathrm{dim}V-\mathrm{dim}\,\mathbb{F} =n^2-1.
\]
记\(\boldsymbol{E}_{ij}\)为\(n\)阶基础矩阵,即第\((i,j)\)元素为\(1\),其余元素为\(0\)的矩阵. 容易验证下列\(n^2 - 1\)个矩阵迹为零且线性无关,因此它们组成了\(\text{Ker}\varphi\)的一组基:
\[
\boldsymbol{E}_{ij}(i\neq j),\boldsymbol{E}_{11}-\boldsymbol{E}_{22},\boldsymbol{E}_{22}-\boldsymbol{E}_{33},\cdots,\boldsymbol{E}_{n - 1,n - 1}-\boldsymbol{E}_{nn}. 
\]

\end{proof}

\begin{example}
设\(\varphi\)是有限维线性空间\(V\)到\(U\)的线性映射,且\(V\)的维数大于\(U\)的维数,求证:\(\text{Ker}\varphi\neq 0\).
\end{example}
\begin{proof}
由线性映射的维数公式
\[
\dim V=\dim\text{Im}\varphi+\dim\text{Ker}\varphi,
\]
以及\(\dim\text{Im}\varphi\leqslant \dim U<\dim V\)可得\(\dim\text{Ker}\varphi>0\),即\(\text{Ker}\varphi\neq 0\).

\end{proof}

\begin{example}
设\(\varphi\)是有限维线性空间\(V\)到\(U\)的满线性映射,求证:必存在\(V\)的子空间\(W\),使得\(V = W\oplus\text{Ker}\varphi\),且\(\varphi\)在\(W\)上的限制是\(W\)到\(U\)上的线性同构.
\end{example}
\begin{proof}
{\color{blue}证法一:}取\(\text{Ker}\varphi\)的一组基\(\boldsymbol{e}_1,\cdots,\boldsymbol{e}_k\),并将其扩张为\(V\)的一组基\(\boldsymbol{e}_1,\cdots,\boldsymbol{e}_k,\boldsymbol{e}_{k + 1},\cdots,\boldsymbol{e}_n\). 令\(W = L(\boldsymbol{e}_{k + 1},\cdots,\boldsymbol{e}_n)\),则显然\(V = W\oplus\text{Ker}\varphi\). 由\hyperref[corollary:由核的基导出值域的基]{推论\ref{corollary:由核的基导出值域的基}}可知,\(\varphi(\boldsymbol{e}_{k + 1}),\cdots,\varphi(\boldsymbol{e}_n)\)是\(\text{Im}\varphi = U\)的一组基,故\(\varphi\)在\(W\)上的限制将\(W\)的一组基\(\boldsymbol{e}_{k + 1},\cdots,\boldsymbol{e}_n\)映射为\(U\)的一组基\(\varphi(\boldsymbol{e}_{k + 1}),\cdots,\varphi(\boldsymbol{e}_n)\),从而由\hyperref[proposition:线性变换是可逆变换的充要条件1]{命题\ref{proposition:线性变换是可逆变换的充要条件1}}可知$\varphi \mid_{W}$必为线性同构.

{\color{blue}证法二:} 取\(W\)为\(\text{Ker}\varphi\)在\(V\)中的补空间. 对任意的\(\boldsymbol{u}\in U\),由于\(\varphi\)是映上的,故存在\(\boldsymbol{v}=\boldsymbol{w}+\boldsymbol{v}_1\),其中\(\boldsymbol{w}\in W\),\(\boldsymbol{v}_1\in\text{Ker}\varphi\),使得\(\boldsymbol{u}=\varphi(\boldsymbol{v})=\varphi(\boldsymbol{w})\),于是\(\varphi\)在\(W\)上的限制也是映上的,故$\dim U=\dim \text{Im}\varphi|_W$.另一方面,由维数公式可知,\(\dim W=\dim V-\dim\text{Ker}\varphi=\mathrm{dim}\,\mathrm{Im}\varphi =\dim U\). 再对\(\varphi\)在\(W\)上的限制用\hyperref[theorem:值域和核空间维数之和等于原像空间维数]{线性映射维数公式}可知,$\mathrm{dim}\,\mathrm{Ker}\varphi |_W=\mathrm{dim}W-\mathrm{dim}\,\mathrm{Im}\varphi |_W=\mathrm{dim}U-\mathrm{dim}\,\mathrm{Im}\varphi |_W=0$.从而它必是单映射,于是\(\varphi\)在\(W\)上的限制是\(W\)到\(U\)上的线性同构. 

\end{proof}

\begin{example}
设\(\varphi\)是有限维线性空间\(V\)到\(V'\)的线性映射,\(U\)是\(V'\)的子空间且\(U\subseteq\text{Im}\varphi\),求证:\(\varphi^{-1}(U)=\{\boldsymbol{v}\in V|\varphi(\boldsymbol{v})\in U\}\)是\(V\)的子空间,且
\[
\dim U+\dim\text{Ker}\varphi=\dim\varphi^{-1}(U).
\]
\end{example}
\begin{note}
注意对线性映射做限制这个操作.
\end{note}
\begin{proof}
容易验证\(\varphi^{-1}(U)\)是\(\varphi\)的不变子空间. 将\(\varphi\)限制在\(\varphi^{-1}(U)\)上,它是到\(U\)上的线性映射. 因为\(\boldsymbol{0}\in U\),故\(\text{Ker}\varphi\subseteq\varphi^{-1}(U)\). 从而$\text{Ker}\varphi |_{\varphi ^{-1}\left( U \right)}=\mathrm{Ker}\varphi \cap \varphi ^{-1}\left( U \right) =\mathrm{Ker}\varphi $,又显然$\text{Im}\varphi |_{\varphi ^{-1}\left( U \right)}=U$.再对\(\varphi\)在\(\varphi^{-1}(U)\)上的限制用\hyperref[theorem:值域和核空间维数之和等于原像空间维数]{线性映射维数公式}即得
\[
\mathrm{dim}\varphi ^{-1}\left( U \right) =\mathrm{dim}\,\mathrm{Im}\varphi |_{\varphi ^{-1}\left( U \right)}+\mathrm{dim}\,\mathrm{Ker}\varphi |_{\varphi ^{-1}\left( U \right)}=\mathrm{dim}U+\mathrm{dimKer}\varphi .
\]

\end{proof}
\begin{remark}
\(\varphi^{-1}(U)=\{\boldsymbol{v}\in V|\varphi(\boldsymbol{v})\in U\}\)称为$U$在线性映射$\varphi$下的原像集.
\end{remark}

\begin{proposition}\label{proposition:线性变换关于子空间的维数不等式}
设\(U\)是有限维线性空间\(V\)的子空间,\(\varphi\)是\(V\)上的线性变换,求证:
\begin{enumerate}[(1)]
\item \(\dim U-\dim\text{Ker}\varphi\leqslant \dim\varphi(U)\leqslant \dim U\)；

\item \(\dim\varphi^{-1}(U)\leqslant \dim U+\dim\text{Ker}\varphi\).
\end{enumerate}
\end{proposition}
\begin{note}
线性变换可以在任意的一个子空间上作限制，但这样得到的只是一个线性映射，不一定是线性变换；如果限制在其不变子空间上，则得到的一定是线性变换。

例如，给定线性变换$T:V\rightarrow V$和子空间$W\subseteq V$，可以定义
\begin{align*}
T|_W:W\rightarrow V,\,T|_W\left( w \right) =T\left( w \right).
\end{align*}
此时$T|_W$是一个$W$到$V$的线性映射，但不一定是$W$到自身的线性变换。
\end{note}
\begin{proof}
\begin{enumerate}[(1)]
\item 注意到当\(\varphi\)限制在\(U\)上时,\(\text{Ker}(\varphi|_U)=U\cap\text{Ker}\varphi\),故由线性映射的维数公式可得
\[
\mathrm{dim}U=\mathrm{dim(}U\cap \mathrm{Ker}\varphi )+\mathrm{dim}\varphi (U)\leqslant \mathrm{dim}\,\mathrm{Ker}\varphi +\mathrm{dim}\varphi (U).
\]
于是
\[
\dim U - \dim\text{Ker}\varphi\leqslant \dim\varphi(U),
\]
而由\hyperref[theorem:值域和核空间维数之和等于原像空间维数]{线性映射维数公式},可知$\mathrm{dim}U=\mathrm{dim}\,\mathrm{Ker}\varphi |_U+\mathrm{dim}\varphi (U)$.进而\(\dim\varphi(U)\leqslant \dim U\).

\item 设\(\overline{\varphi}\)是线性变换\(\varphi\)在子空间\(\varphi^{-1}(U)\)上的限制,则\(\text{Im}\overline{\varphi}=U\cap\text{Im}\varphi\).因为\(\boldsymbol{0}\in U\),故\(\text{Ker}\varphi\subseteq\varphi^{-1}(U)\).从而\(\text{Ker}\overline{\varphi}=\text{Ker}\varphi\cap\varphi^{-1}(U)=\text{Ker}\varphi\). 由线性映射的维数公式可得
\[
\dim\varphi^{-1}(U)=\dim(U\cap\text{Im}\varphi)+\dim\text{Ker}\varphi.
\]
显然,由\(\dim(U\cap\text{Im}\varphi)\leqslant \dim U\)可推出
\[
\dim\varphi^{-1}(U)\leqslant \dim U+\dim\text{Ker}\varphi. 
\]
\end{enumerate}

\end{proof}

\begin{example}\label{example:4.243456}
证明:若\(\boldsymbol{A},\boldsymbol{B}\)是数域\(\mathbb{F}\)上两个\(n\)阶方阵,则
\[
\text{r}(\boldsymbol{A})+\text{r}(\boldsymbol{B})-n\leqslant \text{r}(\boldsymbol{A}\boldsymbol{B})\leqslant \min\{\text{r}(\boldsymbol{A}),\text{r}(\boldsymbol{B})\}.
\]
\end{example}
\begin{proof}
令\(V\)是\(\mathbb{F}\)上\(n\)维列向量空间,则将\(\boldsymbol{A}\)和\(\boldsymbol{B}\)看成是\(V\)上由矩阵\(\boldsymbol{A}\)和\(\boldsymbol{B}\)乘法诱导的线性变换. 又令\(U = \boldsymbol{B}(V)\),注意到\(\boldsymbol{A}(U)=\boldsymbol{A}\boldsymbol{B}(V)\),故\(\mathrm{dim}\boldsymbol{A}(U)=\mathrm{dim}\boldsymbol{AB}(V)=\mathrm{r(}\boldsymbol{AB})\),\(\dim\text{Ker}\boldsymbol{A}=n - \text{r}(\boldsymbol{A})\),即线性方程组\(\boldsymbol{A}\boldsymbol{x}=\boldsymbol{0}\)的解空间维数. 而\(\dim U=\dim\boldsymbol{B}(V)=\text{r}(\boldsymbol{B})\),由\hyperref[proposition:线性变换关于子空间的维数不等式]{命题\ref{proposition:线性变换关于子空间的维数不等式}(1)}的结论,可得
\[
\mathrm{r(}\boldsymbol{A})+\mathrm{r(}\boldsymbol{B})-n=\mathrm{dim}U-\mathrm{dim}\,\mathrm{Ker}\boldsymbol{A}\leqslant \mathrm{dim}\boldsymbol{A}\left( U \right) =\mathrm{r(}\boldsymbol{AB})\leqslant \mathrm{dim}U=\mathrm{r}\left( \boldsymbol{B} \right).
\]
又显然有\(\dim\boldsymbol{A}(U)\leqslant \dim\boldsymbol{A}(V)\),故得\(\text{r}(\boldsymbol{A}\boldsymbol{B})\leqslant \text{r}(\boldsymbol{A})\).

\end{proof}


\end{document}
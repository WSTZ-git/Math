\documentclass[../../main.tex]{subfiles}% 注意这里的文件路径不能用 ./main.tex ,否则用latexmk编译子文件会报错
\graphicspath{{\subfix{./image/}}} % 指定图片目录,后续可以直接使用图片文件名
% 注意这里的文件路径不能用 ../../image/ ,否则用latexmk编译子文件会报错

% 例如:
% \begin{figure}[H]
% \centering
% \includegraphics[scale=0.3]{图.png}
% \caption{}
% \label{figure:图}
% \end{figure}
% 注意:上述\label{}一定要放在\caption{}之后,否则引用图片序号会只会显示??.

\begin{document}

\section{内积的表示和正交基}

\begin{definition}[Gram矩阵和度量矩阵]\label{definition:Gram矩阵和度量矩阵}
设 \(\beta_1,\beta_2,\cdots,\beta_s\) 是内积空间的一个向量组，矩阵
\begin{align*}
G=\left( \begin{matrix}
\left( \beta _1,\beta _1 \right)&		\cdots&		\left( \beta _1,\beta _n \right)\\
\vdots&		\ddots&		\vdots\\
\left( \beta _n,\beta _1 \right)&		\cdots&		\left( \beta _n,\beta _n \right)\\
\end{matrix} \right) 
\end{align*}
称为向量组 \(\beta_1,\beta_2,\cdots,\beta_s\) 的 \textbf{Gram 矩阵}。
若 \(\beta_1,\beta_2,\cdots,\beta_s\) 是一组基，则将 Gram 矩阵称为该基的\textbf{度量矩阵}。 
\end{definition}

\begin{proposition}[Gram阵的性质]\label{proposition:欧氏空间中Gram阵的性质-例9.5}
\begin{enumerate}
\item 设 $v_1,v_2,\cdots,v_m$ 是欧氏空间 $V$ 中 $m$ 个向量，则向量 $v_1,v_2,\cdots,v_m$ 的 Gram 矩阵为
\[
G = G(v_1,v_2,\cdots,v_m)=\begin{pmatrix}
(v_1,v_1) & (v_1,v_2) & \cdots & (v_1,v_m)\\
(v_2,v_1) & (v_2,v_2) & \cdots & (v_2,v_m)\\
\vdots & \vdots & & \vdots\\
(v_m,v_1) & (v_m,v_2) & \cdots & (v_m,v_m)
\end{pmatrix}.
\]
求证：

(1) $G$ 是半正定实对称矩阵；

(2) 向量组 $v_1,v_2,\cdots,v_m$ 线性无关当且仅当 $G$ 是正定阵，也当且仅当 $G$ 是可逆矩阵。

(3)在欧氏空间V的标准内积下,有$G=A'A$,其中$A=(v_1,v_2,\cdots,v_n)$.

\item 设 $v_1,v_2,\cdots,v_m$ 是酉空间 $V$ 中 $m$ 个向量，则向量 $v_1,v_2,\cdots,v_m$ 的 Gram 矩阵为
\[
G = G(v_1,v_2,\cdots,v_m)=\begin{pmatrix}
(v_1,v_1) & (v_1,v_2) & \cdots & (v_1,v_m)\\
(v_2,v_1) & (v_2,v_2) & \cdots & (v_2,v_m)\\
\vdots & \vdots & & \vdots\\
(v_m,v_1) & (v_m,v_2) & \cdots & (v_m,v_m)
\end{pmatrix}.
\]
求证：

(1) $G$ 是半正定Hermite矩阵；

(2) 向量组 $v_1,v_2,\cdots,v_m$ 线性无关当且仅当 $G$ 是正定阵，也当且仅当 $G$ 是可逆矩阵。

(3)在酉空间V的标准内积下,有$G=A'\overline{A}$,其中$A=(v_1,v_2,\cdots,v_n)$.
\end{enumerate}
\end{proposition}
\begin{remark}
向量组 $v_1,v_2,\cdots,v_m$ 的 Gram 矩阵的几何意义是，这 $m$ 个向量张成的平行 $2m$ 面体的体积等于其 Gram 矩阵的行列式的算术平方根（证明可参考\refpro{proposition:例9.15}）:
\[
V(v_1,v_2,\cdots,v_m)=|G(v_1,v_2,\cdots,v_m)|^{\frac{1}{2}}.
\]
特别地，设 $V = \mathbb{R}^n$（取标准内积），$n$ 阶实矩阵 $A = (\alpha_1,\alpha_2,\cdots,\alpha_n)$ 为其列分块，则 $G(\alpha_1,\alpha_2,\cdots,\alpha_n)=A'A$，于是 $V(\alpha_1,\alpha_2,\cdots,\alpha_n)=|A'A|^{\frac{1}{2}}=\text{abs}(|A|)$。因此，$n$ 阶行列式的绝对值等于其 $n$ 个列向量张成的平行 $2n$ 面体的体积，这就是 $n$ 阶行列式的几何意义。 
\end{remark}
\begin{proof}
\begin{enumerate}
\item (1) 由欧氏空间内积的对称性可知 $G$ 是实对称矩阵。对任意的实列向量 $\alpha=(a_1,a_2,\cdots,a_m)'$，令 $v = a_1v_1 + a_2v_2 + \cdots + a_mv_m$，则有
\begin{align}\label{equation:::--2348957892}
\alpha'G\alpha&=\sum_{i,j = 1}^{m}a_ia_j(v_i,v_j)=(\sum_{i = 1}^{m}a_iv_i,\sum_{j = 1}^{m}a_jv_j)=(v,v)\geqslant 0,
\end{align}
因此 $G$ 是半正定阵。

(2) 注意到半正定阵 $G$ 是正定阵当且仅当 $G$ 是非异阵，故两个充要条件只要证明其中一个即可。我们用两种方法来证明它们。

{\color{blue}证法一:}先证必要性,若 $v_1,v_2,\cdots,v_m$ 线性无关，则对任意的非零实列向量 $\alpha=(a_1,a_2,\cdots,a_m)'$，$v = a_1v_1 + a_2v_2 + \cdots + a_mv_m\neq0$，从而由\eqref{equation:::--2348957892}式可知 $\alpha'G\alpha=(v,v)>0$，故 $G$ 是正定阵。

再证充分性,反证,若 $v_1,v_2,\cdots,v_m$ 线性相关，则存在非零实列向量 $\alpha=(a_1,a_2,\cdots,a_m)'$，使得 $v = a_1v_1 + a_2v_2 + \cdots + a_mv_m = 0$，从而由\eqref{equation:::--2348957892}式可知 $\alpha'G\alpha=(v,v)=0$，故 $G$ 不是正定阵,矛盾!

{\color{blue}证法二:}先证充分性,反证,假设 $v_1,v_2,\cdots,v_m$ 线性相关，则存在不全为零的数 $k_1,k_2,\cdots,k_m$，使得 $k_1v_1 + k_2v_2 + \cdots + k_mv_m = 0$。将 $k_i$ 乘以 $G$ 的第 $i$ 行后求和得到
\begin{align}
(k_1v_1 + k_2v_2 + \cdots + k_mv_m,v_j)=0,\quad 1\leqslant  j\leqslant  m,\label{eq:9.3}
\end{align}
即 $G$ 的 $m$ 个行向量线性相关，因此 $G$ 不是可逆矩阵。

再证必要性，反证,若 $G$ 不可逆，则 $G$ 的 $m$ 个行向量线性相关，即存在不全为零的数 $k_1,k_2,\cdots,k_m$，使得 \eqref{eq:9.3} 式成立。于是
\[
(k_1v_1 + k_2v_2 + \cdots + k_mv_m,k_1v_1 + k_2v_2 + \cdots + k_mv_m)=0,
\]
从而 $k_1v_1 + k_2v_2 + \cdots + k_mv_m = 0$，因此 $v_1,v_2,\cdots,v_m$ 线性相关。

(3)证明是显然的.

\item (1)由酉空间内积的对称性可知 $G$ 是Hermite矩阵。对任意的复列向量 $\alpha=(a_1,a_2,\cdots,a_m)'$，令 $v = a_1v_1 + a_2v_2 + \cdots + a_mv_m$，则有
\begin{align}\label{equation:::--234895789}
\alpha'G \overline{\alpha}&=\sum_{i,j = 1}^{m}a_i\overline{a_j}(v_i,v_j)=(\sum_{i = 1}^{m}a_iv_i,\sum_{j = 1}^{m}a_jv_j)=(v,v)\geqslant 0,
\end{align}
因此 $G$ 是半正定Hermite阵。

(2)注意到半正定Hermite阵 $G$ 是正定Hermite阵当且仅当 $G$ 是非异阵，故两个充要条件只要证明其中一个即可。我们用两种方法来证明它们。

{\color{blue}证法一:}先证必要性,若 $v_1,v_2,\cdots,v_m$ 线性无关，则对任意的非零复列向量 $\alpha=(a_1,a_2,\cdots,a_m)'$，$v = a_1v_1 + a_2v_2 + \cdots + a_mv_m\neq0$，从而由\eqref{equation:::--234895789}式可知 $\alpha'G\alpha=(v,v)>0$，故 $G$ 是正定Hermite阵。

再证充分性,反证,若 $v_1,v_2,\cdots,v_m$ 线性相关，则存在非零复列向量 $\alpha=(a_1,a_2,\cdots,a_m)'$，使得 $v = a_1v_1 + a_2v_2 + \cdots + a_mv_m = 0$，从而由\eqref{equation:::--234895789}式可知 $\alpha'G\alpha=(v,v)=0$，故 $G$ 不是正定Hermite阵,矛盾!

{\color{blue}证法二:}先证充分性,反证,假设 $v_1,v_2,\cdots,v_m$ 线性相关，则存在不全为零的数 $k_1,k_2,\cdots,k_m$，使得 $k_1v_1 + k_2v_2 + \cdots + k_mv_m = 0$。将 $k_i$ 乘以 $G$ 的第 $i$ 行后求和得到
\begin{align}
(k_1v_1 + k_2v_2 + \cdots + k_mv_m,v_j)=0,\quad 1\leqslant  j\leqslant  m,\label{eq:9.3121}
\end{align}
即 $G$ 的 $m$ 个行向量线性相关，因此 $G$ 不是可逆矩阵。

再证必要性，反证,若 $G$ 不可逆，则 $G$ 的 $m$ 个行向量线性相关，即存在不全为零的数 $k_1,k_2,\cdots,k_m$，使得 \eqref{eq:9.3121} 式成立。于是
\[
(k_1v_1 + k_2v_2 + \cdots + k_mv_m,k_1v_1 + k_2v_2 + \cdots + k_mv_m)=0,
\]
从而 $k_1v_1 + k_2v_2 + \cdots + k_mv_m = 0$，因此 $v_1,v_2,\cdots,v_m$ 线性相关。

(3)证明是显然的.
\end{enumerate}

\end{proof}

\begin{theorem}\label{theorem:度量矩阵的性质}
\begin{enumerate}
\item 若 \(V\) 是一个 \(n\) 维欧式空间，\(\alpha_1,\alpha_2,\cdots,\alpha_n\) 是它的一组基，对 \(V\) 中任意向量 \(\alpha,\beta\)，其中
\begin{align*}
\alpha&=x_1\alpha_1+\cdots + x_n\alpha_n,\\
\beta&=y_1\alpha_1+\cdots + y_n\alpha_n.
\end{align*}
则
\begin{align}
(\alpha,\beta)=X^TGY,\label{equation:---9.2.1}
\end{align}
其中
\begin{align*}
G=\left( \begin{matrix}
\left( \alpha _1,\alpha _1 \right)&		\cdots&		\left( \alpha _1,\alpha _n \right)\\
\vdots&		\ddots&		\vdots\\
\left( \alpha _n,\alpha _1 \right)&		\cdots&		\left( \alpha _n,\alpha _n \right)\\
\end{matrix} \right) ,X=\left( \begin{array}{c}
x_1\\
\vdots\\
x_n\\
\end{array} \right) ,Y=\left( \begin{array}{c}
y_1\\
\vdots\\
y_n\\
\end{array} \right) .
\end{align*}
此时，$G$就是基\(\alpha_1,\alpha_2,\cdots,\alpha_n\)的度量矩阵.并且$G$ 是一个$n$阶正定实对称阵.

由此可知,若给定了 $n$ 维实线性空间 $V$ 的一组基, 则 $V$ 上的内积结构和 $n$ 阶正定实对称阵之间存在着一个一一对应. 

\item 若 \(V\) 是一个 \(n\) 维酉空间，\(\alpha_1,\alpha_2,\cdots,\alpha_n\) 是它的一组基，对 \(V\) 中任意向量 \(\alpha,\beta\)，其中
\begin{align*}
\alpha&=x_1\alpha_1+\cdots + x_n\alpha_n,\\
\beta&=y_1\alpha_1+\cdots + y_n\alpha_n.
\end{align*}
则
\begin{align*}
(\alpha,\beta)=X^TH\overline{Y},
\end{align*}
其中
\begin{align*}
H=\left( \begin{matrix}
\left( \alpha _1,\alpha _1 \right)&		\cdots&		\left( \alpha _1,\alpha _n \right)\\
\vdots&		\ddots&		\vdots\\
\left( \alpha _n,\alpha _1 \right)&		\cdots&		\left( \alpha _n,\alpha _n \right)\\
\end{matrix} \right) ,X=\left( \begin{array}{c}
x_1\\
\vdots\\
x_n\\
\end{array} \right) ,Y=\left( \begin{array}{c}
y_1\\
\vdots\\
y_n\\
\end{array} \right) .
\end{align*}
此时，$H$就是基\(\alpha_1,\alpha_2,\cdots,\alpha_n\)的度量矩阵.并且$H$ 是一个$n$阶正定Hermite阵.

由此可知,若给定了 $n$ 维复线性空间 $V$ 的一组基, 则 $V$ 上的内积结构和 $n$ 阶正定Hermite阵之间存在着一个一一对应. 
\end{enumerate} 
\end{theorem}
\begin{proof}
\begin{enumerate}
\item 利用内积的线性性容易得到$(\alpha,\beta)=X^TGY$.
 
再来看矩阵 $G$. 因为 $(\alpha_i, \alpha_j) = (\alpha_j, \alpha_i)$, 所以 $G$ 是实对称阵. 又因为对任意的非零向量 $\alpha$, 总有 $(\alpha, \alpha) > 0$, 所以 $x'Gx > 0$ 对一切 $n$ 维非零实列向量 $x$ 成立. 这表明 $G$ 是一个正定阵. 

反之, 若给定 $n$ 阶正定实对称阵 $G$, 利用 \eqref{equation:---9.2.1}式也可以定义 $V$ 上的内积 (参考\hyperref[example:一些常见的内积及内积空间]{例题2.(1)}). 由此我们可以看出, 若给定了 $n$ 维实线性空间 $V$ 的一组基, 则 $V$ 上的内积结构和 $n$ 阶正定实对称阵之间存在着一个一一对应. 

\item 由1类似可证.
\end{enumerate}

\end{proof}

\begin{definition}
设 $\{e_1, e_2, \cdots, e_n\}$ 是 $n$ 维内积空间 $V$ 的一组基. 若 $e_i \perp e_j$ 对一切 $i \neq j$ 成立, 则称这组基是 $V$ 的一组\textbf{正交基}. 又若 $V$ 的一组正交基中每个基向量的长度都等于 $1$, 则称这组正交基为\textbf{标准正交基}.
\end{definition}
\begin{note}
显然在标准正交基下,度量矩阵就是单位矩阵.
\end{note}

\begin{lemma}\label{lemma:正交向量组必线性无关}
内积空间 $V$ 中的任意一组两两正交的非零向量必线性无关.
\end{lemma}
\begin{proof}
设 $v_1, v_2, \cdots, v_m$ 是 $V$ 中两两正交的非零向量，若
\begin{align*}
k_1v_1 + k_2v_2 + \cdots + k_mv_m = \mathbb{0},
\end{align*}
则对任一 $1 \leqslant  i \leqslant  m$，有
\begin{align*}
(k_1v_1 + k_2v_2 + \cdots + k_mv_m, v_i) = 0.
\end{align*}
由于 $v_i \perp v_j (i \neq j)$，故由上式可得 $k_i(v_i, v_i) = 0$，又 $v_i \neq \mathbb{0}$，从而 $k_i = 0$.

\end{proof}

\begin{lemma}\label{lemma:和基正交的向量一定和由基生成的空间正交}
设向量 $\alpha$ 和 $\beta_1, \beta_2, \cdots, \beta_k$ 都正交，则 $\alpha$ 和 $L(\beta_1, \beta_2, \cdots, \beta_k)$ 中的每个向量都正交.
\end{lemma}
\begin{proof}
任取 $\beta = b_1\beta_1 + b_2\beta_2 + \cdots + b_k\beta_k \in L(\beta_1, \beta_2, \cdots, \beta_k)$，则
\begin{align*}
(\beta, \alpha) = (b_1\beta_1 + b_2\beta_2 + \cdots + b_k\beta_k, \alpha) = \sum_{i = 1}^{k}b_i(\beta_i, \alpha) = 0,
\end{align*}
结论得证.

\end{proof}

\begin{corollary}
$n$ 维内积空间中任意一个正交非零向量组的向量个数不超过 $n$.
\end{corollary}
\begin{proof}
假设$n$维内积空间$V$中有$n+1$个正交非零的向量,则由\reflem{lemma:正交向量组必线性无关}可知,这$n+1$个正交非零的向量一定线性无关,这与$\dim V=n$矛盾!

\end{proof}

\begin{theorem}[Gram-Schmidt正交化]\label{theorem:Gram-Schmidt正交化方法}
设 $V$ 是内积空间，$u_1, u_2, \cdots, u_m$ 是 $V$ 中 $m$ 个线性无关的向量，则在 $V$ 中存在 $m$ 个两两正交的非零向量 $v_1, v_2, \cdots, v_m$，使由 $v_1, v_2, \cdots, v_m$ 张成的子空间恰好为由 $u_1, u_2, \cdots, u_m$ 张成的子空间，即 $v_1, v_2, \cdots, v_m$ 是该子空间的一组正交基.并且基$\{u_1,u_2,\cdots,u_n\}$到基$\{v_1,v_2,\cdots,v_n\}$的过渡矩阵为主对角元全为1的上三角矩阵,即存在主对角元全为1的上三角矩阵$B$,使得
\begin{align*}
(v_1,v_2,\cdots,v_n)=(u_1,u_2,\cdots,u_n)\boldsymbol{B}.
\end{align*}
\end{theorem}
\begin{note}
由下述证明可知:我们有
\begin{align*}
&v_1=u_1,
\\
&v_2=u_2-\frac{(u_2,v_1)}{(v_1,v_1)}v_1,
\\
&\cdots \cdots 
\\
&v_n=u_n-\frac{(u_n,v_1)}{(v_1,v_1)}v_1-\cdots -\frac{(u_n,v_{n-1})}{(v_{n-1},v_{n-1})}v_{n-1}.
\end{align*}
从而
\begin{align*}
\boldsymbol{B}^{-1}=\begin{pmatrix}
1&		\frac{( u_2,v_1 )}{( v_1,v_1 )}&		&		\frac{( u_n,v_1 )}{( v_1,v_1 )}\\
&		1&		&		\vdots\\
&		&		\ddots&		\frac{( u_n,v_{n-1} )}{( v_{n-1},v_{n-1} )}\\
&		&		&		1\\
\end{pmatrix},
\end{align*}
因此由\nrefpro{proposition:上三角阵性质}{(3)}可知$\boldsymbol{B}$就是主对角元全为$1$的上三角矩阵.
\end{note}
\begin{proof}
设 $v_1 = u_1$，其余 $v_i$ 可用数学归纳法定义如下：假设 $v_1, \cdots, v_k (k < m)$ 已定义好，这时 $v_1, \cdots, v_k$ 两两正交非零且 $L(v_1, \cdots, v_k) = L(u_1, \cdots, u_k)$. 令
\begin{align}
v_{k + 1} = u_{k + 1} - \sum_{j = 1}^{k}\frac{(u_{k + 1}, v_j)}{\|v_j\|^2}v_j. \label{equation----9.2.3}
\end{align}
由此可知,存在主对角元全为1的上三角矩阵$B$,使得
\begin{align*}
(v_1,v_2,\cdots,v_n)=(u_1,u_2,\cdots,u_n)\boldsymbol{B}.
\end{align*}
注意 $v_{k + 1} \neq \mathbb{0}$，否则 $u_{k + 1}$ 将是 $v_1, \cdots, v_k$ 的线性组合，从而也是 $u_1, \cdots, u_k$ 的线性组合，此与 $u_1, u_2, \cdots, u_m$ 线性无关矛盾. 又对任意的 $1 \leqslant  i \leqslant  k$，有
\begin{align*}
(v_{k + 1}, v_i) &= (u_{k + 1}, v_i) - \sum_{j = 1}^{k}\frac{(u_{k + 1}, v_j)}{\|v_j\|^2}(v_j, v_i) \\
&= (u_{k + 1}, v_i) - (u_{k + 1}, v_i) = 0,
\end{align*}
因此 $v_1, \cdots, v_k, v_{k + 1}$ 两两正交. 由\eqref{equation----9.2.3}式可知 
\begin{align*}
u_{k + 1} \in L(v_1, \cdots, v_k, v_{k + 1})\text{及} v_{k + 1} \in L(v_1, \cdots, v_k) + L(u_{k + 1}) = L(u_1, \cdots, u_k) + L(u_{k + 1}) = L(u_1, \cdots, u_k, u_{k + 1}),
\end{align*}
于是 $L(v_1, \cdots, v_k, v_{k + 1}) = L(u_1, \cdots, u_k, u_{k + 1})$，这就证明了结论.

\end{proof}
\begin{remark}
上述定理证明中的正交化过程通常称为 Gram - Schmidt (格列姆--施密特) 方法.
\end{remark}

\begin{corollary}\label{corollary:有限维内积空间必有标准正交基}
任一有限维内积空间均有标准正交基. 
\end{corollary}

\begin{definition}[正交和]
设 $V$ 是 $n$ 维内积空间，$V_1, V_2, \cdots, V_k$ 是 $V$ 的子空间. 如果对任意的 $\alpha \in V_i$ 和任意的 $\beta \in V_j$ 均有 $(\alpha, \beta) = 0$，则称子空间 $V_i$ 和 $V_j$ 正交. 若 $V = V_1 + V_2 + \cdots + V_k$ 且 $V_i$ 两两正交，则称 $V$ 是 $V_1, V_2, \cdots, V_k$ 的\text{正交和}，记为
\begin{align*}
V = V_1 \perp V_2 \perp \cdots \perp V_k.
\end{align*}
\end{definition}
\begin{remark}
由于\reflem{lemma:正交和必为直和}，正交和通常也称为\textbf{正交直和}.
\end{remark}

\begin{lemma}\label{lemma:正交和必为直和}
正交和必为直和且任一 $V_i$ 和其余子空间的和正交.
\end{lemma}
\begin{proof}
对任意的 $v_i \in V_i$ 和 $\sum_{j \neq i}v_j (v_j \in V_j)$，有
\begin{align*}
(v_i, \sum_{j \neq i}v_j) = \sum_{j \neq i}(v_i, v_j) = 0,
\end{align*}
因此后一个结论成立. 任取 $v \in V_i \cap (\sum_{j \neq i}V_j)$，则由上述论证可得 $(v, v) = 0$，故 $v = \mathbb{0}$，从而 $V_i \cap (\sum_{j \neq i}V_j) = 0$，即正交和必为直和.

\end{proof}

\begin{definition}[正交补空间]\label{definition:正交补空间}
设 $U$ 是内积空间 $V$ 的子空间，令
\begin{align*}
U^\perp = \{v \in V | (v, U) = 0\},
\end{align*}
这里 $(v, U) = 0$ 表示对一切 $u \in U$，均有 $(v, u) = 0$. 容易验证 $U^\perp$ 是 $V$ 的子空间，称为 $U$ 的\textbf{正交补空间}.
\end{definition}

\begin{theorem}
设 $V$ 是 $n$ 维内积空间，$U$ 是 $V$ 的子空间，则

(1) $V = U \oplus U^\perp=U\bot U^{\bot}$;

(2) $U$ 的任一组标准正交基均可扩张为 $V$ 的一组标准正交基.
\end{theorem}
\begin{proof}
(1) 若 $x \in U \cap U^\perp$，则 $(x, x) = 0$，因此 $x = \mathbb{0}$，即 $U \cap U^\perp = 0$. 另一方面，由\refcor{corollary:有限维内积空间必有标准正交基}可知，存在 $U$ 的一组标准正交基 $\{e_1, e_2, \cdots, e_m\}$. 对任意的 $v \in V$，令
\begin{align*}
u = (v, e_1)e_1 + (v, e_2)e_2 + \cdots + (v, e_m)e_m,
\end{align*}
则 $u \in U$. 又令 $w = v - u$，则对任一 $e_i (i = 1, 2, \cdots, m)$，有
\begin{align*}
(w, e_i) = (v, e_i) - (u, e_i) = (v, e_i) - (v, e_i) = 0.
\end{align*}
因此 $w \in U^\perp$，又 $v = u + w$，这就证明了 $V = U \oplus U^\perp$.

(2) 设 $\{e_1, e_2, \cdots, e_m\}$ 是 $U$ 的任一组标准正交基，$\{e_{m + 1}$, $\cdots$, $e_n\}$ 是 $U^\perp$ 的任一组标准正交基，则显然 $\{e_1$, $e_2$, $\cdots$, $e_n\}$ 是 $V$ 的一组标准正交基. 

\end{proof}

\begin{proposition}\label{proposition:一些常见的正交补空间}
设$V$是$n$维内积空间,$A$为$V$上的线性变换,则
\begin{enumerate}
\item $\mathrm{Ker}A^T=\left( \mathrm{Im}A \right) ^{\bot} ,\quad\mathrm{Ker}A=\left( \mathrm{Im}A^T \right) ^{\bot}.$

\end{enumerate}
\end{proposition}
\begin{proof}
\begin{enumerate}
\item 对$\forall \alpha \in \mathrm{Ker}A^T$，都有$A^T\alpha =0$，从而$\alpha ^TA=0$，于是对$\forall A\beta \in \mathrm{Im}A$，都有
$\left( \alpha ,A\beta \right) =\alpha ^TA\beta =0.$
故$\mathrm{Ker}A^T\subseteq \left( \mathrm{Im}A \right) ^{\bot}$.又由维数公式可知
$\mathrm{dimKer}A^T=n-r\left( A \right) =\mathrm{dim}\left( \mathrm{Im}A \right) ^{\bot}.$
因此$\mathrm{Ker}A^T=\left( \mathrm{Im}A \right) ^{\bot}.$

\end{enumerate}

\end{proof}

\begin{example}
已知$A$为实方阵, 证明: 若存在实方阵$P$, 使得$A^{\mathrm{T}} = AP$, 则存在正交方阵$Q$, 使\begin{align*}Q^{-1}AQ = \begin{pmatrix} B & O \\ O & O \end{pmatrix}\end{align*}其中$B$为可逆方阵.
\end{example}
\begin{proof}
对$\forall \alpha \in \mathrm{Ker}A$，都有$A\alpha =0$。从而$\alpha ^TA^T=0$。于是由条件可得
$\alpha ^TA^T=\alpha ^TAP=0\Longrightarrow P^TA^T\alpha =0$。
故$\mathrm{Ker}A\subseteq \mathrm{Ker}A^T$。又因为$\mathrm{r}(A) =\mathrm{r}(A^T)$，所以$\mathrm{dimKer}A=\mathrm{dimKer}A^T$。故$\mathrm{Ker}A=\mathrm{Ker}A^T$。由\refpro{proposition:一些常见的正交补空间}可知$\mathrm{Ker}A^T=\left( \mathrm{Im}A \right) ^{\bot}$，因此
\begin{align}\label{eq:4423423r23r233534f34t3t34t23rewfj80rj893uf34t5321.1}
V=\mathrm{Im}A\bot \left( \mathrm{Im}A \right) ^{\bot}=\mathrm{Im}A\bot \mathrm{Ker}A^T=\mathrm{Im}A\bot \mathrm{Ker}A
\end{align}
故可取$\mathrm{Im}A$的一组正交基$\{ e_1,\cdots ,e_k \}$和$\mathrm{Ker}A$的一组正交基$\{ e_{k+1},\cdots ,e_n \}$，从而
$\{ e_1,\cdots ,e_k,e_{k+1},\cdots ,e_n \}$就是$V$的一组正交基。记$Q=\left( e_1,\cdots ,e_k,e_{k+1},\cdots ,e_n \right) ^T$，则
\begin{align*}
Q^{-1}AQ=\begin{pmatrix}
B&		O\\
O&		O
\end{pmatrix}
\end{align*}
其中$B$为$A|_{\mathrm{Im}A}$的表示矩阵。由\eqref{eq:4423423r23r233534f34t3t34t23rewfj80rj893uf34t5321.1}式知
$\mathrm{Ker}A|_{\mathrm{Im}A}=\mathrm{Ker}A\cap \mathrm{Im}A=\{ 0 \}$。
故$A|_{\mathrm{Im}A}$是单射，从而$A|_{\mathrm{Im}A}$是可逆变换，即$B$是可逆矩阵。

\end{proof}

\begin{definition}[正交投影]
设 $V = V_1 \perp V_2 \perp \cdots \perp V_k$，定义 $V$ 上的线性变换 $E_i (i = 1, 2, \cdots, k)$ 如下：若 $v = v_1 + \cdots + v_i + \cdots + v_k (v_i \in V_i)$，令 $E_i(v) = v_i$. 容易验证 $E_i$ 是 $V$ 上的线性变换，且满足
\begin{align*}
E_i^2 = E_i, \ E_iE_j = 0\ (i \neq j), \ E_1 + E_2 + \cdots + E_k = I_V.
\end{align*}
线性变换 $E_i$ 称为 $V$ 到 $V_i$ 上的\textbf{正交投影}（简称投影）.
\end{definition}

\begin{proposition}\label{proposition:正交投影的性质}
设 $U$ 是内积空间 $V$ 的子空间，$V = U \perp U^\perp$. 设 $E$ 是 $V$ 到 $U$ 上的正交投影，则对任意的 $\alpha, \beta \in V$，有
\begin{align*}
(E(\alpha), \beta) = (\alpha, E(\beta)).
\end{align*}
\end{proposition}
\begin{proof}
设 $\alpha = u_1 + w_1$，$\beta = u_2 + w_2$，其中 $u_1, u_2 \in U$，$w_1, w_2 \in U^\perp$，则 $E(\alpha) = u_1$，$E(\beta) = u_2$，于是
\begin{align*}
(E(\alpha), \beta) &= (u_1, u_2 + w_2) = (u_1, u_2) + (u_1, w_2) = (u_1, u_2), \\
(\alpha, E(\beta)) &= (u_1 + w_1, u_2) = (u_1, u_2) + (w_1, u_2) = (u_1, u_2).
\end{align*}
由此即得结论.

\end{proof}

\begin{proposition}[Bessel (贝塞尔) 不等式]\label{proposition:Bessel不等式}
设 $v_1, v_2, \cdots, v_m$ 是内积空间 $V$ 中的正交非零向量组，$y$ 是 $V$ 中任一向量，则
\begin{align*}
\sum_{k = 1}^{m}\frac{|(y, v_k)|^2}{\|v_k\|^2} \leqslant  \|y\|^2,
\end{align*}
且等号成立的充分必要条件是 $y$ 属于由 $\{v_1, v_2, \cdots, v_m\}$ 张成的子空间.
\end{proposition}
\begin{remark}
Bessel (贝塞尔) 不等式是“斜边大于直角边”这一几何命题在内积空间中的推广.
\end{remark}
\begin{proof}
令
\begin{align*}
x = \sum_{k = 1}^{m}\frac{(y, v_k)}{\|v_k\|^2}v_k,
\end{align*}
则 $x$ 属于由 $\{v_1, v_2, \cdots, v_m\}$ 张成的子空间. 容易验证
\begin{align*}
(y - x, v_k) = 0, \ k = 1, 2, \cdots, m,
\end{align*}
因此 $(y - x, x) = 0$. 由\hyperref[corollary:范数性质的相关推广-勾股定理]{勾股定理}可得
\begin{align*}
\|y\|^2 = \|y - x\|^2 + \|x\|^2,
\end{align*}
故
\begin{align*}
\|x\|^2 \leqslant  \|y\|^2.
\end{align*}
又由 $v_1, v_2, \cdots, v_m$ 两两正交不难算出
\begin{align*}
\|x\|^2 = \sum_{k = 1}^{m}\frac{|(y, v_k)|^2}{\|v_k\|^2}.
\end{align*}
若 $y$ 属于由 $\{v_1, v_2, \cdots, v_m\}$ 张成的子空间，则 $y = x$，故等号成立. 反之，若等号成立，则 $\|y - x\|^2 = 0$，故 $y = x$，即 $y$ 属于由 $\{v_1, v_2, \cdots, v_m\}$ 张成的子空间. 

\end{proof}








\end{document}
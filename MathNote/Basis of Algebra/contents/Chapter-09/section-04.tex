\documentclass[../../main.tex]{subfiles}
\graphicspath{{\subfix{../../image/}}} % 指定图片目录,后续可以直接使用图片文件名。

% 例如:
% \begin{figure}[H]
% \centering
% \includegraphics{image-01.01}
% \caption{图片标题}
% \label{figure:image-01.01}
% \end{figure}
% 注意:上述\label{}一定要放在\caption{}之后,否则引用图片序号会只会显示??.

\begin{document}

\section{内积空间的同构、正交变换和酉变换}

\begin{definition}[保积同构]
设 $V$ 与 $U$ 是域 $\mathbb{K}$ 上的内积空间，$\mathbb{K}$ 是实数域或复数域，$\varphi$ 是 $V \to U$ 的线性映射. 若对任意的 $x,y \in V$，有
\begin{align*}
(\varphi(x),\varphi(y)) = (x,y),
\end{align*}
则称 $\varphi$ 是 $V \to U$ 的保持内积的线性映射. 又若 $\varphi$ 作为线性映射是同构，则称 $\varphi$ 是内积空间 $V$ 到 $U$ 上的\textbf{保积同构}.
\end{definition}
\begin{remark}
\begin{enumerate}
\item 在不引起误解的情况下，我们常把内积空间的保积同构就称为同构.

\item 保持内积的线性映射一定是单映射，这是因为 任取$x\in \mathrm{Ker}\varphi $,$\|\varphi(x)\| = \|x\|$，从 $\|\varphi(x)\| = 0$ 得到 $\|x\| = 0$，故 $x = 0$.因此$\mathrm{Ker}\varphi =\left\{ 0 \right\} .$

\item 容易证明保持内积的同构关系是一个等价关系.
\end{enumerate}
\end{remark}

\begin{theorem}\label{theorem:保范线性映射一定保持内积}
若 $\varphi$ 是内积空间 $V$ 到内积空间 $U$ 的保持范数的线性映射，则 $\varphi$ 保持内积.
\end{theorem}
\begin{remark}
显然线性映射保持内积一定保持范数,再结合上述定理可知,保持内积与保持范数的等价性，因此保持内积的同构也称为\textbf{保范同构}或\textbf{保距同构}. 
\end{remark}
\begin{proof}
向量的范数可以用内积表示，反过来内积也可以用范数来表示. 设 $x,y$ 是 $V$ 中的任意两个向量，则
\begin{align*}
\|x + y\|^2&=(x + y,x + y)=(x,x)+(y,y)+(x,y)+(y,x),\\
\|x - y\|^2&=(x - y,x - y)=(x,x)+(y,y)-(x,y)-(y,x),
\end{align*}
故
\begin{align}
\|x + y\|^2 - \|x - y\|^2 = 2(x,y) + 2\overline{(x,y)}.\label{equation::---9.4.1}
\end{align}
另一方面，
\begin{align*}
\|x + \mathrm{i}y\|^2&=(x + \mathrm{i}y,x + \mathrm{i}y)=(x,x)+(y,y)+\mathrm{i}(y,x)-\mathrm{i}(x,y),\\
\|x - \mathrm{i}y\|^2&=(x - \mathrm{i}y,x - \mathrm{i}y)=(x,x)+(y,y)-\mathrm{i}(y,x)+\mathrm{i}(x,y),
\end{align*}
故
\begin{align}
\|x + \mathrm{i}y\|^2 - \|x - \mathrm{i}y\|^2 = -2\mathrm{i}(x,y) + 2\mathrm{i}\overline{(x,y)}.\label{equation::---9.4.2}
\end{align}
由\eqref{equation::---9.4.1}式和\eqref{equation::---9.4.2}式得
\begin{align*}
(x,y) = \frac{1}{4}\|x + y\|^2 - \frac{1}{4}\|x - y\|^2 + \frac{\mathrm{i}}{4}\|x + \mathrm{i}y\|^2 - \frac{\mathrm{i}}{4}\|x - \mathrm{i}y\|^2,
\end{align*}
由此即可得到结论.
\end{proof}
\begin{remark}
我们仅对复空间进行了讨论，事实上对实空间，可得下列等式:
\begin{align*}
(x,y) = \frac{1}{4}\|x + y\|^2 - \frac{1}{4}\|x - y\|^2,
\end{align*}
因此对实空间结论也成立. 
\end{remark}

\begin{theorem}\label{theorem:保积同构的等价命题}
设 $V$ 与 $U$ 都是 $n$ 维内积空间 (同为实空间或同为复空间)，若 $\varphi$ 是 $V \to U$ 的线性映射，则下列命题等价:
\begin{enumerate}[(1)]
\item $\varphi$ 保持内积；

\item  $\varphi$ 是保积同构；

\item  $\varphi$ 将 $V$ 的任一组标准正交基变成 $U$ 的一组标准正交基；

\item $\varphi$ 将 $V$ 的某一组标准正交基变成 $U$ 的一组标准正交基.
\end{enumerate}
\end{theorem}
\begin{proof}
$(1) \Rightarrow (2)$：$\varphi$ 保持内积，因此 $\varphi$ 为单映射. 由线性映射的维数公式可得
\[
\dim \text{Im}\,\varphi = \dim V = \dim U = n,
\]
因此 $\text{Im}\,\varphi = U$，即 $\varphi$ 是映上的，故为同构.

$(2) \Rightarrow (3)$：设 $\{e_1,e_2,\cdots,e_n\}$ 是 $V$ 的任意一组标准正交基. 由于 $\varphi$ 保持内积，故对 $i \neq j$，有
\[
(\varphi(e_i),\varphi(e_j)) = (e_i,e_j) = 0,
\]
又
\[
(\varphi(e_i),\varphi(e_i)) = (e_i,e_i) = 1.
\]
这表明 $\{\varphi(e_1),\varphi(e_2),\cdots,\varphi(e_n)\}$ 是 $U$ 的标准正交基.

$(3) \Rightarrow (4)$：显然.

$(4) \Rightarrow (1)$：设 $\{e_1,e_2,\cdots,e_n\}$ 是 $V$ 的标准正交基且 $\{\varphi(e_1),\varphi(e_2),\cdots,\varphi(e_n)\}$ 是 $U$ 的标准正交基. 假设
\[
u = \sum_{i = 1}^{n}a_ie_i,\quad v = \sum_{i = 1}^{n}b_ie_i,
\]
则
\begin{align*}
\varphi (u)=\sum_{i=1}^n{a_i\varphi (e_i),\varphi (v)=\sum_{i=1}^n{b_i\varphi (e_i),}}
\end{align*}
于是
\begin{align*}
(\varphi (u),\varphi (v))=\left( \sum_{i=1}^n{a_i\varphi (e_i),\sum_{i=1}^n{b_i\varphi (e_i)}} \right) =a_1\overline{b_1}+a_2\overline{b_2}+\cdots +a_n\overline{b_n}=(u,v).
\end{align*}
\end{proof}

\begin{corollary}\label{corollary:有限维内积空间同构的充要条件}
两个有限维内积空间 $V$ 与 $U$ (同为实空间或同为复空间) 同构的充分必要条件是它们有相同的维数.
\end{corollary}
\begin{proof}
只需证明充分性. 设 $\{e_1,e_2,\cdots,e_n\}$ 是 $V$ 的标准正交基，$\{f_1,f_2,\cdots,f_n\}$ 是 $U$ 的标准正交基，令 $\varphi$ 是 $V \to U$ 的线性映射:
\[
\varphi(e_i) = f_i,\quad i = 1,2,\cdots,n,
\]
则 $\varphi$ 将标准正交基变为标准正交基，由\refthe{theorem:保积同构的等价命题}可知 $\varphi$ 是保积同构.
\end{proof}

\begin{definition}
设 $\varphi$ 是内积空间 $V$ 上保持内积的线性变换，则
\begin{enumerate}
\item 若 $V$ 是欧氏空间，则称 $\varphi$ 为\textbf{正交变换}或\textbf{正交算子}；

\item 若 $V$ 是酉空间，则称 $\varphi$ 为\textbf{酉变换}或\textbf{酉算子}.
\end{enumerate}
\end{definition}

\begin{theorem}\label{theorem:正交变换和酉变换的基本性质}
\begin{enumerate}
\item 正交变换及酉变换都是可逆线性变换.

\item 设 $\varphi$ 是内积空间 $V$ 上的线性变换，若$\varphi$在$V$上保持范数,则$\varphi$一定是$V$上的正交变换(酉变换).

\item (1)正交变换等价于把欧氏空间中一组标准正交基变成标准正交基的线性变换.

(2)酉变换等价于把酉空间中一组标准正交基变成标准正交基的线性变换.
\end{enumerate}
\end{theorem}
\begin{proof}
由\refthe{theorem:保范线性映射一定保持内积}和\refthe{theorem:保积同构的等价命题}可直接得到证明.
\end{proof}

\begin{theorem}\label{theorem:正交变换或酉变换g关于伴随算子的充要条件}
设 $\varphi$ 是欧氏空间或酉空间上的线性变换，则 $\varphi$ 是正交变换或酉变换的充分必要条件是 $\varphi$ 非异，且
\begin{align*}
\varphi^* = \varphi^{-1}.
\end{align*}
\end{theorem}
\begin{proof}
设 $\varphi$ 是欧氏空间 $V$ 上的正交变换，则对 $V$ 中的任意向量 $\alpha,\beta$，有
\begin{align*}
(\varphi(\alpha),\beta) = (\varphi(\alpha),\varphi(\varphi^{-1}(\beta))) = (\alpha,\varphi^{-1}(\beta)),
\end{align*}
此即 $\varphi^* = \varphi^{-1}$.

反过来，若 $\varphi^* = \varphi^{-1}$，则
\begin{align*}
(\varphi(\alpha),\varphi(\beta)) = (\alpha,\varphi^*\varphi(\beta)) = (\alpha,\beta),
\end{align*}
即 $\varphi$ 保持内积，故 $\varphi$ 是正交变换.

对酉变换可类似证明.
\end{proof}

\begin{definition}[正交矩阵和酉矩阵]
设 $A$ 是 $n$ 阶非异实方阵，若 $A' = A^{-1}$，则称 $A$ 是\textbf{正交矩阵}. 

设 $C$ 是 $n$ 阶非异复方阵，若 $\overline{C}' = C^{-1}$，则称 $C$ 是\textbf{酉矩阵}.
\end{definition}

\begin{theorem}
正交矩阵适合条件 $AA' = A'A = I_n$;

酉矩阵适合条件 $A\overline{A}' = \overline{A}'A = I_n$.
\end{theorem}
\begin{proof}
由正交矩阵与酉矩阵的定义立得.
\end{proof}

\begin{theorem}\label{theorem:正交矩阵的基本性质1}
设 $A = (a_{ij})$ 是 $n$ 阶实矩阵，则 $A$ 是正交矩阵的充分必要条件是:
\begin{align*}
a_{i1}a_{j1} + a_{i2}a_{j2} + \cdots + a_{in}a_{jn} &= 0,\quad i \neq j,\\
a_{i1}^2 + a_{i2}^2 + \cdots + a_{in}^2 &= 1,
\end{align*}
或
\begin{align*}
a_{1i}a_{1j} + a_{2i}a_{2j} + \cdots + a_{ni}a_{nj} &= 0,\quad i \neq j,\\
a_{1i}^2 + a_{2i}^2 + \cdots + a_{ni}^2 &= 1.
\end{align*}
也就是说，$A$ 为正交矩阵的充分必要条件是它的 $n$ 个行向量是 $n$ 维实 行向量空间 (取标准内积) 的标准正交基，或它的 $n$ 个列向量是 $n$ 维实 列向量空间 (取标准内积) 的标准正交基.
\end{theorem}
\begin{proof}
由 $AA' = I_n$ 得到第一个结论，由 $A'A = I_n$ 得到第二个结论.
\end{proof}

\begin{theorem}\label{theorem:酉矩阵的基本性质1}
设 $A = (a_{ij})$ 是 $n$ 阶复矩阵，则 $A$ 是酉矩阵的充分必要条件是:
\begin{align*}
a_{i1}\overline{a}_{j1} + a_{i2}\overline{a}_{j2} + \cdots + a_{in}\overline{a}_{jn} &= 0,\quad i \neq j,\\
|a_{i1}|^2 + |a_{i2}|^2 + \cdots + |a_{in}|^2 &= 1,
\end{align*}
或
\begin{align*}
a_{1i}\overline{a}_{1j} + a_{2i}\overline{a}_{2j} + \cdots + a_{ni}\overline{a}_{nj} &= 0,\quad i \neq j,\\
|a_{1i}|^2 + |a_{2i}|^2 + \cdots + |a_{ni}|^2 &= 1.
\end{align*}
也就是说，$A$ 为酉矩阵的充分必要条件是它的 $n$ 个行向量是 $n$ 维复 行向量空间 (取标准内积) 的标准正交基，或它的 $n$ 个列向量是 $n$ 维复 列向量空间 (取标准内积) 的标准正交基.
\end{theorem}
\begin{proof}
类似\refthe{theorem:正交矩阵的基本性质1}的证明.
\end{proof}

\begin{theorem}\label{theorem:正交矩阵的行列式和特征值}
若 $n$ 阶实矩阵 $A$ 是正交矩阵，则
\begin{enumerate}[(1)]
\item $A$ 的行列式值等于 $1$ 或 $-1$；

\item $A$ 的特征值的模长等于 $1$.
\end{enumerate}
\end{theorem}
\begin{proof}
\begin{enumerate}[(1)]
\item 由 $AA' = I_n$，取行列式即得结论.

\item 设 $\lambda$ 是 $A$ 的特征值，$x$ 是属于 $\lambda$ 的特征向量，则 $Ax = \lambda x$，于是 $\overline{x}'A' = \overline{\lambda}\overline{x}'$. 因此
\[
\overline{x}'A'Ax = \overline{\lambda}\overline{x}'\lambda x,
\]
即
\[
\overline{x}'x = \overline{\lambda}\lambda(\overline{x}'x),
\]
从而 $\overline{\lambda}\lambda = 1$，即 $|\lambda| = 1$. 
\end{enumerate}
\end{proof}

\begin{theorem}\label{theorem:酉矩阵的行列式和特征值}
若 $n$ 阶复矩阵 $A$ 是酉矩阵，则
\begin{enumerate}
\item $A$ 的行列式值的模长等于 $1$；

\item $A$ 的特征值的模长等于 $1$.
\end{enumerate}
\end{theorem}
\begin{proof}
类似\refthe{theorem:正交矩阵的行列式和特征值}的证明.
\end{proof}

\begin{proposition}\label{proposition:常见的正交矩阵和酉矩阵}
\begin{enumerate}[(1)]
\item 单位阵是正交矩阵也是酉矩阵；

\item 对角阵是正交矩阵的充分必要条件是主对角线上的元素为 $1$ 或 $-1$. 
\end{enumerate}
\end{proposition}
\begin{proof}
证明是显然的.
\end{proof}

\begin{theorem}\label{theorem:正交变换和酉变换关于表示矩阵的充要条件}
设 $\varphi$ 是欧氏空间 (酉空间) $V$ 上的线性变换,则$\varphi$ 是正交变换 (酉变换)的充分必要条件是在 $V$ 的任一组标准正交基下，$\varphi$ 的表示矩阵是正交矩阵 (酉矩阵).
\end{theorem}
\begin{proof}
必要性:由\refthe{theorem:正交变换或酉变换g关于伴随算子的充要条件}，当 $\varphi$ 是正交变换时，若 $\varphi$ 在 $V$ 的一组标准正交基下的表示矩阵为 $A$，则 $\varphi^*$ 在同一组基下的表示矩阵为 $A'$，由 $\varphi^* = \varphi^{-1}$ 得 $A' = A^{-1}$，即 $A$ 是正交矩阵. 同理，当 $\varphi$ 是酉变换时，$\varphi$ 在一组标准正交基下的表示矩阵 $A$ 应适合 $\overline{A}' = A^{-1}$，即 $A$ 是酉矩阵.

充分性:这由线性变换与其表示矩阵的关系即得.
\end{proof}

\begin{theorem}[矩阵的QR分解]\label{theorem:矩阵的QR分解}
设 $A$ 是 $n$ 阶实 (复) 矩阵，则 $A$ 可分解为
\begin{align*}
A = QR,
\end{align*}
其中 $Q$ 是正交 (酉) 矩阵，$R$ 是一个主对角线上的元素均大于等于零的上三角阵，并且若 $A$ 是非异阵，则这样的分解必唯一.特别地,若上述矩阵$R$的第$(i,i)$对角元为零,则$R$的第$i$行.
\end{theorem}
\begin{proof}
{\color{blue}证法一:}
设 $A$ 是 $n$ 阶实矩阵，$A = (u_1,u_2,\cdots,u_n)$ 是 $A$ 的列分块. 考虑 $n$ 维实列向量空间 $\mathbb{R}^n$，并取其标准内积，我们先通过类似于 Gram - Schmidt 方法的正交化过程，把 $\{u_1,u_2,\cdots,u_n\}$ 变成一组两两正交的向量 $\{w_1,w_2,\cdots,w_n\}$，并且 $w_k$ 或者是零向量或者是单位向量.

我们用数学归纳法来定义上述向量. 假设 $w_1,\cdots,w_{k - 1}$ 已经定义好，现来定义 $w_k$. 令
\begin{align*}
v_k = u_k - \sum_{j = 1}^{k - 1}(u_k,w_j)w_j.
\end{align*}
若 $v_k = 0$，则令 $w_k = 0$；若 $v_k \neq 0$，则令 $w_k = \frac{v_k}{\|v_k\|}$. 容易验证 $\{w_1,w_2,\cdots,w_n\}$ 是一组两两正交的向量，$w_k$ 或者是零向量或者是单位向量，并且满足
\begin{align}
u_k = \sum_{j = 1}^{k - 1}(u_k,w_j)w_j + \|v_k\|w_k,\quad k = 1,2,\cdots,n.\label{equation---::9.4.5}
\end{align}
由\eqref{equation---::9.4.5}式可得
\begin{align}
A = (u_1,u_2,\cdots,u_n) = (w_1,w_2,\cdots,w_n)R,\label{equation---::9.4.6}
\end{align}
其中 $R$ 是一个上三角阵且主对角线上的元素依次为 $\|v_1\|,\|v_2\|,\cdots,\|v_n\|$，均大于等于零，并且由\eqref{equation---::9.4.6}式知，如果 $w_k = 0$，则 $R$ 的第 $k$ 行元素全为零.此即,若上述矩阵$R$的第$(i,i)$对角元为零,则$R$的第$i$行.

假设 $w_{i_1},w_{i_2},\cdots,w_{i_r}$ 是其中的非零向量全体，由\refthe{theorem:正交变换或酉变换g关于伴随算子的充要条件}可将它们扩张为 $\mathbb{R}^n$ 的一组标准正交基 $\{\widetilde{w}_1$,$\widetilde{w}_2$,$\cdots$,$\widetilde{w}_n\}$，其中 $\widetilde{w}_j = w_j$,$j = i_1,i_2,\cdots,i_r$. 令 $Q = (\widetilde{w}_1,\widetilde{w}_2,\cdots,\widetilde{w}_n)$，由\refthe{theorem:正交矩阵的基本性质1}知 $Q$ 是正交矩阵. 注意到若 $w_k = 0$，则 $R$ 的第 $k$ 行元素全为零，此时用 $\widetilde{w}_k$ 代替 $w_k$ 仍然可使\eqref{equation---::9.4.6}式成立，因此
\begin{align*}
A = (u_1,u_2,\cdots,u_n) = (\widetilde{w}_1,\widetilde{w}_2,\cdots,\widetilde{w}_n)R = QR,
\end{align*}
从而得到了 $A$ 的 $QR$ 分解.

复矩阵情形的证明完全类似.
至于非异阵 $QR$ 分解的唯一性，利用摄动法不难证明.

{\color{blue}证法二:}对阶数 \(n\) 进行归纳. 当 \(n = 1\) 时结论显然成立. 假设对 \(n - 1\) 阶矩阵结论成立，现证 \(n\) 阶矩阵的情形. 设 \(A = (\alpha_1,\alpha_2,\cdots,\alpha_n)\) 为其列分块，\(\beta = (\|\alpha_1\|,0,\cdots,0)'\) 为 \(n\) 维列向量，则 \(\|\alpha_1\| = \|\beta\|\)，故由\refpro{proposition:例9.42}可知，存在 \(n\) 阶单位矩阵或镜像矩阵 \(M\)，使得 \(M\alpha_1 = \beta\)。于是
\begin{align*}
MA &= (M\alpha_1,M\alpha_2,\cdots,M\alpha_n) = 
\begin{pmatrix}
\|\alpha_1\| & * \\
O & A_1
\end{pmatrix}
\end{align*}
其中 \(A_1\) 是 \(n - 1\) 阶实矩阵. 由归纳假设，存在 \(n - 1\) 阶正交矩阵 \(Q_1\) 和主对角元全大于等于零的上三角矩阵 \(R_1\)，使得 \(A_1 = Q_1R_1\)。容易验证单位矩阵或镜像矩阵 \(M\) 适合 \(M^{-1} = M' = M\)，因此
\begin{align*}
A &= M\begin{pmatrix}
\|\alpha_1\| & * \\
O & Q_1R_1
\end{pmatrix} = M\begin{pmatrix}
1 & O \\
O & Q_1
\end{pmatrix}\begin{pmatrix}
\|\alpha_1\| & * \\
O & R_1
\end{pmatrix}
\end{align*}
令
\begin{align*}
Q &= M\begin{pmatrix}
1 & O \\
O & Q_1
\end{pmatrix},\quad R = \begin{pmatrix}
\|\alpha_1\| & * \\
O & R_1
\end{pmatrix}
\end{align*}
显然 \(A = QR\) 满足要求. 当 \(A\) 是可逆矩阵时，\(QR\) 分解的唯一性同证法一.
\end{proof}

\begin{example}
求下列矩阵的 $QR$ 分解:
\[
A = \begin{pmatrix}
1 & 2 & 5 \\
1 & 0 & 1 \\
0 & 1 & 2
\end{pmatrix}.
\]
\end{example}
\begin{solution}
采用与\refthe{theorem:矩阵的QR分解}证明中相同的记号，经过计算可得:
\begin{align*}
v_1&=u_1=(1,1,0)' ,w_1=\frac{1}{\sqrt{2}}(1,1,0)' ;
\\
v_2&=u_2-\sqrt{2}w_1=(1,-1,1)' ,w_2=\frac{1}{\sqrt{3}}(1,-1,1)' ;
\\
v_3&=u_3-3\sqrt{2}w_1-2\sqrt{3}w_2=(0,0,0)' ,w_3=(0,0,0)',
\end{align*}
从而有
\[
A = (u_1,u_2,u_3) = (w_1,w_2,w_3)\begin{pmatrix}
\sqrt{2} & \sqrt{2} & 3\sqrt{2} \\
0 & \sqrt{3} & 2\sqrt{3} \\
0 & 0 & 0
\end{pmatrix}.
\]
用 $\widetilde{w}_3 = \frac{1}{\sqrt{6}}(-1,1,2)'$ 代替 $w_3$ 可得 $A$ 的 $QR$ 分解为
\[
Q = \begin{pmatrix}
\frac{1}{\sqrt{2}} & \frac{1}{\sqrt{3}} & -\frac{1}{\sqrt{6}} \\
\frac{1}{\sqrt{2}} & -\frac{1}{\sqrt{3}} & \frac{1}{\sqrt{6}} \\
0 & \frac{1}{\sqrt{3}} & \frac{2}{\sqrt{6}}
\end{pmatrix}, \quad
R = \begin{pmatrix}
\sqrt{2} & \sqrt{2} & 3\sqrt{2} \\
0 & \sqrt{3} & 2\sqrt{3} \\
0 & 0 & 0
\end{pmatrix}.
\] 
\end{solution}








\end{document}
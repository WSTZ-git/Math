% contents/chapter-02/section-04.tex 第二章第三节
\documentclass[../../main.tex]{subfiles}
\graphicspath{{\subfix{../../image/}}} % 指定图片目录,后续可以直接使用图片文件名。

% 例如:
% \begin{figure}[H]
% \centering
% \includegraphics[scale=0.3]{image-01.01}
% \caption{图片标题}
% \label{figure:image-01.01}
% \end{figure}
% 注意:上述\label{}一定要放在\caption{}之后,否则引用图片序号会只会显示??.

\begin{document}

\section{矩阵的迹}

\begin{proposition}[矩阵迹的性质]\label{proposition:矩阵矩阵迹的性质}
设\(A,B\)是\(n\)阶矩阵,则有:
\begin{enumerate}
\item (线性)\(\mathrm{tr}(A + B)=\mathrm{tr}(A)+\mathrm{tr}(B)\),\(\mathrm{tr}(kA)=k\mathrm{tr}(A)\);
\item (对称性)\(\mathrm{tr}(A')=\mathrm{tr}(A)\);
\item (交换性)\(\mathrm{tr}(AB)=\mathrm{tr}(BA)\).
\end{enumerate}
\end{proposition}
\begin{proof}
根据矩阵迹的定义及矩阵乘法的定义容易验证.
\end{proof}

\begin{proposition}[矩阵迹的刻画]\label{proposition:矩阵迹的刻画}
设\(f\)是数域\(\mathbb{F}\)上\(n\)阶矩阵集合到\(\mathbb{F}\)的一个映射,它满足下列条件:

(1) 对任意的\(n\)阶矩阵\(A,B\),\(f(A + B)=f(A)+f(B)\);

(2) 对任意的\(n\)阶矩阵\(A\)和\(\mathbb{F}\)中的数\(k\),\(f(kA)=kf(A)\);

(3) 对任意的\(n\)阶矩阵\(A,B\),\(f(AB)=f(BA)\);

(4) \(f(I_n)=n\).

求证:\(f\)就是迹,即\(f(A)=\mathrm{tr}(A)\)对一切\(\mathbb{F}\)上\(n\)阶矩阵\(A\)成立.
\end{proposition}
\begin{note}
这个命题给出了迹的刻画,它告诉我们迹函数由线性、交换性和正规性(即单位矩阵处的取值为其阶数)唯一决定.
\end{note}
\begin{proof}
设\(E_{ij}\)是\(n\)阶基础矩阵.由(1)和(4),有
\[
n = f(I_n)=f(E_{11}+E_{22}+\cdots+E_{nn})=f(E_{11})+f(E_{22})+\cdots+f(E_{nn}).
\]
又由(3),有
\[
f(E_{ii})=f(E_{ij}E_{ji})=f(E_{ji}E_{ij})=f(E_{jj}),
\]
所以\(f(E_{ii}) = 1(1\leq i\leq n)\).另一方面,若\(i\neq j\),则
\[
f(E_{ij})=f(E_{i1}E_{1j})=f(E_{1j}E_{i1})=f(O)=f(0\cdot I_n)=0\cdot f(I_n)=0.
\]
设\(n\)阶矩阵\(A=(a_{ij})\),则
\[
f(A)=f\left(\sum_{i,j = 1}^{n}a_{ij}E_{ij}\right)=\sum_{i,j = 1}^{n}a_{ij}f(E_{ij})=\sum_{i = 1}^{n}a_{ii}=\mathrm{tr}(A).
\]
\end{proof}

\begin{example}
求证:不存在\(n\)阶矩阵\(A,B\),使得\(AB - BA = kI_n(k\neq0)\).
\end{example}
\begin{proof}
用反证法证明. 若存在\(n\)阶矩阵\(A,B\)满足条件\(AB - BA = kI_n(k\neq0)\),则
\[
kn=\mathrm{tr}(kI_n)=\mathrm{tr}(AB - BA)=\mathrm{tr}(AB)-\mathrm{tr}(BA)=0
\]
矛盾.
\end{proof}

\begin{proposition}
设\(A\)是\(n\)阶矩阵,\(P\)是同阶可逆阵,求证:\(\mathrm{tr}(P^{-1}AP)=\mathrm{tr}(A)\),即相似矩阵具有相同的迹.
\end{proposition}
\begin{proof}
因为\(\mathrm{tr}(AB)=\mathrm{tr}(BA)\),故\(\mathrm{tr}(P^{-1}AP)=\mathrm{tr}(APP^{-1})=\mathrm{tr}(A)\).
\end{proof}

\begin{example}
设\(A_1,A_2,\cdots,A_k\)是实对称阵且\(A_1^2 + A_2^2+\cdots+A_k^2 = O\),证明:每个\(A_i = O\).
\end{example}
\begin{proof}
对题设中的等式两边同时取迹,可得
\[
0=\mathrm{tr}(O)=\mathrm{tr}(A_1^2 + A_2^2+\cdots+A_k^2)=\mathrm{tr}(A_1A_1')+\mathrm{tr}(A_2A_2')+\cdots+\mathrm{tr}(A_kA_k').
\]
又由于\(\mathrm{tr}(A_iA_i')\geq0\),从而只可能是\(\mathrm{tr}(A_iA_i') = 0(1\leq i\leq k)\),再次由\hyperref[proposition:零矩阵的充要条件]{零矩阵的充要条件}可得\(A_i = O(1\leq i\leq k)\).
\end{proof}

\begin{proposition}\label{proposition:反称/反酉矩阵为零矩阵的充要条件}
\begin{enumerate}
\item 设\(n\)阶实矩阵\(A\)适合\(A'=-A\),如果存在同阶实矩阵\(B\),使得\(AB = B\),则\(B = O\);
\item 设\(n\)阶复矩阵\(A\)适合\(\overline{A}'=-A\),如果存在同阶复矩阵\(B\),使得\(AB = B\),则\(B = O\).
\end{enumerate}
\end{proposition}
\begin{proof}
\begin{enumerate}
\item 在等式\(AB = B\)两边同时左乘\(B'\)可得
\[
B'AB = B'B.
\]
上式两边同时转置并注意到\(A'=-A\),可得
\[
B'B=(B'B)'=(B'AB)'=B'A'B=-B'AB=-B'B,
\]
从而有\(B'B = O\).两边同时取迹,由\hyperref[proposition:零矩阵的充要条件]{零矩阵的充要条件}可得\(B = O\).
\item 证明与1类似.
\end{enumerate}
\end{proof}

\begin{proposition}\label{proposition:矩阵迹的不等式}
设\(A\)为\(n\)阶实矩阵,求证:\(\mathrm{tr}(A^2)\leq\mathrm{tr}(AA')\),等号成立当且仅当\(A\)是对称阵.
\end{proposition}
\begin{proof}
若已知$\mathrm{tr}(AA') \geq \mathrm{tr}(A^2)$,则由迹的线性、对称性、交换性和正定性可得
\begin{align*}
&\mathrm{tr}((A - A')(A - A')')\\
=&\mathrm{tr}((A - A')(A' - A))=\mathrm{tr}(AA' - A^2 - (A')^2 + A'A)\\
=&2\mathrm{tr}(AA') - 2\mathrm{tr}(A^2)\geq0,
\end{align*}
故要证的不等式成立.若上述不等式的等号成立,则由迹的正定性可知\(A - A' = O\),即\(A\)为对称阵.
若已知$A$为对称阵,则$\mathrm{tr}(AA') = \mathrm{tr}(A^2)$显然成立.
\end{proof}

\begin{proposition}\label{proposition:矩阵可交换关于迹的充分条件}
设\(A,B\)是两个\(n\)阶矩阵,使得\(\mathrm{tr}(ABC)=\mathrm{tr}(CBA)\)对任意\(n\)阶矩阵\(C\)成立,求证:\(AB = BA\).
\end{proposition}
\begin{proof}
设\(AB=(d_{ij}),BA=(e_{ij})\),令\(C = E_{kl}(1\leq k,l\leq n)\),则
\[
\mathrm{tr}(ABC)=d_{lk},\mathrm{tr}(CBA)=e_{lk},
\]
因此\(d_{lk}=e_{lk}(1\leq k,l\leq n)\),即有\(AB = BA\).
\end{proof}
\begin{remark}
注 若\(A,B\)是实(复)矩阵,我们还可以通过迹的正定性来证明结论.事实上,由迹的交换性和线性可得\(\mathrm{tr}((AB - BA)C)=0\),令\(C\)为\(AB - BA\)的转置(共轭转置),再由\hyperref[proposition:零矩阵的充要条件]{零矩阵的充要条件}即得结论.
\end{remark}

\begin{example}
若\(n\)阶实方阵\(A\)满足\(AA' = I_n\),则称为正交矩阵. 证明:不存在\(n\)阶正交矩阵\(A,B\)满足\(A^2 = cAB + B^2\),其中\(c\)是非零常数.
\end{example}
\begin{proof}
用反证法,设存在\(n\)阶正交阵\(A,B\),使得\(A^2 = cAB + B^2(c\neq0)\). 在等式两边同时左乘\(A'\),右乘\(B'\),可得\(AB' = cI_n + A'B\),从而\(cI_n = A'B - AB'\). 两边同时取迹,可得\(0\ne nc=\text{tr}(cI_n)=\text{tr}(A'B)-\text{tr}(AB')=\text{tr}((A'B)') - \text{tr}(AB')=\text{tr}(B'A)-\text{tr}(AB') = 0\),矛盾.
\end{proof}

\begin{example}
设\(A,B\)为\(n\)阶实对称阵,证明:\(\text{tr}((AB)^2)\leq\text{tr}(A^2B^2)\),并求等号成立的充要条件.
\end{example}
\begin{proof}
{\color{blue}证法一:}
由\hyperref[proposition:矩阵迹的不等式]{命题\ref{proposition:矩阵迹的不等式}},再结合$A,B$的对称性可得
\begin{align*}
\mathrm{tr}\left( \left( AB \right) ^2 \right) \leqslant \mathrm{tr}\left( \left( AB \right) \left( AB \right) \prime \right) =\mathrm{tr}\left( ABBA \right) =\mathrm{tr}\left( A^2B^2 \right) .
\end{align*}
等号成立当且仅当$AB$也为实对称矩阵,即\(AB = B'A'=BA\).

{\color{blue}证法二:}证法 2 设\(P\)为正交矩阵，使得\(P'AP = \mathrm{diag}\{\lambda_1,\lambda_2,\cdots,\lambda_n\}\). 注意到问题的条件和结论在同时正交相似变换\(A\mapsto P'AP\)，\(B\mapsto P'BP\)下不改变，故不妨从一开始就假设\(A\)为正交相似标准型\(\mathrm{diag}\{\lambda_1,\lambda_2,\cdots,\lambda_n\}\). 设\(B=(b_{ij})\)，则经计算可知
\begin{align*}
&\mathrm{tr}(A^2B^2)-\mathrm{tr}((AB)^2)=\sum_{i,j = 1}^{n}\lambda_i^2b_{ij}^2-\sum_{i,j = 1}^{n}\lambda_i\lambda_jb_{ij}^2\\
=&\sum_{1\leq i<j\leq n}(\lambda_i^2+\lambda_j^2 - 2\lambda_i\lambda_j)b_{ij}^2=\sum_{1\leq i<j\leq n}(\lambda_i - \lambda_j)^2b_{ij}^2\geq0,
\end{align*}
且等号成立当且仅当\(\lambda_ib_{ij}=\lambda_jb_{ij}(1\leq i<j\leq n)\)，这也当且仅当\(\lambda_ib_{ij}=\lambda_jb_{ij}(1\leq i,j\leq n)\)，即当且仅当\(AB = BA\)成立. 
\end{proof}



\end{document}
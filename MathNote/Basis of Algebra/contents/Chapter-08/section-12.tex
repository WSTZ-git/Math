\documentclass[../../main.tex]{subfiles}
\graphicspath{{\subfix{../../image/}}} % 指定图片目录,后续可以直接使用图片文件名。

% 例如:
% \begin{figure}[H]
% \centering
% \includegraphics[scale=0.3]{image-01.01}
% \caption{图片标题}
% \label{figure:image-01.01}
% \end{figure}
% 注意:上述\label{}一定要放在\caption{}之后,否则引用图片序号会只会显示??.

\begin{document}

\section{半正定型与半正定阵}

\begin{proposition}\label{proposition:半正定阵的判定准则123}
设 \(\boldsymbol{A}\) 是 \(n\) 阶实对称矩阵，则 \(\boldsymbol{A}\) 是半正定阵的充要条件是以下条件之一：
\begin{enumerate}[(1)]
\item \(\boldsymbol{A}\) 合同于 \(\begin{pmatrix}\boldsymbol{I}_r&\boldsymbol{O}\\\boldsymbol{O}&\boldsymbol{O}\end{pmatrix}\);

\item 存在$n$阶实矩阵 \(\boldsymbol{C}\)，使得 \(\boldsymbol{A}=\boldsymbol{C}'\boldsymbol{C}\);

\item \(\boldsymbol{A}\) 的所有主子式全大于等于零;

\item \(\boldsymbol{A}\) 的所有特征值全大于等于零。
\end{enumerate}
\end{proposition}
\begin{proof}
\begin{enumerate}[(1)]
\item 参考\refthe{theorem:正定矩阵的充要条件}.

\item 参考\hyperref[proposition:正定和半正定阵的判定准则]{命题\ref{proposition:正定和半正定阵的判定准则}(2)}.

\item 参考\refpro{proposition:半正定阵关于顺序主子式的性质}.

\item 参考\refcor{corollary:二次型式(半)正定型(负定型)的充要条件}.
\end{enumerate}
\end{proof}

\begin{proposition}\label{proposition:半正定阵的相关性质}
设 \(\boldsymbol{A},\boldsymbol{B}\) 都是 \(n\) 阶半正定实对称矩阵, \(c\) 是非负实数, 求证:
\begin{enumerate}[(1)]
\item \(\boldsymbol{A}^*,\boldsymbol{A}+\boldsymbol{B},c\boldsymbol{A}\) 都是半正定阵;
\item 若 \(\boldsymbol{D}\) 是实矩阵, 则 \(\boldsymbol{D}'\boldsymbol{A}\boldsymbol{D}\) 也是半正定阵.
\end{enumerate}
\end{proposition}
\begin{proof}
\begin{enumerate}[(1)]
\item 因为 \(\boldsymbol{A}\) 半正定, 故存在实矩阵 \(\boldsymbol{C}\), 使得 \(\boldsymbol{A}=\boldsymbol{C}'\boldsymbol{C}\), 于是 \(\boldsymbol{A}^*=\boldsymbol{C}^*(\boldsymbol{C}')^*=\boldsymbol{C}^*(\boldsymbol{C}^*)'\) 是半正定阵. 对任一非零实列向量 \(\boldsymbol{\alpha}\), 有
\[\boldsymbol{\alpha}'(\boldsymbol{A}+\boldsymbol{B})\boldsymbol{\alpha}=\boldsymbol{\alpha}'\boldsymbol{A}\boldsymbol{\alpha}+\boldsymbol{\alpha}'\boldsymbol{B}\boldsymbol{\alpha}\geq0,\quad\boldsymbol{\alpha}'(c\boldsymbol{A})\boldsymbol{\alpha}=c\boldsymbol{\alpha}'\boldsymbol{A}\boldsymbol{\alpha}\geq0\]
因此 \(\boldsymbol{A}+\boldsymbol{B},c\boldsymbol{A}\) 都是半正定阵.
\item 采用 (1) 的记号, 则 \(\boldsymbol{D}'\boldsymbol{A}\boldsymbol{D}=\boldsymbol{D}'\boldsymbol{C}'\boldsymbol{C}\boldsymbol{D}=(\boldsymbol{C}\boldsymbol{D})'(\boldsymbol{C}\boldsymbol{D})\) 也是半正定阵.
\end{enumerate} 
\end{proof}

\begin{proposition}\label{proposition:半正定阵的行满秩分解}
设 $A$ 为 $n$ 阶实对称矩阵，求证：$A$ 是秩为 $r$ 的半正定阵的充要条件是存在秩等于 $r$ 的 $r\times n$ 实矩阵 $B$，使得 $A = B'B$。 
\end{proposition}
\begin{proof}
若 $A = B'B$，则由\refpro{proposition:r(AA')=r(A)}可得 $\mathrm{r}(A)=\mathrm{r}(B'B)=\mathrm{r}(B)=r$，且对任意的 $n$ 维实列向量 $\alpha$，$\alpha'A\alpha=\alpha'B'B\alpha=(B\alpha)'(B\alpha)\geq0$，因此 $A$ 是秩为 $r$ 的半正定阵。反之，若 $A$ 是秩为 $r$ 的半正定阵，则存在可逆矩阵 $C$，使得 $A = C'\mathrm{diag}\{1,\cdots,1,0,\cdots,0\}C$，其中有 $r$ 个 $1$。令 $B=(I_r\ O)C$，则 $B$ 是秩等于 $r$ 的 $r\times n$ 矩阵，且 $A = B'B$。 
\end{proof}

\subsection{性质1(极限性质)半正定阵是正定阵的极限}

\begin{proposition}\label{proposition:半正定阵关于摄动的充要条件}
\(n\) 阶实对称矩阵 \(\boldsymbol{A}\) 是半正定阵的充要条件是对任意的正实数 \(t\), \(\boldsymbol{A}+t\boldsymbol{I}_n\) 都是正定阵.
\end{proposition}
\begin{remark}
这个\refpro{proposition:半正定阵关于摄动的充要条件}告诉我们: \textbf{半正定阵是一列正定阵的极限}, 称之为\textbf{半正定阵的极限性质}. 因此我们可以利用极限性质和摄动法将半正定阵的问题转化成正定阵的问题来研究.
\end{remark}
\begin{proof}
先证必要性. 对任一非零实列向量 \(\boldsymbol{\alpha}\), 有
\[\boldsymbol{\alpha}'(\boldsymbol{A}+t\boldsymbol{I}_n)\boldsymbol{\alpha}=\boldsymbol{\alpha}'\boldsymbol{A}\boldsymbol{\alpha}+t\boldsymbol{\alpha}'\boldsymbol{\alpha}\]
因为 \(\boldsymbol{A}\) 半正定, 故 \(\boldsymbol{\alpha}'\boldsymbol{A}\boldsymbol{\alpha}\geq0\). 又 \(t>0\) 且 \(\boldsymbol{\alpha}'\boldsymbol{\alpha}>0\), 从而 \(\boldsymbol{\alpha}'(\boldsymbol{A}+t\boldsymbol{I}_n)\boldsymbol{\alpha}>0\), 因此 \(\boldsymbol{A}+t\boldsymbol{I}_n\) 是正定阵.

再证充分性. 由假设对任一非零实列向量 \(\boldsymbol{\alpha}\) 和正实数 \(t\), 有
\[\boldsymbol{\alpha}'(\boldsymbol{A}+t\boldsymbol{I}_n)\boldsymbol{\alpha}=\boldsymbol{\alpha}'\boldsymbol{A}\boldsymbol{\alpha}+t\boldsymbol{\alpha}'\boldsymbol{\alpha}>0\]
令 \(t\to0^+\), 上式两边同取极限可得 \(\boldsymbol{\alpha}'\boldsymbol{A}\boldsymbol{\alpha}\geq0\), 即 \(\boldsymbol{A}\) 是半正定阵. 
\end{proof}

\begin{proposition}\label{proposition:半正定阵关于顺序主子式的性质}
\(n\) 阶实对称矩阵 \(\boldsymbol{A}\) 是半正定阵的充要条件是 \(\boldsymbol{A}\) 的所有主子式全大于等于零.特别地,半正定实对称矩阵$\boldsymbol{A}$的主对角元素都大于等于零.
\end{proposition}
\begin{remark}
我们不能用顺序主子式的非负性来推出半正定性, 这一点和正定阵不同. 例如, 矩阵 \(\boldsymbol{A}=\text{diag}\{1,0,-1\}\) 的顺序主子式都非负, 但 \(\boldsymbol{A}\) 却不是半正定阵. 
\end{remark}
\begin{proof}
必要性由\hyperref[proposition:正定阵的性质]{命题\ref{proposition:正定阵的性质}(1)} 和\hyperref[proposition:正定和半正定阵的判定准则]{命题\ref{proposition:正定和半正定阵的判定准则}(2)}即得, 下证充分性. 由\refpro{proposition:直接计算两个矩阵和的行列式}可得
\[|\boldsymbol{A}+t\boldsymbol{I}_n|=t^n + c_1t^{n - 1}+\cdots + c_{n - 1}t + c_n\]
其中 \(c_i\) 是 \(\boldsymbol{A}\) 的所有 \(i\) 阶主子式之和. 由假设可知 \(c_i\geq0(1\leq i\leq n)\), 故对任意的正实数 \(t\), 我们总有 \(|\boldsymbol{A}+t\boldsymbol{I}_n|>0\). 设 \(\boldsymbol{A}_k(1\leq k\leq n)\) 是 \(\boldsymbol{A}\) 的 \(n\) 个顺序主子阵, 则 \(\boldsymbol{A}_k\) 的主子式也是 \(\boldsymbol{A}\) 的主子式, 从而 \(\boldsymbol{A}_k\) 的所有主子式全大于等于零, 根据上面的讨论同理 可知, 对任意的正实数 \(t\), 我们总有 \(|\boldsymbol{A}_k + t\boldsymbol{I}_k|>0\). 注意到 \(|\boldsymbol{A}_k + t\boldsymbol{I}_k|(1\leq k\leq n)\) 是 \(\boldsymbol{A}+t\boldsymbol{I}_n\) 的 \(n\) 个顺序主子式, 故由上面的讨论可知, 对任意的正实数 \(t\), \(\boldsymbol{A}+t\boldsymbol{I}_n\) 都是正定阵, 再由\refpro{proposition:半正定阵关于摄动的充要条件} 即得 \(\boldsymbol{A}\) 为半正定阵. 
\end{proof}

\begin{proposition}\label{proposition:半正定阵的Hadamard乘积性质}
设 \(\boldsymbol{A}=(a_{ij}),\boldsymbol{B}=(b_{ij})\) 都是 \(n\) 阶半正定实对称矩阵, 求证: \(\boldsymbol{A},\boldsymbol{B}\) 的 Hadamard 乘积 \(\boldsymbol{H}=\boldsymbol{A}\circ\boldsymbol{B}=(a_{ij}b_{ij})\) 也是半正定阵.
\end{proposition}
\begin{proof}
{\color{blue}证法一:}设 \(\boldsymbol{B}=\boldsymbol{C}'\boldsymbol{C}\), 其中 \(\boldsymbol{C}\) 为实矩阵, 剩余的证明与\refpro{proposition:正定实对称阵的Hadamard积也正定}完全类似.

{\color{blue}证法二:} 由于对任意的正实数 \(t\), \(\boldsymbol{A}+t\boldsymbol{I}_n,\boldsymbol{B}+t\boldsymbol{I}_n\) 都是正定阵, 故由\refpro{proposition:正定实对称阵的Hadamard积也正定}可知 \((\boldsymbol{A}+t\boldsymbol{I}_n)\circ(\boldsymbol{B}+t\boldsymbol{I}_n)\) 为正定阵. 令 \(t\to0^+\), 即得 \(\boldsymbol{A}\circ\boldsymbol{B}\) 为半正定阵.
\end{proof}

\begin{proposition}\label{proposition:半正定阵的行列式的相关的不等式}
设 \(\boldsymbol{A}\) 是 \(n\) 阶半正定实对称矩阵, \(\boldsymbol{S}\) 是 \(n\) 阶实反对称矩阵, 求证:
\[|\boldsymbol{A}+\boldsymbol{S}|\geq|\boldsymbol{A}|+|\boldsymbol{S}|\geq|\boldsymbol{A}|\geq0\]
\end{proposition}
\begin{proof}
对任意的正实数 \(t\), \(\boldsymbol{A}+t\boldsymbol{I}_n\) 为正定阵, 故由\refpro{proposition:A+S的行列式的相关结论}可得
\begin{align*}
|\boldsymbol{A}+t\boldsymbol{I}_n+\boldsymbol{S}|\geq|\boldsymbol{A}+t\boldsymbol{I}_n|+|\boldsymbol{S}|\geq|\boldsymbol{A}+t\boldsymbol{I}_n|>0
\end{align*}
令\(t\to0^+\),即得结论.
\end{proof}

\begin{definition}[亚半正定]
设 \(\boldsymbol{M}\) 为 \(n\) 阶实矩阵, 若对任意的实列向量 \(\boldsymbol{\alpha}\), 总有 \(\boldsymbol{\alpha}'\boldsymbol{M}\boldsymbol{\alpha}\geq0\), 则称 \(\boldsymbol{M}\) 是\textbf{亚半正定阵}. 
\end{definition}

\begin{theorem}\label{theorem:亚半正定阵的等价条件}
证明下列结论等价:
\begin{enumerate}[(1)]
\item \(\boldsymbol{M}\) 是亚半正定阵;
\item \(\boldsymbol{M}+\boldsymbol{M}'\) 是半正定阵;
\item \(\boldsymbol{M}=\boldsymbol{A}+\boldsymbol{S}\), 其中 \(\boldsymbol{A}\) 是半正定实对称矩阵, \(\boldsymbol{S}\) 是实反对称矩阵.
\end{enumerate} 
\end{theorem}
\begin{remark}
由\refpro{proposition:半正定阵的行列式的相关的不等式}可知，亚半正定阵 \(\boldsymbol{M}\) 天然满足 \(|\boldsymbol{M}| = |\boldsymbol{A}+\boldsymbol{S}|\geq0\).
\end{remark}
\begin{proof}
与\refthe{theorem:亚正定阵的等价条件}的证明完全类似.
\end{proof}

\begin{proposition}\label{proposition:对应矩阵的行列式小于零的二次型必存在小于零的一点}
设 \(f(\boldsymbol{x})=\boldsymbol{x}'\boldsymbol{A}\boldsymbol{x}\) 是 \(n\) 元实二次型，\(n\) 阶实矩阵 \(\boldsymbol{A}\) 未必对称且 \(|\boldsymbol{A}|<0\)，求证：必存在一组实数 \(a_1,a_2,\cdots,a_n\)，使得 \(f(a_1,a_2,\cdots,a_n)<0\)。
\end{proposition}
\begin{remark}
这个命题是\refpro{proposition:系数阵的行列式小于零的二次型必存在小于零的一点}的延拓.
\end{remark}
\begin{proof}
用反证法证明。若对任意的 \(\boldsymbol{x}\in\mathbb{R}^n\)，\(f(\boldsymbol{x})=\boldsymbol{x}'\boldsymbol{A}\boldsymbol{x}\geq0\)，则 \(\boldsymbol{A}\) 是亚半正定阵。由\refpro{proposition:半正定阵的行列式的相关的不等式}和\refthe{theorem:亚半正定阵的等价条件}可知 \(|\boldsymbol{A}|\geq0\)，这与假设矛盾。
\end{proof}

\begin{proposition}\label{proposition:半正定阵行列式与主对角乘积的不等式}
设 \(\boldsymbol{A}=(a_{ij})\) 是 \(n\) 阶半正定实对称矩阵，求证：\(|\boldsymbol{A}|\leq a_{11}a_{22}\cdots a_{nn}\)，且等号成立当且仅当或者存在某个 \(a_{ii}=0\) 或者 \(\boldsymbol{A}\) 是对角矩阵。 
\end{proposition}
\begin{proof}
对任意的正实数 \(t\)，\(\boldsymbol{A}+t\boldsymbol{I}_n\) 为正定阵，故由\refcor{corollary:正定阵的行列式的相关不等式}可得
\begin{align*}
|\boldsymbol{A}+t\boldsymbol{I}_n|&\leq(a_{11}+t)(a_{22}+t)\cdots(a_{nn}+t)
\end{align*}
令 \(t\to0^+\)，即得不等式。若 \(\boldsymbol{A}\) 是非正定的半正定阵，则由\refcor{corollary:可逆的半正定阵必是正定阵}可知 \(|\boldsymbol{A}| = 0\)，此时等号成立当且仅当存在某个 \(a_{ii}=0\)；若 \(\boldsymbol{A}\) 是正定阵，则由\refcor{corollary:正定阵的行列式的相关不等式}可知等号成立当且仅当 \(\boldsymbol{A}\) 是对角矩阵。
\end{proof}

\begin{proposition}\label{proposition:半正定阵的迹与行列式相关不等式}
设 \(\boldsymbol{A},\boldsymbol{B}\) 都是 \(n\) 阶半正定实对称矩阵，求证：\(\frac{1}{n}\mathrm{tr}(\boldsymbol{A}\boldsymbol{B})\geq|\boldsymbol{A}|^{\frac{1}{n}}|\boldsymbol{B}|^{\frac{1}{n}}\)，并求等号成立的充要条件。
\end{proposition}
\begin{proof}
{\color{blue}证法一:}
设 \(\boldsymbol{C}\) 为 \(n\) 阶实矩阵，使得 \(\boldsymbol{B}=\boldsymbol{C}'\boldsymbol{C}\)，则由\hyperref[proposition:半正定阵的相关性质]{命题\ref{proposition:半正定阵的相关性质}(2)}可知 \(\boldsymbol{C}\boldsymbol{A}\boldsymbol{C}'=(a_{ij})\) 仍为半正定阵。注意到 \(\mathrm{tr}(\boldsymbol{A}\boldsymbol{B})=\mathrm{tr}(\boldsymbol{A}\boldsymbol{C}'\boldsymbol{C})=\mathrm{tr}(\boldsymbol{C}\boldsymbol{A}\boldsymbol{C}')=\sum_{i = 1}^{n}a_{ii}\)，故由\refpro{proposition:半正定阵行列式与主对角乘积的不等式}和基本不等式可得
\begin{align*}
|\boldsymbol{A}|^{\frac{1}{n}}|\boldsymbol{B}|^{\frac{1}{n}}=|\boldsymbol{A}|^{\frac{1}{n}}|\boldsymbol{C}'\boldsymbol{C}|^{\frac{1}{n}}=|\boldsymbol{C}\boldsymbol{A}\boldsymbol{C}'|^{\frac{1}{n}}\leq(a_{11}a_{22}\cdots a_{nn})^{\frac{1}{n}}\leq\frac{1}{n}\sum_{i = 1}^{n}a_{ii}=\frac{1}{n}\mathrm{tr}(\boldsymbol{A}\boldsymbol{B})
\end{align*}
由\refpro{proposition:半正定阵行列式与主对角乘积的不等式}等号成立的充要条件和幂平均不等式等号成立的充要条件($a_{ii}$全相等)可得,上述不等式等号成立的充要条件是以下两种情形之一成立：

(1)存在某个$a_{ii}=0$且$a_{kk}$都相等,即\(a_{11}=a_{22}=\cdots=a_{nn}=0\)，此时 \(\mathrm{tr}(\boldsymbol{A}\boldsymbol{B}) = 0\)，故由\refpro{proposition:A为实半正定阵AB=O的充要条件为tr(AB)=0}可知 \(\boldsymbol{A}\boldsymbol{B}=\boldsymbol{O}\)；

(2)$\boldsymbol{C}\boldsymbol{A}\boldsymbol{C}'$是对角矩阵且$a_{kk}$都相等,即\(a_{11}=a_{22}=\cdots=a_{nn}=a>0\)且$a_ij=0,i\ne j$，此时
\(\boldsymbol{C}\boldsymbol{A}\boldsymbol{C}'=a\boldsymbol{I}_n\).并且此时\(|\boldsymbol{A}|^{\frac{1}{n}}|\boldsymbol{B}|^{\frac{1}{n}}=\mathrm{tr}(\boldsymbol{A}\boldsymbol{B})=\mathrm{tr}(\boldsymbol{A}\boldsymbol{C}'\boldsymbol{C})=\mathrm{tr}(\boldsymbol{C}\boldsymbol{A}\boldsymbol{C}')=\sum_{i = 1}^{n}a_{ii}=na>0\),因此$|A|,|B|\ne0$,于是此时$A,B$都可逆,从而$C$也可逆.故 \(\boldsymbol{AB}=\boldsymbol{AC}' \boldsymbol{C}=\boldsymbol{C}^{-1}\boldsymbol{CAC}' \boldsymbol{C}=\boldsymbol{C}^{-1}a\boldsymbol{I}_n\boldsymbol{C}=a\boldsymbol{I}_n\)。

综上所述，等号成立的充要条件是 \(\boldsymbol{A}\boldsymbol{B}=k\boldsymbol{I}_n\)，其中 \(k\geq0\)。

{\color{blue}证法二:}
注意到 \(B^{\frac{1}{2}}AB^{\frac{1}{2}}\) 仍为半正定阵，若设其特征值为 \(\lambda_1,\lambda_2,\cdots,\lambda_n\)，则 \(\lambda_i \geq 0\)，且 \(\mathrm{tr}(AB)=\mathrm{tr}(B^{\frac{1}{2}}AB^{\frac{1}{2}})=\sum_{i = 1}^{n}\lambda_i\)，故由基本不等式可得
\begin{align*}
|A|^{\frac{1}{n}}|B|^{\frac{1}{n}} = |B^{\frac{1}{2}}AB^{\frac{1}{2}}|^{\frac{1}{n}} = (\lambda_1\lambda_2\cdots\lambda_n)^{\frac{1}{n}} \leq \frac{1}{n}\sum_{i = 1}^{n}\lambda_i = \frac{1}{n}\mathrm{tr}(AB)
\end{align*}
等号成立的充要条件是以下两种情形之一成立：

(1) \(\lambda_1 = \lambda_2 = \cdots = \lambda_n = 0\)，此时 \(\mathrm{tr}(AB) = 0\)，故由\refpro{proposition:A为实半正定阵AB=O的充要条件为tr(AB)=0}可知 \(AB = O\)；

(2) \(\lambda_1 = \lambda_2 = \cdots = \lambda_n = a > 0\)，此时 \(B^{\frac{1}{2}}AB^{\frac{1}{2}} = aI_n\)，故 \(AB = aI_n\)。
综上所述，等号成立的充要条件是 \(AB = kI_n\)，其中 \(k \geq 0\)。 
\end{proof}

\subsection{性质2 若主对角元为零，则同行同列的所有元素都为零}

\begin{proposition}\label{proposition:若主对角元为零，则同行同列的所有元素都为零}
设 \(\boldsymbol{A}=(a_{ij})\) 为 \(n\) 阶半正定实对称矩阵，求证：若 \(a_{ii}=0\)，则 \(\boldsymbol{A}\) 的第 \(i\) 行和第 \(i\) 列的所有元素都等于零。
\end{proposition}
\begin{remark}
应用可见\hyperref[proposition:利用正定阵构造负定二次型]{例题\ref{proposition:利用正定阵构造负定二次型}证法三}.
\end{remark}
\begin{proof}
任取 \(j\neq i\)，考虑 \(\boldsymbol{A}\) 的第 \(i,j\) 行和列构成的主子式，由\refpro{proposition:半正定阵关于顺序主子式的性质}可得
\[
\begin{vmatrix}
a_{ii}&a_{ij}\\
a_{ji}&a_{jj}
\end{vmatrix}=a_{ii}a_{jj}-a_{ij}a_{ji}=-a_{ij}^2\geq0.
\]
从而 \(a_{ij}=a_{ji}=0(j\neq i)\)，再由$i,j$的任意性,结论得证。
\end{proof}


\subsection{性质3 若$\alpha'A\alpha=0$,则$A\alpha=0$}

\begin{proposition}\label{proposition:半正/负定阵关于线性方程的充要条件}
设 $\boldsymbol{A}$ 为 $n$ 阶实对称矩阵，求证：$\boldsymbol{A}$ 为半正定阵或半负定阵的充要条件是对任一满足 $\boldsymbol{\alpha}'\boldsymbol{A}\boldsymbol{\alpha}=0$ 的 $n$ 维实列向量 $\boldsymbol{\alpha}$，均有 $\boldsymbol{A}\boldsymbol{\alpha}=\boldsymbol{0}$.
\end{proposition}
\begin{proof}
{\heiti 必要性：}若 $\boldsymbol{A}$ 是半正定阵，则存在实矩阵 $\boldsymbol{C}$，使得 $\boldsymbol{A}=\boldsymbol{C}'\boldsymbol{C}$，从而
\begin{align*}
0 = \boldsymbol{\alpha}'\boldsymbol{A}\boldsymbol{\alpha}=\boldsymbol{\alpha}'\boldsymbol{C}'\boldsymbol{C}\boldsymbol{\alpha}=(\boldsymbol{C}\boldsymbol{\alpha})'(\boldsymbol{C}\boldsymbol{\alpha}),
\end{align*}
于是由\refpro{proposition:零矩阵的充要条件}可知$\boldsymbol{C}\boldsymbol{\alpha}=\boldsymbol{0}$，因此 $\boldsymbol{A}\boldsymbol{\alpha}=\boldsymbol{C}'(\boldsymbol{C}\boldsymbol{\alpha})=\boldsymbol{0}$。同理可证 $\boldsymbol{A}$ 是半负定阵的情形。

{\heiti 充分性：}用反证法，设 $\boldsymbol{A}$ 既不是半正定阵，也不是半负定阵，则 $\boldsymbol{A}$ 的正惯性指数 $p > 0$，负惯性指数 $q > 0$。设 $\boldsymbol{C}$ 是非异实矩阵，使得 $\boldsymbol{B}=\boldsymbol{C}'\boldsymbol{A}\boldsymbol{C}=\mathrm{diag}\{\boldsymbol{I}_p,-\boldsymbol{I}_q,\boldsymbol{O}\}$ 为 $\boldsymbol{A}$ 的合同标准型。令 $b_1 = 1$，$b_{p + 1}= 1$，其他 $b_i$ 全为零，则 $\boldsymbol{\beta}=(b_1,b_2,\cdots,b_n)'$ 是非零列向量，并且满足 $\boldsymbol{\beta}'\boldsymbol{B}\boldsymbol{\beta}=0$，但 $\boldsymbol{B}\boldsymbol{\beta}\neq\boldsymbol{0}$，从而 $\boldsymbol{\alpha}=\boldsymbol{C}\boldsymbol{\beta}=(a_1,a_2,\cdots,a_n)'$ 也是非零列向量，并且满足 $\boldsymbol{\alpha}'\boldsymbol{A}\boldsymbol{\alpha}=0$，但 $\boldsymbol{A}\boldsymbol{\alpha}=\boldsymbol{A}\boldsymbol{C}\boldsymbol{\beta}=(\boldsymbol{C}')^{-1}\boldsymbol{B}\boldsymbol{\beta}\neq\boldsymbol{0}$，这就推出了矛盾.
\end{proof}

\begin{proposition}\label{proposition:半正定与实反称阵关于秩的性质}
设 $\boldsymbol{A}$ 为 $n$ 阶半正定实对称矩阵，$\boldsymbol{S}$ 为 $n$ 阶实反对称矩阵，求证：

(1) $\mathrm{r}\left( \boldsymbol{A}+\boldsymbol{S} \right) =\mathrm{r}\left( \boldsymbol{A}\,\,|\,\,\boldsymbol{S} \right) $；

(2) $|\boldsymbol{A}+\boldsymbol{S}|>0$ 成立的充要条件是 $\mathrm{r}\left( \boldsymbol{A}\,\,|\,\,\boldsymbol{S} \right)=n$。
\end{proposition}
\begin{proof}
(1) 只要证明线性方程组 $\begin{pmatrix}
\boldsymbol{A} \\
\boldsymbol{S}
\end{pmatrix}\boldsymbol{x}=\boldsymbol{0}$ 与 $(\boldsymbol{A}+\boldsymbol{S})\boldsymbol{x}=\boldsymbol{0}$ 同解即可. 显然，$\begin{pmatrix}
\boldsymbol{A} \\
\boldsymbol{S}
\end{pmatrix}\boldsymbol{x}=\boldsymbol{0}$ 的任一解都是 $(\boldsymbol{A}+\boldsymbol{S})\boldsymbol{x}=\boldsymbol{0}$ 的解. 反之，任取 $(\boldsymbol{A}+\boldsymbol{S})\boldsymbol{x}=\boldsymbol{0}$ 的解 $\boldsymbol{x}=\boldsymbol{x}_0\in\mathbb{R}^n$，即 $(\boldsymbol{A}+\boldsymbol{S})\boldsymbol{x}_0=\boldsymbol{0}$，此等式左乘 $\boldsymbol{x}_0'$，由\refpro{proposition:反对称阵的刻画}可得
\begin{align*}
0=\boldsymbol{x}_0'(\boldsymbol{A}+\boldsymbol{S})\boldsymbol{x}_0=\boldsymbol{x}_0'\boldsymbol{A}\boldsymbol{x}_0+\boldsymbol{x}_0'\boldsymbol{S}\boldsymbol{x}_0=\boldsymbol{x}_0'\boldsymbol{A}\boldsymbol{x}_0,
\end{align*}
再由\refpro{proposition:半正/负定阵关于线性方程的充要条件}可知 $\boldsymbol{A}\boldsymbol{x}_0=\boldsymbol{0}$，从而 $\boldsymbol{S}\boldsymbol{x}_0=\boldsymbol{0}$，于是 $\boldsymbol{x}=\boldsymbol{x}_0$ 也是 $\begin{pmatrix}
\boldsymbol{A} \\
\boldsymbol{S}
\end{pmatrix}\boldsymbol{x}=\boldsymbol{0}$ 的解.

(2) 由\refpro{proposition:半正定阵的行列式的相关的不等式}可知 $|\boldsymbol{A}+\boldsymbol{S}|\geq0$，故 $|\boldsymbol{A}+\boldsymbol{S}|>0$ 当且仅当 $\boldsymbol{A}+\boldsymbol{S}$ 非异，由 (1) 可知这也当且仅当 $\mathrm{r}\left( \boldsymbol{A}\,\,|\,\,\boldsymbol{S} \right) =\mathrm{r}(\boldsymbol{A}+\boldsymbol{S})=n$.
\end{proof}

\begin{proposition}\label{proposition:}
设 $\boldsymbol{A},\boldsymbol{B}$ 为 $n$ 阶实对称矩阵，其中 $\boldsymbol{B}$ 半正定且满足 $|\boldsymbol{A}+\mathrm{i}\boldsymbol{B}| = 0$，求证：存在非零实列向量 $\boldsymbol{\alpha}$，使得 $\boldsymbol{A}\boldsymbol{\alpha}=\boldsymbol{B}\boldsymbol{\alpha}=\boldsymbol{0}$。
\end{proposition}
\begin{proof}
由 $|\boldsymbol{A}+\mathrm{i}\boldsymbol{B}| = 0$ 可知，存在非零复列向量 $\boldsymbol{\gamma}=\boldsymbol{\alpha}+\mathrm{i}\boldsymbol{\beta}$，其中 $\boldsymbol{\alpha},\boldsymbol{\beta}\in\mathbb{R}^n$，使得 $(\boldsymbol{A}+\mathrm{i}\boldsymbol{B})\boldsymbol{\gamma}=(\boldsymbol{A}+\mathrm{i}\boldsymbol{B})(\boldsymbol{\alpha}+\mathrm{i}\boldsymbol{\beta})=\boldsymbol{0}$。按实部和虚部整理后可得
\begin{align}
\boldsymbol{A}\boldsymbol{\alpha}-\boldsymbol{B}\boldsymbol{\beta}&=\boldsymbol{0}, \label{eq:8.4}\\
\boldsymbol{A}\boldsymbol{\beta}+\boldsymbol{B}\boldsymbol{\alpha}&=\boldsymbol{0}. \label{eq:8.5}
\end{align}
将 \eqref{eq:8.5} 式左乘 $\boldsymbol{\alpha}'$ 减去 \eqref{eq:8.4} 式左乘 $\boldsymbol{\beta}'$，注意到 $\boldsymbol{\alpha}'\boldsymbol{A}\boldsymbol{\beta}=(\boldsymbol{\alpha}'\boldsymbol{A}\boldsymbol{\beta})'=\boldsymbol{\beta}'\boldsymbol{A}\boldsymbol{\alpha}$，故可得 $\boldsymbol{\alpha}'\boldsymbol{B}\boldsymbol{\alpha}+\boldsymbol{\beta}'\boldsymbol{B}\boldsymbol{\beta}=0$。由 $\boldsymbol{B}$ 的半正定性可得 $\boldsymbol{\alpha}'\boldsymbol{B}\boldsymbol{\alpha}=\boldsymbol{\beta}'\boldsymbol{B}\boldsymbol{\beta}=0$，再由\refpro{proposition:半正/负定阵关于线性方程的充要条件}可得 $\boldsymbol{B}\boldsymbol{\alpha}=\boldsymbol{B}\boldsymbol{\beta}=\boldsymbol{0}$，从而 $\boldsymbol{A}\boldsymbol{\alpha}=\boldsymbol{A}\boldsymbol{\beta}=\boldsymbol{0}$。因为 $\boldsymbol{\gamma}\neq\boldsymbol{0}$，故 $\boldsymbol{\alpha},\boldsymbol{\beta}$ 中至少有一个是非零实列向量，从而结论得证.
\end{proof}

\begin{proposition}\label{proposition:利用核空间求半正定型的规范标准型}
设 $\boldsymbol{A}$ 为 $n$ 阶半正定实对称矩阵，$f(\boldsymbol{x})=\boldsymbol{x}'\boldsymbol{A}\boldsymbol{x}$ 是相伴的半正定实二次型. 设 $\mathrm{Ker} f(\boldsymbol{x}) =\{\boldsymbol{\alpha}\in\mathbb{R}^n\mid f(\boldsymbol{\alpha})=\boldsymbol{\alpha}'\boldsymbol{A}\boldsymbol{\alpha}=0\}$ 作为实线性空间的维数等于 $d$，求证：$f(\boldsymbol{x})$ 的规范标准形为 $y_1^2 + y_2^2+\cdots + y_{n - d}^2$。
\end{proposition}
\begin{remark}
若实二次型 $f(\boldsymbol{x})$ 可通过配方（不要求是非异线性变换）变成完全平方和，则 $f(\boldsymbol{x})$ 必为半正定型. 一般来说，$\mathrm{Ker} f(\boldsymbol{x})$ 及其维数比较容易求出(实际上,$\dim mathrm{Ker} f(\boldsymbol{x})=\mathrm{r}(A)$)，因此由这个\refpro{proposition:利用核空间求半正定型的规范标准型}便可快速得到 $f(\boldsymbol{x})$ 的规范标准型.具体应用见\hyperref[example:例8.34]{例题\ref{example:例8.34}解法三},\hyperref[example:例8.35]{例题\ref{example:例8.35}解法三}.
\end{remark}
\begin{proof}
由\refpro{proposition:半正/负定阵关于线性方程的充要条件}可知 $\mathrm{Ker} f(\boldsymbol{x})$ 等于齐次线性方程组 $\boldsymbol{A}\boldsymbol{x}=\boldsymbol{0}$ 的解空间，故由 $\dim\mathrm{Ker} f(\boldsymbol{x}) = d$ 和线性方程组的求解理论可知 $\mathrm{r}(\boldsymbol{A}) = n - d$，于是半正定型 $f(\boldsymbol{x})$ 的正惯性指数等于 $n - d$，从而结论得证。
\end{proof}


\subsection{性质4 主对角块占优}

半正定阵的第四个重要性质是：\textbf{若实对称矩阵 $\boldsymbol{M}=\begin{pmatrix}
\boldsymbol{A} & \boldsymbol{B} \\
\boldsymbol{B}' & \boldsymbol{D}
\end{pmatrix}$ 是半正定阵，则主对角块 $\boldsymbol{A},\boldsymbol{D}$ 占优，即利用 $\boldsymbol{A},\boldsymbol{D}$ 以及第三类分块初等变换可将非主对角块消去，从而得到分块对角矩阵.} 

若 $\boldsymbol{M}$ 为正定阵，则 $\boldsymbol{A},\boldsymbol{D}$ 都是正定阵，从而$\boldsymbol{A},\boldsymbol{D}$ 都可逆,由分块初等变换可知上述性质显然成立. 若 $\boldsymbol{M}$ 为半正定阵，则由线性方程组的求解理论(\refthe{theorem:矩阵方程有解的充要条件})可知，上述性质等价于如下结论.

\begin{proposition}\label{proposition:例8.75}
设 $\boldsymbol{M}=\begin{pmatrix}
\boldsymbol{A} & \boldsymbol{B} \\
\boldsymbol{B}' & \boldsymbol{D}
\end{pmatrix}$ 为半正定实对称矩阵，求证：$\mathrm{r}\left( \boldsymbol{A}\,\,|\,\,\boldsymbol{B} \right) =\mathrm{r}(\boldsymbol{A})$。
\end{proposition}
\begin{remark}
半正定阵的性质 4(即这个\refpro{proposition:例8.75})可看成是半正定阵的性质 2(\refpro{proposition:若主对角元为零，则同行同列的所有元素都为零})的推广. 
\end{remark}
\begin{proof}
{\color{blue}证法一:}
根据线性方程组的求解理论，要证明 $\mathrm{r}\left( \boldsymbol{A}\,\,|\,\,\boldsymbol{B} \right) =\mathrm{r}(\boldsymbol{A})$，只要证明线性方程组 $\begin{pmatrix}
\boldsymbol{A} \\
\boldsymbol{B}'
\end{pmatrix}\boldsymbol{x}=\boldsymbol{0}$ 与 $\boldsymbol{A}\boldsymbol{x}=\boldsymbol{0}$ 同解即可. 显然前面线性方程组的解是后面线性方程组的解，下面证明反之也成立. 设 $\boldsymbol{A}\boldsymbol{x}_0=\boldsymbol{0}$，其中 $\boldsymbol{x}_0$ 是实列向量，则有
\begin{align*}
\begin{pmatrix}
\boldsymbol{x}_0' & \boldsymbol{0}
\end{pmatrix}
\begin{pmatrix}
\boldsymbol{A} & \boldsymbol{B} \\
\boldsymbol{B}' & \boldsymbol{D}
\end{pmatrix}
\begin{pmatrix}
\boldsymbol{x}_0 \\
\boldsymbol{0}
\end{pmatrix}=\boldsymbol{x}_0'\boldsymbol{A}\boldsymbol{x}_0 = 0,
\end{align*}
由\refpro{proposition:半正/负定阵关于线性方程的充要条件}可知 $\begin{pmatrix}
\boldsymbol{A} & \boldsymbol{B} \\
\boldsymbol{B}' & \boldsymbol{D}
\end{pmatrix}
\begin{pmatrix}
\boldsymbol{x}_0 \\
\boldsymbol{0}
\end{pmatrix}=\boldsymbol{0}$，即有 $\begin{pmatrix}
\boldsymbol{A} \\
\boldsymbol{B}'
\end{pmatrix}\boldsymbol{x}_0=\boldsymbol{0}$ 成立，从而结论得证.

{\color{blue}证法二:}
由 $\boldsymbol{M}$ 的半正定性可得 $\boldsymbol{A}$ 的半正定性，因此存在非异实矩阵 $\boldsymbol{C}$，使得 $\boldsymbol{C}'\boldsymbol{A}\boldsymbol{C}=\begin{pmatrix}
\boldsymbol{I}_r & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{O}
\end{pmatrix}$. 考虑如下合同变换：
\begin{align*}
\begin{pmatrix}
\boldsymbol{C}' & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{I}
\end{pmatrix}
\begin{pmatrix}
\boldsymbol{A} & \boldsymbol{B} \\
\boldsymbol{B}' & \boldsymbol{D}
\end{pmatrix}
\begin{pmatrix}
\boldsymbol{C} & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{I}
\end{pmatrix}=
\begin{pmatrix}
\boldsymbol{C}'\boldsymbol{A}\boldsymbol{C} & \boldsymbol{C}'\boldsymbol{B} \\
\boldsymbol{B}'\boldsymbol{C} & \boldsymbol{D}
\end{pmatrix}=
\begin{pmatrix}
\boldsymbol{I}_r & \boldsymbol{O} & \boldsymbol{B}_1 \\
\boldsymbol{O} & \boldsymbol{O} & \boldsymbol{B}_2 \\
\boldsymbol{B}_1' & \boldsymbol{B}_2' & \boldsymbol{D}
\end{pmatrix},
\end{align*}
由\refpro{proposition:若主对角元为零，则同行同列的所有元素都为零}可知 $\boldsymbol{B}_2 = \boldsymbol{O}$. 对分块矩阵 $\left( \boldsymbol{A}\,\,|\,\,\boldsymbol{B} \right)$ 左乘 $\boldsymbol{C}'$，相当于实施初等行变换，再对左边的分块 $\boldsymbol{A}$ 右乘 $\boldsymbol{C}$，相当于实施初等列变换，注意到矩阵的秩在初等变换下不改变，故有
\[
\mathrm{r}\left( \boldsymbol{A}\,\,|\,\,\boldsymbol{B} \right) =\mathrm{r}\left( \boldsymbol{C}' \boldsymbol{AC}\,\,|\,\boldsymbol{C}' \boldsymbol{B} \right) =\mathrm{r}\begin{pmatrix}
\boldsymbol{I}_r & \boldsymbol{O} & \boldsymbol{B}_1 \\
\boldsymbol{O} & \boldsymbol{O} & \boldsymbol{O}
\end{pmatrix}=r = \mathrm{r}(\boldsymbol{A}).\]
\end{proof}

\begin{proposition}\label{proposition:例8.76}
设 $\boldsymbol{A},\boldsymbol{B},\boldsymbol{A}-\boldsymbol{B}$ 都是 $n$ 阶半正定实对称矩阵，求证：$\mathrm{r}\left( \boldsymbol{A}\,\,|\,\,\boldsymbol{B} \right) =\mathrm{r}(\boldsymbol{A})$。
\end{proposition}
\begin{proof}
{\color{blue}证法一:}
根据线性方程组的求解理论(\refpro{proposition:线性方程组同解系数矩阵秩相同})，要证明 $\mathrm{r}\left( \boldsymbol{A}\,\,|\,\,\boldsymbol{B} \right) =\mathrm{r}(\boldsymbol{A})$，只要证明线性方程组 $\begin{pmatrix}
\boldsymbol{A} \\
\boldsymbol{B}
\end{pmatrix}\boldsymbol{x}=\boldsymbol{0}$ 与 $\boldsymbol{A}\boldsymbol{x}=\boldsymbol{0}$ 同解即可. 显然前面线性方程组的解是后面线性方程组的解，下面证明反之也成立. 设 $\boldsymbol{A}\boldsymbol{x}_0=\boldsymbol{0}$，其中 $\boldsymbol{x}_0$ 是实列向量，则将等式 $\boldsymbol{A}=(\boldsymbol{A}-\boldsymbol{B})+\boldsymbol{B}$ 的两边同时左乘 $\boldsymbol{x}_0'$，右乘 $\boldsymbol{x}_0$，可得
\begin{align*}
0=\boldsymbol{x}_0'\boldsymbol{A}\boldsymbol{x}_0=\boldsymbol{x}_0'(\boldsymbol{A}-\boldsymbol{B})\boldsymbol{x}_0+\boldsymbol{x}_0'\boldsymbol{B}\boldsymbol{x}_0.
\end{align*}
因为 $\boldsymbol{A}-\boldsymbol{B},\boldsymbol{B}$ 都是半正定阵，故 $\boldsymbol{x}_0'(\boldsymbol{A}-\boldsymbol{B})\boldsymbol{x}_0\geq0$，$\boldsymbol{x}_0'\boldsymbol{B}\boldsymbol{x}_0\geq0$，由上述等式可得 $\boldsymbol{x}_0'(\boldsymbol{A}-\boldsymbol{B})\boldsymbol{x}_0=\boldsymbol{x}_0'\boldsymbol{B}\boldsymbol{x}_0 = 0$，再由\refpro{proposition:半正/负定阵关于线性方程的充要条件}可得 $\boldsymbol{B}\boldsymbol{x}_0=\boldsymbol{0}$，因此 $\boldsymbol{x}=\boldsymbol{x}_0$ 也是线性方程组 $\begin{pmatrix}
\boldsymbol{A} \\
\boldsymbol{B}
\end{pmatrix}\boldsymbol{x}=\boldsymbol{0}$ 的解，结论得证.

{\color{blue}证法二:}
考虑如下对称分块初等变换：
\begin{align*}
\begin{pmatrix}
\boldsymbol{A}-\boldsymbol{B} & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{B}
\end{pmatrix}\to
\begin{pmatrix}
\boldsymbol{A}-\boldsymbol{B} & \boldsymbol{B} \\
\boldsymbol{O} & \boldsymbol{B}
\end{pmatrix}\to
\begin{pmatrix}
\boldsymbol{A} & \boldsymbol{B} \\
\boldsymbol{B} & \boldsymbol{B}
\end{pmatrix}=\begin{pmatrix}
\boldsymbol{A} & \boldsymbol{B} \\
\boldsymbol{B}' & \boldsymbol{B}
\end{pmatrix},
\end{align*}
因为 $\boldsymbol{A}-\boldsymbol{B},\boldsymbol{B}$ 都是半正定阵，故 $\begin{pmatrix}
\boldsymbol{A}-\boldsymbol{B} & \boldsymbol{O} \\
\boldsymbol{O} & \boldsymbol{B}
\end{pmatrix}$ 也是半正定阵，从而 $\begin{pmatrix}
\boldsymbol{A} & \boldsymbol{B} \\
\boldsymbol{B}' & \boldsymbol{B}
\end{pmatrix}$ 也是半正定阵，由\refpro{proposition:例8.75}即得结论.
\end{proof}

\begin{proposition}\label{proposition:例8.77}
设 $\boldsymbol{A},\boldsymbol{B}$ 为 $n$ 阶半正定实对称矩阵，求证：

(1) $\mathrm{r}(\boldsymbol{A}+\boldsymbol{B})=\mathrm{r}(\boldsymbol{A}\,\,|\,\,\boldsymbol{B})$；

(2) $\boldsymbol{A}+\boldsymbol{B}$ 是正定阵的充要条件是 $\mathrm{r}(\boldsymbol{A}\,\,|\,\,\boldsymbol{B})=n$。
\end{proposition}
\begin{proof}
(1) 注意到$(\boldsymbol{A}+\boldsymbol{B})-\boldsymbol{A}=\boldsymbol{A}$是半正定实对称矩阵,由\refpro{proposition:例8.76}可知，$\mathrm{r}(\boldsymbol{A}+\boldsymbol{B})=\mathrm{r}(\boldsymbol{A}+\boldsymbol{B}\,\,|\,\,\boldsymbol{B})=\mathrm{r}(\boldsymbol{A}\,\,|\,\,\boldsymbol{B})$(做分块初等变换,用第1列分块减去第2列分块)。

(2) 注意到 $\boldsymbol{A}+\boldsymbol{B}$ 是半正定阵，故它是正定阵当且仅当它是非异阵，即 $\mathrm{r}(\boldsymbol{A}+\boldsymbol{B})=n$，再由 (1) 可知，这也当且仅当 $\mathrm{r}(\boldsymbol{A}\,\,|\,\,\boldsymbol{B})=n$。
\end{proof}

\begin{proposition}\label{proposition:例8.78}
证明下列关于 $n$ 阶实对称矩阵 $\boldsymbol{A}=(a_{ij})$ 的命题等价：

(1) $\boldsymbol{A}$ 是半正定阵；

(2) 存在主对角元全等于 $1$ 的上三角矩阵 $\boldsymbol{B}$ 和主对角元全为非负实数的对角矩阵 $\boldsymbol{D}$，使得 $\boldsymbol{A}=\boldsymbol{B}'\boldsymbol{D}\boldsymbol{B}$；

(3) 存在主对角元全为非负实数的上三角矩阵 $\boldsymbol{C}$，使得 $\boldsymbol{A}=\boldsymbol{C}'\boldsymbol{C}$。
\end{proposition}
\begin{proof}
{\color{blue}证法一:}
$(1)\Rightarrow(2)$：只要证明存在主对角元全为 $1$ 的上三角矩阵 $\boldsymbol{T}$，使得 $\boldsymbol{T}'\boldsymbol{A}\boldsymbol{T}=\boldsymbol{D}$ 是半正定对角矩阵即可. 因为一旦得证，由\hyperref[proposition:上三角阵性质]{上三角阵性质}可知$\boldsymbol{B}=\boldsymbol{T}^{-1}$ 也是主对角元全为 $1$ 的上三角矩阵，并且 $\boldsymbol{A}=\boldsymbol{B}'\boldsymbol{D}\boldsymbol{B}$. 对阶数 $n$ 进行归纳，当 $n = 1$ 时结论显然成立. 假设对 $n - 1$ 阶半正定阵结论成立，现证明 $n$ 阶半正定阵的情形. 设 $\boldsymbol{A}=\begin{pmatrix}
\boldsymbol{A}_{n - 1} & \boldsymbol{\alpha} \\
\boldsymbol{\alpha}' & a_{nn}
\end{pmatrix}$，其中 $\boldsymbol{A}_{n - 1}$ 是 $n - 1$ 阶矩阵，$\boldsymbol{\alpha}$ 是 $n - 1$ 维列向量. 因为 $\boldsymbol{A}$ 半正定，所以 $\boldsymbol{A}_{n - 1}$ 是 $n - 1$ 阶半正定阵，并且由\refpro{proposition:例8.75}可得 $\mathrm{r}(\boldsymbol{A}_{n - 1}\,\,|\,\,\boldsymbol{\alpha})=\mathrm{r}(\boldsymbol{A}_{n - 1})$，故由线性方程组的求解理论(\refthe{theorem:矩阵方程有解的充要条件})可知，存在 $n - 1$ 维列向量 $\boldsymbol{\beta}$，使得 $\boldsymbol{A}_{n - 1}\boldsymbol{\beta}=\boldsymbol{\alpha}$. 考虑如下对称分块初等变换：
\begin{align*}
\begin{pmatrix}
\boldsymbol{I}_{n - 1} & \boldsymbol{O} \\
-\boldsymbol{\beta}' & 1
\end{pmatrix}
\begin{pmatrix}
\boldsymbol{A}_{n - 1} & \boldsymbol{\alpha} \\
\boldsymbol{\alpha}' & a_{nn}
\end{pmatrix}
\begin{pmatrix}
\boldsymbol{I}_{n - 1} & -\boldsymbol{\beta} \\
\boldsymbol{O} & 1
\end{pmatrix}=
\begin{pmatrix}
\boldsymbol{A}_{n - 1} & \boldsymbol{O} \\
\boldsymbol{O} & a_{nn}-\boldsymbol{\beta}'\boldsymbol{A}_{n - 1}\boldsymbol{\beta}
\end{pmatrix},
\end{align*}
由 $\boldsymbol{A}$ 的半正定性(\refpro{proposition:半正定阵关于顺序主子式的性质})可得 $a_{nn}-\boldsymbol{\beta}'\boldsymbol{A}_{n - 1}\boldsymbol{\beta}\geq0$. 再由归纳假设，存在主对角元全为 $1$ 的 $n - 1$ 阶上三角矩阵 $\boldsymbol{T}_{n - 1}$，使得 $\boldsymbol{T}_{n - 1}'\boldsymbol{A}_{n - 1}\boldsymbol{T}_{n - 1}=\boldsymbol{D}_{n - 1}$ 是 $n - 1$ 阶半正定对角矩阵. 令
\[
\boldsymbol{T}=\begin{pmatrix}
\boldsymbol{I}_{n - 1} & -\boldsymbol{\beta} \\
\boldsymbol{O} & 1
\end{pmatrix}
\begin{pmatrix}
\boldsymbol{T}_{n - 1} & \boldsymbol{O} \\
\boldsymbol{O} & 1
\end{pmatrix},
\]
则 $\boldsymbol{T}$ 是一个主对角元全为 $1$ 的 $n$ 阶上三角矩阵，使得
\[
\boldsymbol{T}'\boldsymbol{A}\boldsymbol{T}=\begin{pmatrix}
\boldsymbol{D}_{n - 1} & \boldsymbol{O} \\
\boldsymbol{O} & a_{nn}-\boldsymbol{\beta}'\boldsymbol{A}_{n - 1}\boldsymbol{\beta}
\end{pmatrix}
\]
是 $n$ 阶半正定对角矩阵.

$(2)\Rightarrow(3)$：由(2)可知,存在主对角元全等于 $1$ 的上三角矩阵 $\boldsymbol{B}$ 和主对角元全为非负实数的对角矩阵 $\boldsymbol{D}$，使得 $\boldsymbol{A}=\boldsymbol{B}'\boldsymbol{D}\boldsymbol{B}$.设 $\boldsymbol{D}=\mathrm{diag}\{d_1,d_2,\cdots,d_n\}$，令 $s_i = \sqrt{d_i}\geq0$，
\[
\boldsymbol{S}=\mathrm{diag}\{s_1,s_2,\cdots,s_n\}.
\]
设 $\boldsymbol{C}=\boldsymbol{S}\boldsymbol{B}$，则 $\boldsymbol{A}=\boldsymbol{C}'\boldsymbol{C}$. 显然 $\boldsymbol{C}=\boldsymbol{S}\boldsymbol{B}$ 是主对角元全为非负实数的上三角矩阵.

$(3)\Rightarrow(1)$：由 $\boldsymbol{A}=\boldsymbol{C}'\boldsymbol{C}$即\hyperref[proposition:半正定阵的判定准则123]{命题\ref{proposition:半正定阵的判定准则123}(2)}可知 $\boldsymbol{A}$ 为半正定阵.

{\color{blue}证法二(矩阵的QR分解):}
(1) $\Rightarrow$ (3)、(2)：因为 $A$ 半正定，故存在实矩阵 $P$，使得 $A = P'P$。设 $P = QC$ 是 $QR$ 分解，其中 $Q$ 是正交矩阵，$C$ 是主对角元全大于等于零的上三角矩阵，则
\[
A=(QC)'(QC)=C'(Q'Q)C = C'C.
\]
由\hyperref[theorem:矩阵的QR分解]{矩阵的QR分解}的证明可知，若 $C = (c_{ij})$ 的第 $(i,i)$ 元素 $c_{ii}=0$，则 $C$ 的第 $i$ 行元素全为零。令 $D$ $=$ $\mathrm{diag}$ $\{$ $c_{11}^2$,$c_{22}^2$,$\cdots$,$c_{nn}^2$ $\}$，且 $B = (b_{ij})$ 定义为：若 $c_{ii}>0$，则 $b_{ij}=\frac{c_{ij}}{c_{ii}}$（$1\leq j\leq n$）；若 $c_{ii}=0$，则 $b_{ij}=\delta_{ij}$（$1\leq j\leq n$），其中 $\delta_{ij}$ 是 Kronecker 符号。容易验证 $B$ 是主对角元全等于 1 的上三角矩阵且 $A = B'DB$。

(2) $\Rightarrow$ (1) 和 (3) $\Rightarrow$ (1) 都是显然的。 
\end{proof}















\end{document}
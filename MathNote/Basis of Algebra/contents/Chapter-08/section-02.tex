\documentclass[../../main.tex]{subfiles}
\graphicspath{{\subfix{../../image/}}} % 指定图片目录,后续可以直接使用图片文件名。

% 例如:
% \begin{figure}[H]
% \centering
% \includegraphics{image-01.01}
% \caption{图片标题}
% \label{figure:image-01.01}
% \end{figure}
% 注意:上述\label{}一定要放在\caption{}之后,否则引用图片序号会只会显示??.

\begin{document}

\section{二次型的化简}

\subsection{配方法}

\begin{lemma}
\begin{align*}
(x_1 + x_2 + \cdots + x_n)^2&=x_1^2 + x_2^2 + \cdots + x_n^2\\
&+ 2x_1x_2 + 2x_1x_3 + \cdots + 2x_1x_n\\
&+ 2x_2x_3 + \cdots + 2x_2x_n\\
&+ \cdots\\
&+ 2x_{n - 1}x_n.
\end{align*} 
\end{lemma}

\vspace{1cm}

通过下面这个例子介绍\textbf{配方法}.
\begin{example}\label{example:二次型化简配方法例题1}
将下列二次型化成对角型:
\[
f(x_1,x_2,x_3)=x_1^2 + 2x_1x_2 - 4x_1x_3 - 3x_2^2 - 6x_2x_3 + x_3^2.
\]
\end{example}
\begin{solution}
先将含有 $x_1$ 的项放在一起凑成完全平方再减去必要的项:
\begin{align*}
f(x_1,x_2,x_3)&=(x_1^2 + 2x_1x_2 - 4x_1x_3) - 3x_2^2 - 6x_2x_3 + x_3^2\\
&=((x_1 + x_2 - 2x_3)^2 - x_2^2 - 4x_3^2 + 4x_2x_3) - 3x_2^2 - 6x_2x_3 + x_3^2\\
&=(x_1 + x_2 - 2x_3)^2 - 4x_2^2 - 2x_2x_3 - 3x_3^2.
\end{align*}
再对后面那些项配方:
\begin{align*}
-4x_2^2 - 2x_2x_3 - 3x_3^2&=-\left((2x_2 + \frac{1}{2}x_3)^2 - \frac{1}{4}x_3^2\right) - 3x_3^2\\
&=-(2x_2 + \frac{1}{2}x_3)^2 - \frac{11}{4}x_3^2.
\end{align*}
于是
\[
f(x_1,x_2,x_3)=(x_1 + x_2 - 2x_3)^2 - (2x_2 + \frac{1}{2}x_3)^2 - \frac{11}{4}x_3^2.
\]
令
\[
\begin{cases}
y_1 = x_1 + x_2 - 2x_3,\\
y_2 = 2x_2 + \frac{1}{2}x_3,\\
y_3 = x_3,
\end{cases}
\]
则
\[
\begin{pmatrix}
y_1\\
y_2\\
y_3
\end{pmatrix}=
\begin{pmatrix}
1 & 1 & -2\\
0 & 2 & \frac{1}{2}\\
0 & 0 & 1
\end{pmatrix}
\begin{pmatrix}
x_1\\
x_2\\
x_3
\end{pmatrix},
\]
因此 $f = y_1^2 - y_2^2 - \frac{11}{4}y_3^2$，其变换矩阵为
\[
\boldsymbol{C}=
\begin{pmatrix}
1 & 1 & -2\\
0 & 2 & \frac{1}{2}\\
0 & 0 & 1
\end{pmatrix}^{-1}=
\begin{pmatrix}
1 & -\frac{1}{2} & \frac{9}{4}\\
0 & \frac{1}{2} & -\frac{1}{4}\\
0 & 0 & 1
\end{pmatrix}.
\]
\end{solution}
\begin{remark}
在用配方法化二次型为只含平方项的标准型的过程中，必须保证变换矩阵 $\boldsymbol{C}$ 是非异阵. 如果我们按照上面例题的方法，将含 $x_1$ 的项放在一起配成一个完全平方，接下来将含 $x_2$ 的项放在一起再配方，如此不断做下去. 最后得到的变换矩阵 $\boldsymbol{C}$ 是一个主对角元全不为零的上三角阵，因此是一个非异阵. 有时我们用看似简单的方法得到的结果未必正确. 比如用观察法即可得到下列配方:
\begin{align*}
f&=2x_1^2 + 2x_2^2 + 2x_3^2 - 2x_1x_2 + 2x_1x_3 + 2x_2x_3\\
&=(x_1 - x_2)^2 + (x_1 + x_3)^2 + (x_2 + x_3)^2.
\end{align*}
若令 $y_1 = x_1 - x_2$, $y_2 = x_1 + x_3$, $y_3 = x_2 + x_3$，则 $f = y_1^2 + y_2^2 + y_3^2$. 由于矩阵
\[
\begin{pmatrix}
1 & -1 & 0\\
1 & 0 & 1\\
0 & 1 & 1
\end{pmatrix}
\]
不是非异阵，因此上述配方不是我们所需要的结论.
\end{remark}

\vspace{1cm}

如果已知的二次型中没有平方项，我们可以采用下面例子中的方法.
\begin{example}
将二次型
\[
f(x_1,x_2,x_3,x_4)=2x_1x_2 - x_1x_3 + x_1x_4 - x_2x_3 + x_2x_4 - 2x_3x_4
\]
化成对角型.
\end{example}
\begin{solution}
这个二次型缺少了 $x_i^2$ 项，因此无法用\refexa{example:二次型化简配方法例题1}的方法配方，但我们可作如下变换:
\[
\begin{cases}
x_1 = y_1 + y_2,\\
x_2 = y_1 - y_2,\\
x_3 = y_3,\\
x_4 = y_4.
\end{cases}
\]
代入原二次型得
\[
f = 2y_1^2 - 2y_2^2 - 2y_1y_3 + 2y_1y_4 - 2y_3y_4.
\]
这时 $y_1^2$ 项不为零，于是
\begin{align*}
f&=(2y_1^2 - 2y_1y_3 + 2y_1y_4) - 2y_2^2 - 2y_3y_4\\
&=2\left((y_1 - \frac{1}{2}y_3 + \frac{1}{2}y_4)^2 - \frac{1}{4}y_3^2 - \frac{1}{4}y_4^2 + \frac{1}{2}y_3y_4\right) - 2y_2^2 - 2y_3y_4\\
&=2(y_1 - \frac{1}{2}y_3 + \frac{1}{2}y_4)^2 - 2y_2^2 - \frac{1}{2}y_3^2 - y_3y_4 - \frac{1}{2}y_4^2\\
&=2(y_1 - \frac{1}{2}y_3 + \frac{1}{2}y_4)^2 - 2y_2^2 - \frac{1}{2}(y_3 + y_4)^2.
\end{align*}
令
\[
\begin{cases}
z_1 = y_1 - \frac{1}{2}y_3 + \frac{1}{2}y_4,\\
z_2 = y_2,\\
z_3 = y_3 + y_4,\\
z_4 = y_4,
\end{cases}
\]
于是
\[
f = 2z_1^2 - 2z_2^2 - \frac{1}{2}z_3^2,
\]
其中 $z_4^2$ 的系数为零，故未写出.

为求变换矩阵 $\boldsymbol{C}$，可从上面 $z_i$ 的表示式中解出 $y_i$:
\[
\begin{cases}
y_1 = z_1 + \frac{1}{2}z_3 - z_4,\\
y_2 = z_2,\\
y_3 = z_3 - z_4,\\
y_4 = z_4,
\end{cases}
\]
再将 $x_i$ 求出:
\[
\begin{cases}
x_1 = z_1 + z_2 + \frac{1}{2}z_3 - z_4,\\
x_2 = z_1 - z_2 + \frac{1}{2}z_3 - z_4,\\
x_3 = z_3 - z_4,\\
x_4 = z_4,
\end{cases}
\]
于是
\[
\boldsymbol{C}=
\begin{pmatrix}
1 & 1 & \frac{1}{2} & -1\\
1 & -1 & \frac{1}{2} & -1\\
0 & 0 & 1 & -1\\
0 & 0 & 0 & 1
\end{pmatrix}.
\] 
\end{solution}



\subsection{初等变换法}

用配方法化简二次型有时比较麻烦，求非异阵 $\boldsymbol{C}$ 也比较麻烦. 我们常常用初等变换法来化简二次型，初等变换法的依据是\hyperref[lemma:初等合同变换]{初等合同变换}.

这种方法可总结如下: 作 $n\times 2n$ 矩阵 $(\boldsymbol{A}\vdots\boldsymbol{I}_n)$，对这个矩阵实施初等行变换，同时施以同样的初等列变换，将它左半边化为对角阵，则这个对角阵就是已化简的二次型的相伴矩阵，右半边的转置便是变换矩阵 $\boldsymbol{C}$.

如碰到第 $(1,1)$ 元素是零的矩阵，可先设法将第 $(1,1)$ 元素化成非零，再进行上述过程. 

\vspace{0.5cm}

下面我们通过例子来说明这种方法.

\begin{example}\label{example:二次型化简-初等变换法例题1}
将下列二次型化为对角型:
\[
f(x_1,x_2,x_3)=x_1^2 - 3x_2^2 - 2x_1x_2 + 2x_1x_3 - 6x_2x_3.
\]
\end{example}
\begin{solution}
记与 $f$ 相伴的对称阵为 $\boldsymbol{A}$，写出 $(\boldsymbol{A}\vdots\boldsymbol{I}_3)$ 并作初等变换:
\begin{gather*}
\left( \boldsymbol{A}\,|\,\boldsymbol{I}_3 \right) =\left( \begin{matrix}
1&		-1&		1&		1&		0&		0\\
-1&		-3&		-3&		0&		1&		0\\
1&		-3&		0&		0&		0&		1\\
\end{matrix} \right) \xrightarrow{r_1+r_2}
\\
\left( \begin{matrix}
1&		-1&		1&		1&		0&		0\\
0&		-4&		-2&		1&		1&		0\\
1&		-3&		0&		0&		0&		1\\
\end{matrix} \right) \xrightarrow{j_1+j_2}\left( \begin{matrix}
1&		0&		1&		1&		0&		0\\
0&		-4&		-2&		1&		1&		0\\
1&		-2&		0&		0&		0&		1\\
\end{matrix} \right) \xrightarrow{-r_1+r_3}
\\
\left( \begin{matrix}
1&		0&		1&		1&		0&		0\\
0&		-4&		-2&		1&		1&		0\\
0&		-2&		-1&		-1&		0&		1\\
\end{matrix} \right) \xrightarrow{-j_1+j_3}\left( \begin{matrix}
1&		0&		0&		1&		0&		0\\
0&		-4&		-2&		1&		1&		0\\
0&		-2&		-1&		-1&		0&		1\\
\end{matrix} \right) \xrightarrow{-\frac{1}{2}r_2+r_3}
\\
\left( \begin{matrix}
1&		0&		0&		1&		0&		0\\
0&		-4&		-2&		1&		1&		0\\
0&		0&		0&		-\frac{3}{2}&		-\frac{1}{2}&		1\\
\end{matrix} \right) \xrightarrow{-\frac{1}{2}j_2+j_3}\left( \begin{matrix}
1&		0&		0&		1&		0&		0\\
0&		-4&		0&		1&		1&		0\\
0&		0&		0&		-\frac{3}{2}&		-\frac{1}{2}&		1\\
\end{matrix} \right) .
\end{gather*}
于是 $f$ 可化简为
\[
y_1^2 - 4y_2^2,
\]
\[
\boldsymbol{C}=
\begin{pmatrix}
1 & 0 & 0\\
1 & 1 & 0\\
-\frac{3}{2} & -\frac{1}{2} & 1
\end{pmatrix}'=
\begin{pmatrix}
1 & 1 & -\frac{3}{2}\\
0 & 1 & -\frac{1}{2}\\
0 & 0 & 1
\end{pmatrix}.
\]
\end{solution}

\begin{example}
将二次型 $f(x_1,x_2,x_3)=2x_1x_2 + 4x_1x_3 - 4x_2x_3$ 化成对角型.
\end{example}
\begin{solution}
写出与 $f$ 相伴的对称阵 $\boldsymbol{A}$，作 $(\boldsymbol{A}\vdots\boldsymbol{I}_3)$ 并将它的第二行加到第一行上，再将第二列加到第一列上:
\[
(\boldsymbol{A}\vdots\boldsymbol{I}_3)=
\begin{pmatrix}
0 & 1 & 2 & 1 & 0 & 0\\
1 & 0 & -2 & 0 & 1 & 0\\
2 & -2 & 0 & 0 & 0 & 1
\end{pmatrix}\to
\begin{pmatrix}
2 & 1 & 0 & 1 & 1 & 0\\
1 & 0 & -2 & 0 & 1 & 0\\
0 & -2 & 0 & 0 & 0 & 1
\end{pmatrix}.
\]
同\refexa{example:二次型化简-初等变换法例题1}一样，对上述矩阵进行初等变换得到
\[
\begin{pmatrix}
2 & 0 & 0 & 1 & 1 & 0\\
0 & -\frac{1}{2} & 0 & -\frac{1}{2} & \frac{1}{2} & 0\\
0 & 0 & 8 & 2 & -2 & 1
\end{pmatrix}.
\]
因此 $f$ 化简为
\[
2y_1^2 - \frac{1}{2}y_2^2 + 8y_3^2,
\]
\[
\boldsymbol{C}=
\begin{pmatrix}
1 & -\frac{1}{2} & 2\\
1 & \frac{1}{2} & -2\\
0 & 0 & 1
\end{pmatrix}.
\] 
\end{solution}








\end{document}